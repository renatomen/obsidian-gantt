/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/dhtmlx-gantt@9.0.15/codebase/dhtmlxgantt.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(t,e){"object"==typeof exports&&typeof module<"u"?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=typeof globalThis<"u"?globalThis:t||self).dhtmlxgantt={})}(this,(function(t){"use strict";
/** @license

dhtmlxGantt v.9.0.15 Standard

This version of dhtmlxGantt is distributed under GPL 2.0 license and can be legally used in GPL projects.

To use dhtmlxGantt in non-GPL projects (and get Pro version of the product), please obtain Individual, Commercial, Enterprise or Ultimate license on our site https://dhtmlx.com/docs/products/dhtmlxGantt/#licensing or contact us at info@dhtmlx.com

(c) XB Software

*/function e(t){var e=0,i=0,n=0,a=0;if(t.getBoundingClientRect){var r=t.getBoundingClientRect(),s=document.body,o=document.documentElement||document.body.parentNode||document.body,l=window.pageYOffset||o.scrollTop||s.scrollTop,d=window.pageXOffset||o.scrollLeft||s.scrollLeft,c=o.clientTop||s.clientTop||0,u=o.clientLeft||s.clientLeft||0;e=r.top+l-c,i=r.left+d-u,n=document.body.offsetWidth-r.right,a=document.body.offsetHeight-r.bottom}else{for(;t;)e+=parseInt(t.offsetTop,10),i+=parseInt(t.offsetLeft,10),t=t.offsetParent;n=document.body.offsetWidth-t.offsetWidth-i,a=document.body.offsetHeight-t.offsetHeight-e}return{y:Math.round(e),x:Math.round(i),width:t.offsetWidth,height:t.offsetHeight,right:Math.round(n),bottom:Math.round(a)}}function i(t){var e=!1,i=!1;if(window.getComputedStyle){var n=window.getComputedStyle(t,null);e=n.display,i=n.visibility}else t.currentStyle&&(e=t.currentStyle.display,i=t.currentStyle.visibility);return"none"!=e&&"hidden"!=i}function n(t){return!isNaN(t.getAttribute("tabindex"))&&1*t.getAttribute("tabindex")>=0}function a(t){return!{a:!0,area:!0}[t.nodeName.loLowerCase()]||!!t.getAttribute("href")}function r(t){return!{input:!0,select:!0,textarea:!0,button:!0,object:!0}[t.nodeName.toLowerCase()]||!t.hasAttribute("disabled")}function s(t){for(var e=t.querySelectorAll(["a[href]","area[href]","input","select","textarea","button","iframe","object","embed","[tabindex]","[contenteditable]"].join(", ")),s=Array.prototype.slice.call(e,0),o=0;o<s.length;o++)s[o].$position=o;for(s.sort((function(t,e){return 0===t.tabIndex&&0!==e.tabIndex?1:0!==t.tabIndex&&0===e.tabIndex?-1:t.tabIndex===e.tabIndex?t.$position-e.$position:t.tabIndex<e.tabIndex?-1:1})),o=0;o<s.length;o++){var l=s[o];(n(l)||r(l)||a(l))&&i(l)||(s.splice(o,1),o--)}return s}function o(){var t=document.createElement("div");t.style.cssText="visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;",document.body.appendChild(t);var e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),Math.max(e,15)}function l(t){if(!t)return"";var e=t.className||"";return e.baseVal&&(e=e.baseVal),e.indexOf||(e=""),v(e)}function d(t,e){e&&-1===t.className.indexOf(e)&&(t.className+=" "+e)}function c(t,e){e=e.split(" ");for(var i=0;i<e.length;i++){var n=new RegExp("\\s?\\b"+e[i]+"\\b(?![-_.])","");t.className=t.className.replace(n,"")}}function u(t){return"string"==typeof t?document.getElementById(t)||document.querySelector(t)||document.body:t||document.body}var h;function _(t,e){h||(h=document.createElement("div")),h.innerHTML=e;var i=h.firstChild;return t.appendChild(i),i}function g(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function f(t,e){for(var i=t.childNodes,n=i.length,a=[],r=0;r<n;r++){var s=i[r];s.className&&-1!==s.className.indexOf(e)&&a.push(s)}return a}function p(t){var e;return t.tagName?e=t:(e=(t=t||window.event).target||t.srcElement).shadowRoot&&t.composedPath&&(e=t.composedPath()[0]),e}function m(t,e){if(e){for(var i=p(t);i;){if(i.getAttribute&&i.getAttribute(e))return i;i=i.parentNode||i.host}return null}}function v(t){return(String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")}).apply(t)}function k(t,e,i){var n=p(t),a="";for(void 0===i&&(i=!0);n;){if(a=l(n)){var r=a.indexOf(e);if(r>=0){if(!i)return n;var s=0===r||!v(a.charAt(r-1)),o=r+e.length>=a.length||!v(a.charAt(r+e.length));if(s&&o)return n}}n=n.parentNode}return null}function y(t,i){var n;const a=document.documentElement,r=e(i),{clientX:s,clientY:o}=(null==(n=t.touches)?void 0:n[0])??t;return{x:s+a.scrollLeft-a.clientLeft-r.x+i.scrollLeft,y:o+a.scrollTop-a.clientTop-r.y+i.scrollTop}}function b(t,i){const n=e(t),a=e(i);return{x:n.x-a.x,y:n.y-a.y}}function x(t,e){if(!t||!e)return!1;for(;t&&t!=e;)t=t.parentNode;return t===e}function $(t,e){if(t.closest)return t.closest(e);if(t.matches||t.msMatchesSelector||t.webkitMatchesSelector){var i=t;if(!document.documentElement.contains(i))return null;do{if((i.matches||i.msMatchesSelector||i.webkitMatchesSelector).call(i,e))return i;i=i.parentElement||i.parentNode}while(null!==i&&1===i.nodeType);return null}return console.error("Your browser is not supported"),null}function w(t){for(;t;){if(t.offsetWidth>0&&t.offsetHeight>0)return t;t=t.parentElement}return null}function S(){return document.head.createShadowRoot||document.head.attachShadow}function T(){var t=document.activeElement;return t.shadowRoot&&(t=t.shadowRoot.activeElement),t===document.body&&document.getSelection&&(t=document.getSelection().focusNode||document.body),t}function E(t){if(!t||!S())return document.body;for(;t.parentNode&&(t=t.parentNode);)if(t instanceof ShadowRoot)return t.host;return document.body}const C=Object.freeze(Object.defineProperty({__proto__:null,addClassName:d,closest:$,getActiveElement:T,getChildNodes:f,getClassName:l,getClosestSizedElement:w,getFocusableNodes:s,getNodePosition:e,getRelativeEventPosition:y,getRelativeNodePosition:b,getRootNode:E,getScrollSize:o,getTargetNode:p,hasClass:function(t,e){return"classList"in t?t.classList.contains(e):new RegExp("\\b"+e+"\\b").test(t.className)},hasShadowParent:function(t){return!!E(t)},insertNode:_,isChildOf:x,isShadowDomSupported:S,locateAttribute:m,locateClassName:k,removeClassName:c,removeNode:g,toNode:u},Symbol.toStringTag,{value:"Module"})),D=typeof window<"u"?window:global;let A=class{constructor(t){this._mouseDown=!1,this._touchStarts=!1,this._touchActive=!1,this._longTapTimer=!1,this._gantt=t,this._domEvents=t._createDomEventScope()}attach(t,e,i){const n=this._gantt,a=t.getViewPort();this._originPosition=D.getComputedStyle(a).display,this._restoreOriginPosition=()=>{a.style.position=this._originPosition},"static"===this._originPosition&&(a.style.position="relative");const r=n.$services.getService("state");r.registerProvider("clickDrag",(()=>({autoscroll:!1})));let s=null;const o=()=>{s&&(this._mouseDown=!0,t.setStart(n.copy(s)),t.setPosition(n.copy(s)),t.setEnd(n.copy(s)),s=null)};this._domEvents.attach(a,"mousedown",(t=>{u(t)}));const l=E(n.$root)||document.body;function d(t){return t.changedTouches&&t.changedTouches[0]||t}this._domEvents.attach(l,"mouseup",(t=>{h(t)})),this._domEvents.attach(a,"mousemove",(t=>{_(t)})),this._domEvents.attach(a,"touchstart",(t=>{this._touchStarts=!0,this._longTapTimer=setTimeout((()=>{this._touchStarts&&(u(d(t)),this._touchStarts=!1,this._touchActive=!0)}),this._gantt.config.touch_drag)})),this._domEvents.attach(l,"touchend",(t=>{this._touchStarts=!1,this._touchActive=!1,clearTimeout(this._longTapTimer),h(d(t))})),this._domEvents.attach(a,"touchmove",(t=>{if(this._touchActive){let e=c();if(e&&n.utils.dom.closest(t.target,e))return;_(d(t)),t.preventDefault()}else this._touchStarts=!1,clearTimeout(this._longTapTimer)}));const c=()=>{let t=".gantt_task_line, .gantt_task_link";return void 0!==i&&(t=i instanceof Array?i.join(", "):i),t},u=i=>{s=null;let a=c();a&&n.utils.dom.closest(i.target,a)||(r.registerProvider("clickDrag",(()=>({autoscroll:this._mouseDown}))),e&&!0!==i[e]||(s=this._getCoordinates(i,t)))},h=i=>{if(s=null,(!e||!0===i[e])&&!0===this._mouseDown){this._mouseDown=!1;const e=this._getCoordinates(i,t);t.dragEnd(e)}},_=i=>{if(e&&!0!==i[e])return;const n=this._gantt.ext.clickDrag,a=(this._gantt.config.drag_timeline||{}).useKey;if(n&&a&&!e&&i[a])return;let r=null;if(!this._mouseDown&&s)return r=this._getCoordinates(i,t),void(Math.abs(s.relative.left-r.relative.left)>5&&o());!0===this._mouseDown&&(r=this._getCoordinates(i,t),t.setEnd(r),t.render())}}detach(){const t=this._gantt;this._domEvents.detachAll(),this._restoreOriginPosition&&this._restoreOriginPosition(),t.$services.getService("state").unregisterProvider("clickDrag")}destructor(){this.detach()}_getCoordinates(t,e){const i=e.getViewPort(),n=i.getBoundingClientRect(),{clientX:a,clientY:r}=t;return{absolute:{left:a,top:r},relative:{left:a-n.left+i.scrollLeft,top:r-n.top+i.scrollTop}}}};var I=function(){this._silent_mode=!1,this.listeners={}};function M(t){var e=new I;t.attachEvent=function(t,i,n){var a,r,s,o;t="ev_"+t.toLowerCase(),e.listeners[t]||(e.listeners[t]=(a=this,r={},s=0,o=function(){var t=!0;for(var e in r){var i=r[e].apply(a,arguments);t=t&&i}return t},o.addEvent=function(t,e){if("function"==typeof t){var i;if(e&&e.id?i=e.id:(i=s,s++),e&&e.once){var n=t;t=function(){n(),o.removeEvent(i)}}return r[i]=t,i}return!1},o.removeEvent=function(t){delete r[t]},o.clear=function(){r={}},o)),n&&n.thisObject&&(i=i.bind(n.thisObject));var l=t+":"+e.listeners[t].addEvent(i,n);return n&&n.id&&(l=n.id),l},t.attachAll=function(t){this.attachEvent("listen_all",t)},t.callEvent=function(t,i){if(e._silent_mode)return!0;var n="ev_"+t.toLowerCase(),a=e.listeners;return a.ev_listen_all&&a.ev_listen_all.apply(this,[t].concat(i)),!a[n]||a[n].apply(this,i)},t.checkEvent=function(t){return!!e.listeners["ev_"+t.toLowerCase()]},t.detachEvent=function(t){if(t){var i=e.listeners;for(var n in i)i[n].removeEvent(t);var a=t.split(":");if(i=e.listeners,2===a.length){var r=a[0],s=a[1];i[r]&&i[r].removeEvent(s)}}},t.detachAllEvents=function(){for(var t in e.listeners)e.listeners[t].clear()}}I.prototype={_silentStart:function(){this._silent_mode=!0},_silentEnd:function(){this._silent_mode=!1}};var N={second:1,minute:60,hour:3600,day:86400,week:604800,month:2592e3,quarter:7776e3,year:31536e3};function L(t){return N[t]||N.hour}function P(t,e){if(t.forEach)t.forEach(e);else for(var i=t.slice(),n=0;n<i.length;n++)e(i[n],n)}function R(t,e){if(t.find)return t.find(e);for(var i=0;i<t.length;i++)if(e(t[i],i))return t[i]}function H(t,e){if(t.includes)return t.includes(e);for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}function O(t){return Array.isArray?Array.isArray(t):t&&void 0!==t.length&&t.pop&&t.push}function B(t){return!(!t||"object"!=typeof t||!(t.getFullYear&&t.getMonth&&t.getDate))}function z(t){return B(t)&&!isNaN(t.getTime())}function W(t,e){var i,n=function(){n.$cancelTimeout(),n.$pending=!0;var a=Array.prototype.slice.call(arguments);i=setTimeout((function(){t.apply(this,a),n.$pending=!1}),e)};return n.$pending=!1,n.$cancelTimeout=function(){clearTimeout(i),n.$pending=!1},n.$execute=function(){var e=Array.prototype.slice.call(arguments);t.apply(this,e),n.$cancelTimeout()},n}function j(t,e){return F(t)&&!F(e)&&(t="0"),t}function F(t){return 0===t}function V(t,e){for(var i,n,a,r=0,s=t.length-1;r<=s;)if(n=+t[i=Math.floor((r+s)/2)],a=+t[i-1],n<e)r=i+1;else{if(!(n>e)){for(;+t[i]==+t[i+1];)i++;return i}if(!isNaN(a)&&a<e)return i-1;s=i-1}return t.length-1}class U{constructor(t,e,i){var n;this._el=document.createElement("div"),this.defaultRender=(t,e)=>{this._el||(this._el=document.createElement("div"));const i=this._el,n=Math.min(t.relative.top,e.relative.top),a=Math.max(t.relative.top,e.relative.top),r=Math.min(t.relative.left,e.relative.left),s=Math.max(t.relative.left,e.relative.left);if(this._singleRow){const t=this._getTaskPositionByTop(this._startPoint.relative.top);i.style.height=t.height+"px",i.style.top=t.top+"px"}else i.style.height=Math.abs(a-n)+"px",i.style.top=n+"px";return i.style.width=Math.abs(s-r)+"px",i.style.left=r+"px",i},this._gantt=e,this._view=i,this._viewPort=t.viewPort,this._el.classList.add(t.className),"function"==typeof t.callback&&(this._callback=t.callback),this.render=()=>{let e;e=t.render?t.render(this._startPoint,this._endPoint):this.defaultRender(this._startPoint,this._endPoint),e!==this._el&&(this._el&&this._el.parentNode&&this._el.parentNode.removeChild(this._el),this._el=e),""!==t.className&&this._el.classList.add(t.className),this.draw()},(n=this._viewPort).attachEvent&&n.detachEvent||M(this._viewPort),this._singleRow=t.singleRow,this._useRequestAnimationFrame=t.useRequestAnimationFrame}draw(){if(this._useRequestAnimationFrame)return requestAnimationFrame((()=>{this._viewPort.appendChild(this.getElement())}));this._viewPort.appendChild(this.getElement())}clear(){if(this._useRequestAnimationFrame)return requestAnimationFrame((()=>{this._el.parentNode&&this._viewPort.removeChild(this._el)}));this._el.parentNode&&this._viewPort.removeChild(this._el)}getElement(){return this._el}getViewPort(){return this._viewPort}setStart(t){const e=this._gantt;this._startPoint=t,this._startDate=e.dateFromPos(this._startPoint.relative.left),this._viewPort.callEvent("onBeforeDrag",[this._startPoint])}setEnd(t){const e=this._gantt;if(this._endPoint=t,this._singleRow){const t=this._getTaskPositionByTop(this._startPoint.relative.top);this._endPoint.relative.top=t.top}this._endDate=e.dateFromPos(this._endPoint.relative.left),this._startPoint.relative.left>this._endPoint.relative.left&&(this._positionPoint={relative:{left:this._endPoint.relative.left,top:this._positionPoint.relative.top},absolute:{left:this._endPoint.absolute.left,top:this._positionPoint.absolute.top}}),this._startPoint.relative.top>this._endPoint.relative.top&&(this._positionPoint={relative:{left:this._positionPoint.relative.left,top:this._endPoint.relative.top},absolute:{left:this._positionPoint.absolute.left,top:this._endPoint.absolute.top}}),this._viewPort.callEvent("onDrag",[this._startPoint,this._endPoint])}setPosition(t){this._positionPoint=t}dragEnd(t){const e=this._gantt;t.relative.left<0&&(t.relative.left=0),this._viewPort.callEvent("onBeforeDragEnd",[this._startPoint,t]),this.setEnd(t),this._endDate=this._endDate||e.getState().max_date,this._startDate.valueOf()>this._endDate.valueOf()&&([this._startDate,this._endDate]=[this._endDate,this._startDate]),this.clear();const i=e.getTaskByTime(this._startDate,this._endDate),n=this._getTasksByTop(this._startPoint.relative.top,this._endPoint.relative.top);this._viewPort.callEvent("onDragEnd",[this._startPoint,this._endPoint]),this._callback&&this._callback(this._startPoint,this._endPoint,this._startDate,this._endDate,i,n)}getInBounds(){return this._singleRow}_getTasksByTop(t,e){const i=this._gantt;let n=t,a=e;t>e&&(n=e,a=t);const r=this._getTaskPositionByTop(n).index,s=this._getTaskPositionByTop(a).index,o=[];for(let t=r;t<=s;t++)i.getTaskByIndex(t)&&o.push(i.getTaskByIndex(t));return o}_getTaskPositionByTop(t){const e=this._gantt,i=this._view,n=i.getItemIndexByTopPosition(t),a=e.getTaskByIndex(n);if(a){const t=i.getItemHeight(a.id);return{top:i.getItemTop(a.id)||0,height:t||0,index:n}}{const n=i.getTotalHeight();return{top:t>n?n:0,height:e.config.row_height,index:t>n?e.getTaskCount():0}}}}let q=!1;class G{constructor(t){this._mouseDown=!1,this._calculateDirectionVector=()=>{if(this._trace.length>=10){const t=this._trace.slice(this._trace.length-10),e=[];for(let i=1;i<t.length;i++)e.push({x:t[i].x-t[i-1].x,y:t[i].y-t[i-1].y});const i={x:0,y:0};return e.forEach((t=>{i.x+=t.x,i.y+=t.y})),{magnitude:Math.sqrt(i.x*i.x+i.y*i.y),angleDegrees:180*Math.atan2(Math.abs(i.y),Math.abs(i.x))/Math.PI}}return null},this._applyDndReadyStyles=()=>{this._timeline.$task.classList.add("gantt_timeline_move_available")},this._clearDndReadyStyles=()=>{this._timeline.$task.classList.remove("gantt_timeline_move_available")},this._getScrollPosition=t=>{const e=this._gantt;return{x:e.$ui.getView(t.$config.scrollX).getScrollState().position,y:e.$ui.getView(t.$config.scrollY).getScrollState().position}},this._countNewScrollPosition=t=>{const e=this._calculateDirectionVector();let i=this._startPoint.x-t.x,n=this._startPoint.y-t.y;return e&&(e.angleDegrees<15?n=0:e.angleDegrees>75&&(i=0)),{x:this._scrollState.x+i,y:this._scrollState.y+n}},this._setScrollPosition=(t,e)=>{const i=this._gantt;requestAnimationFrame((()=>{i.scrollLayoutCell(t.$id,e.x,e.y)}))},this._stopDrag=t=>{const e=this._gantt;if(this._trace=[],e.$root.classList.remove("gantt_noselect"),void 0!==this._originalReadonly&&this._mouseDown&&(e.config.readonly=this._originalReadonly,e.config.drag_timeline&&e.config.drag_timeline.render&&e.render()),void 0!==this._originAutoscroll&&(e.config.autoscroll=this._originAutoscroll),e.config.drag_timeline){const{useKey:i}=e.config.drag_timeline;if(i&&!0!==t[i])return}this._mouseDown=!1,q=!1},this._startDrag=t=>{const e=this._gantt;this._originAutoscroll=e.config.autoscroll,e.config.autoscroll=!1,q=!0,e.$root.classList.add("gantt_noselect"),this._originalReadonly=e.config.readonly,e.config.readonly=!0,e.config.drag_timeline&&e.config.drag_timeline.render&&e.render(),this._trace=[],this._mouseDown=!0;const{x:i,y:n}=this._getScrollPosition(this._timeline);this._scrollState={x:i,y:n},this._startPoint={x:t.clientX,y:t.clientY},this._trace.push(this._startPoint)},this._gantt=t,this._domEvents=t._createDomEventScope(),this._trace=[]}static create(t){return new G(t)}static _isDragInProgress(){return q}destructor(){this._domEvents.detachAll()}attach(t){this._timeline=t;const e=this._gantt;this._domEvents.attach(t.$task,"mousedown",(t=>{if(!e.config.drag_timeline)return;const{useKey:i,ignore:n,enabled:a}=e.config.drag_timeline;if(!1===a)return;let r=".gantt_task_line, .gantt_task_link";void 0!==n&&(r=n instanceof Array?n.join(", "):n),r&&e.utils.dom.closest(t.target,r)||i&&!0!==t[i]||this._startDrag(t)})),this._domEvents.attach(document,"keydown",(t=>{if(!e.config.drag_timeline)return;const{useKey:i}=e.config.drag_timeline;i&&!0===t[i]&&this._applyDndReadyStyles()})),this._domEvents.attach(document,"keyup",(t=>{if(!e.config.drag_timeline)return;const{useKey:i}=e.config.drag_timeline;i&&!1===t[i]&&(this._clearDndReadyStyles(),this._stopDrag(t))})),this._domEvents.attach(document,"mouseup",(t=>{this._stopDrag(t)})),this._domEvents.attach(e.$root,"mouseup",(t=>{this._stopDrag(t)})),this._domEvents.attach(document,"mouseleave",(t=>{this._stopDrag(t)})),this._domEvents.attach(e.$root,"mouseleave",(t=>{this._stopDrag(t)})),this._domEvents.attach(e.$root,"mousemove",(i=>{if(!e.config.drag_timeline)return;const{useKey:n}=e.config.drag_timeline;if(n&&!0!==i[n])return;const a=this._gantt.ext.clickDrag,r=(this._gantt.config.click_drag||{}).useKey;if((!a||!r||n||!i[r])&&!0===this._mouseDown){this._trace.push({x:i.clientX,y:i.clientY});const e=this._countNewScrollPosition({x:i.clientX,y:i.clientY});this._setScrollPosition(t,e),this._scrollState=e,this._startPoint={x:i.clientX,y:i.clientY}}}))}}class Y{constructor(t){this.show=(t,e)=>{void 0===e?this._showForTask(t):this._showAtCoordinates(t,e)},this.hide=t=>{const e=this._gantt,i=this._quickInfoBox;this._quickInfoBoxId=0;const n=this._quickInfoTask;if(this._quickInfoTask=null,i&&i.parentNode){if(e.config.quick_info_detached)return e.callEvent("onAfterQuickInfo",[n]),i.parentNode.removeChild(i);i.className+=" gantt_qi_hidden","auto"===i.style.right?i.style.left="-350px":i.style.right="-350px",t&&(i.style.left=i.style.right="",i.parentNode.removeChild(i)),e.callEvent("onAfterQuickInfo",[n])}},this.getNode=()=>this._quickInfoBox?this._quickInfoBox:null,this.setContainer=t=>{t&&(this._container="string"==typeof t?document.getElementById(t):t)},this.setContent=t=>{const e=this._gantt,i={taskId:null,header:{title:"",date:""},content:"",buttons:e.config.quickinfo_buttons};t||(t=i),t.taskId||(t.taskId=i.taskId),t.header||(t.header=i.header),t.header.title||(t.header.title=i.header.title),t.header.date||(t.header.date=i.header.date),t.content||(t.content=i.content),t.buttons||(t.buttons=i.buttons);let n=this.getNode();n||(n=this._createQuickInfoElement()),t.taskId&&(this._quickInfoBoxId=t.taskId);const a=n.querySelector(".gantt_cal_qi_title"),r=a.querySelector(".gantt_cal_qi_tcontent"),s=a.querySelector(".gantt_cal_qi_tdate"),o=n.querySelector(".gantt_cal_qi_content"),l=n.querySelector(".gantt_cal_qi_controls");e._waiAria.quickInfoHeader(n,[t.header.title,t.header.date].join(" ")),r.innerHTML=t.header.title,s.innerHTML=t.header.date,t.header.title||t.header.date?a.style.display="":a.style.display="none",o.innerHTML=t.content;const d=t.buttons;d.length?l.style.display="":l.style.display="none";let c="";for(let t=0;t<d.length;t++){const i=e._waiAria.quickInfoButtonAttrString(e.locale.labels[d[t]]);c+=`<div class="gantt_qi_big_icon ${d[t]} dhx_gantt_${d[t]}" title="${e.locale.labels[d[t]]}" ${i}>\n            <div class='dhx_menu_icon dhx_gantt_icon ${d[t]} gantt_menu_icon dhx_gantt_${d[t]}'></div>\n            <div>${e.locale.labels[d[t]]}</div>\n         </div>`}l.innerHTML=c,e.eventRemove(n,"click",this._qiButtonClickHandler),e.eventRemove(n,"keypress",this._qiKeyPressHandler),e.event(n,"click",this._qiButtonClickHandler),e.event(n,"keypress",this._qiKeyPressHandler)},this._qiButtonClickHandler=t=>{this._qi_button_click(t.target)},this._qiKeyPressHandler=t=>{const e=t.which;13!==e&&32!==e||setTimeout((()=>{this._qi_button_click(t.target)}),1)},this._gantt=t}_showAtCoordinates(t,e){this.hide(!0),this._quickInfoBoxId=0,this._quickInfoTask=null,this._quickInfoBox||(this._createQuickInfoElement(),this.setContent()),this._appendAtCoordinates(t,e),this._gantt.callEvent("onQuickInfo",[null])}_showForTask(t){const e=this._gantt;if(t===this._quickInfoBoxId&&e.utils.dom.isChildOf(this._quickInfoBox,document.body)||!e.config.show_quick_info)return;this.hide(!0);const i=this._getContainer(),n=this._get_event_counter_part(t,6,i.xViewport,i.yViewport);n&&(this._quickInfoBox=this._init_quick_info(t),this._quickInfoTask=t,this._quickInfoBox.className=this._prepare_quick_info_classname(t),this._fill_quick_data(t),this._show_quick_info(n,6),e.callEvent("onQuickInfo",[t]))}_get_event_counter_part(t,e,i,n){const a=this._gantt;let r=a.getTaskNode(t);if(!r&&(r=a.getTaskRowNode(t),!r))return null;let s=0;const o=e+r.offsetTop+r.offsetHeight;let l=r;if(a.utils.dom.isChildOf(l,i))for(;l&&l!==i;)s+=l.offsetLeft,l=l.offsetParent;const d=a.getScrollState();return l?{left:s,top:o,dx:s+r.offsetWidth/2-d.x>i.offsetWidth/2?1:0,dy:o+r.offsetHeight/2-d.y>n.offsetHeight/2?1:0,width:r.offsetWidth,height:r.offsetHeight}:null}_createQuickInfoElement(){const t=this._gantt,e=document.createElement("div");e.className+="gantt_cal_quick_info",t._waiAria.quickInfoAttr(e);var i=`\n\t\t<div class="gantt_cal_qi_tcontrols">\n\t\t\t<a class="gantt_cal_qi_close_btn dhx_gantt_icon dhx_gantt_icon_close"></a>\n\t\t</div>\n\t\t<div class="gantt_cal_qi_title" ${t._waiAria.quickInfoHeaderAttrString()}>\n\t\t\t\t\n\t\t\t\t<div class="gantt_cal_qi_tcontent"></div>\n\t\t\t\t<div class="gantt_cal_qi_tdate"></div>\n\t\t\t</div>\n\t\t\t<div class="gantt_cal_qi_content"></div>`;if(i+='<div class="gantt_cal_qi_controls">',i+="</div>",e.innerHTML=i,t.config.quick_info_detached){const e=this._getContainer();t.event(e.parent,"scroll",(()=>{this.hide()}))}return this._quickInfoBox=e,e}_init_quick_info(t){const e=this._gantt,i=e.getTask(t);return"boolean"==typeof this._quickInfoReadonly&&e.isReadonly(i)!==this._quickInfoReadonly&&(this.hide(!0),this._quickInfoBox=null),this._quickInfoReadonly=e.isReadonly(i),this._quickInfoBox||(this._quickInfoBox=this._createQuickInfoElement()),this._quickInfoBox}_prepare_quick_info_classname(t){const e=this._gantt,i=e.getTask(t);let n=`gantt_cal_quick_info gantt_${e.getTaskType(i)}`;const a=e.templates.quick_info_class(i.start_date,i.end_date,i);return a&&(n+=" "+a),n}_fill_quick_data(t){const e=this._gantt,i=e.getTask(t);this._quickInfoBoxId=t;let n=[];if(this._quickInfoReadonly){const t=e.config.quickinfo_buttons,i={icon_delete:!0,icon_edit:!0};for(let e=0;e<t.length;e++)this._quickInfoReadonly&&i[t[e]]||n.push(t[e])}else n=e.config.quickinfo_buttons;this.setContent({header:{title:e.templates.quick_info_title(i.start_date,i.end_date,i),date:e.templates.quick_info_date(i.start_date,i.end_date,i)},content:e.templates.quick_info_content(i.start_date,i.end_date,i),buttons:n})}_appendAtCoordinates(t,e){const i=this._quickInfoBox,n=this._getContainer();i.parentNode&&"#document-fragment"!==i.parentNode.nodeName.toLowerCase()||n.parent.appendChild(i),i.style.left=t+"px",i.style.top=e+"px"}_show_quick_info(t,e){const i=this._gantt,n=this._quickInfoBox;if(i.config.quick_info_detached){const a=this._getContainer();n.parentNode&&"#document-fragment"!==n.parentNode.nodeName.toLowerCase()||a.parent.appendChild(n);const r=n.offsetWidth,s=n.offsetHeight,o=i.getScrollState(),l=a.xViewport,d=a.yViewport,c=l.offsetWidth+o.x-r,u=t.top-o.y+s;let h=t.top;u>d.offsetHeight/2&&(h=t.top-(s+t.height+2*e),h<o.y&&u<=d.offsetHeight&&(h=t.top)),h<o.y&&(h=o.y);const _=Math.min(Math.max(o.x,t.left-t.dx*(r-t.width)),c),g=h;this._appendAtCoordinates(_,g)}else n.style.top="20px",1===t.dx?(n.style.right="auto",n.style.left="-300px",setTimeout((()=>{n.style.left="10px"}),1)):(n.style.left="auto",n.style.right="-300px",setTimeout((()=>{n.style.right="10px"}),1)),n.className+=" gantt_qi_"+(1===t.dx?"left":"right"),i.$root.appendChild(n)}_qi_button_click(t){const e=this._gantt,i=this._quickInfoBox;if(!t||t===i)return;if(t.closest(".gantt_cal_qi_close_btn"))return void this.hide();const n=t.className;if(-1!==n.indexOf("_icon")){const t=this._quickInfoBoxId;e.$click.buttons[n.split(" ")[1].replace("icon_","")](t)}else this._qi_button_click(t.parentNode)}_getContainer(){const t=this._gantt;let e=this._container?this._container:t.$task_data;return e&&e.offsetHeight&&e.offsetWidth?{parent:e,xViewport:t.$task,yViewport:t.$task_data}:(e=this._container?this._container:t.$grid_data,e&&e.offsetHeight&&e.offsetWidth?{parent:e,xViewport:t.$grid,yViewport:t.$grid_data}:{parent:this._container?this._container:t.$layout,xViewport:t.$layout,yViewport:t.$layout})}}var J,K={}.constructor.toString();function X(t){var e,i;if(t&&"object"==typeof t)switch(!0){case B(t):i=new Date(t);break;case O(t):for(i=new Array(t.length),e=0;e<t.length;e++)i[e]=X(t[e]);break;default:if(t.constructor.toString()!==K)i=Object.create(t);else{if(function(t){return t.$$typeof&&t.$$typeof.toString().includes("react.")}(t))return t;i={}}for(e in t)Object.prototype.hasOwnProperty.apply(t,[e])&&(i[e]=X(t[e]))}return i||t}function Z(t,e,i){for(var n in e)(void 0===t[n]||i)&&(t[n]=e[n]);return t}function Q(t){return void 0!==t}function tt(){return J||(J=(new Date).valueOf()),++J}function et(t,e){return t.bind?t.bind(e):function(){return t.apply(e,arguments)}}function it(t,e,i,n){t.addEventListener?t.addEventListener(e,i,void 0!==n&&n):t.attachEvent&&t.attachEvent("on"+e,i)}function nt(t,e,i,n){t.removeEventListener?t.removeEventListener(e,i,void 0!==n&&n):t.detachEvent&&t.detachEvent("on"+e,i)}const at=Object.freeze(Object.defineProperty({__proto__:null,bind:et,copy:X,defined:Q,event:it,eventRemove:nt,mixin:Z,uid:tt},Symbol.toStringTag,{value:"Module"}));function rt(t,e){t=t||it,e=e||nt;var i=[],n={attach:function(e,n,a,r){i.push({element:e,event:n,callback:a,capture:r}),t(e,n,a,r)},detach:function(t,n,a,r){e(t,n,a,r);for(var s=0;s<i.length;s++){var o=i[s];o.element===t&&o.event===n&&o.callback===a&&o.capture===r&&(i.splice(s,1),s--)}},detachAll:function(){for(var t=i.slice(),e=0;e<t.length;e++){var a=t[e];n.detach(a.element,a.event,a.callback,a.capture),n.detach(a.element,a.event,a.callback,void 0),n.detach(a.element,a.event,a.callback,!1),n.detach(a.element,a.event,a.callback,!0)}i.splice(0,i.length)},extend:function(){return rt(this.event,this.eventRemove)}};return n}class st{constructor(t){this._gantt=t}getNode(){const t=this._gantt;return this._tooltipNode||(this._tooltipNode=document.createElement("div"),this._tooltipNode.className="gantt_tooltip",t._waiAria.tooltipAttr(this._tooltipNode)),this._tooltipNode}setViewport(t){return this._root=t,this}show(t,e){const i=this._gantt,n=document.body,a=this.getNode();if(x(a,n)||(this.hide(),a.style.top=a.style.top||"0px",a.style.left=a.style.left||"0px",n.appendChild(a)),this._isLikeMouseEvent(t)){const i=this._calculateTooltipPosition(t);e=i.top,t=i.left}return a.style.top=e+"px",a.style.left=t+"px",i._waiAria.tooltipVisibleAttr(a),this}hide(){const t=this._gantt,e=this.getNode();return e&&e.parentNode&&e.parentNode.removeChild(e),t._waiAria.tooltipHiddenAttr(e),this}setContent(t){return this.getNode().innerHTML=t,this}_isLikeMouseEvent(t){return!(!t||"object"!=typeof t)&&"clientX"in t&&"clientY"in t}_getViewPort(){return this._root||document.body}_calculateTooltipPosition(t){const i=this._gantt,n=this._getViewPortSize(),a=this.getNode(),r={top:0,left:0,width:a.offsetWidth,height:a.offsetHeight,bottom:0,right:0},s=i.config.tooltip_offset_x,o=i.config.tooltip_offset_y,l=document.body,d=y(t,l),c=e(l);d.y+=c.y,r.top=d.y,r.left=d.x,r.top+=o,r.left+=s,r.bottom=r.top+r.height,r.right=r.left+r.width;const u=window.scrollY+l.scrollTop;return r.top<n.top-u?(r.top=n.top,r.bottom=r.top+r.height):r.bottom>n.bottom&&(r.bottom=n.bottom,r.top=r.bottom-r.height),r.left<n.left?(r.left=n.left,r.right=n.left+r.width):r.right>n.right&&(r.right=n.right,r.left=r.right-r.width),d.x>=r.left&&d.x<=r.right&&(r.left=d.x-r.width-s,r.right=r.left+r.width),d.y>=r.top&&d.y<=r.bottom&&(r.top=d.y-r.height-o,r.bottom=r.top+r.height),r.left<0&&(r.left=0),r.right<0&&(r.right=0),r}_getViewPortSize(){const t=this._gantt,i=this._getViewPort();let n,a=i,r=window.scrollY+document.body.scrollTop,s=window.scrollX+document.body.scrollLeft;return i===t.$task_data?(a=t.$task,r=0,s=0,n=e(t.$task)):n=e(a),{left:n.x+s,top:n.y+r,width:n.width,height:n.height,bottom:n.y+n.height+r,right:n.x+n.width+s}}}class ot{constructor(t){this._listeners={},this.tooltip=new st(t),this._gantt=t,this._domEvents=rt(),this._initDelayedFunctions()}destructor(){this.tooltip.hide(),this._domEvents.detachAll()}hideTooltip(){this.delayHide()}attach(t){let e=document.body;const i=this._gantt;t.global||(e=i.$root);let n=null;const a=e=>{const i=p(e),a=$(i,t.selector);if(x(i,this.tooltip.getNode()))return;const r=()=>{n=a,t.onmouseenter(e,a)};n?a&&a===n?t.onmousemove(e,a):(t.onmouseleave(e,n),n=null,a&&a!==n&&r()):a&&r()};this.detach(t.selector),this._domEvents.attach(e,"mousemove",a),this._listeners[t.selector]={node:e,handler:a}}detach(t){const e=this._listeners[t];e&&this._domEvents.detach(e.node,"mousemove",e.handler)}tooltipFor(t){const e=t=>{let e=t;return document.createEventObject&&!document.createEvent&&(e=document.createEventObject(t)),e};this._initDelayedFunctions(),this.attach({selector:t.selector,global:t.global,onmouseenter:(i,n)=>{const a=t.html(i,n);a&&this.delayShow(e(i),a)},onmousemove:(i,n)=>{const a=t.html(i,n);a?this.delayShow(e(i),a):(this.delayShow.$cancelTimeout(),this.delayHide())},onmouseleave:()=>{this.delayShow.$cancelTimeout(),this.delayHide()}})}_initDelayedFunctions(){const t=this._gantt;this.delayShow&&this.delayShow.$cancelTimeout(),this.delayHide&&this.delayHide.$cancelTimeout(),this.tooltip.hide(),this.delayShow=W(((e,i)=>{!1===t.callEvent("onBeforeTooltip",[e])?this.tooltip.hide():(this.tooltip.setContent(i),this.tooltip.show(e))}),t.config.tooltip_timeout||1),this.delayHide=W((()=>{this.delayShow.$cancelTimeout(),this.tooltip.hide()}),t.config.tooltip_hide_timeout||1)}}const lt={onBeforeUndo:"onAfterUndo",onBeforeRedo:"onAfterRedo"},dt=["onTaskDragStart","onAfterTaskUpdate","onAfterParentExpand","onAfterTaskDelete","onBeforeBatchUpdate"];class ct{constructor(t,e){this._batchAction=null,this._batchMode=!1,this._ignore=!1,this._ignoreMoveEvents=!1,this._initialTasks={},this._initialLinks={},this._nestedTasks={},this._nestedLinks={},this._undo=t,this._gantt=e,this._attachEvents()}store(t,e,i=!1){return e===this._gantt.config.undo_types.task?this._storeTask(t,i):e===this._gantt.config.undo_types.link&&this._storeLink(t,i)}isMoveEventsIgnored(){return this._ignoreMoveEvents}toggleIgnoreMoveEvents(t){this._ignoreMoveEvents=t||!1}startIgnore(){this._ignore=!0}stopIgnore(){this._ignore=!1}startBatchAction(){this._timeout||(this._timeout=setTimeout((()=>{this.stopBatchAction(),this._timeout=null}),10)),this._ignore||this._batchMode||(this._batchMode=!0,this._batchAction=this._undo.action.create())}stopBatchAction(){if(this._ignore)return;const t=this._undo;this._batchAction&&t.logAction(this._batchAction),this._batchMode=!1,this._batchAction=null}onTaskAdded(t){this._ignore||this._storeTaskCommand(t,this._undo.command.type.add)}onTaskUpdated(t){this._ignore||this._storeTaskCommand(t,this._undo.command.type.update)}onTaskMoved(t){this._ignore||(t.$local_index=this._gantt.getTaskIndex(t.id),this._storeEntityCommand(t,this.getInitialTask(t.id),this._undo.command.type.move,this._undo.command.entity.task))}onTaskDeleted(t){if(!this._ignore){if(this._storeTaskCommand(t,this._undo.command.type.remove),this._nestedTasks[t.id]){const e=this._nestedTasks[t.id];for(let t=0;t<e.length;t++)this._storeTaskCommand(e[t],this._undo.command.type.remove)}if(this._nestedLinks[t.id]){const e=this._nestedLinks[t.id];for(let t=0;t<e.length;t++)this._storeLinkCommand(e[t],this._undo.command.type.remove)}}}onLinkAdded(t){this._ignore||this._storeLinkCommand(t,this._undo.command.type.add)}onLinkUpdated(t){this._ignore||this._storeLinkCommand(t,this._undo.command.type.update)}onLinkDeleted(t){this._ignore||this._storeLinkCommand(t,this._undo.command.type.remove)}setNestedTasks(t,e){const i=this._gantt;let n=null;const a=[];let r=this._getLinks(i.getTask(t));for(let t=0;t<e.length;t++)n=this.setInitialTask(e[t]),r=r.concat(this._getLinks(n)),a.push(n);const s={};for(let t=0;t<r.length;t++)s[r[t]]=!0;const o=[];for(const t in s)o.push(this.setInitialLink(t));this._nestedTasks[t]=a,this._nestedLinks[t]=o}setInitialTask(t,e){const i=this._gantt;if(e||!this._initialTasks[t]||!this._batchMode){const e=i.copy(i.getTask(t));e.$index=i.getGlobalTaskIndex(t),e.$local_index=i.getTaskIndex(t),this.setInitialTaskObject(t,e)}return this._initialTasks[t]}getInitialTask(t){return this._initialTasks[t]}clearInitialTasks(){this._initialTasks={}}setInitialTaskObject(t,e){this._initialTasks[t]=e}setInitialLink(t,e){return this._initialLinks[t]&&this._batchMode||(this._initialLinks[t]=this._gantt.copy(this._gantt.getLink(t))),this._initialLinks[t]}getInitialLink(t){return this._initialLinks[t]}clearInitialLinks(){this._initialLinks={}}_attachEvents(){let t=null;const e=this._gantt,i=()=>{t||(t=setTimeout((()=>{t=null})),this.clearInitialTasks(),e.eachTask((t=>{this.setInitialTask(t.id)})),this.clearInitialLinks(),e.getLinks().forEach((t=>{this.setInitialLink(t.id)})))},n=t=>e.copy(e.getTask(t));for(const t in lt)e.attachEvent(t,(()=>(this.startIgnore(),!0))),e.attachEvent(lt[t],(()=>(this.stopIgnore(),!0)));for(let t=0;t<dt.length;t++)e.attachEvent(dt[t],(()=>(this.startBatchAction(),!0)));e.attachEvent("onParse",(()=>{this._undo.clearUndoStack(),this._undo.clearRedoStack(),i()})),e.attachEvent("onAfterTaskAdd",((t,e)=>{this.setInitialTask(t,!0),this.onTaskAdded(e)})),e.attachEvent("onAfterTaskUpdate",((t,e)=>{this.onTaskUpdated(e)})),e.attachEvent("onAfterParentExpand",((t,e)=>{this.onTaskUpdated(e)})),e.attachEvent("onAfterTaskDelete",((t,e)=>{this.onTaskDeleted(e)})),e.attachEvent("onAfterLinkAdd",((t,e)=>{this.setInitialLink(t,!0),this.onLinkAdded(e)})),e.attachEvent("onAfterLinkUpdate",((t,e)=>{this.onLinkUpdated(e)})),e.attachEvent("onAfterLinkDelete",((t,e)=>{this.onLinkDeleted(e)})),e.attachEvent("onRowDragEnd",((t,e)=>(this.onTaskMoved(n(t)),this.toggleIgnoreMoveEvents(),!0))),e.attachEvent("onBeforeTaskDelete",(t=>{this.store(t,e.config.undo_types.task);const n=[];return i(),e.eachTask((t=>{n.push(t.id)}),t),this.setNestedTasks(t,n),!0}));const a=e.getDatastore("task");a.attachEvent("onBeforeItemMove",((t,e,n)=>(this.isMoveEventsIgnored()||i(),!0))),a.attachEvent("onAfterItemMove",((t,e,i)=>(this.isMoveEventsIgnored()||this.onTaskMoved(n(t)),!0))),e.attachEvent("onRowDragStart",((t,e,n)=>(this.toggleIgnoreMoveEvents(!0),i(),!0)));let r=null,s=!1;if(e.attachEvent("onBeforeTaskDrag",(t=>{if(r=e.getState().drag_id,r===t){const i=e.getTask(t);e.isSummaryTask(i)&&e.config.drag_project&&(s=!0)}if(e.plugins().multiselect){const t=e.getSelectedTasks();t.length>1&&t.forEach((t=>{this.store(t,e.config.undo_types.task,!0)}))}return this.store(t,e.config.undo_types.task)})),e.attachEvent("onAfterTaskDrag",(t=>{(s||e.plugins().multiselect&&e.getSelectedTasks().length>1)&&r===t&&(s=!1,r=null,this.stopBatchAction()),this.store(t,e.config.undo_types.task,!0)})),e.attachEvent("onLightbox",(t=>this.store(t,e.config.undo_types.task))),e.attachEvent("onBeforeTaskAutoSchedule",(t=>(this.store(t.id,e.config.undo_types.task,!0),!0))),e.ext.inlineEditors){let t=null,i=null;e.attachEvent("onGanttLayoutReady",(()=>{t&&e.ext.inlineEditors.detachEvent(t),i&&e.ext.inlineEditors.detachEvent(i),i=e.ext.inlineEditors.attachEvent("onEditStart",(t=>{this.store(t.id,e.config.undo_types.task)})),t=e.ext.inlineEditors.attachEvent("onBeforeEditStart",(t=>(this.stopBatchAction(),!0)))}))}}_storeCommand(t){const e=this._undo;if(e.updateConfigs(),e.undoEnabled)if(this._batchMode)this._batchAction.commands.push(t);else{const i=e.action.create([t]);e.logAction(i)}}_storeEntityCommand(t,e,i,n){const a=this._undo.command.create(t,e,i,n);this._storeCommand(a)}_storeTaskCommand(t,e){this._gantt.isTaskExists(t.id)&&(t.$local_index=this._gantt.getTaskIndex(t.id)),this._storeEntityCommand(t,this.getInitialTask(t.id),e,this._undo.command.entity.task)}_storeLinkCommand(t,e){this._storeEntityCommand(t,this.getInitialLink(t.id),e,this._undo.command.entity.link)}_getLinks(t){return t.$source.concat(t.$target)}_storeTask(t,e=!1){const i=this._gantt;return this.setInitialTask(t,e),i.eachTask((t=>{this.setInitialTask(t.id)}),t),!0}_storeLink(t,e=!1){return this.setInitialLink(t,e),!0}}class ut{constructor(t){this.maxSteps=100,this.undoEnabled=!0,this.redoEnabled=!0,this.action={create:t=>({commands:t?t.slice():[]}),invert:t=>{const e=this._gantt.copy(t),i=this.command;for(let n=0;n<t.commands.length;n++){const t=e.commands[n]=i.invert(e.commands[n]);t.type!==i.type.update&&t.type!==i.type.move||([t.value,t.oldValue]=[t.oldValue,t.value])}return e}},this.command={entity:null,type:null,create:(t,e,i,n)=>{const a=this._gantt;return{entity:n,type:i,value:a.copy(t),oldValue:a.copy(e||t)}},invert:t=>{const e=this._gantt.copy(t);return e.type=this.command.inverseCommands(t.type),e},inverseCommands:t=>{const e=this._gantt,i=this.command.type;switch(t){case i.update:return i.update;case i.remove:return i.add;case i.add:return i.remove;case i.move:return i.move;default:return e.assert(!1,"Invalid command "+t),null}}},this._undoStack=[],this._redoStack=[],this._gantt=t}getUndoStack(){return this._undoStack}setUndoStack(t){this._undoStack=t}getRedoStack(){return this._redoStack}setRedoStack(t){this._redoStack=t}clearUndoStack(){this._undoStack=[]}clearRedoStack(){this._redoStack=[]}updateConfigs(){const t=this._gantt;this.maxSteps=t.config.undo_steps||100,this.command.entity=t.config.undo_types,this.command.type=t.config.undo_actions,this.undoEnabled=!!t.config.undo,this.redoEnabled=!!t.config.redo}undo(){const t=this._gantt;if(this.updateConfigs(),!this.undoEnabled)return;const e=this._pop(this._undoStack);if(e&&this._reorderCommands(e),!1!==t.callEvent("onBeforeUndo",[e])&&e)return this._applyAction(this.action.invert(e)),this._push(this._redoStack,t.copy(e)),void t.callEvent("onAfterUndo",[e]);t.callEvent("onAfterUndo",[null])}redo(){const t=this._gantt;if(this.updateConfigs(),!this.redoEnabled)return;const e=this._pop(this._redoStack);if(e&&this._reorderCommands(e),!1!==t.callEvent("onBeforeRedo",[e])&&e)return this._applyAction(e),this._push(this._undoStack,t.copy(e)),void t.callEvent("onAfterRedo",[e]);t.callEvent("onAfterRedo",[null])}logAction(t){this._push(this._undoStack,t),this._redoStack=[]}_push(t,e){const i=this._gantt;if(!e.commands.length)return;const n=t===this._undoStack?"onBeforeUndoStack":"onBeforeRedoStack";if(!1!==i.callEvent(n,[e])&&e.commands.length){for(t.push(e);t.length>this.maxSteps;)t.shift();return e}}_pop(t){return t.pop()}_reorderCommands(t){const e={any:0,link:1,task:2},i={move:1,any:0};t.commands.sort((function(t,n){if("task"===t.entity&&"task"===n.entity)return t.type!==n.type?(i[n.type]||0)-(i[t.type]||0):"move"===t.type&&t.oldValue&&n.oldValue&&n.oldValue.parent===t.oldValue.parent?t.oldValue.$index-n.oldValue.$index:0;{const i=e[t.entity]||e.any;return(e[n.entity]||e.any)-i}}))}_applyAction(t){let e=null;const i=this.command.entity,n=this.command.type,a=this._gantt,r={};r[i.task]={add:"addTask",get:"getTask",update:"updateTask",remove:"deleteTask",move:"moveTask",isExists:"isTaskExists"},r[i.link]={add:"addLink",get:"getLink",update:"updateLink",remove:"deleteLink",isExists:"isLinkExists"},a.batchUpdate((function(){for(let i=0;i<t.commands.length;i++){e=t.commands[i];const s=r[e.entity][e.type],o=r[e.entity].get,l=r[e.entity].isExists;if(e.type===n.add)a[s](e.oldValue,e.oldValue.parent,e.oldValue.$local_index);else if(e.type===n.remove)a[l](e.value.id)&&a[s](e.value.id);else if(e.type===n.update){const t=a[o](e.value.id);for(const i in e.value){let n=!(i.startsWith("$")||i.startsWith("_"));["$open"].indexOf(i)>-1&&(n=!0),n&&(t[i]=e.value[i])}a[s](e.value.id)}else e.type===n.move&&(a[s](e.value.id,e.value.$local_index,e.value.parent),a.callEvent("onRowDragEnd",[e.value.id]))}}))}}const ht={click_drag:function(t){t.ext||(t.ext={});const e={className:"gantt_click_drag_rect",useRequestAnimationFrame:!0,callback:void 0,singleRow:!1};function i(){const i={viewPort:t.$task_data,...e};t.ext.clickDrag&&t.ext.clickDrag.destructor(),t.ext.clickDrag=new A(t);const n=t.config.click_drag;i.render=n.render||e.render,i.className=n.className||e.className,i.callback=n.callback||e.callback,i.viewPort=n.viewPort||t.$task_data,i.useRequestAnimationFrame=void 0===n.useRequestAnimationFrame?e.useRequestAnimationFrame:n.useRequestAnimationFrame,i.singleRow=void 0===n.singleRow?e.singleRow:n.singleRow;const a=t.$ui.getView("timeline"),r=new U(i,t,a);t.ext.clickDrag.attach(r,n.useKey,n.ignore)}t.attachEvent("onGanttReady",(()=>{t.config.click_drag&&i()})),t.attachEvent("onGanttLayoutReady",(function(){t.$container&&t.config.click_drag&&t.attachEvent("onGanttRender",(function(){i()}),{once:!0})})),t.attachEvent("onDestroy",(()=>{t.ext.clickDrag&&t.ext.clickDrag.destructor()}))},drag_timeline:function(t){t.ext||(t.ext={}),t.ext.dragTimeline={create:()=>G.create(t),_isDragInProgress:()=>G._isDragInProgress},t.config.drag_timeline={enabled:!0,render:!1}},fullscreen:function(t){function e(){const t=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;return!(!t||t!==document.body)}function i(){try{return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled}catch(t){console.error("Fullscreen is not available:",t)}}t.$services.getService("state").registerProvider("fullscreen",(()=>i()?{fullscreen:e()}:void 0));let n={overflow:null,padding:null,paddingTop:null,paddingRight:null,paddingBottom:null,paddingLeft:null};const a={width:null,height:null,top:null,left:null,position:null,zIndex:null,modified:!1};let r=null;function s(t,e){e.width=t.width,e.height=t.height,e.top=t.top,e.left=t.left,e.position=t.position,e.zIndex=t.zIndex}let o=!1;function l(){if(!t.$container)return;let i;e()?o&&(i="onExpand",function(){const e=t.ext.fullscreen.getFullscreenElement(),i=document.body;s(e.style,a),n={overflow:i.style.overflow,padding:i.style.padding?i.style.padding:null,paddingTop:i.style.paddingTop?i.style.paddingTop:null,paddingRight:i.style.paddingRight?i.style.paddingRight:null,paddingBottom:i.style.paddingBottom?i.style.paddingBottom:null,paddingLeft:i.style.paddingLeft?i.style.paddingLeft:null},i.style.padding&&(i.style.padding="0"),i.style.paddingTop&&(i.style.paddingTop="0"),i.style.paddingRight&&(i.style.paddingRight="0"),i.style.paddingBottom&&(i.style.paddingBottom="0"),i.style.paddingLeft&&(i.style.paddingLeft="0"),i.style.overflow="hidden",e.style.width="100vw",e.style.height="100vh",e.style.top="0px",e.style.left="0px",e.style.position="absolute",e.style.zIndex=1,a.modified=!0,r=function(t){let e=t.parentNode;const i=[];for(;e&&e.style;)i.push({element:e,originalPositioning:e.style.position}),e.style.position="static",e=e.parentNode;return i}(e)}()):o&&(o=!1,i="onCollapse",function(){const e=t.ext.fullscreen.getFullscreenElement(),i=document.body;a.modified&&(n.padding&&(i.style.padding=n.padding),n.paddingTop&&(i.style.paddingTop=n.paddingTop),n.paddingRight&&(i.style.paddingRight=n.paddingRight),n.paddingBottom&&(i.style.paddingBottom=n.paddingBottom),n.paddingLeft&&(i.style.paddingLeft=n.paddingLeft),i.style.overflow=n.overflow,n={overflow:null,padding:null,paddingTop:null,paddingRight:null,paddingBottom:null,paddingLeft:null},s(a,e.style),a.modified=!1),r.forEach((t=>{t.element.style.position=t.originalPositioning})),r=null}()),setTimeout((()=>{t.render()})),setTimeout((()=>{t.callEvent(i,[t.ext.fullscreen.getFullscreenElement()])}))}function d(){return!t.$container||!t.ext.fullscreen.getFullscreenElement()||!i()&&((console.warning||console.log)("The `fullscreen` feature not being allowed, or full-screen mode not being supported"),!0)}t.ext.fullscreen={expand(){if(d()||e()||!t.callEvent("onBeforeExpand",[this.getFullscreenElement()]))return;o=!0;const i=document.body,n=i.webkitRequestFullscreen?[Element.ALLOW_KEYBOARD_INPUT]:[],a=i.msRequestFullscreen||i.mozRequestFullScreen||i.webkitRequestFullscreen||i.requestFullscreen;a&&a.apply(i,n)},collapse(){if(d()||!e()||!t.callEvent("onBeforeCollapse",[this.getFullscreenElement()]))return;const i=document.msExitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.exitFullscreen;i&&i.apply(document)},toggle(){d()||(e()?this.collapse():this.expand())},getFullscreenElement:()=>t.$root},t.expand=function(){t.ext.fullscreen.expand()},t.collapse=function(){t.ext.fullscreen.collapse()},t.attachEvent("onGanttReady",(function(){t.event(document,"webkitfullscreenchange",l),t.event(document,"mozfullscreenchange",l),t.event(document,"MSFullscreenChange",l),t.event(document,"fullscreenChange",l),t.event(document,"fullscreenchange",l)}))},keyboard_navigation:function(t){var e,i;(i=t).config.keyboard_navigation=!0,i.config.keyboard_navigation_cells=!1,i.$keyboardNavigation={},i._compose=function(){for(var t=Array.prototype.slice.call(arguments,0),e={},i=0;i<t.length;i++){var n=t[i];for(var a in"function"==typeof n&&(n=new n),n)e[a]=n[a]}return e},i.$keyboardNavigation.shortcuts={createCommand:function(){return{modifiers:{shift:!1,alt:!1,ctrl:!1,meta:!1},keyCode:null}},parse:function(t){for(var e=[],i=this.getExpressions(this.trim(t)),n=0;n<i.length;n++){for(var a=this.getWords(i[n]),r=this.createCommand(),s=0;s<a.length;s++)this.commandKeys[a[s]]?r.modifiers[a[s]]=!0:this.specialKeys[a[s]]?r.keyCode=this.specialKeys[a[s]]:r.keyCode=a[s].charCodeAt(0);e.push(r)}return e},getCommandFromEvent:function(t){var e=this.createCommand();e.modifiers.shift=!!t.shiftKey,e.modifiers.alt=!!t.altKey,e.modifiers.ctrl=!!t.ctrlKey,e.modifiers.meta=!!t.metaKey,e.keyCode=t.which||t.keyCode,e.keyCode>=96&&e.keyCode<=105&&(e.keyCode-=48);var i=String.fromCharCode(e.keyCode);return i&&(e.keyCode=i.toLowerCase().charCodeAt(0)),e},getHashFromEvent:function(t){return this.getHash(this.getCommandFromEvent(t))},getHash:function(t){var e=[];for(var i in t.modifiers)t.modifiers[i]&&e.push(i);return e.push(t.keyCode),e.join(this.junctionChar)},getExpressions:function(t){return t.split(this.junctionChar)},getWords:function(t){return t.split(this.combinationChar)},trim:function(t){return t.replace(/\s/g,"")},junctionChar:",",combinationChar:"+",commandKeys:{shift:16,alt:18,ctrl:17,meta:!0},specialKeys:{backspace:8,tab:9,enter:13,esc:27,space:32,up:38,down:40,left:37,right:39,home:36,end:35,pageup:33,pagedown:34,delete:46,insert:45,plus:107,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123}},(e=i).$keyboardNavigation.EventHandler={_handlers:null,findHandler:function(t){this._handlers||(this._handlers={});var i=e.$keyboardNavigation.shortcuts.getHash(t);return this._handlers[i]},doAction:function(t,i){var n=this.findHandler(t);if(n){if(!1===e.$keyboardNavigation.facade.callEvent("onBeforeAction",[t,i]))return;n.call(this,i),i.preventDefault?i.preventDefault():i.returnValue=!1}},bind:function(t,i){this._handlers||(this._handlers={});for(var n=e.$keyboardNavigation.shortcuts,a=n.parse(t),r=0;r<a.length;r++)this._handlers[n.getHash(a[r])]=i},unbind:function(t){for(var i=e.$keyboardNavigation.shortcuts,n=i.parse(t),a=0;a<n.length;a++)this._handlers[i.getHash(n[a])]&&delete this._handlers[i.getHash(n[a])]},bindAll:function(t){for(var e in t)this.bind(e,t[e])},initKeys:function(){this._handlers||(this._handlers={}),this.keys&&this.bindAll(this.keys)}},function(t){t.$keyboardNavigation.getFocusableNodes=s,t.$keyboardNavigation.trapFocus=function(e,i){if(9!=i.keyCode)return!1;for(var n=t.$keyboardNavigation.getFocusableNodes(e),a=T(),r=-1,s=0;s<n.length;s++)if(n[s]==a){r=s;break}if(i.shiftKey){if(r<=0){var o=n[n.length-1];if(o)return o.focus(),i.preventDefault(),!0}}else if(r>=n.length-1){var l=n[0];if(l)return l.focus(),i.preventDefault(),!0}return!1}}(i),function(t){t.$keyboardNavigation.GanttNode=function(){},t.$keyboardNavigation.GanttNode.prototype=t._compose(t.$keyboardNavigation.EventHandler,{focus:function(){t.focus()},blur:function(){},isEnabled:function(){return t.$container.hasAttribute("tabindex")},scrollHorizontal:function(e){var i=t.dateFromPos(t.getScrollState().x),n=t.getScale(),a=e<0?-n.step:n.step;i=t.date.add(i,a,n.unit),t.scrollTo(t.posFromDate(i))},scrollVertical:function(e){var i=t.getScrollState().y,n=t.config.row_height;t.scrollTo(null,i+(e<0?-1:1)*n)},keys:{"alt+left":function(t){this.scrollHorizontal(-1)},"alt+right":function(t){this.scrollHorizontal(1)},"alt+up":function(t){this.scrollVertical(-1)},"alt+down":function(t){this.scrollVertical(1)},"ctrl+z":function(){t.undo&&t.undo()},"ctrl+r":function(){t.redo&&t.redo()}}}),t.$keyboardNavigation.GanttNode.prototype.bindAll(t.$keyboardNavigation.GanttNode.prototype.keys)}(i),function(t){t.$keyboardNavigation.KeyNavNode=function(){},t.$keyboardNavigation.KeyNavNode.prototype=t._compose(t.$keyboardNavigation.EventHandler,{isValid:function(){return!0},fallback:function(){return null},moveTo:function(e){t.$keyboardNavigation.dispatcher.setActiveNode(e)},compareTo:function(t){if(!t)return!1;for(var e in this){if(!!this[e]!=!!t[e])return!1;var i=!(!this[e]||!this[e].toString),n=!(!t[e]||!t[e].toString);if(n!=i)return!1;if(n&&i){if(t[e].toString()!=this[e].toString())return!1}else if(t[e]!=this[e])return!1}return!0},getNode:function(){},focus:function(){var e=this.getNode();if(e){var i=t.$keyboardNavigation.facade;!1!==i.callEvent("onBeforeFocus",[e])&&e&&(e.setAttribute("tabindex","-1"),e.$eventAttached||(e.$eventAttached=!0,t.event(e,"focus",(function(t){return t.preventDefault(),!1}),!1)),t.utils.dom.isChildOf(document.activeElement,e)&&(e=document.activeElement),e.focus&&e.focus(),i.callEvent("onFocus",[this.getNode()]))}},blur:function(){var e=this.getNode();e&&(t.$keyboardNavigation.facade.callEvent("onBlur",[e]),e.setAttribute("tabindex","-1"))}})}(i),function(t){t.$keyboardNavigation.HeaderCell=function(t){this.index=t||0},t.$keyboardNavigation.HeaderCell.prototype=t._compose(t.$keyboardNavigation.KeyNavNode,{_handlers:null,isValid:function(){return!(!t.config.show_grid&&t.getVisibleTaskCount()||!t.getGridColumns()[this.index]&&t.getVisibleTaskCount())},fallback:function(){if(!t.config.show_grid)return t.getVisibleTaskCount()?new t.$keyboardNavigation.TaskRow:null;for(var e=t.getGridColumns(),i=this.index;i>=0&&!e[i];)i--;return e[i]?new t.$keyboardNavigation.HeaderCell(i):null},fromDomElement:function(e){var i=k(e,"gantt_grid_head_cell");if(i){for(var n=0;i&&i.previousSibling;)i=i.previousSibling,n+=1;return new t.$keyboardNavigation.HeaderCell(n)}return null},getNode:function(){const e=t.$grid_scale;return e?e.childNodes[this.index]:null},keys:{left:function(){this.index>0&&this.moveTo(new t.$keyboardNavigation.HeaderCell(this.index-1))},right:function(){var e=t.getGridColumns();this.index<e.length-1&&this.moveTo(new t.$keyboardNavigation.HeaderCell(this.index+1))},down:function(){var e,i=t.getChildren(t.config.root_id);t.isTaskExists(i[0])&&(e=i[0]),e&&(t.config.keyboard_navigation_cells?this.moveTo(new t.$keyboardNavigation.TaskCell(e,this.index)):this.moveTo(new t.$keyboardNavigation.TaskRow(e)))},end:function(){var e=t.getGridColumns();this.moveTo(new t.$keyboardNavigation.HeaderCell(e.length-1))},home:function(){this.moveTo(new t.$keyboardNavigation.HeaderCell(0))},"enter, space":function(){T().click()},"ctrl+enter":function(){t.isReadonly(this)||t.createTask({},this.taskId)}}}),t.$keyboardNavigation.HeaderCell.prototype.bindAll(t.$keyboardNavigation.HeaderCell.prototype.keys)}(i),function(t){t.$keyboardNavigation.TaskRow=function(e){if(!e){var i=t.getChildren(t.config.root_id);i[0]&&(e=i[0])}this.taskId=e,t.isTaskExists(this.taskId)&&(this.index=t.getTaskIndex(this.taskId),this.globalIndex=t.getGlobalTaskIndex(this.taskId),this.splitItem=!!t.getTask(this.taskId).$split_subtask,this.parentId=t.getParent(this.taskId))},t.$keyboardNavigation.TaskRow.prototype=t._compose(t.$keyboardNavigation.KeyNavNode,{_handlers:null,isValid:function(){return t.isTaskExists(this.taskId)&&t.getTaskIndex(this.taskId)>-1},fallback:function(){if(!t.getVisibleTaskCount()){var e=new t.$keyboardNavigation.HeaderCell;return e.isValid()?e:null}if(this.splitItem)return new t.$keyboardNavigation.TaskRow(this.parentId);var i=-1;if(t.getTaskByIndex(this.globalIndex-1))i=this.globalIndex-1;else if(t.getTaskByIndex(this.globalIndex+1))i=this.globalIndex+1;else for(var n=this.globalIndex;n>=0;){if(t.getTaskByIndex(n)){i=n;break}n--}return i>-1?new t.$keyboardNavigation.TaskRow(t.getTaskByIndex(i).id):void 0},fromDomElement:function(e){if(t.config.keyboard_navigation_cells)return null;var i=t.locate(e);return t.isTaskExists(i)?new t.$keyboardNavigation.TaskRow(i):null},getNode:function(){if(t.isTaskExists(this.taskId)&&t.isTaskVisible(this.taskId))return t.config.show_grid?t.$grid.querySelector(`.gantt_row[${t.config.task_attribute}="${String(this.taskId).replaceAll('"','\\"')}"]`):t.getTaskNode(this.taskId)},focus:function(e){if(!e){const e=t.getTaskPosition(t.getTask(this.taskId)),i=t.getTaskHeight(this.taskId),n=t.getScrollState();let a,r;a=t.$task?t.$task.offsetWidth:n.inner_width,r=t.$grid_data||t.$task_data?(t.$grid_data||t.$task_data).offsetHeight:n.inner_height;const s=t.config.show_chart&&t.$ui.getView("timeline");e.top<n.y||e.top+i>n.y+r?t.scrollTo(null,e.top-20):t.config.scroll_on_click&&s&&(e.left>n.x+a?t.scrollTo(e.left-t.config.task_scroll_offset):e.left+e.width<n.x&&t.scrollTo(e.left+e.width-t.config.task_scroll_offset))}t.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this,[e]),function(){var e=t.$ui.getView("grid");if(e&&e.$grid_data){var i=parseInt(e.$grid.scrollLeft),n=parseInt(e.$grid_data.scrollTop),a=e.$config.scrollX;if(a&&e.$config.scrollable){var r=t.$ui.getView(a);r&&r.scrollTo(i,n)}var s=e.$config.scrollY;if(s){var o=t.$ui.getView(s);o&&o.scrollTo(i,n)}}}()},keys:{pagedown:function(){t.getVisibleTaskCount()&&this.moveTo(new t.$keyboardNavigation.TaskRow(t.getTaskByIndex(t.getVisibleTaskCount()-1).id))},pageup:function(){t.getVisibleTaskCount()&&this.moveTo(new t.$keyboardNavigation.TaskRow(t.getTaskByIndex(0).id))},up:function(){var e,i=t.getPrev(this.taskId);e=t.isTaskExists(i)?new t.$keyboardNavigation.TaskRow(i):new t.$keyboardNavigation.HeaderCell,this.moveTo(e)},down:function(){var e=t.getNext(this.taskId);t.isTaskExists(e)&&this.moveTo(new t.$keyboardNavigation.TaskRow(e))},"shift+down":function(){t.hasChild(this.taskId)&&!t.getTask(this.taskId).$open&&t.open(this.taskId)},"shift+up":function(){t.hasChild(this.taskId)&&t.getTask(this.taskId).$open&&t.close(this.taskId)},"shift+right":function(){if(!t.isReadonly(this)){var e=t.getPrevSibling(this.taskId);t.isTaskExists(e)&&!t.isChildOf(this.taskId,e)&&(t.getTask(e).$open=!0,!1!==t.moveTask(this.taskId,-1,e)&&t.updateTask(this.taskId))}},"shift+left":function(){if(!t.isReadonly(this)){var e=t.getParent(this.taskId);t.isTaskExists(e)&&!1!==t.moveTask(this.taskId,t.getTaskIndex(e)+1,t.getParent(e))&&t.updateTask(this.taskId)}},space:function(e){t.isSelectedTask(this.taskId)?t.unselectTask(this.taskId):t.selectTask(this.taskId)},"ctrl+left":function(e){t.close(this.taskId)},"ctrl+right":function(e){t.open(this.taskId)},delete:function(e){t.isReadonly(this)||t.$click.buttons.delete(this.taskId)},enter:function(){t.isReadonly(this)||t.showLightbox(this.taskId)},"ctrl+enter":function(){t.isReadonly(this)||t.createTask({},this.taskId)}}}),t.$keyboardNavigation.TaskRow.prototype.bindAll(t.$keyboardNavigation.TaskRow.prototype.keys)}(i),function(t){t.$keyboardNavigation.TaskCell=function(e,i){if(!(e=j(e,t.config.root_id))){var n=t.getChildren(t.config.root_id);n[0]&&(e=n[0])}this.taskId=e,this.columnIndex=i||0,t.isTaskExists(this.taskId)&&(this.index=t.getTaskIndex(this.taskId),this.globalIndex=t.getGlobalTaskIndex(this.taskId))},t.$keyboardNavigation.TaskCell.prototype=t._compose(t.$keyboardNavigation.TaskRow,{_handlers:null,isValid:function(){return t.$keyboardNavigation.TaskRow.prototype.isValid.call(this)&&!!t.getGridColumns()[this.columnIndex]},fallback:function(){var e=t.$keyboardNavigation.TaskRow.prototype.fallback.call(this),i=e;if(e instanceof t.$keyboardNavigation.TaskRow){for(var n=t.getGridColumns(),a=this.columnIndex;a>=0&&!n[a];)a--;n[a]&&(i=new t.$keyboardNavigation.TaskCell(e.taskId,a))}return i},fromDomElement:function(e){if(!t.config.keyboard_navigation_cells)return null;var i=t.locate(e);if(t.isTaskExists(i)){var n=0,a=m(e,"data-column-index");return a&&(n=1*a.getAttribute("data-column-index")),new t.$keyboardNavigation.TaskCell(i,n)}return null},getNode:function(){if(t.isTaskExists(this.taskId)&&(t.isTaskVisible(this.taskId)||t.config.show_tasks_outside_timescale)){if(t.config.show_grid&&t.$grid){var e=t.$grid.querySelector(".gantt_row["+t.config.task_attribute+"='"+this.taskId+"']");return e?e.querySelector("[data-column-index='"+this.columnIndex+"']"):null}return t.getTaskNode(this.taskId)}},keys:{up:function(){var e,i=t.getPrev(this.taskId);e=t.isTaskExists(i)?new t.$keyboardNavigation.TaskCell(i,this.columnIndex):new t.$keyboardNavigation.HeaderCell(this.columnIndex),this.moveTo(e)},down:function(){var e=t.getNext(this.taskId);t.isTaskExists(e)&&this.moveTo(new t.$keyboardNavigation.TaskCell(e,this.columnIndex))},left:function(){this.columnIndex>0&&this.moveTo(new t.$keyboardNavigation.TaskCell(this.taskId,this.columnIndex-1))},right:function(){var e=t.getGridColumns();this.columnIndex<e.length-1&&this.moveTo(new t.$keyboardNavigation.TaskCell(this.taskId,this.columnIndex+1))},end:function(){var e=t.getGridColumns();this.moveTo(new t.$keyboardNavigation.TaskCell(this.taskId,e.length-1))},home:function(){this.moveTo(new t.$keyboardNavigation.TaskCell(this.taskId,0))},pagedown:function(){t.getVisibleTaskCount()&&this.moveTo(new t.$keyboardNavigation.TaskCell(t.getTaskByIndex(t.getVisibleTaskCount()-1).id,this.columnIndex))},pageup:function(){t.getVisibleTaskCount()&&this.moveTo(new t.$keyboardNavigation.TaskCell(t.getTaskByIndex(0).id,this.columnIndex))}}}),t.$keyboardNavigation.TaskCell.prototype.bindAll(t.$keyboardNavigation.TaskRow.prototype.keys),t.$keyboardNavigation.TaskCell.prototype.bindAll(t.$keyboardNavigation.TaskCell.prototype.keys)}(i),function(t){!function(){var e=[];function i(){return!!e.length}function n(e){setTimeout((function(){i()||t.$destroyed||t.focus()}),1)}function a(i){t.eventRemove(i,"keydown",s),t.event(i,"keydown",s),e.push(i)}function r(){var i=e.pop();i&&t.eventRemove(i,"keydown",s),n()}function s(i){var n=i.currentTarget;n==e[e.length-1]&&t.$keyboardNavigation.trapFocus(n,i)}function o(){a(t.getLightbox())}t.attachEvent("onLightbox",o),t.attachEvent("onAfterLightbox",r),t.attachEvent("onLightboxChange",(function(){r(),o()})),t.attachEvent("onAfterQuickInfo",(function(){n()})),t.attachEvent("onMessagePopup",(function(e){l=t.utils.dom.getActiveElement(),a(e)})),t.attachEvent("onAfterMessagePopup",(function(){r(),setTimeout((function(){l&&l.focus&&(l.focus(),l=null)}),1)}));var l=null;t.$keyboardNavigation.isModal=i}()}(i),function(t){t.$keyboardNavigation.dispatcher={isActive:!1,activeNode:null,globalNode:new t.$keyboardNavigation.GanttNode,enable:function(){this.isActive=!0,this.setActiveNode(this.getActiveNode())},disable:function(){this.isActive=!1},isEnabled:function(){return!!this.isActive},getDefaultNode:function(){var e;return(e=t.config.keyboard_navigation_cells?new t.$keyboardNavigation.TaskCell:new t.$keyboardNavigation.TaskRow).isValid()||(e=e.fallback()),e},setDefaultNode:function(){this.setActiveNode(this.getDefaultNode())},getActiveNode:function(){var t=this.activeNode;return t&&!t.isValid()&&(t=t.fallback()),t},fromDomElement:function(e){for(var i=[t.$keyboardNavigation.TaskRow,t.$keyboardNavigation.TaskCell,t.$keyboardNavigation.HeaderCell],n=0;n<i.length;n++)if(i[n].prototype.fromDomElement){var a=i[n].prototype.fromDomElement(e);if(a)return a}return null},focusGlobalNode:function(){this.blurNode(this.globalNode),this.focusNode(this.globalNode)},setActiveNode:function(t){var e=!0;this.activeNode&&this.activeNode.compareTo(t)&&(e=!1),this.isEnabled()&&(e&&this.blurNode(this.activeNode),this.activeNode=t,this.focusNode(this.activeNode,!e))},focusNode:function(t,e){t&&t.focus&&t.focus(e)},blurNode:function(t){t&&t.blur&&t.blur()},keyDownHandler:function(e){if(!t.$keyboardNavigation.isModal()&&this.isEnabled()&&!e.defaultPrevented){var i=this.globalNode,n=t.$keyboardNavigation.shortcuts.getCommandFromEvent(e),a=this.getActiveNode();!1!==t.$keyboardNavigation.facade.callEvent("onKeyDown",[n,e])&&(a?a.findHandler(n)?a.doAction(n,e):i.findHandler(n)&&i.doAction(n,e):this.setDefaultNode())}},_timeout:null,awaitsFocus:function(){return null!==this._timeout},delay:function(e,i){clearTimeout(this._timeout),this._timeout=setTimeout(t.bind((function(){this._timeout=null,e()}),this),i||1)},clearDelay:function(){clearTimeout(this._timeout)}}}(i),function(){var t=i.$keyboardNavigation.dispatcher;t.isTaskFocused=function(e){var n=t.activeNode;return(n instanceof i.$keyboardNavigation.TaskRow||n instanceof i.$keyboardNavigation.TaskCell)&&n.taskId==e};var e=function(e){if(i.config.keyboard_navigation&&(i.config.keyboard_navigation_cells||!r(e))&&!s(e)&&!$(e.target,".gantt_cal_light"))return t.keyDownHandler(e)},n=function(e){if(t.$preventDefault)return e.preventDefault(),i.$container.blur(),!1;t.awaitsFocus()||t.focusGlobalNode()},a=function(){if(!t.isEnabled())return;const e=!x(document.activeElement,i.$container)&&"body"!=document.activeElement.localName;var n=t.getActiveNode();if(n&&!e){var a,r,s=n.getNode();s&&s.parentNode&&(a=s.parentNode.scrollTop,r=s.parentNode.scrollLeft),n.focus(!0),s&&s.parentNode&&(s.parentNode.scrollTop=a,s.parentNode.scrollLeft=r)}};function r(t){return!!$(t.target,".gantt_grid_editor_placeholder")}function s(t){return!!$(t.target,".no_keyboard_navigation")}function o(e){if(!i.config.keyboard_navigation||!i.config.keyboard_navigation_cells&&r(e))return!0;if(!s(e)){var n,a=t.fromDomElement(e);if(a&&(t.activeNode instanceof i.$keyboardNavigation.TaskCell&&x(e.target,i.$task)&&(a=new i.$keyboardNavigation.TaskCell(a.taskId,t.activeNode.columnIndex)),n=a,i.config.show_grid&&i.$ui.getView("grid")&&i.config.keyboard_navigation_cells)){const t=e.target.classList.contains("gantt_row"),a=e.target.closest(".gantt_task_line"),r=i.utils.dom.getNodePosition(i.$grid).x,s=r+i.$grid.offsetWidth,o=i.utils.dom.getNodePosition(document.activeElement).x;if(t||a&&(o<r||s<o)){let a=i.$grid.scrollLeft;const r=a+i.$grid.offsetWidth;let s=0;t&&(a=i.utils.dom.getRelativeEventPosition(e,i.$grid).x);for(let t=0;t<i.config.columns.length;t++){const e=i.config.columns[t];if(!e.hide&&(s+=e.width,a<s)){r<s&&(s-=e.width),n.columnIndex=t;break}}}}n?t.isEnabled()?t.delay((function(){t.setActiveNode(n)})):t.activeNode=n:(t.$preventDefault=!0,setTimeout((function(){t.$preventDefault=!1}),300))}}i.attachEvent("onDataRender",(function(){i.config.keyboard_navigation&&a()})),i.attachEvent("onGanttRender",(function(){i.$root&&(i.eventRemove(i.$root,"keydown",e),i.eventRemove(i.$container,"focus",n),i.eventRemove(i.$container,"mousedown",o),i.config.keyboard_navigation?(i.event(i.$root,"keydown",e),i.event(i.$container,"focus",n),i.event(i.$container,"mousedown",o),i.$container.setAttribute("tabindex","0")):i.$container.removeAttribute("tabindex"))}));var l=i.attachEvent("onGanttReady",(function(){if(i.detachEvent(l),i.$data.tasksStore.attachEvent("onStoreUpdated",(function(e){if(i.config.keyboard_navigation&&t.isEnabled()){const n=t.getActiveNode(),r=i.$ui.getView("grid");if(!r||!r.$grid_data)return;const s=r.getItemTop(e),o=r.$grid_data.scrollTop,l=o+r.$grid_data.getBoundingClientRect().height;n&&n.taskId==e&&o<=s&&l>=s&&a()}})),i._smart_render){var e=i._smart_render._redrawTasks;i._smart_render._redrawTasks=function(n,a){if(i.config.keyboard_navigation&&t.isEnabled()){var r=t.getActiveNode();if(r&&void 0!==r.taskId){for(var s=!1,o=0;o<a.length;o++)if(a[o].id==r.taskId&&a[o].start_date){s=!0;break}s||a.push(i.getTask(r.taskId))}}return e.apply(this,arguments)}}}));let d=null,c=!1;i.attachEvent("onTaskCreated",(function(t){return d=t.id,!0})),i.attachEvent("onAfterTaskAdd",(function(e,n){if(!i.config.keyboard_navigation)return!0;if(t.isEnabled()){if(e==d&&(c=!0,setTimeout((()=>{c=!1,d=null}))),c&&n.type==i.config.types.placeholder)return;var a=0,r=t.activeNode;r instanceof i.$keyboardNavigation.TaskCell&&(a=r.columnIndex);var s=i.config.keyboard_navigation_cells?i.$keyboardNavigation.TaskCell:i.$keyboardNavigation.TaskRow;n.type==i.config.types.placeholder&&!1===i.config.placeholder_task.focusOnCreate||t.setActiveNode(new s(e,a))}})),i.attachEvent("onTaskIdChange",(function(e,n){if(!i.config.keyboard_navigation)return!0;var a=t.activeNode;return t.isTaskFocused(e)&&(a.taskId=n),!0}));var u=setInterval((function(){i.config.keyboard_navigation&&(t.isEnabled()||t.enable())}),500);function h(t){var e={gantt:i.$keyboardNavigation.GanttNode,headerCell:i.$keyboardNavigation.HeaderCell,taskRow:i.$keyboardNavigation.TaskRow,taskCell:i.$keyboardNavigation.TaskCell};return e[t]||e.gantt}function _(t){for(var e=i.getGridColumns(),n=0;n<e.length;n++)if(e[n].name==t)return n;return 0}i.attachEvent("onDestroy",(function(){clearInterval(u)}));var g={};M(g),i.mixin(g,{addShortcut:function(t,e,i){var n=h(i);n&&n.prototype.bind(t,e)},getShortcutHandler:function(t,e){var n=i.$keyboardNavigation.shortcuts.parse(t);if(n.length)return g.getCommandHandler(n[0],e)},getCommandHandler:function(t,e){var i=h(e);if(i&&t)return i.prototype.findHandler(t)},removeShortcut:function(t,e){var i=h(e);i&&i.prototype.unbind(t)},focus:function(e){var i,n=e?e.type:null,a=h(n);switch(n){case"taskCell":i=new a(e.id,_(e.column));break;case"taskRow":i=new a(e.id);break;case"headerCell":i=new a(_(e.column))}t.delay((function(){i?t.setActiveNode(i):(t.enable(),t.getActiveNode()?t.awaitsFocus()||t.enable():t.setDefaultNode())}))},getActiveNode:function(){if(t.isEnabled()){var e=t.getActiveNode(),n=(r=e)instanceof i.$keyboardNavigation.GanttNode?"gantt":r instanceof i.$keyboardNavigation.HeaderCell?"headerCell":r instanceof i.$keyboardNavigation.TaskRow?"taskRow":r instanceof i.$keyboardNavigation.TaskCell?"taskCell":null,a=i.getGridColumns();switch(n){case"taskCell":return{type:"taskCell",id:e.taskId,column:a[e.columnIndex].name};case"taskRow":return{type:"taskRow",id:e.taskId};case"headerCell":return{type:"headerCell",column:a[e.index].name}}}var r;return null}}),i.$keyboardNavigation.facade=g,i.ext.keyboardNavigation=g,i.focus=function(){g.focus()},i.addShortcut=g.addShortcut,i.getShortcutHandler=g.getShortcutHandler,i.removeShortcut=g.removeShortcut}()},quick_info:function(t){t.ext||(t.ext={}),t.ext.quickInfo=new Y(t),t.config.quickinfo_buttons=["icon_edit","icon_delete"],t.config.quick_info_detached=!0,t.config.show_quick_info=!0,t.templates.quick_info_title=function(t,e,i){return i.text.substr(0,50)},t.templates.quick_info_content=function(t,e,i){return i.details||i.text},t.templates.quick_info_date=function(e,i,n){return t.templates.task_time(e,i,n)},t.templates.quick_info_class=function(t,e,i){return""},t.attachEvent("onTaskClick",(function(e,i){const n=t.utils.dom.closest(i.target,".gantt_add"),a=t.utils.dom.closest(i.target,".gantt_close"),r=t.utils.dom.closest(i.target,".gantt_open");return!n&&!a&&!r&&setTimeout((function(){t.ext.quickInfo.show(e)}),0),!0}));const e=["onViewChange","onLightbox","onBeforeTaskDelete","onBeforeDrag"],i=function(){return t.ext.quickInfo.hide(),!0};for(let n=0;n<e.length;n++)t.attachEvent(e[n],i);function n(){return t.ext.quickInfo.hide(),t.ext.quickInfo._quickInfoBox=null,!0}t.attachEvent("onEmptyClick",(function(e){let n=!0;const a=document.querySelector(".gantt_cal_quick_info");a&&t.utils.dom.isChildOf(e.target,a)&&(n=!1),n&&i()})),t.attachEvent("onGanttReady",n),t.attachEvent("onDestroy",n),t.event(window,"keydown",(function(e){27===e.keyCode&&t.ext.quickInfo.hide()})),t.showQuickInfo=function(){t.ext.quickInfo.show.apply(t.ext.quickInfo,arguments)},t.hideQuickInfo=function(){t.ext.quickInfo.hide.apply(t.ext.quickInfo,arguments)}},tooltip:function(t){t.config.tooltip_timeout=30,t.config.tooltip_offset_y=20,t.config.tooltip_offset_x=10,t.config.tooltip_hide_timeout=30;const e=new ot(t);t.ext.tooltips=e,t.attachEvent("onGanttReady",(function(){t.$root&&e.tooltipFor({selector:"["+t.config.task_attribute+"]:not(.gantt_task_row)",html:e=>{if(t.config.touch&&!t.config.touch_tooltip)return;const i=t.locate(e);if(t.isTaskExists(i)){const e=t.getTask(i);return t.templates.tooltip_text(e.start_date,e.end_date,e)}return null},global:!1})})),t.attachEvent("onDestroy",(function(){e.destructor()})),t.attachEvent("onLightbox",(function(){e.hideTooltip()})),t.attachEvent("onBeforeTooltip",(function(){if(t.getState().link_source_id)return!1})),t.attachEvent("onGanttScroll",(function(){e.hideTooltip()}))},undo:function(t){const e=new ut(t),i=new ct(e,t);function n(t,e){return String(t)===String(e)}function a(t,e,i){t&&(n(t.id,e)&&(t.id=i),n(t.parent,e)&&(t.parent=i))}function r(t,e,i){a(t.value,e,i),a(t.oldValue,e,i)}function s(t,e,i){t&&(n(t.source,e)&&(t.source=i),n(t.target,e)&&(t.target=i))}function o(t,e,i){s(t.value,e,i),s(t.oldValue,e,i)}function l(t,i,n){const a=e;for(let e=0;e<t.length;e++){const s=t[e];for(let t=0;t<s.commands.length;t++)s.commands[t].entity===a.command.entity.task?r(s.commands[t],i,n):s.commands[t].entity===a.command.entity.link&&o(s.commands[t],i,n)}}function d(t,i,n){const a=e;for(let e=0;e<t.length;e++){const r=t[e];for(let t=0;t<r.commands.length;t++){const e=r.commands[t];e.entity===a.command.entity.link&&(e.value&&e.value.id===i&&(e.value.id=n),e.oldValue&&e.oldValue.id===i&&(e.oldValue.id=n))}}}t.config.undo=!0,t.config.redo=!0,t.config.undo_types={link:"link",task:"task"},t.config.undo_actions={update:"update",remove:"remove",add:"add",move:"move"},t.ext||(t.ext={}),t.ext.undo={undo:()=>e.undo(),redo:()=>e.redo(),getUndoStack:()=>e.getUndoStack(),setUndoStack:t=>e.setUndoStack(t),getRedoStack:()=>e.getRedoStack(),setRedoStack:t=>e.setRedoStack(t),clearUndoStack:()=>e.clearUndoStack(),clearRedoStack:()=>e.clearRedoStack(),saveState:(t,e)=>i.store(t,e,!0),getInitialState:(e,n)=>n===t.config.undo_types.link?i.getInitialLink(e):i.getInitialTask(e)},t.undo=t.ext.undo.undo,t.redo=t.ext.undo.redo,t.getUndoStack=t.ext.undo.getUndoStack,t.getRedoStack=t.ext.undo.getRedoStack,t.clearUndoStack=t.ext.undo.clearUndoStack,t.clearRedoStack=t.ext.undo.clearRedoStack,t.attachEvent("onTaskIdChange",((t,i)=>{const n=e;l(n.getUndoStack(),t,i),l(n.getRedoStack(),t,i)})),t.attachEvent("onLinkIdChange",((t,i)=>{const n=e;d(n.getUndoStack(),t,i),d(n.getRedoStack(),t,i)})),t.attachEvent("onGanttReady",(()=>{e.updateConfigs()}))},marker:function(t){function e(e){if(!t.config.show_markers||!e.start_date)return!1;var i=t.getState();if(+e.start_date>+i.max_date||(!e.end_date||+e.end_date<+i.min_date)&&+e.start_date<+i.min_date)return;var n=document.createElement("div");n.setAttribute("data-marker-id",e.id);var a="gantt_marker";t.templates.marker_class&&(a+=" "+t.templates.marker_class(e)),e.css&&(a+=" "+e.css),t.templates.marker_class&&(a+=" "+t.templates.marker_class(e)),e.title&&(n.title=e.title),n.className=a;var r=t.posFromDate(e.start_date);n.style.left=r+"px";let s=Math.max(t.getRowTop(t.getVisibleTaskCount()),0)+"px";if(t.config.timeline_placeholder&&t.$task_data&&(s=t.$task_data.scrollHeight+"px"),n.style.height=s,e.end_date){var o=t.posFromDate(e.end_date);n.style.width=Math.max(o-r,0)+"px"}if(e.text){let i=null;i="function"==typeof e.text?e.text(e):e.text,i&&(t.config.external_render&&t.config.external_render.isElement(i)?(n.innerHTML="<div class='gantt_marker_content' ></div>",t.config.external_render.renderElement(i,n.querySelector(".gantt_marker_content"))):n.innerHTML="<div class='gantt_marker_content' >"+e.text+"</div>")}return n}function i(){if(t.$task_data&&t.$root.contains(t.$task_data)){if(!t.$marker_area||!t.$task_data.contains(t.$marker_area)){var e=document.createElement("div");e.className="gantt_marker_area",t.$task_data.appendChild(e),t.$marker_area=e}}else t.$marker_area=null}t._markers||(t._markers=t.createDatastore({name:"marker",initItem:function(e){return e.id=e.id||t.uid(),e}})),t.config.show_markers=!0,t.attachEvent("onBeforeGanttRender",(function(){t.$marker_area||i()})),t.attachEvent("onDataRender",(function(){t.$marker_area||(i(),t.renderMarkers())})),t.attachEvent("onGanttLayoutReady",(function(){t.attachEvent("onBeforeGanttRender",(function(){t.$marker_area&&(t.$marker_area.innerHTML=""),i(),t.$services.getService("layers").createDataRender({name:"marker",defaultContainer:function(){return t.$marker_area}}).addLayer(e)}),{once:!0})})),t.getMarker=function(t){return this._markers?this._markers.getItem(t):null},t.addMarker=function(t){return this._markers.addItem(t)},t.deleteMarker=function(t){return!!this._markers.exists(t)&&(this._markers.removeItem(t),!0)},t.updateMarker=function(t){this._markers.refresh(t)},t._getMarkers=function(){return this._markers.getItems()},t.renderMarkers=function(){this._markers.refresh()}},multiselect:function(t){t.config.multiselect=!0,t.config.multiselect_one_level=!1,t._multiselect={_selected:{},_one_level:!1,_active:!0,_first_selected_when_shift:null,getDefaultSelected:function(){var t=this.getSelected();return t.length?t[t.length-1]:null},setFirstSelected:function(t){this._first_selected_when_shift=t},getFirstSelected:function(){return this._first_selected_when_shift},isActive:function(){return this.updateState(),this._active},updateState:function(){this._one_level=t.config.multiselect_one_level;var e=this._active;this._active=t.config.select_task,this._active!=e&&this.reset()},reset:function(){this._selected={}},setLastSelected:function(e){t.$data.tasksStore.silent((function(){var i=t.$data.tasksStore;e?i.select(e+""):i.unselect(null)}))},getLastSelected:function(){var e=t.$data.tasksStore.getSelectedId();return e&&t.isTaskExists(e)?e:null},select:function(e,i){return!!(e&&t.callEvent("onBeforeTaskMultiSelect",[e,!0,i])&&t.callEvent("onBeforeTaskSelected",[e]))&&(this._selected[e]=!0,this.setLastSelected(e),this.afterSelect(e),t.callEvent("onTaskMultiSelect",[e,!0,i]),t.callEvent("onTaskSelected",[e]),!0)},toggle:function(t,e){this._selected[t]?this.unselect(t,e):this.select(t,e)},unselect:function(e,i){e&&t.callEvent("onBeforeTaskMultiSelect",[e,!1,i])&&(this._selected[e]=!1,this.getLastSelected()==e&&this.setLastSelected(this.getDefaultSelected()),this.afterSelect(e),t.callEvent("onTaskMultiSelect",[e,!1,i]),t.callEvent("onTaskUnselected",[e]))},isSelected:function(e){return!(!t.isTaskExists(e)||!this._selected[e])},getSelected:function(){var e=[];for(var i in this._selected)this._selected[i]&&t.isTaskExists(i)?e.push(i):this._selected[i]=!1;return e.sort((function(e,i){return t.getGlobalTaskIndex(e)>t.getGlobalTaskIndex(i)?1:-1})),e},forSelected:function(t){for(var e=this.getSelected(),i=0;i<e.length;i++)t(e[i])},isSameLevel:function(e){if(!this._one_level)return!0;var i=this.getLastSelected();return!i||!t.isTaskExists(i)||!t.isTaskExists(e)||t.calculateTaskLevel(t.getTask(i))==t.calculateTaskLevel(t.getTask(e))},afterSelect:function(e){t.isTaskExists(e)&&t._quickRefresh((function(){t.refreshTask(e)}))},doSelection:function(e){if(!this.isActive()||t._is_icon_open_click(e))return!1;var i=t.locate(e);if(!i||!t.callEvent("onBeforeMultiSelect",[e]))return!1;var n=this.getSelected(),a=this.getFirstSelected(),r=!1,s=this.getLastSelected(),o=t.config.multiselect,l=function(){const a=t.ext.inlineEditors;if(a&&a.getState){const i=a.getState(),n=a.locateCell(e.target);t.config.inline_editors_multiselect_open&&n&&a.getEditorConfig(n.columnName)&&(a.isVisible()&&i.id==n.id&&i.columnName==n.columnName||a.startEdit(n.id,n.columnName))}this.setFirstSelected(i),this.isSelected(i)||this.select(i,e),n=this.getSelected();for(var r=0;r<n.length;r++)n[r]!==i&&this.unselect(n[r],e)}.bind(this),d=function(){if(s){if(i){var n=t.getGlobalTaskIndex(this.getFirstSelected()),o=t.getGlobalTaskIndex(i),l=t.getGlobalTaskIndex(s);-1!=n&&-1!=l||(n=o,this.reset());for(var d=s;t.getGlobalTaskIndex(d)!==n;)this.unselect(d,e),d=n>l?t.getNext(d):t.getPrev(d);for(d=i;t.getGlobalTaskIndex(d)!==n;)this.select(d,e)&&!r&&(r=!0,a=d),d=n>o?t.getNext(d):t.getPrev(d)}}else s=i}.bind(this);return o&&(e.ctrlKey||e.metaKey)?(this.isSelected(i)||this.setFirstSelected(i),i&&this.toggle(i,e)):o&&e.shiftKey?(t.isTaskExists(this.getFirstSelected())&&null!==this.getFirstSelected()||this.setFirstSelected(i),n.length?d():l()):l(),this.isSelected(i)?this.setLastSelected(i):a?i==s&&this.setLastSelected(e.shiftKey?a:this.getDefaultSelected()):this.setLastSelected(null),this.getSelected().length||this.setLastSelected(null),this.getLastSelected()&&this.isSelected(this.getFirstSelected())||this.setFirstSelected(this.getLastSelected()),!0}},function(){var e=t.selectTask;t.selectTask=function(i){if(!(i=j(i,this.config.root_id)))return!1;var n=t._multiselect,a=i;return n.isActive()?(n.select(i,null)&&n.setLastSelected(i),n.setFirstSelected(n.getLastSelected())):a=e.call(this,i),a};var i=t.unselectTask;t.unselectTask=function(e){var n=t._multiselect,a=n.isActive();(e=e||n.getLastSelected())&&a&&(n.unselect(e,null),e==n.getLastSelected()&&n.setLastSelected(null),t.refreshTask(e),n.setFirstSelected(n.getLastSelected()));var r=e;return a||(r=i.call(this,e)),r},t.toggleTaskSelection=function(e){var i=t._multiselect;e&&i.isActive()&&(i.toggle(e),i.setFirstSelected(i.getLastSelected()))},t.getSelectedTasks=function(){var e=t._multiselect;return e.isActive(),e.getSelected()},t.eachSelectedTask=function(t){return this._multiselect.forSelected(t)},t.isSelectedTask=function(t){return this._multiselect.isSelected(t)},t.getLastSelectedTask=function(){return this._multiselect.getLastSelected()},t.attachEvent("onGanttReady",(function(){var e=t.$data.tasksStore.isSelected;t.$data.tasksStore.isSelected=function(i){return t._multiselect.isActive()?t._multiselect.isSelected(i):e.call(this,i)}}))}(),t.attachEvent("onTaskIdChange",(function(e,i){var n=t._multiselect;if(!n.isActive())return!0;t.isSelectedTask(e)&&(n.unselect(e,null),n.select(i,null))})),t.attachEvent("onAfterTaskDelete",(function(e,i){var n=t._multiselect;if(!n.isActive())return!0;n._selected[e]&&(n._selected[e]=!1,n.setLastSelected(n.getDefaultSelected())),n.forSelected((function(e){t.isTaskExists(e)||n.unselect(e,null)}))})),t.attachEvent("onBeforeTaskMultiSelect",(function(e,i,n){const a=t._multiselect;if(i&&a.isActive()){let i=t.getSelectedId(),r=null;i&&(r=t.getTask(i));let s=t.getTask(e),o=!1;if(r&&r.$level!=s.$level&&(o=!0),t.config.multiselect_one_level&&o&&!n.ctrlKey&&!n.shiftKey)return!0;if(a._one_level)return a.isSameLevel(e)}return!0})),t.attachEvent("onTaskClick",(function(e,i){return t._multiselect.doSelection(i)&&t.callEvent("onMultiSelect",[i]),!0}))},export_api:function(t){return t.ext=t.ext||{},t.ext.export_api=t.ext.export_api||{_apiUrl:"https://export.dhtmlx.com/gantt",_preparePDFConfigRaw(e,i){let n=null;e.start&&e.end&&(n={start_date:t.config.start_date,end_date:t.config.end_date},t.config.start_date=t.date.str_to_date(t.config.date_format)(e.start),t.config.end_date=t.date.str_to_date(t.config.date_format)(e.end)),e=t.mixin(e,{name:"gantt."+i,data:t.ext.export_api._serializeHtml()}),n&&(t.config.start_date=n.start_date,t.config.end_date=n.end_date)},_prepareConfigPDF:(e,i)=>(e=t.mixin(e||{},{name:"gantt."+i,data:t.ext.export_api._serializeAll(),config:t.config}),t.ext.export_api._fixColumns(e.config.columns),e),_pdfExportRouter(e,i){e&&e.raw?t.ext.export_api._preparePDFConfigRaw(e,i):e=t.ext.export_api._prepareConfigPDF(e,i),e.version=t.version,t.ext.export_api._sendToExport(e,i)},exportToPDF(e){t.ext.export_api._pdfExportRouter(e,"pdf")},exportToPNG(e){t.ext.export_api._pdfExportRouter(e,"png")},exportToICal(e){e=t.mixin(e||{},{name:"gantt.ical",data:t.ext.export_api._serializePlain().data,version:t.version}),t.ext.export_api._sendToExport(e,"ical")},exportToExcel(e){let i,n,a,r;e=e||{};const s=t.config.smart_rendering;if("base-colors"===e.visual&&(t.config.smart_rendering=!1),e.start||e.end){a=t.getState(),n=[t.config.start_date,t.config.end_date],r=t.getScrollState();const o=t.date.str_to_date(t.config.date_format);i=t.eachTask,e.start&&(t.config.start_date=o(e.start)),e.end&&(t.config.end_date=o(e.end)),t.render(),t.config.smart_rendering=s,t.eachTask=t.ext.export_api._eachTaskTimed(t.config.start_date,t.config.end_date)}else"base-colors"===e.visual&&(t.render(),t.config.smart_rendering=s);t._no_progress_colors="base-colors"===e.visual,(e=t.mixin(e,{name:"gantt.xlsx",title:"Tasks",data:t.ext.export_api._serializeTimeline(e).data,columns:t.ext.export_api._serializeGrid({rawDates:!0}),version:t.version})).visual&&(e.scales=t.ext.export_api._serializeScales(e)),t.ext.export_api._sendToExport(e,"excel"),(e.start||e.end)&&(t.config.start_date=a.min_date,t.config.end_date=a.max_date,t.eachTask=i,t.render(),t.scrollTo(r.x,r.y),t.config.start_date=n[0],t.config.end_date=n[1])},exportToJSON(e){e=t.mixin(e||{},{name:"gantt.json",data:t.ext.export_api._serializeAll(),config:t.config,columns:t.ext.export_api._serializeGrid(),worktime:t.ext.export_api._getWorktimeSettings(),version:t.version}),t.ext.export_api._sendToExport(e,"json")},importFromExcel(e){try{const t=e.data;if(t instanceof File){const i=new FormData;i.append("file",t),e.data=i}}catch{}t.ext.export_api._sendImportAjaxExcel(e)},importFromMSProject(e){const i=e.data;try{if(i instanceof File){const t=new FormData;t.append("file",i),e.data=t}}catch{}t.ext.export_api._sendImportAjaxMSP(e)},importFromPrimaveraP6:e=>(e.type="primaveraP6-parse",t.importFromMSProject(e)),exportToMSProject(e){(e=e||{}).skip_circular_links=void 0===e.skip_circular_links||!!e.skip_circular_links;const i=t.templates.xml_format,n=t.templates.format_date,a=t.config.xml_date,r=t.config.date_format,s="%d-%m-%Y %H:%i:%s";t.config.xml_date=s,t.config.date_format=s,t.templates.xml_format=t.date.date_to_str(s),t.templates.format_date=t.date.date_to_str(s);const o=t.ext.export_api._serializeAll();t.ext.export_api._customProjectProperties(o,e),t.ext.export_api._customTaskProperties(o,e),e.skip_circular_links&&t.ext.export_api._clearRecLinks(o),e=t.ext.export_api._exportConfig(o,e),t.ext.export_api._sendToExport(e,e.type||"msproject"),t.config.xml_date=a,t.config.date_format=r,t.templates.xml_format=i,t.templates.format_date=n,t.config.$custom_data=null,t.config.custom=null},exportToPrimaveraP6:e=>((e=e||{}).type="primaveraP6",t.exportToMSProject(e)),_fixColumns(e){for(let i=0;i<e.length;i++)e[i].label=e[i].label||t.locale.labels["column_"+e[i].name],"string"==typeof e[i].width&&(e[i].width=1*e[i].width)},_xdr(e,i,n){t.ajax.post(e,i,n)},_markColumns(t){const e=t.config.columns;if(e)for(let t=0;t<e.length;t++)e[t].template&&(e[t].$template=!0)},_sendImportAjaxExcel(e){const i=e.server||t.ext.export_api._apiUrl,n=e.store||0,a=e.data,r=e.callback;a.append("type","excel-parse"),a.append("data",JSON.stringify({sheet:e.sheet||0})),n&&a.append("store",n);const s=new XMLHttpRequest;s.onreadystatechange=function(t){4===s.readyState&&0===s.status&&r&&r(null)},s.onload=function(){let t=null;if(!(s.status>400))try{t=JSON.parse(s.responseText)}catch{}r&&r(t)},s.open("POST",i,!0),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.send(a)},_ajaxToExport(e,i,n){delete e.callback;const a=e.server||t.ext.export_api._apiUrl,r="type="+i+"&store=1&data="+encodeURIComponent(JSON.stringify(e));t.ext.export_api._xdr(a,r,(function(t){const e=t.xmlDoc||t;let i=null;if(!(e.status>400))try{i=JSON.parse(e.responseText)}catch{}n(i)}))},_serializableGanttConfig(e){const i=t.mixin({},e);return i.columns&&(i.columns=i.columns.map((function(e){const i=t.mixin({},e);return delete i.editor,i}))),delete i.editor_types,i},_sendToExport(e,i){const n=t.date.date_to_str(t.config.date_format||t.config.xml_date);if(e.skin||(e.skin=t.skin),e.config&&(e.config=t.copy(t.ext.export_api._serializableGanttConfig(e.config)),t.ext.export_api._markColumns(e,i),e.config.start_date&&e.config.end_date&&(e.config.start_date instanceof Date&&(e.config.start_date=n(e.config.start_date)),e.config.end_date instanceof Date&&(e.config.end_date=n(e.config.end_date)))),e.callback)return t.ext.export_api._ajaxToExport(e,i,e.callback);const a=t.ext.export_api._createHiddenForm();a.firstChild.action=e.server||t.ext.export_api._apiUrl,a.firstChild.childNodes[0].value=JSON.stringify(e),a.firstChild.childNodes[1].value=i,a.firstChild.submit()},_createHiddenForm(){if(!t.ext.export_api._hidden_export_form){const e=t.ext.export_api._hidden_export_form=document.createElement("div");e.style.display="none",e.innerHTML="<form method='POST' target='_blank'><textarea name='data' style='width:0px; height:0px;' readonly='true'></textarea><input type='hidden' name='type' value=''></form>",document.body.appendChild(e)}return t.ext.export_api._hidden_export_form},_copyObjectBase(e){const i={start_date:void 0,end_date:void 0,constraint_date:void 0,deadline:void 0};for(const t in e)"$"!==t.charAt(0)&&"baselines"!==t&&(i[t]=e[t]);const n=t.templates.xml_format||t.templates.format_date;return i.start_date=n(i.start_date),i.end_date&&(i.end_date=n(i.end_date)),i.constraint_date&&(i.constraint_date=n(i.constraint_date)),i.deadline&&(i.deadline=n(i.deadline)),i},_color_box:null,_color_hash:{},_getStyles(e){if(t.ext.export_api._color_box||(t.ext.export_api._color_box=document.createElement("DIV"),t.ext.export_api._color_box.style.cssText="position:absolute; display:none;",document.body.appendChild(t.ext.export_api._color_box)),t.ext.export_api._color_hash[e])return t.ext.export_api._color_hash[e];t.ext.export_api._color_box.className=e;const i=t.ext.export_api._getColor(t.ext.export_api._color_box,"color"),n=t.ext.export_api._getColor(t.ext.export_api._color_box,"backgroundColor");return t.ext.export_api._color_hash[e]=i+";"+n},_getMinutesWorktimeSettings(t){const e=[];return t.forEach((function(t){e.push(t.startMinute),e.push(t.endMinute)})),e},_getWorktimeSettings(){const e={hours:[0,24],minutes:null,dates:{0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0}};let i;if(t.config.work_time){const n=t._working_time_helper;if(n&&n.get_calendar)i=n.get_calendar();else if(n)i={hours:n.hours,minutes:null,dates:n.dates};else if(t.config.worktimes&&t.config.worktimes.global){const e=t.config.worktimes.global;if(e.parsed){i={hours:null,minutes:t.ext.export_api._getMinutesWorktimeSettings(e.parsed.hours),dates:{}};for(const n in e.parsed.dates)Array.isArray(e.parsed.dates[n])?i.dates[n]=t.ext.export_api._getMinutesWorktimeSettings(e.parsed.dates[n]):i.dates[n]=e.parsed.dates[n]}else i={hours:e.hours,minutes:null,dates:e.dates}}else i=e}else i=e;return i},_eachTaskTimed:(e,i)=>function(n,a,r){a=a||t.config.root_id,r=r||t;const s=t.getChildren(a);if(s)for(let a=0;a<s.length;a++){const o=t._pull[s[a]];(!e||o.end_date>e)&&(!i||o.start_date<i)&&n.call(r,o),t.hasChild(o.id)&&t.eachTask(n,o.id,r)}},_originalCopyObject:t.json._copyObject,_copyObjectPlain(e){const i=t.templates.task_text(e.start_date,e.end_date,e),n=t.ext.export_api._copyObjectBase(e);return n.text=i||n.text,n},_getColor(t,e){const i=t.currentStyle?t.currentStyle[e]:getComputedStyle(t,null)[e],n=i.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+)/i);return(n&&4===n.length?("0"+parseInt(n[1],10).toString(16)).slice(-2)+("0"+parseInt(n[2],10).toString(16)).slice(-2)+("0"+parseInt(n[3],10).toString(16)).slice(-2):i).replace("#","")},_copyObjectTable(e){const i=t.date.date_to_str("%Y-%m-%dT%H:%i:%s.000Z"),n=t.ext.export_api._copyObjectColumns(e,t.ext.export_api._copyObjectPlain(e));n.start_date&&(n.start_date=i(e.start_date)),n.end_date&&(n.end_date=i(e.end_date));const a=t._day_index_by_date?t._day_index_by_date:t.columnIndexByDate;n.$start=a.call(t,e.start_date),n.$end=a.call(t,e.end_date);let r=0;const s=t.getScale().width;if(s.indexOf(0)>-1){let t=0;for(;t<n.$start;t++)s[t]||r++;for(n.$start-=r;t<n.$end;t++)s[t]||r++;n.$end-=r}n.$level=e.$level,n.$type=e.$rendered_type;const o=t.templates;return n.$text=o.task_text(e.start,e.end_date,e),n.$left=o.leftside_text?o.leftside_text(e.start,e.end_date,e):"",n.$right=o.rightside_text?o.rightside_text(e.start,e.end_date,e):"",n},_copyObjectColors(e){const i=t.ext.export_api._copyObjectTable(e),n=t.getTaskNode(e.id);if(n&&n.firstChild){let e=t.ext.export_api._getColor(t._no_progress_colors?n:n.firstChild,"backgroundColor");"363636"===e&&(e=t.ext.export_api._getColor(n,"backgroundColor")),i.$color=e}else e.color&&(i.$color=e.color);return i},_copyObjectColumns(e,i){for(let n=0;n<t.config.columns.length;n++){const a=t.config.columns[n].template;if(a){let r=a(e);r instanceof Date&&(r=t.templates.date_grid(r,e)),i["_"+n]=r}}return i},_copyObjectAll(e){const i=t.ext.export_api._copyObjectBase(e),n=["leftside_text","rightside_text","task_text","progress_text","task_class"];for(let a=0;a<n.length;a++){const r=t.templates[n[a]];r&&(i["$"+a]=r(e.start_date,e.end_date,e))}return t.ext.export_api._copyObjectColumns(e,i),i.open=e.$open,i},_serializeHtml(){const e=t.config.smart_scales,i=t.config.smart_rendering;(e||i)&&(t.config.smart_rendering=!1,t.config.smart_scales=!1,t.render());const n=t.$container.parentNode.innerHTML;return(e||i)&&(t.config.smart_scales=e,t.config.smart_rendering=i,t.render()),n},_serializeAll(){t.json._copyObject=t.ext.export_api._copyObjectAll;const e=t.ext.export_api._exportSerialize();return t.json._copyObject=t.ext.export_api._originalCopyObject,e},_serializePlain(){const e=t.templates.xml_format,i=t.templates.format_date;t.templates.xml_format=t.date.date_to_str("%Y%m%dT%H%i%s",!0),t.templates.format_date=t.date.date_to_str("%Y%m%dT%H%i%s",!0),t.json._copyObject=t.ext.export_api._copyObjectPlain;const n=t.ext.export_api._exportSerialize();return t.templates.xml_format=e,t.templates.format_date=i,t.json._copyObject=t.ext.export_api._originalCopyObject,delete n.links,n},_getRaw(){if(t._scale_helpers){const e=t._get_scales(),i=t.config.min_column_width,n=t._get_resize_options().x?Math.max(t.config.autosize_min_width,0):t.config.$task.offsetWidth,a=t.config.config.scale_height-1;return t._scale_helpers.prepareConfigs(e,i,n,a)}{const e=t.$ui.getView("timeline");if(e){let i=e.$config.width;"x"!==t.config.autosize&&"xy"!==t.config.autosize||(i=Math.max(t.config.autosize_min_width,0));const n=t.getState(),a=e._getScales(),r=t.config.min_column_width,s=t.config.scale_height-1,o=t.config.rtl;return e.$scaleHelper.prepareConfigs(a,r,i,s,n.min_date,n.max_date,o)}}},_serializeTimeline(e){t.json._copyObject=e.visual?t.ext.export_api._copyObjectColors:t.ext.export_api._copyObjectTable;const i=t.ext.export_api._exportSerialize();if(t.json._copyObject=t.ext.export_api._originalCopyObject,delete i.links,e.cellColors){const e=t.templates.timeline_cell_class||t.templates.task_cell_class;if(e){const n=t.ext.export_api._getRaw();let a=n[0].trace_x;for(let t=1;t<n.length;t++)n[t].trace_x.length>a.length&&(a=n[t].trace_x);for(let n=0;n<i.data.length;n++){i.data[n].styles=[];const r=t.getTask(i.data[n].id);for(let s=0;s<a.length;s++){const o=e(r,a[s]);o&&i.data[n].styles.push({index:s,styles:t.ext.export_api._getStyles(o)})}}}}return i},_serializeScales(e){const i=[],n=t.ext.export_api._getRaw();let a=1/0,r=0;for(let t=0;t<n.length;t++)a=Math.min(a,n[t].col_width);for(let s=0;s<n.length;s++){let o=0,l=0;const d=[];i.push(d);const c=n[s];r=Math.max(r,c.trace_x.length);const u=c.format||c.template||(c.date?t.date.date_to_str(c.date):t.config.date_scale);for(let i=0;i<c.trace_x.length;i++){const n=c.trace_x[i];l=o+Math.round(c.width[i]/a);const r={text:u(n),start:o,end:l,styles:""};if(e.cellColors){const e=c.css||t.templates.scaleCell_class;if(e){const i=e(n);i&&(r.styles=t.ext.export_api._getStyles(i))}}d.push(r),o=l}}return{width:r,height:i.length,data:i}},_serializeGrid(e){t.exportMode=!0;const i=[],n=t.config.columns;let a=0;for(let r=0;r<n.length;r++)"add"!==n[r].name&&"buttons"!==n[r].name&&(i[a]={id:n[r].template?"_"+r:n[r].name,header:n[r].label||t.locale.labels["column_"+n[r].name],width:n[r].width?Math.floor(n[r].width/4):"",tree:n[r].tree||!1},"duration"===n[r].name&&(i[a].type="number"),"start_date"!==n[r].name&&"end_date"!==n[r].name||(i[a].type="date",e&&e.rawDates&&(i[a].id=n[r].name)),a++);return t.exportMode=!1,i},_exportSerialize(){t.exportMode=!0;const e=t.templates.xml_format,i=t.templates.format_date;t.templates.xml_format=t.templates.format_date=t.date.date_to_str(t.config.date_format||t.config.xml_date);const n=t.serialize();return t.templates.xml_format=e,t.templates.format_date=i,t.exportMode=!1,n},_setLevel(t){for(let e=0;e<t.length;e++){0==t[e].parent&&(t[e]._lvl=1);for(let i=e+1;i<t.length;i++)t[e].id==t[i].parent&&(t[i]._lvl=t[e]._lvl+1)}},_clearLevel(t){for(let e=0;e<t.length;e++)delete t[e]._lvl},_clearRecLinks(e){t.ext.export_api._setLevel(e.data);const i={};for(let t=0;t<e.data.length;t++)i[e.data[t].id]=e.data[t];const n={};for(let a=0;a<e.links.length;a++){const r=e.links[a];t.isTaskExists(r.source)&&t.isTaskExists(r.target)&&i[r.source]&&i[r.target]&&(n[r.id]=r)}for(const e in n)t.ext.export_api._makeLinksSameLevel(n[e],i);const a={};for(const e in i)t.ext.export_api._clearCircDependencies(i[e],n,i,{},a,null);Object.keys(n)&&t.ext.export_api._clearLinksSameLevel(n,i);for(let t=0;t<e.links.length;t++)n[e.links[t].id]||(e.links.splice(t,1),t--);t.ext.export_api._clearLevel(e.data)},_clearCircDependencies(e,i,n,a,r,s){const o=e.$_source;if(!o)return;a[e.id]&&t.ext.export_api._onCircDependencyFind(s,i,a,r),a[e.id]=!0;const l={};for(let e=0;e<o.length;e++){if(r[o[e]])continue;const s=i[o[e]],d=n[s._target];l[d.id]&&t.ext.export_api._onCircDependencyFind(s,i,a,r),l[d.id]=!0,t.ext.export_api._clearCircDependencies(d,i,n,a,r,s)}a[e.id]=!1},_onCircDependencyFind(e,i,n,a){e&&(t.callEvent("onExportCircularDependency",[e.id,e])&&delete i[e.id],delete n[e._source],delete n[e._target],a[e.id]=!0)},_makeLinksSameLevel(t,e){let i,n;const a={target:e[t.target],source:e[t.source]};if(a.target._lvl!=a.source._lvl){a.target._lvl<a.source._lvl?(i="source",n=a.target._lvl):(i="target",n=a.source._lvl);do{const t=e[a[i].parent];if(!t)break;a[i]=t}while(a[i]._lvl<n);let t=e[a.source.parent],r=e[a.target.parent];for(;t&&r&&t.id!=r.id;)a.source=t,a.target=r,t=e[a.source.parent],r=e[a.target.parent]}t._target=a.target.id,t._source=a.source.id,a.target.$_target||(a.target.$_target=[]),a.target.$_target.push(t.id),a.source.$_source||(a.source.$_source=[]),a.source.$_source.push(t.id)},_clearLinksSameLevel(t,e){for(const e in t)delete t[e]._target,delete t[e]._source;for(const t in e)delete e[t].$_source,delete e[t].$_target},_customProjectProperties(e,i){if(i&&i.project){for(const e in i.project)t.config.$custom_data||(t.config.$custom_data={}),t.config.$custom_data[e]="function"==typeof i.project[e]?i.project[e](t.config):i.project[e];delete i.project}},_customTaskProperties(e,i){i&&i.tasks&&(e.data.forEach((function(e){for(const n in i.tasks)e.$custom_data||(e.$custom_data={}),e.$custom_data[n]="function"==typeof i.tasks[n]?i.tasks[n](e,t.config):i.tasks[n]})),delete i.tasks)},_exportConfig(e,i){const n=i.name||"gantt.xml";delete i.name,t.config.custom=i;const a=t.ext.export_api._getWorktimeSettings(),r=t.getSubtaskDates();if(r.start_date&&r.end_date){const e=t.templates.format_date||t.templates.xml_format;t.config.start_end={start_date:e(r.start_date),end_date:e(r.end_date)}}const s=void 0!==i.auto_scheduling&&!!i.auto_scheduling,o={callback:i.callback||null,config:t.config,data:e,manual:s,name:n,worktime:a};for(const t in i)o[t]=i[t];return o},_sendImportAjaxMSP(e){const i=e.server||t.ext.export_api._apiUrl,n=e.store||0,a=e.data,r=e.callback,s={durationUnit:e.durationUnit||void 0,projectProperties:e.projectProperties||void 0,taskProperties:e.taskProperties||void 0};a.append("type",e.type||"msproject-parse"),a.append("data",JSON.stringify(s)),n&&a.append("store",n);const o=new XMLHttpRequest;o.onreadystatechange=function(t){4===o.readyState&&0===o.status&&r&&r(null)},o.onload=function(){let t=null;if(!(o.status>400))try{t=JSON.parse(o.responseText)}catch{}r&&r(t)},o.open("POST",i,!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.send(a)}},t.exportToPDF=t.ext.export_api.exportToPDF,t.exportToPNG=t.ext.export_api.exportToPNG,t.exportToICal=t.ext.export_api.exportToICal,t.exportToExcel=t.ext.export_api.exportToExcel,t.exportToJSON=t.ext.export_api.exportToJSON,t.importFromExcel=t.ext.export_api.importFromExcel,t.importFromMSProject=t.ext.export_api.importFromMSProject,t.exportToMSProject=t.ext.export_api.exportToMSProject,t.importFromPrimaveraP6=t.ext.export_api.importFromPrimaveraP6,t.exportToPrimaveraP6=t.ext.export_api.exportToPrimaveraP6,t.ext.export_api}},_t={KEY_CODES:{UP:38,DOWN:40,LEFT:37,RIGHT:39,SPACE:32,ENTER:13,DELETE:46,ESC:27,TAB:9}};class gt{constructor(t){this.addExtension=(t,e)=>{this._extensions[t]=e},this.getExtension=t=>this._extensions[t],this._extensions={};for(const e in t)this._extensions[e]=t[e]}}var ft=typeof window<"u";const pt={isIE:ft&&(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0),isOpera:ft&&(navigator.userAgent.indexOf("Opera")>=0||navigator.userAgent.indexOf("OPR")>=0),isChrome:ft&&navigator.userAgent.indexOf("Chrome")>=0,isSafari:ft&&(navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0),isFF:ft&&navigator.userAgent.indexOf("Firefox")>=0,isIPad:ft&&navigator.userAgent.search(/iPad/gi)>=0,isEdge:ft&&-1!=navigator.userAgent.indexOf("Edge"),isNode:!ft||typeof navigator>"u"||!1,isSalesforce:ft&&(!!D.Sfdc||!!D.$A||D.Aura)};function mt(t){if("string"==typeof t||"number"==typeof t)return t;let e="";for(const i in t){let n="";t.hasOwnProperty(i)&&(n="string"==typeof t[i]?encodeURIComponent(t[i]):"number"==typeof t[i]?String(t[i]):encodeURIComponent(JSON.stringify(t[i])),n=i+"="+n,e.length&&(n="&"+n),e+=n)}return e}function vt(t,e){var i={method:t};if(0===e.length)throw new Error("Arguments list of query is wrong.");if(1===e.length)return"string"==typeof e[0]?(i.url=e[0],i.async=!0):(i.url=e[0].url,i.async=e[0].async||!0,i.callback=e[0].callback,i.headers=e[0].headers),e[0].data?"string"!=typeof e[0].data?i.data=mt(e[0].data):i.data=e[0].data:i.data="",i;switch(i.url=e[0],t){case"GET":case"DELETE":i.callback=e[1],i.headers=e[2];break;case"POST":case"PUT":e[1]?"string"!=typeof e[1]?i.data=mt(e[1]):i.data=e[1]:i.data="",i.callback=e[2],i.headers=e[3]}return i}const kt={date_to_str:(t,e,i)=>{t=t.replace(/%[a-zA-Z]/g,(t=>{switch(t){case"%d":return`"+to_fixed(date.get${e?"UTC":""}Date())+"`;case"%m":return`"+to_fixed((date.get${e?"UTC":""}Month()+1))+"`;case"%j":return`"+date.get${e?"UTC":""}Date()+"`;case"%n":return`"+(date.get${e?"UTC":""}Month()+1)+"`;case"%y":return`"+to_fixed(date.get${e?"UTC":""}FullYear()%100)+"`;case"%Y":return`"+date.get${e?"UTC":""}FullYear()+"`;case"%D":return`"+locale.date.day_short[date.get${e?"UTC":""}Day()]+"`;case"%l":return`"+locale.date.day_full[date.get${e?"UTC":""}Day()]+"`;case"%M":return`"+locale.date.month_short[date.get${e?"UTC":""}Month()]+"`;case"%F":return`"+locale.date.month_full[date.get${e?"UTC":""}Month()]+"`;case"%h":return`"+to_fixed((date.get${e?"UTC":""}Hours()+11)%12+1)+"`;case"%g":return`"+((date.get${e?"UTC":""}Hours()+11)%12+1)+"`;case"%G":return`"+date.get${e?"UTC":""}Hours()+"`;case"%H":return`"+to_fixed(date.get${e?"UTC":""}Hours())+"`;case"%i":return`"+to_fixed(date.get${e?"UTC":""}Minutes())+"`;case"%a":return`"+(date.get${e?"UTC":""}Hours()>11?"pm":"am")+"`;case"%A":return`"+(date.get${e?"UTC":""}Hours()>11?"PM":"AM")+"`;case"%s":return`"+to_fixed(date.get${e?"UTC":""}Seconds())+"`;case"%W":return'"+to_fixed(getISOWeek(date))+"';case"%w":return'"+to_fixed(getWeek(date))+"';default:return t}}));const n=new Function("date","to_fixed","locale","getISOWeek","getWeek",`return "${t}";`);return t=>n(t,i.date.to_fixed,i.locale,i.date.getISOWeek,i.date.getWeek)},str_to_date:(t,e,i)=>{let n="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);";const a=t.match(/%[a-zA-Z]/g);for(let t=0;t<a.length;t++)switch(a[t]){case"%j":case"%d":n+=`set[2]=temp[${t}]||1;`;break;case"%n":case"%m":n+=`set[1]=(temp[${t}]||1)-1;`;break;case"%y":n+=`set[0]=temp[${t}]*1+(temp[${t}]>50?1900:2000);`;break;case"%g":case"%G":case"%h":case"%H":n+=`set[3]=temp[${t}]||0;`;break;case"%i":n+=`set[4]=temp[${t}]||0;`;break;case"%Y":n+=`set[0]=temp[${t}]||0;`;break;case"%a":case"%A":n+=`set[3]=set[3]%12+((temp[${t}]||'').toLowerCase()=='am'?0:12);`;break;case"%s":n+=`set[5]=temp[${t}]||0;`;break;case"%M":n+=`set[1]=locale.date.month_short_hash[temp[${t}]]||0;`;break;case"%F":n+=`set[1]=locale.date.month_full_hash[temp[${t}]]||0;`}let r="set[0],set[1],set[2],set[3],set[4],set[5]";e&&(r=` Date.UTC(${r})`);const s=new Function("date","locale",`var set=[0,0,1,0,0,0]; ${n} return new Date(${r});`);return t=>s(t,i.locale)}},yt={date_to_str:(t,e,i)=>n=>t.replace(/%[a-zA-Z]/g,(t=>{switch(t){case"%d":return e?i.date.to_fixed(n.getUTCDate()):i.date.to_fixed(n.getDate());case"%m":return e?i.date.to_fixed(n.getUTCMonth()+1):i.date.to_fixed(n.getMonth()+1);case"%j":return e?n.getUTCDate():n.getDate();case"%n":return e?n.getUTCMonth()+1:n.getMonth()+1;case"%y":return e?i.date.to_fixed(n.getUTCFullYear()%100):i.date.to_fixed(n.getFullYear()%100);case"%Y":return e?n.getUTCFullYear():n.getFullYear();case"%D":return e?i.locale.date.day_short[n.getUTCDay()]:i.locale.date.day_short[n.getDay()];case"%l":return e?i.locale.date.day_full[n.getUTCDay()]:i.locale.date.day_full[n.getDay()];case"%M":return e?i.locale.date.month_short[n.getUTCMonth()]:i.locale.date.month_short[n.getMonth()];case"%F":return e?i.locale.date.month_full[n.getUTCMonth()]:i.locale.date.month_full[n.getMonth()];case"%h":return e?i.date.to_fixed((n.getUTCHours()+11)%12+1):i.date.to_fixed((n.getHours()+11)%12+1);case"%g":return e?(n.getUTCHours()+11)%12+1:(n.getHours()+11)%12+1;case"%G":return e?n.getUTCHours():n.getHours();case"%H":return e?i.date.to_fixed(n.getUTCHours()):i.date.to_fixed(n.getHours());case"%i":return e?i.date.to_fixed(n.getUTCMinutes()):i.date.to_fixed(n.getMinutes());case"%a":return e?n.getUTCHours()>11?"pm":"am":n.getHours()>11?"pm":"am";case"%A":return e?n.getUTCHours()>11?"PM":"AM":n.getHours()>11?"PM":"AM";case"%s":return e?i.date.to_fixed(n.getUTCSeconds()):i.date.to_fixed(n.getSeconds());case"%W":return e?i.date.to_fixed(i.date.getUTCISOWeek(n)):i.date.to_fixed(i.date.getISOWeek(n));default:return t}})),str_to_date:(t,e,i)=>n=>{const a=[0,0,1,0,0,0],r=n.match(/[a-zA-Z]+|[0-9]+/g),s=t.match(/%[a-zA-Z]/g);for(let t=0;t<s.length;t++)switch(s[t]){case"%j":case"%d":a[2]=r[t]||1;break;case"%n":case"%m":a[1]=(r[t]||1)-1;break;case"%y":a[0]=1*r[t]+(r[t]>50?1900:2e3);break;case"%g":case"%G":case"%h":case"%H":a[3]=r[t]||0;break;case"%i":a[4]=r[t]||0;break;case"%Y":a[0]=r[t]||0;break;case"%a":case"%A":a[3]=a[3]%12+("am"===(r[t]||"").toLowerCase()?0:12);break;case"%s":a[5]=r[t]||0;break;case"%M":a[1]=i.locale.date.month_short_hash[r[t]]||0;break;case"%F":a[1]=i.locale.date.month_full_hash[r[t]]||0}return e?new Date(Date.UTC(a[0],a[1],a[2],a[3],a[4],a[5])):new Date(a[0],a[1],a[2],a[3],a[4],a[5])}};class bt{constructor(t){const{url:e,token:i}=t;this._url=e,this._token=i,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:"application/json","Content-Type":"application/json","Remote-Token":this._token}}fetch(t,e){const i={credentials:"include",headers:this.headers()};return e&&(i.method="POST",i.body=e),fetch(t,i).then((t=>t.json()))}load(t){return t&&(this._url=t),this.fetch(this._url).then((t=>this.parse(t)))}parse(t){const{key:e,websocket:i}=t;e&&(this._token=t.key);for(const e in t.data)this.data[e]=t.data[e];for(const e in t.api){const i=this.api[e]={},n=t.api[e];for(const t in n)i[t]=this._wrapper(e+"."+t)}return i&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(t,e,i,n){let a=e;"/"===a[0]&&(a=document.location.protocol+"//"+document.location.host+e),a=a.replace(/^http(s|):/,"ws$1:");const r=-1!=a.indexOf("?")?"&":"?";a=`${a}${r}token=${i}&ws=1`;const s=new WebSocket(a);return s.onclose=()=>setTimeout((()=>t.connect()),2e3),s.onmessage=e=>{const i=JSON.parse(e.data);switch(i.action){case"result":t.result(i.body,[]);break;case"event":t.fire(i.body.name,i.body.value);break;case"start":n();break;default:t.onError(i.data)}},s}(this,this._url,this._token,(()=>(this._mode=3,this._send(),this._resubscribe(),this)))}_wrapper(t){return function(){const e=[].slice.call(arguments);let i=null;const n=new Promise(((n,a)=>{i={data:{id:this._uid(),name:t,args:e},status:1,resolve:n,reject:a},this._queue.push(i)}));return this.onCall(i,n),3===this._mode?this._send(i):setTimeout((()=>this._send()),1),n}.bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(2==this._mode)return void setTimeout((()=>this._send()),100);const e=t?[t]:this._queue.filter((t=>1===t.status));if(!e.length)return;const i=e.map((t=>(t.status=2,t.data)));3!==this._mode?this.fetch(this._url,JSON.stringify(i)).catch((t=>this.onError(t))).then((t=>this.result(t,i))):this._socket.send(JSON.stringify({action:"call",body:i}))}result(t,e){const i={};if(t)for(let e=0;e<t.length;e++)i[t[e].id]=t[e];else for(let t=0;t<e.length;t++)i[e[t].id]={id:e[t].id,error:"Network Error",data:null};for(let t=this._queue.length-1;t>=0;t--){const e=this._queue[t],n=i[e.data.id];n&&(this.onResponse(e,n),n.error?e.reject(n.error):e.resolve(n.data),this._queue.splice(t,1))}}on(t,e){const i=this._uid();let n=this._events[t];const a=!!n;return a||(n=this._events[t]=[]),n.push({id:i,handler:e}),a||3!=this._mode||this._socket.send(JSON.stringify({action:"subscribe",name:t})),{name:t,id:i}}_resubscribe(){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:"subscribe",name:t}))}detach(t){if(!t){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:"unsubscribe",key:t}));return void(this._events={})}const{id:e,name:i}=t,n=this._events[i];if(n){const t=n.filter((t=>t.id!=e));t.length?this._events[i]=t:(delete this._events[i],3==this._mode&&this._socket.send(JSON.stringify({action:"unsubscribe",name:i})))}}fire(t,e){const i=this._events[t];if(i)for(let t=0;t<i.length;t++)i[t].handler(e)}onError(t){return null}onCall(t,e){}onResponse(t,e){}}const xt=function(t,e){const i=new bt({url:t,token:e});i.fetch=function(t,e){const i={headers:this.headers()};return e&&(i.method="POST",i.body=e),fetch(t,i).then((t=>t.json()))},this._ready=i.load().then((t=>this._remote=t)),this.ready=function(){return this._ready},this.on=function(t,e){this.ready().then((i=>{if("string"==typeof t)i.on(t,e);else for(const e in t)i.on(e,t[e])}))}};function $t(t,e){if(!e)return!0;if(t._on_timeout)return!1;var i=Math.ceil(1e3/e);return i<2||(setTimeout((function(){delete t._on_timeout}),i),t._on_timeout=!0),!0}var wt=function(){var t={};return{getState:function(e){if(t[e])return t[e].method();var i={};for(var n in t)t[n].internal||Z(i,t[n].method(),!0);return i},registerProvider:function(e,i,n){t[e]={method:i,internal:n}},unregisterProvider:function(e){delete t[e]}}};const St=Promise;var Tt={$create:function(t){return Z(t||[],this)},$removeAt:function(t,e){t>=0&&this.splice(t,e||1)},$remove:function(t){this.$removeAt(this.$find(t))},$insertAt:function(t,e){if(e||0===e){var i=this.splice(e,this.length-e);this[e]=t,this.push.apply(this,i)}else this.push(t)},$find:function(t){for(var e=0;e<this.length;e++)if(t==this[e])return e;return-1},$each:function(t,e){for(var i=0;i<this.length;i++)t.call(e||this,this[i])},$map:function(t,e){for(var i=0;i<this.length;i++)this[i]=t.call(e||this,this[i]);return this},$filter:function(t,e){for(var i=0;i<this.length;i++)t.call(e||this,this[i])||(this.splice(i,1),i--);return this}};function Et(t,e,i,n){return!!((n=e?e.config:n)&&n.placeholder_task&&i.exists(t))&&i.getItem(t).type===n.types.placeholder}var Ct=function(t){return this.pull={},this.$initItem=t.initItem,this.visibleOrder=Tt.$create(),this.fullOrder=Tt.$create(),this._skip_refresh=!1,this._filterRule=null,this._searchVisibleOrder={},this._indexRangeCache={},this._getItemsCache=null,this.$config=t,M(this),this._attachDataChange((function(){return this._indexRangeCache={},this._getItemsCache=null,!0})),this};Ct.prototype={_attachDataChange:function(t){this.attachEvent("onClearAll",t),this.attachEvent("onBeforeParse",t),this.attachEvent("onBeforeUpdate",t),this.attachEvent("onBeforeDelete",t),this.attachEvent("onBeforeAdd",t),this.attachEvent("onParse",t),this.attachEvent("onBeforeFilter",t)},_parseInner:function(t){for(var e=null,i=[],n=0,a=t.length;n<a;n++)e=t[n],this.$initItem&&(this.$config.copyOnParse()&&(e=X(e)),e=this.$initItem(e)),this.callEvent("onItemLoading",[e])&&(this.pull.hasOwnProperty(e.id)||this.fullOrder.push(e.id),i.push(e),this.pull[e.id]=e);return i},parse:function(t){this.isSilent()||this.callEvent("onBeforeParse",[t]);var e=this._parseInner(t);this.isSilent()||(this.refresh(),this.callEvent("onParse",[e]))},getItem:function(t){return this.pull[t]},_updateOrder:function(t){t.call(this.visibleOrder),t.call(this.fullOrder)},updateItem:function(t,e){if(Q(e)||(e=this.getItem(t)),!this.isSilent()&&!1===this.callEvent("onBeforeUpdate",[e.id,e]))return!1;Z(this.pull[t],e,!0),this.isSilent()||(this.callEvent("onAfterUpdate",[e.id,e]),this.callEvent("onStoreUpdated",[e.id,e,"update"]))},_removeItemInner:function(t){this._updateOrder((function(){this.$remove(t)})),delete this.pull[t]},removeItem:function(t){var e=this.getItem(t);if(!this.isSilent()&&!1===this.callEvent("onBeforeDelete",[e.id,e]))return!1;this.callEvent("onAfterDeleteConfirmed",[e.id,e]),this._removeItemInner(t),this.isSilent()&&this.callEvent("onAfterSilentDelete",[e.id,e]),this.isSilent()||(this.filter(),this.callEvent("onAfterDelete",[e.id,e]),this.callEvent("onStoreUpdated",[e.id,e,"delete"]))},_addItemInner:function(t,e){if(this.exists(t.id))this.silent((function(){this.updateItem(t.id,t)}));else{var i=this.visibleOrder,n=i.length;(!Q(e)||e<0)&&(e=n),e>n&&(e=Math.min(i.length,e))}this.pull[t.id]=t,this._updateOrder((function(){-1===this.$find(t.id)&&this.$insertAt(t.id,e)})),this.filter()},isVisible:function(t){return this.visibleOrder.$find(t)>-1},getVisibleItems:function(){return this.getIndexRange()},addItem:function(t,e){return Q(t.id)||(t.id=tt()),this.$initItem&&(t=this.$initItem(t)),!(!this.isSilent()&&!1===this.callEvent("onBeforeAdd",[t.id,t]))&&(this._addItemInner(t,e),this.isSilent()||(this.callEvent("onAfterAdd",[t.id,t]),this.callEvent("onStoreUpdated",[t.id,t,"add"])),t.id)},_changeIdInner:function(t,e){this.pull[t]&&(this.pull[e]=this.pull[t]);var i=this._searchVisibleOrder[t];this.pull[e].id=e,this._updateOrder((function(){this[this.$find(t)]=e})),this._searchVisibleOrder[e]=i,delete this._searchVisibleOrder[t],delete this.pull[t]},changeId:function(t,e){this._changeIdInner(t,e),this.callEvent("onIdChange",[t,e])},exists:function(t){return!!this.pull[t]},_moveInner:function(t,e){var i=this.getIdByIndex(t);this._updateOrder((function(){this.$removeAt(t),this.$insertAt(i,Math.min(this.length,e))}))},move:function(t,e){var i=this.getIdByIndex(t),n=this.getItem(i);this._moveInner(t,e),this.isSilent()||this.callEvent("onStoreUpdated",[n.id,n,"move"])},clearAll:function(){this.$destroyed||(this.silent((function(){this.unselect()})),this.pull={},this.visibleOrder=Tt.$create(),this.fullOrder=Tt.$create(),this.isSilent()||(this.callEvent("onClearAll",[]),this.refresh()))},silent:function(t,e){var i=!1;this.isSilent()&&(i=!0),this._skip_refresh=!0,t.call(e||this),i||(this._skip_refresh=!1)},isSilent:function(){return!!this._skip_refresh},arraysEqual:function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},refresh:function(t,e){var i,n;if(!this.$destroyed&&!this.isSilent()&&(t&&(i=this.getItem(t)),n=t?[t,i,"paint"]:[null,null,null],!1!==this.callEvent("onBeforeStoreUpdate",n))){var a=this._quick_refresh&&!this._mark_recompute;if(this._mark_recompute=!1,t){if(!e&&!a){var r=this.visibleOrder;this.filter(),this.arraysEqual(r,this.visibleOrder)||(t=void 0)}}else a||this.filter();n=t?[t,i,"paint"]:[null,null,null],this.callEvent("onStoreUpdated",n)}},count:function(){return this.fullOrder.length},countVisible:function(){return this.visibleOrder.length},sort:function(t){},serialize:function(){},eachItem:function(t){for(var e=0;e<this.fullOrder.length;e++){var i=this.getItem(this.fullOrder[e]);t.call(this,i)}},find:function(t){var e=[];return this.eachItem((function(i){t(i)&&e.push(i)})),e},filter:function(t){this.isSilent()||this.callEvent("onBeforeFilter",[]),this.callEvent("onPreFilter",[]);var e=Tt.$create(),i=[];this.eachItem((function(t){this.callEvent("onFilterItem",[t.id,t])&&(Et(t.id,null,this,this._ganttConfig)?i.push(t.id):e.push(t.id))}));for(var n=0;n<i.length;n++)e.push(i[n]);for(this.visibleOrder=e,this._searchVisibleOrder={},n=0;n<this.visibleOrder.length;n++)this._searchVisibleOrder[this.visibleOrder[n]]=n;this.isSilent()||this.callEvent("onFilter",[])},getIndexRange:function(t,e){var i=Math.min(e||1/0,this.countVisible()-1),n=t||0,a=n+"-"+i;if(this._indexRangeCache[a])return this._indexRangeCache[a].slice();for(var r=[],s=n;s<=i;s++)r.push(this.getItem(this.visibleOrder[s]));return this._indexRangeCache[a]=r.slice(),r},getItems:function(){if(this._getItemsCache)return this._getItemsCache.slice();var t=[];for(var e in this.pull)t.push(this.pull[e]);return this._getItemsCache=t.slice(),t},getIdByIndex:function(t){return this.visibleOrder[t]},getIndexById:function(t){var e=this._searchVisibleOrder[t];return void 0===e&&(e=-1),e},_getNullIfUndefined:function(t){return void 0===t?null:t},getFirst:function(){return this._getNullIfUndefined(this.visibleOrder[0])},getLast:function(){return this._getNullIfUndefined(this.visibleOrder[this.visibleOrder.length-1])},getNext:function(t){return this._getNullIfUndefined(this.visibleOrder[this.getIndexById(t)+1])},getPrev:function(t){return this._getNullIfUndefined(this.visibleOrder[this.getIndexById(t)-1])},destructor:function(){this.callEvent("onDestroy",[]),this.detachAllEvents(),this.$destroyed=!0,this.pull=null,this.$initItem=null,this.visibleOrder=null,this.fullOrder=null,this._skip_refresh=null,this._filterRule=null,this._searchVisibleOrder=null,this._indexRangeCache={}}};var Dt=function(t){var e;Ct.apply(this,[t]),this._branches={},this.pull={},this.$initItem=function(e){var i=e;t.initItem&&(i=t.initItem(i));var n=this.getItem(e.id);return n&&!At(n.parent,i.parent)&&this.move(i.id,i.$index||-1,i.parent||this._ganttConfig.root_id),i},this.$parentProperty=t.parentProperty||"parent","function"!=typeof t.rootId?this.$getRootId=(e=t.rootId||0,function(){return e}):this.$getRootId=t.rootId,this.$openInitially=t.openInitially,this.visibleOrder=Tt.$create(),this.fullOrder=Tt.$create(),this._searchVisibleOrder={},this._indexRangeCache={},this._eachItemMainRangeCache=null,this._getItemsCache=null,this._skip_refresh=!1,this._ganttConfig=null,t.getConfig&&(this._ganttConfig=t.getConfig());var i={},n={},a={},r={},s=!1;return this._attachDataChange((function(){return this._indexRangeCache={},this._eachItemMainRangeCache=null,this._getItemsCache=null,!0})),this.attachEvent("onPreFilter",(function(){this._indexRangeCache={},this._eachItemMainRangeCache=null,i={},n={},a={},r={},s=!1,this.eachItem((function(t){var e=this.getParent(t.id);t.$open&&!1!==a[e]?a[t.id]=!0:a[t.id]=!1,this._isSplitItem(t)&&(s=!0,i[t.id]=!0,n[t.id]=!0),s&&n[e]&&(n[t.id]=!0),a[e]||void 0===a[e]?r[t.id]=!0:r[t.id]=!1}))})),this.attachEvent("onFilterItem",(function(t,e){var a=!1;this._ganttConfig&&(a=this._ganttConfig.open_split_tasks);var o=r[e.id];return s&&(o&&n[e.id]&&!i[e.id]&&(o=!!a),n[e.id]&&!i[e.id]&&(e.$split_subtask=!0)),e.$expanded_branch=!!r[e.id],!!o})),this.attachEvent("onFilter",(function(){i={},n={},a={},r={}})),this};function At(t,e){return String(t)===String(e)}function It(t){return pt.isNode||!t.$root}Dt.prototype=Z({_buildTree:function(t){for(var e=null,i=this.$getRootId(),n=0,a=t.length;n<a;n++)e=t[n],this.setParent(e,j(this.getParent(e),i)||i);for(n=0,a=t.length;n<a;n++)e=t[n],this._add_branch(e),e.$level=this.calculateItemLevel(e),e.$local_index=this.getBranchIndex(e.id),Q(e.$open)||(e.$open=Q(e.open)?e.open:this.$openInitially());this._updateOrder()},_isSplitItem:function(t){return"split"==t.render&&this.hasChild(t.id)},parse:function(t){this._skip_refresh||this.callEvent("onBeforeParse",[t]);var e=this._parseInner(t);this._buildTree(e),this.filter(),this._skip_refresh||this.callEvent("onParse",[e])},_addItemInner:function(t,e){var i=this.getParent(t);Q(i)||(i=this.$getRootId(),this.setParent(t,i));var n=this.getIndexById(i)+Math.min(Math.max(e,0),this.visibleOrder.length);1*n!==n&&(n=void 0),Ct.prototype._addItemInner.call(this,t,n),this.setParent(t,i),t.hasOwnProperty("$rendered_parent")&&this._move_branch(t,t.$rendered_parent),this._add_branch(t,e)},_changeIdInner:function(t,e){var i=this.getChildren(t),n=this._searchVisibleOrder[t];Ct.prototype._changeIdInner.call(this,t,e);var a=this.getParent(e);this._replace_branch_child(a,t,e),this._branches[t]&&(this._branches[e]=this._branches[t]);for(var r=0;r<i.length;r++){var s=this.getItem(i[r]);s[this.$parentProperty]=e,s.$rendered_parent=e}this._searchVisibleOrder[e]=n,delete this._branches[t]},_traverseBranches:function(t,e){Q(e)||(e=this.$getRootId());var i=this._branches[e];if(i)for(var n=0;n<i.length;n++){var a=i[n];t.call(this,a),this._branches[a]&&this._traverseBranches(t,a)}},_updateOrder:function(t){this.fullOrder=Tt.$create(),this._traverseBranches((function(t){this.fullOrder.push(t)})),t&&Ct.prototype._updateOrder.call(this,t)},_removeItemInner:function(t){var e=[];this.eachItem((function(t){e.push(t)}),t),e.push(this.getItem(t));for(var i=0;i<e.length;i++)this._move_branch(e[i],this.getParent(e[i]),null),Ct.prototype._removeItemInner.call(this,e[i].id),this._move_branch(e[i],this.getParent(e[i]),null)},move:function(t,e,i){var n=arguments[3],a=(this._ganttConfig||{}).root_id||0;if(n=j(n,a)){if(n===t)return;i=this.getParent(n),e=this.getBranchIndex(n)}if(!At(t,i)){Q(i)||(i=this.$getRootId());var r=this.getItem(t),s=this.getParent(r.id),o=this.getChildren(i);if(-1==e&&(e=o.length+1),At(s,i)&&this.getBranchIndex(t)==e)return;if(!1===this.callEvent("onBeforeItemMove",[t,i,e]))return!1;for(var l=[],d=0;d<o.length;d++)Et(o[d],null,this,this._ganttConfig)&&(l.push(o[d]),o.splice(d,1),d--);this._replace_branch_child(s,t);var c=(o=this.getChildren(i))[e];(c=j(c,a))?o=o.slice(0,e).concat([t]).concat(o.slice(e)):o.push(t),l.length&&(o=o.concat(l)),At(r.$rendered_parent,s)||At(s,i)||(r.$rendered_parent=s),this.setParent(r,i),this._branches[i]=o;var u=this.calculateItemLevel(r)-r.$level;r.$level+=u,this.eachItem((function(t){t.$level+=u}),r.id,this),this._moveInner(this.getIndexById(t),this.getIndexById(i)+e),this.callEvent("onAfterItemMove",[t,i,e]),this.refresh()}},getBranchIndex:function(t){var e=this.getChildren(this.getParent(t));let i=e.indexOf(t+"");return-1==i&&(i=e.indexOf(+t)),i},hasChild:function(t){var e=this._branches[t];return e&&e.length},getChildren:function(t){return this._branches[t]||Tt.$create()},isChildOf:function(t,e){if(!this.exists(t))return!1;if(e===this.$getRootId())return!0;if(!this.hasChild(e))return!1;var i=this.getItem(t),n=this.getParent(t);if(this.getItem(e).$level>=i.$level)return!1;for(;i&&this.exists(n);){if((i=this.getItem(n))&&At(i.id,e))return!0;n=this.getParent(i)}return!1},getSiblings:function(t){if(!this.exists(t))return Tt.$create();var e=this.getParent(t);return this.getChildren(e)},getNextSibling:function(t){for(var e=this.getSiblings(t),i=0,n=e.length;i<n;i++)if(At(e[i],t)){var a=e[i+1];return 0===a&&i>0&&(a="0"),a||null}return null},getPrevSibling:function(t){for(var e=this.getSiblings(t),i=0,n=e.length;i<n;i++)if(At(e[i],t)){var a=e[i-1];return 0===a&&i>0&&(a="0"),a||null}return null},getParent:function(t){var e;return(e=void 0!==t.id?t:this.getItem(t))?e[this.$parentProperty]:this.$getRootId()},clearAll:function(){this._branches={},Ct.prototype.clearAll.call(this)},calculateItemLevel:function(t){var e=0;return this.eachParent((function(){e++}),t),e},_setParentInner:function(t,e,i){i||(t.hasOwnProperty("$rendered_parent")?this._move_branch(t,t.$rendered_parent,e):this._move_branch(t,t[this.$parentProperty],e))},setParent:function(t,e,i){this._setParentInner(t,e,i),t[this.$parentProperty]=e},_eachItemCached:function(t,e){for(var i=0,n=e.length;i<n;i++)t.call(this,e[i])},_eachItemIterate:function(t,e,i){var n=this.getChildren(e);for(n.length&&(n=n.slice().reverse());n.length;){var a=n.pop(),r=this.getItem(a);if(t.call(this,r),i&&i.push(r),this.hasChild(r.id))for(var s=this.getChildren(r.id),o=s.length-1;o>=0;o--)n.push(s[o])}},eachItem:function(t,e){var i=this.$getRootId();Q(e)||(e=i);var n=j(e,i)||i,a=!1,r=!1,s=null;n===i&&(this._eachItemMainRangeCache?(a=!0,s=this._eachItemMainRangeCache):(r=!0,s=this._eachItemMainRangeCache=[])),a?this._eachItemCached(t,s):this._eachItemIterate(t,n,r?s:null)},eachParent:function(t,e){for(var i={},n=e,a=this.getParent(n);this.exists(a);){if(i[a])throw new Error("Invalid tasks tree. Cyclic reference has been detected on task "+a);i[a]=!0,n=this.getItem(a),t.call(this,n),a=this.getParent(n)}},_add_branch:function(t,e,i){var n=void 0===i?this.getParent(t):i;this.hasChild(n)||(this._branches[n]=Tt.$create());var a=this.getChildren(n);a.indexOf(t.id+"")>-1||a.indexOf(+t.id)>-1||(1*e==e?a.splice(e,0,t.id):a.push(t.id),t.$rendered_parent=n)},_move_branch:function(t,e,i){this._eachItemMainRangeCache=null,this._replace_branch_child(e,t.id),this.exists(i)||At(i,this.$getRootId())?this._add_branch(t,void 0,i):delete this._branches[t.id],t.$level=this.calculateItemLevel(t),this.eachItem((function(t){t.$level=this.calculateItemLevel(t)}),t.id)},_replace_branch_child:function(t,e,i){var n=this.getChildren(t);if(n&&void 0!==t){var a=Tt.$create();let r=n.indexOf(e+"");-1!=r||isNaN(+e)||(r=n.indexOf(+e)),r>-1&&(i?n.splice(r,1,i):n.splice(r,1)),a=n,this._branches[t]=a}},sort:function(t,e,i){this.exists(i)||(i=this.$getRootId()),t||(t="order");var n="string"==typeof t?function(e,i){return e[t]==i[t]||B(e[t])&&B(i[t])&&e[t].valueOf()==i[t].valueOf()?0:e[t]>i[t]?1:-1}:t;if(e){var a=n;n=function(t,e){return a(e,t)}}var r=this.getChildren(i);if(r){for(var s=[],o=r.length-1;o>=0;o--)s[o]=this.getItem(r[o]);for(s.sort(n),o=0;o<s.length;o++)r[o]=s[o].id,this.sort(t,e,r[o])}},filter:function(t){for(let t in this.pull){const e=this.pull[t].$rendered_parent,i=this.getParent(this.pull[t]);At(e,i)||this._move_branch(this.pull[t],e,i)}return Ct.prototype.filter.apply(this,arguments)},open:function(t){this.exists(t)&&(this.getItem(t).$open=!0,this._skipTaskRecalculation=!0,this.callEvent("onItemOpen",[t]))},close:function(t){this.exists(t)&&(this.getItem(t).$open=!1,this._skipTaskRecalculation=!0,this.callEvent("onItemClose",[t]))},destructor:function(){Ct.prototype.destructor.call(this),this._branches=null,this._indexRangeCache={},this._eachItemMainRangeCache=null}},Ct.prototype);const Mt=function(t,e){const i=e.getDatastore(t),n=function(t,e){const n=e.getLayers(),a=i.getItem(t);if(a&&i.isVisible(t))for(let t=0;t<n.length;t++)n[t].render_item(a)};function a(t){return!!t.$services.getService("state").getState("batchUpdate").batch_update}i.attachEvent("onStoreUpdated",(function(n,a,r){if(It(e))return!0;const s=e.$services.getService("layers").getDataRender(t);s&&(s.onUpdateRequest=function(t){!function(t){if(t.update_items){let n=[];if(t.get_visible_range){var e=t.get_visible_range(i);if(void 0!==e.start&&void 0!==e.end&&(n=i.getIndexRange(e.start,e.end)),void 0!==e.ids){let t=e.ids.map((function(t){return i.getItem(t)}));t.length>0&&(t=t.filter((t=>void 0!==t)),n=n.concat(t))}if((null==e.start||null==e.end)&&null==e.ids)throw new Error("Invalid range returned from 'getVisibleRange' of the layer")}else n=i.getVisibleItems();t.prepare_data&&t.prepare_data(n,t),t.update_items(n)}}(t)})})),i.attachEvent("onStoreUpdated",(function(t,n,r){a(e)||(t&&"move"!=r&&"delete"!=r?(i.callEvent("onBeforeRefreshItem",[n.id]),i.callEvent("onAfterRefreshItem",[n.id])):(i.callEvent("onBeforeRefreshAll",[]),i.callEvent("onAfterRefreshAll",[])))})),i.attachEvent("onAfterRefreshAll",(function(){if(It(e))return!0;const n=e.$services.getService("layers").getDataRender(t);n&&!a(e)&&function(t){const e=t.getLayers();for(let t=0;t<e.length;t++)e[t].clear();let n=null;const a={};for(let t=0;t<e.length;t++){const o=e[t];let l;if(o.get_visible_range){var r=o.get_visible_range(i);if(void 0!==r.start&&void 0!==r.end){var s=r.start+" - "+r.end;a[s]?l=a[s]:(l=i.getIndexRange(r.start,r.end),a[s]=l)}else{if(void 0===r.ids)throw new Error("Invalid range returned from 'getVisibleRange' of the layer");l=r.ids.map((function(t){return i.getItem(t)}))}}else n||(n=i.getVisibleItems()),l=n;o.prepare_data&&o.prepare_data(l),e[t].render_items(l)}}(n)})),i.attachEvent("onAfterRefreshItem",(function(i){if(It(e))return!0;const a=e.$services.getService("layers").getDataRender(t);a&&n(i,a)})),i.attachEvent("onItemOpen",(function(){if(It(e)||i.isSilent())return!0;e.render()})),i.attachEvent("onItemClose",(function(){if(It(e)||i.isSilent())return!0;e.render()})),i.attachEvent("onIdChange",(function(r,s){if(It(e))return!0;if(i.callEvent("onBeforeIdChange",[r,s]),!a(e)&&!i.isSilent()){const a=e.$services.getService("layers").getDataRender(t);a?(function(t,e,i){for(let n=0;n<t.length;n++)t[n].change_id(e,i)}(a.getLayers(),r,s,i.getItem(s)),n(s,a)):e.render()}}))};function Nt(){for(var t=this.$services.getService("datastores"),e=[],i=0;i<t.length;i++){var n=this.getDatastore(t[i]);n.$destroyed||e.push(n)}return e}const Lt=function(){var t=Z({},{createDatastore:function(t){var e="treedatastore"==(t.type||"").toLowerCase()?Dt:Ct;if(t){var i=this;t.openInitially=function(){return i.config.open_tree_initially},t.copyOnParse=function(){return i.config.deepcopy_on_parse}}var n=new e(t);if(this.mixin(n,function(t){var e=null,i=t._removeItemInner;function n(t){e=null,this.callEvent("onAfterUnselect",[t])}return t._removeItemInner=function(t){return e==t&&n.call(this,t),e&&this.eachItem&&this.eachItem((function(t){t.id==e&&n.call(this,t.id)}),t),i.apply(this,arguments)},t.attachEvent("onIdChange",(function(e,i){t.getSelectedId()==e&&t.silent((function(){t.unselect(e),t.select(i)}))})),{select:function(t){if(t){if(e==t)return e;if(!this._skip_refresh&&!this.callEvent("onBeforeSelect",[t]))return!1;this.unselect(),e=t,this._skip_refresh||(this.refresh(t),this.callEvent("onAfterSelect",[t]))}return e},getSelectedId:function(){return e},isSelected:function(t){return t==e},unselect:function(t){(t=t||e)&&(e=null,this._skip_refresh||(this.refresh(t),n.call(this,t)))}}}(n)),t.name){var a="datastore:"+t.name;n.attachEvent("onDestroy",function(){this.$services.dropService(a);for(var e=this.$services.getService("datastores"),i=0;i<e.length;i++)if(e[i]===t.name){e.splice(i,1);break}}.bind(this)),this.$services.dropService(a),this.$services.setService(a,(function(){return n}));var r=this.$services.getService("datastores");r?r.indexOf(t.name)<0&&r.push(t.name):(r=[],this.$services.setService("datastores",(function(){return r})),r.push(t.name)),Mt(t.name,this)}return n},getDatastore:function(t){return this.$services.getService("datastore:"+t)},_getDatastores:Nt,refreshData:function(){var t;It(this)||(t=this.getScrollState()),this.callEvent("onBeforeDataRender",[]);for(var e=Nt.call(this),i=0;i<e.length;i++)e[i].refresh();this.config.preserve_scroll&&!It(this)&&(t.x||t.y)&&this.scrollTo(t.x,t.y),this.callEvent("onDataRender",[])},isChildOf:function(t,e){return this.$data.tasksStore.isChildOf(t,e)},refreshTask:function(t,e){var i=this.getTask(t),n=this;function a(){if(void 0===e||e){for(var t=0;t<i.$source.length;t++)n.refreshLink(i.$source[t]);for(t=0;t<i.$target.length;t++)n.refreshLink(i.$target[t])}}if(i&&this.isTaskVisible(t))this.$data.tasksStore.refresh(t,!!this.getState("tasksDnd").drag_id||!1===e),a();else if(this.isTaskExists(t)&&this.isTaskExists(this.getParent(t))&&!this._bulk_dnd){this.refreshTask(this.getParent(t));var r=!1;this.eachParent((function(t){(r||this.isSplitTask(t))&&(r=!0)}),t),r&&a()}},refreshLink:function(t){this.$data.linksStore.refresh(t,!!this.getState("tasksDnd").drag_id)},silent:function(t){var e=this;e.$data.tasksStore.silent((function(){e.$data.linksStore.silent((function(){t()}))}))},clearAll:function(){for(var t=Nt.call(this),e=0;e<t.length;e++)t[e].silent((function(){t[e].clearAll()}));for(e=0;e<t.length;e++)t[e].clearAll();this._update_flags(),this.userdata={},this.callEvent("onClear",[]),this.render()},_clear_data:function(){this.$data.tasksStore.clearAll(),this.$data.linksStore.clearAll(),this._update_flags(),this.userdata={}},selectTask:function(t){var e=this.$data.tasksStore;if(!this.config.select_task)return!1;if(t=j(t,this.config.root_id)){let i=this.getSelectedId();e._skipResourceRepaint=!0,e.select(t),e._skipResourceRepaint=!1,i&&e.pull[i].$split_subtask&&i!=t&&this.refreshTask(i),e.pull[t].$split_subtask&&i!=t&&this.refreshTask(t)}return e.getSelectedId()},unselectTask:function(t){var e=this.$data.tasksStore;e.unselect(t),t&&e.pull[t].$split_subtask&&this.refreshTask(t)},isSelectedTask:function(t){return this.$data.tasksStore.isSelected(t)},getSelectedId:function(){return this.$data.tasksStore.getSelectedId()}});return Z(t,{getTask:function(t){t=j(t,this.config.root_id),this.assert(t,"Invalid argument for gantt.getTask");var e=this.$data.tasksStore.getItem(t);return this.assert(e,"Task not found id="+t),e},getTaskByTime:function(t,e){var i=this.$data.tasksStore.getItems(),n=[];if(t||e){t=+t||-1/0,e=+e||1/0;for(var a=0;a<i.length;a++){var r=i[a];+r.start_date<e&&+r.end_date>t&&n.push(r)}}else n=i;return n},isTaskExists:function(t){return!(!this.$data||!this.$data.tasksStore)&&this.$data.tasksStore.exists(t)},updateTask:function(t,e){Q(e)||(e=this.getTask(t)),this.$data.tasksStore.updateItem(t,e),this.isTaskExists(t)&&this.refreshTask(t)},addTask:function(t,e,i){if(Q(t.id)||(t.id=tt()),this.isTaskExists(t.id)&&this.getTask(t.id).$index!=t.$index)return t.start_date&&"string"==typeof t.start_date&&(t.start_date=this.date.parseDate(t.start_date,"parse_date")),t.end_date&&"string"==typeof t.end_date&&(t.end_date=this.date.parseDate(t.end_date,"parse_date")),this.$data.tasksStore.updateItem(t.id,t);if(Q(e)||(e=this.getParent(t)||0),this.isTaskExists(e)||(e=this.config.root_id),this.setParent(t,e),this.getState().lightbox&&this.isTaskExists(e)){var n=this.getTask(e);this.callEvent("onAfterParentExpand",[e,n])}return this.$data.tasksStore.addItem(t,i,e)},deleteTask:function(t){return t=j(t,this.config.root_id),this.$data.tasksStore.removeItem(t)},getTaskCount:function(){return this.$data.tasksStore.count()},getVisibleTaskCount:function(){return this.$data.tasksStore.countVisible()},getTaskIndex:function(t){return this.$data.tasksStore.getBranchIndex(t)},getGlobalTaskIndex:function(t){return t=j(t,this.config.root_id),this.assert(t,"Invalid argument"),this.$data.tasksStore.getIndexById(t)},eachTask:function(t,e,i){return this.$data.tasksStore.eachItem(et(t,i||this),e)},eachParent:function(t,e,i){return this.$data.tasksStore.eachParent(et(t,i||this),e)},changeTaskId:function(t,e){this.$data.tasksStore.changeId(t,e);var i=this.$data.tasksStore.getItem(e),n=[];i.$source&&(n=n.concat(i.$source)),i.$target&&(n=n.concat(i.$target));for(var a=0;a<n.length;a++){var r=this.getLink(n[a]);r.source==t&&(r.source=e),r.target==t&&(r.target=e)}},calculateTaskLevel:function(t){return this.$data.tasksStore.calculateItemLevel(t)},getNext:function(t){return this.$data.tasksStore.getNext(t)},getPrev:function(t){return this.$data.tasksStore.getPrev(t)},getParent:function(t){return this.$data.tasksStore.getParent(t)},setParent:function(t,e,i){return this.$data.tasksStore.setParent(t,e,i)},getSiblings:function(t){return this.$data.tasksStore.getSiblings(t).slice()},getNextSibling:function(t){return this.$data.tasksStore.getNextSibling(t)},getPrevSibling:function(t){return this.$data.tasksStore.getPrevSibling(t)},getTaskByIndex:function(t){var e=this.$data.tasksStore.getIdByIndex(t);return this.isTaskExists(e)?this.getTask(e):null},getChildren:function(t){return this.hasChild(t)?this.$data.tasksStore.getChildren(t).slice():[]},hasChild:function(t){return this.$data.tasksStore.hasChild(t)},open:function(t){this.$data.tasksStore.open(t)},close:function(t){this.$data.tasksStore.close(t)},moveTask:function(t,e,i){return i=j(i,this.config.root_id),this.$data.tasksStore.move.apply(this.$data.tasksStore,arguments)},sort:function(t,e,i,n){var a=!n;this.$data.tasksStore.sort(t,e,i),this.callEvent("onAfterSort",[t,e,i]),a&&this.render()}}),Z(t,{getLinkCount:function(){return this.$data.linksStore.count()},getLink:function(t){return this.$data.linksStore.getItem(t)},getLinks:function(){return this.$data.linksStore.getItems()},isLinkExists:function(t){return this.$data.linksStore.exists(t)},addLink:function(t){return this.$data.linksStore.addItem(t)},updateLink:function(t,e){Q(e)||(e=this.getLink(t)),this.$data.linksStore.updateItem(t,e)},deleteLink:function(t){return this.$data.linksStore.removeItem(t)},changeLinkId:function(t,e){return this.$data.linksStore.changeId(t,e)}}),t};function Pt(t){var e=t.date,i=t.$services;return{getSum:function(t,e,i){void 0===i&&(i=t.length-1),void 0===e&&(e=0);for(var n=0,a=e;a<=i;a++)n+=t[a];return n},setSumWidth:function(t,e,i,n){var a=e.width;void 0===n&&(n=a.length-1),void 0===i&&(i=0);var r=n-i+1;if(!(i>a.length-1||r<=0||n>a.length-1)){var s=t-this.getSum(a,i,n);this.adjustSize(s,a,i,n),this.adjustSize(-s,a,n+1),e.full_width=this.getSum(a)}},splitSize:function(t,e){for(var i=[],n=0;n<e;n++)i[n]=0;return this.adjustSize(t,i),i},adjustSize:function(t,e,i,n){i||(i=0),void 0===n&&(n=e.length-1);for(var a=n-i+1,r=this.getSum(e,i,n),s=i;s<=n;s++){var o=Math.floor(t*(r?e[s]/r:1/a));r-=e[s],t-=o,a--,e[s]+=o}e[e.length-1]+=t},sortScales:function(t){function i(t,i){var n=new Date(1970,0,1);return e.add(n,i,t)-n}t.sort((function(t,e){return i(t.unit,t.step)<i(e.unit,e.step)?1:i(t.unit,t.step)>i(e.unit,e.step)?-1:0}));for(var n=0;n<t.length;n++)t[n].index=n},_isLegacyMode:function(e){var i=e||t.config;return i.scale_unit||i.date_scale||i.subscales},_prepareScaleObject:function(e){var i=e.format;return i||(i=e.template||e.date||"%d %M"),"string"==typeof i&&(i=t.date.date_to_str(i)),{unit:e.unit||"day",step:e.step||1,format:i,css:e.css}},primaryScale:function(e){var n,a=i.getService("templateLoader"),r=this._isLegacyMode(e),s=e||t.config;if(r)a.initTemplate("date_scale",void 0,void 0,s,t.config.templates),n={unit:t.config.scale_unit,step:t.config.step,template:t.templates.date_scale,date:t.config.date_scale,css:t.templates.scale_cell_class};else{var o=s.scales[0];n={unit:o.unit,step:o.step,template:o.template,format:o.format,date:o.date,css:o.css||t.templates.scale_cell_class}}return this._prepareScaleObject(n)},getSubScales:function(e){var i,n=this._isLegacyMode(e),a=e||t.config;if(n){let e="https://docs.dhtmlx.com/gantt/migrating.html#:~:text=%3D%20false%3B-,Time%20scale%20settings,-Configuration%20of%20time";t.env.isFF&&(e="https://docs.dhtmlx.com/gantt/migrating.html#6162"),console.warn(`You are using the obsolete scale configuration.\nIt will stop working in the future versions.\nPlease migrate the configuration to the newer version:\n${e}`),i=a.subscales||[]}else i=a.scales.slice(1);return i.map(function(t){return this._prepareScaleObject(t)}.bind(this))},prepareConfigs:function(t,e,i,n,a,r,s){for(var o=this.splitSize(n,t.length),l=i,d=[],c=t.length-1;c>=0;c--){var u=c==t.length-1,h=this.initScaleConfig(t[c],a,r);u&&this.processIgnores(h),this.initColSizes(h,e,l,o[c]),this.limitVisibleRange(h),u&&(l=h.full_width),d.unshift(h)}for(c=0;c<d.length-1;c++)this.alineScaleColumns(d[d.length-1],d[c]);for(c=0;c<d.length;c++)s&&this.reverseScale(d[c]),this.setPosSettings(d[c]);return d},reverseScale:function(t){t.width=t.width.reverse(),t.trace_x=t.trace_x.reverse();var e=t.trace_indexes;t.trace_indexes={},t.trace_index_transition={},t.rtl=!0;for(var i=0;i<t.trace_x.length;i++)t.trace_indexes[t.trace_x[i].valueOf()]=i,t.trace_index_transition[e[t.trace_x[i].valueOf()]]=i;return t},setPosSettings:function(t){for(var e=0,i=t.trace_x.length;e<i;e++)t.left.push((t.width[e-1]||0)+(t.left[e-1]||0))},_ignore_time_config:function(i,n){if(t.config.skip_off_time){for(var a=!0,r=i,s=0;s<n.step;s++)s&&(r=e.add(i,s,n.unit)),a=a&&!this.isWorkTime(r,n.unit);return a}return!1},processIgnores:function(t){t.ignore_x={},t.display_count=t.count},initColSizes:function(t,i,n,a){var r=n;t.height=a;var s=void 0===t.display_count?t.count:t.display_count;s||(s=1),t.col_width=Math.floor(r/s),i&&t.col_width<i&&(t.col_width=i,r=t.col_width*s),t.width=[];for(var o=t.ignore_x||{},l=0;l<t.trace_x.length;l++)if(o[t.trace_x[l].valueOf()]||t.display_count==t.count)t.width[l]=0;else{var d=1;"month"==t.unit&&(d=Math.round((e.add(t.trace_x[l],t.step,t.unit)-t.trace_x[l])/864e5)),t.width[l]=d}this.adjustSize(r-this.getSum(t.width),t.width),t.full_width=this.getSum(t.width)},initScaleConfig:function(t,e,i){var n=Z({count:0,col_width:0,full_width:0,height:0,width:[],left:[],trace_x:[],trace_indexes:{},min_date:new Date(e),max_date:new Date(i)},t);return this.eachColumn(t.unit,t.step,e,i,(function(t){n.count++,n.trace_x.push(new Date(t)),n.trace_indexes[t.valueOf()]=n.trace_x.length-1})),n.trace_x_ascending=n.trace_x.slice(),n},iterateScales:function(t,e,i,n,a){for(var r=e.trace_x,s=t.trace_x,o=i||0,l=n||s.length-1,d=0,c=1;c<r.length;c++){var u=t.trace_indexes[+r[c]];void 0!==u&&u<=l&&(a&&a.apply(this,[d,c,o,u]),o=u,d=c)}},alineScaleColumns:function(t,e,i,n){this.iterateScales(t,e,i,n,(function(i,n,a,r){var s=this.getSum(t.width,a,r-1);this.getSum(e.width,i,n-1)!=s&&this.setSumWidth(s,e,i,n-1)}))},eachColumn:function(i,n,a,r,s){var o=new Date(a),l=new Date(r);e[i+"_start"]&&(o=e[i+"_start"](o));var d=new Date(o);for(+d>=+l&&(l=e.add(d,n,i));+d<+l;){s.call(this,new Date(d));var c=d.getTimezoneOffset();d=e.add(d,n,i),d=t._correct_dst_change(d,c,n,i),e[i+"_start"]&&(d=e[i+"_start"](d))}},limitVisibleRange:function(t){var i=t.trace_x,n=t.width.length-1,a=0;if(+i[0]<+t.min_date&&0!=n){var r=Math.floor(t.width[0]*((i[1]-t.min_date)/(i[1]-i[0])));a+=t.width[0]-r,t.width[0]=r,i[0]=new Date(t.min_date)}var s=i.length-1,o=i[s],l=e.add(o,t.step,t.unit);if(+l>+t.max_date&&s>0&&(r=t.width[s]-Math.floor(t.width[s]*((l-t.max_date)/(l-o))),a+=t.width[s]-r,t.width[s]=r),a){for(var d=this.getSum(t.width),c=0,u=0;u<t.width.length;u++){var h=Math.floor(a*(t.width[u]/d));t.width[u]+=h,c+=h}this.adjustSize(a-c,t.width)}}}}function Rt(t,e,i){e<t.start_date&&(t.start_date=new Date(e)),i>t.end_date&&(t.end_date=new Date(i))}function Ht(t){(function(t){var e=function(t){var e=new Pt(t).primaryScale(),i=e.unit,n=e.step;if(t.config.scale_offset_minimal){var a=new Pt(t),r=[a.primaryScale()].concat(a.getSubScales());a.sortScales(r),i=r[r.length-1].unit,n=r[r.length-1].step||1}return{unit:i,step:n}}(t),i=e.unit,n=e.step,a=function(t,e){var i={start_date:null,end_date:null};if(e.config.start_date&&e.config.end_date){i.start_date=e.date[t+"_start"](new Date(e.config.start_date));var n=new Date(e.config.end_date),a=e.date[t+"_start"](new Date(n));n=+n!=+a?e.date.add(a,1,t):a,i.end_date=n}return i}(i,t);if(!a.start_date||!a.end_date){for(var r=!0,s=t.getTaskByTime(),o=0;o<s.length;o++)if(s[o].type!==t.config.types.project){r=!1;break}if(s.length&&r){var l=s[0].start_date,d=t.date.add(l,1,t.config.duration_unit);a={start_date:new Date(l),end_date:new Date(d)}}else a=t.getSubtaskDates();a.start_date&&a.end_date||(a={start_date:new Date,end_date:new Date}),t.eachTask((function(e){t.config.deadlines&&e.deadline&&Rt(a,e.deadline,e.deadline),e.constraint_date&&e.constraint_type&&t.config.constraint_types&&e.constraint_type!==t.config.constraint_types.ASAP&&e.constraint_type!==t.config.constraint_types.ALAP&&Rt(a,e.constraint_date,e.constraint_date),t.config.baselines&&e.baselines&&e.baselines.forEach((function(t){Rt(a,t.start_date,t.end_date)}))})),a.start_date=t.date[i+"_start"](a.start_date),a.start_date=t.calculateEndDate({start_date:t.date[i+"_start"](a.start_date),duration:-1,unit:i,step:n}),a.end_date=t.date[i+"_start"](a.end_date),a.end_date=t.calculateEndDate({start_date:a.end_date,duration:2,unit:i,step:n})}t._min_date=a.start_date,t._max_date=a.end_date})(t),function(t){if(t.config.fit_tasks){var e=+t._min_date,i=+t._max_date;if(+t._min_date!=e||+t._max_date!=i)t.render(),t.callEvent("onScaleAdjusted",[])}}(t)}function Ot(t,e,i){for(var n=0;n<e.length;n++)t.isLinkExists(e[n])&&(i[e[n]]=t.getLink(e[n]))}function Bt(t,e,i){Ot(t,e.$source,i),Ot(t,e.$target,i)}const zt=function(t,e){var i={};return t.isTaskExists(e)&&Bt(t,t.getTask(e),i),t.eachTask((function(e){Bt(t,e,i)}),e),i},Wt=function(t,e){var i={};return t.eachTask((function(t){i[t.id]=t}),e),i};class jt{constructor(t,e){this.$gantt=t,this.$dp=e,this._dataProcessorHandlers=[]}attach(){const t=this.$dp,e=this.$gantt,i={},n=i=>this.clientSideDelete(i,t,e);this._dataProcessorHandlers.push(e.attachEvent("onAfterTaskAdd",(function(i,n){e.isTaskExists(i)&&(t.setGanttMode("tasks"),t.setUpdated(i,!0,"inserted"))}))),this._dataProcessorHandlers.push(e.attachEvent("onAfterTaskUpdate",(function(i,n){e.isTaskExists(i)&&(t.setGanttMode("tasks"),t.setUpdated(i,!0),e._sendTaskOrder&&e._sendTaskOrder(i,n))}))),this._dataProcessorHandlers.push(e.attachEvent("onBeforeTaskDelete",(function(n,a){return e.config.cascade_delete&&(i[n]={tasks:Wt(e,n),links:zt(e,n)}),!t.deleteAfterConfirmation||(t.setGanttMode("tasks"),t.setUpdated(n,!0,"deleted"),!1)}))),this._dataProcessorHandlers.push(e.attachEvent("onAfterTaskDelete",(function(a,r){t.setGanttMode("tasks");const s=!n(a),o=e.config.cascade_delete&&i[a];if(s||o){if(o){const e=t.updateMode;t.setUpdateMode("off");const r=i[a];for(const e in r.tasks)n(e)||(t.storeItem(r.tasks[e]),t.setUpdated(e,!0,"deleted"));t.setGanttMode("links");for(const e in r.links)n(e)||(t.storeItem(r.links[e]),t.setUpdated(e,!0,"deleted"));i[a]=null,"off"!==e&&t.sendAllData(),t.setGanttMode("tasks"),t.setUpdateMode(e)}s&&(t.storeItem(r),t.deleteAfterConfirmation||t.setUpdated(a,!0,"deleted")),"off"===t.updateMode||t._tSend||t.sendAllData()}}))),this._dataProcessorHandlers.push(e.attachEvent("onAfterLinkUpdate",(function(i,n){e.isLinkExists(i)&&(t.setGanttMode("links"),t.setUpdated(i,!0))}))),this._dataProcessorHandlers.push(e.attachEvent("onAfterLinkAdd",(function(i,n){e.isLinkExists(i)&&(t.setGanttMode("links"),t.setUpdated(i,!0,"inserted"))}))),this._dataProcessorHandlers.push(e.attachEvent("onAfterLinkDelete",(function(e,i){t.setGanttMode("links"),!n(e)&&(t.storeItem(i),t.setUpdated(e,!0,"deleted"))}))),this._dataProcessorHandlers.push(e.attachEvent("onRowDragEnd",(function(t,i){e._sendTaskOrder(t,e.getTask(t))})));let a=null,r=null;this._dataProcessorHandlers.push(e.attachEvent("onTaskIdChange",(function(i,n){if(!t._waitMode)return;const s=e.getChildren(n);if(s.length){a=a||{};for(let t=0;t<s.length;t++){const e=this.getTask(s[t]);a[e.id]=e}}const o=function(t){let e=[];return t.$source&&(e=e.concat(t.$source)),t.$target&&(e=e.concat(t.$target)),e}(this.getTask(n));if(o.length){r=r||{};for(let t=0;t<o.length;t++){const e=this.getLink(o[t]);r[e.id]=e}}}))),t.attachEvent("onAfterUpdateFinish",(function(){(a||r)&&(e.batchUpdate((function(){for(const t in a)e.updateTask(a[t].id);for(const t in r)e.updateLink(r[t].id);a=null,r=null})),a?e._dp.setGanttMode("tasks"):e._dp.setGanttMode("links"))})),t.attachEvent("onBeforeDataSending",(function(){if("CUSTOM"===this._tMode)return!0;let t=this._serverProcessor;if("REST-JSON"===this._tMode||"REST"===this._tMode){const e=this._ganttMode;t=t.substring(0,t.indexOf("?")>-1?t.indexOf("?"):t.length),this.serverProcessor=t+("/"===t.slice(-1)?"":"/")+e}else{const i=this._ganttMode+"s";this.serverProcessor=t+e.ajax.urlSeparator(t)+"gantt_mode="+i}return!0})),t.attachEvent("insertCallback",(function(t,i,n,a){const r=t.data||e.xml._xmlNodeToJSON(t.firstChild),s={add:e.addTask,isExist:e.isTaskExists};"links"===a&&(s.add=e.addLink,s.isExist=e.isLinkExists),s.isExist.call(e,i)||(r.id=i,s.add.call(e,r))})),t.attachEvent("updateCallback",(function(t,i){const n=t.data||e.xml._xmlNodeToJSON(t.firstChild);if(!e.isTaskExists(i))return;const a=e.getTask(i);for(const t in n){let i=n[t];switch(t){case"id":continue;case"start_date":case"end_date":i=e.defined(e.templates.xml_date)?e.templates.xml_date(i):e.templates.parse_date(i);break;case"duration":a.end_date=e.calculateEndDate({start_date:a.start_date,duration:i,task:a})}a[t]=i}e.updateTask(i),e.refreshData()})),t.attachEvent("deleteCallback",(function(t,i,n,a){const r={delete:e.deleteTask,isExist:e.isTaskExists};"links"===a?(r.delete=e.deleteLink,r.isExist=e.isLinkExists):"assignment"===a&&(r.delete=function(t){e.$data.assignmentsStore.remove(t)},r.isExist=function(t){return e.$data.assignmentsStore.exists(t)}),r.isExist.call(e,i)&&r.delete.call(e,i)})),this.handleResourceCRUD(t,e),this.handleResourceAssignmentCRUD(t,e),this.handleBaselineCRUD(t,e)}clientSideDelete(t,e,i){const n=e.updatedRows.slice();let a=!1;"true_deleted"===i.getUserData(t,"!nativeeditor_status",e._ganttMode)&&(a=!0,e.setUpdated(t,!1));for(let r=0;r<n.length&&!e._in_progress[t];r++)n[r]===t&&("inserted"===i.getUserData(t,"!nativeeditor_status",e._ganttMode)&&(a=!0),e.setUpdated(t,!1));return a}handleResourceAssignmentCRUD(t,e){if(!e.config.resources||!0!==e.config.resources.dataprocessor_assignments)return;const i=e.getDatastore(e.config.resource_assignment_store),n={},a={};function r(e){const n=e.id;i.exists(n)&&(t.setGanttMode("assignment"),t.setUpdated(n,!0,"inserted")),delete a[n]}e.attachEvent("onBeforeTaskAdd",(function(t,e){return n[t]=!0,!0})),e.attachEvent("onTaskIdChange",(function(t,e){delete n[t]})),i.attachEvent("onAfterAdd",((t,e)=>{var i;n[e.task_id]?(a[(i=e).id]=i,n[i.task_id]=!0):r(e)})),i.attachEvent("onAfterUpdate",((e,n)=>{i.exists(e)&&(a[e]?r(n):(t.setGanttMode("assignment"),t.setUpdated(e,!0)))})),i.attachEvent("onAfterDelete",((i,n)=>{t.setGanttMode("assignment"),!this.clientSideDelete(i,t,e)&&(t.storeItem(n),t.setUpdated(i,!0,"deleted"))}))}handleResourceCRUD(t,e){if(!e.config.resources||!0!==e.config.resources.dataprocessor_resources)return;const i=e.getDatastore(e.config.resource_store);i.attachEvent("onAfterAdd",((e,n)=>{!function(e){const n=e.id;i.exists(n)&&(t.setGanttMode("resource"),t.setUpdated(n,!0,"inserted"))}(n)})),i.attachEvent("onAfterUpdate",((e,n)=>{i.exists(e)&&(t.setGanttMode("resource"),t.setUpdated(e,!0))})),i.attachEvent("onAfterDelete",((i,n)=>{t.setGanttMode("resource"),!this.clientSideDelete(i,t,e)&&(t.storeItem(n),t.setUpdated(i,!0,"deleted"))}))}handleBaselineCRUD(t,e){if(!e.config.baselines||!0!==e.config.baselines.dataprocessor_baselines)return;const i=e.getDatastore(e.config.baselines.datastore);i.attachEvent("onAfterAdd",((e,n)=>{!function(e){const n=e.id;i.exists(n)&&(t.setGanttMode("baseline"),t.setUpdated(n,!0,"inserted"))}(n)})),i.attachEvent("onAfterUpdate",((e,n)=>{i.exists(e)&&(t.setGanttMode("baseline"),t.setUpdated(e,!0))})),i.attachEvent("onAfterDelete",((i,n)=>{t.setGanttMode("baseline"),!this.clientSideDelete(i,t,e)&&(t.storeItem(n),t.setUpdated(i,!0,"deleted"))}))}detach(){P(this._dataProcessorHandlers,(t=>{this.$gantt.detachEvent(t)})),this._dataProcessorHandlers=[]}}const Ft=class{constructor(){this.clear=()=>{this._storage={}},this.storeItem=t=>{this._storage[t.id]=X(t)},this.getStoredItem=t=>this._storage[t]||null,this._storage={}}};Ft.create=()=>new Ft;let Vt=Ft,Ut=class{constructor(t){this.serverProcessor=t,this.action_param="!nativeeditor_status",this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._headers=null,this._payload=null,this._postDelim="_",this._routerParametersFormat="parameters",this._waitMode=0,this._in_progress={},this._storage=Vt.create(),this._invalid={},this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),M(this)}setTransactionMode(t,e){"object"==typeof t?(this._tMode=t.mode||this._tMode,Q(t.headers)&&(this._headers=t.headers),Q(t.payload)&&(this._payload=t.payload),this._tSend=!!e):(this._tMode=t,this._tSend=e),"REST"===this._tMode&&(this._tSend=!1),"JSON"===this._tMode||"REST-JSON"===this._tMode?(this._tSend=!1,this._serializeAsJson=!0,this._headers=this._headers||{},this._headers["Content-Type"]="application/json"):this._headers&&!this._headers["Content-Type"]&&(this._headers["Content-Type"]="application/x-www-form-urlencoded"),"CUSTOM"===this._tMode&&(this._tSend=!1,this._router=t.router)}escape(t){return this._utf?encodeURIComponent(t):escape(t)}enableUTFencoding(t){this._utf=!!t}getSyncState(){return!this.updatedRows.length}setUpdateMode(t,e){this.autoUpdate="cell"===t,this.updateMode=t,this.dnd=e}ignore(t,e){this._silent_mode=!0,t.call(e||D),this._silent_mode=!1}setUpdated(t,e,i){if(this._silent_mode)return;const n=this.findRow(t);i=i||"updated";const a=this.$gantt.getUserData(t,this.action_param,this._ganttMode);a&&"updated"===i&&(i=a),e?(this.set_invalid(t,!1),this.updatedRows[n]=t,this.$gantt.setUserData(t,this.action_param,i,this._ganttMode),this._in_progress[t]&&(this._in_progress[t]="wait")):this.is_invalid(t)||(this.updatedRows.splice(n,1),this.$gantt.setUserData(t,this.action_param,"",this._ganttMode)),this.markRow(t,e,i),e&&this.autoUpdate&&this.sendData(t)}markRow(t,e,i){let n="";const a=this.is_invalid(t);if(a&&(n=this.styles[a],e=!0),this.callEvent("onRowMark",[t,e,i,a])&&(n=this.styles[e?i:"clear"]+" "+n,this.$gantt[this._methods[0]](t,n),a&&a.details)){n+=this.styles[a+"_cell"];for(let e=0;e<a.details.length;e++)a.details[e]&&this.$gantt[this._methods[1]](t,e,n)}}getActionByState(t){return"inserted"===t?"create":"updated"===t?"update":"deleted"===t?"delete":"update"}getState(t){return this.$gantt.getUserData(t,this.action_param,this._ganttMode)}is_invalid(t){return this._invalid[t]}set_invalid(t,e,i){i&&(e={value:e,details:i,toString:function(){return this.value.toString()}}),this._invalid[t]=e}checkBeforeUpdate(t){return!0}sendData(t){if(this.$gantt.editStop&&this.$gantt.editStop(),void 0===t||this._tSend){const t=[];if(this.modes&&["task","link","assignment","baseline"].forEach((e=>{this.modes[e]&&this.modes[e].updatedRows.length&&t.push(e)})),t.length){for(let e=0;e<t.length;e++)this.setGanttMode(t[e]),this.sendAllData();return}return this.sendAllData()}return!this._in_progress[t]&&(this.messages=[],!(!this.checkBeforeUpdate(t)&&this.callEvent("onValidationError",[t,this.messages]))&&void this._beforeSendData(this._getRowData(t),t))}serialize(t,e){if(this._serializeAsJson)return this._serializeAsJSON(t);if("string"==typeof t)return t;if(void 0!==e)return this.serialize_one(t,"");{const e=[],i=[];for(const n in t)t.hasOwnProperty(n)&&(e.push(this.serialize_one(t[n],n+this._postDelim)),i.push(n));return e.push("ids="+this.escape(i.join(","))),this.$gantt.security_key&&e.push("dhx_security="+this.$gantt.security_key),e.join("&")}}serialize_one(t,e){if("string"==typeof t)return t;const i=[];let n="";for(const a in t)if(t.hasOwnProperty(a)){if(("id"===a||a==this.action_param)&&"REST"===this._tMode)continue;n="string"==typeof t[a]||"number"==typeof t[a]?String(t[a]):JSON.stringify(t[a]),i.push(this.escape((e||"")+a)+"="+this.escape(n))}return i.join("&")}sendAllData(){if(!this.updatedRows.length)return;this.messages=[];let t=!0;if(this._forEachUpdatedRow((function(e){t=t&&this.checkBeforeUpdate(e)})),!t&&!this.callEvent("onValidationError",["",this.messages]))return!1;this._tSend?this._sendData(this._getAllData()):this._forEachUpdatedRow((function(t){if(!this._in_progress[t]){if(this.is_invalid(t))return;this._beforeSendData(this._getRowData(t),t)}}))}findRow(t){let e=0;for(e=0;e<this.updatedRows.length&&t!=this.updatedRows[e];e++);return e}defineAction(t,e){this._uActions||(this._uActions={}),this._uActions[t]=e}afterUpdateCallback(t,e,i,n,a){if(!this.$gantt)return;this.setGanttMode(a);const r=t,s="error"!==i&&"invalid"!==i;if(s||this.set_invalid(t,i),this._uActions&&this._uActions[i]&&!this._uActions[i](n))return delete this._in_progress[r];"wait"!==this._in_progress[r]&&this.setUpdated(t,!1);const o=t;switch(i){case"inserted":case"insert":e!=t&&(this.setUpdated(t,!1),this.$gantt[this._methods[2]](t,e),t=e);break;case"delete":case"deleted":if(this.deleteAfterConfirmation&&"task"===this._ganttMode){if("task"===this._ganttMode&&this.$gantt.isTaskExists(t)){this.$gantt.setUserData(t,this.action_param,"true_deleted",this._ganttMode);const e=this.$gantt.getTask(t);this.$gantt.silent((()=>{this.$gantt.deleteTask(t)})),this.$gantt.callEvent("onAfterTaskDelete",[t,e]),this.$gantt.render(),delete this._in_progress[r]}return this.callEvent("onAfterUpdate",[t,i,e,n])}return this.$gantt.setUserData(t,this.action_param,"true_deleted",this._ganttMode),this.$gantt[this._methods[3]](t),delete this._in_progress[r],this.callEvent("onAfterUpdate",[t,i,e,n])}"wait"!==this._in_progress[r]?(s&&this.$gantt.setUserData(t,this.action_param,"",this._ganttMode),delete this._in_progress[r]):(delete this._in_progress[r],this.setUpdated(e,!0,this.$gantt.getUserData(t,this.action_param,this._ganttMode))),this.callEvent("onAfterUpdate",[o,i,e,n])}afterUpdate(t,e,i){let n;n=3===arguments.length?arguments[1]:arguments[4];let a=this.getGanttMode();const r=n.filePath||n.url;a="REST"!==this._tMode&&"REST-JSON"!==this._tMode?-1!==r.indexOf("gantt_mode=links")?"link":-1!==r.indexOf("gantt_mode=assignments")?"assignment":-1!==r.indexOf("gantt_mode=baselines")?"baseline":"task":r.indexOf("/link")>=0?"link":r.indexOf("/assignment")>=0?"assignment":r.indexOf("/baseline")>=0?"baseline":"task",this.setGanttMode(a);const s=this.$gantt.ajax;let o;try{o=JSON.parse(e.xmlDoc.responseText)}catch{e.xmlDoc.responseText.length||(o={})}const l=e=>{const i=o.action||this.getState(e)||"updated",n=o.sid||e[0],r=o.tid||e[0];t.afterUpdateCallback(n,r,i,o,a)};if(o)return Array.isArray(i)&&i.length>1?i.forEach((t=>l(t))):l(i),t.finalizeUpdate(),void this.setGanttMode(a);const d=s.xmltop("data",e.xmlDoc);if(!d)return this.cleanUpdate(i);const c=s.xpath("//data/action",d);if(!c.length)return this.cleanUpdate(i);for(let e=0;e<c.length;e++){const i=c[e],n=i.getAttribute("type"),r=i.getAttribute("sid"),s=i.getAttribute("tid");t.afterUpdateCallback(r,s,n,i,a)}t.finalizeUpdate()}cleanUpdate(t){if(t)for(let e=0;e<t.length;e++)delete this._in_progress[t[e]]}finalizeUpdate(){this._waitMode&&this._waitMode--,this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])}init(t){if(this._initialized)return;var e,i;this.$gantt=t,this.$gantt._dp_init&&this.$gantt._dp_init(this),this._setDefaultTransactionMode(),this.styles={updated:"gantt_updated",order:"gantt_updated",inserted:"gantt_inserted",deleted:"gantt_deleted",delete_confirmation:"gantt_deleted",invalid:"gantt_invalid",error:"gantt_error",clear:""},this._methods=["_row_style","setCellTextStyle","_change_id","_delete_task"],e=this.$gantt,i=this,e.getUserData=function(t,e,i){return this.userdata||(this.userdata={}),this.userdata[i]=this.userdata[i]||{},this.userdata[i][t]&&this.userdata[i][t][e]?this.userdata[i][t][e]:""},e.setUserData=function(t,e,i,n){this.userdata||(this.userdata={}),this.userdata[n]=this.userdata[n]||{},this.userdata[n][t]=this.userdata[n][t]||{},this.userdata[n][t][e]=i},e._change_id=function(t,e){switch(this._dp._ganttMode){case"task":this.changeTaskId(t,e);break;case"link":this.changeLinkId(t,e);break;case"assignment":this.$data.assignmentsStore.changeId(t,e);break;case"resource":this.$data.resourcesStore.changeId(t,e);break;case"baseline":this.$data.baselineStore.changeId(t,e);break;default:throw new Error(`Invalid mode of the dataProcessor after database id is received: ${this._dp._ganttMode}, new id: ${e}`)}},e._row_style=function(t,i){"task"===this._dp._ganttMode&&e.isTaskExists(t)&&(e.getTask(t).$dataprocessor_class=i,e.refreshTask(t))},e._delete_task=function(t,e){},e._sendTaskOrder=function(t,e){e.$drop_target&&(this._dp.setGanttMode("task"),this.getTask(t).target=e.$drop_target,this._dp.setUpdated(t,!0,"order"),delete this.getTask(t).$drop_target)},e.setDp=function(){this._dp=i},e.setDp();const n=new jt(this.$gantt,this);n.attach(),this.attachEvent("onDestroy",(function(){delete this.setGanttMode,delete this._getRowData,delete this.$gantt._dp,delete this.$gantt._change_id,delete this.$gantt._row_style,delete this.$gantt._delete_task,delete this.$gantt._sendTaskOrder,delete this.$gantt,n.detach()})),this.$gantt.callEvent("onDataProcessorReady",[this]),this._initialized=!0}setOnAfterUpdate(t){this.attachEvent("onAfterUpdate",t)}setOnBeforeUpdateHandler(t){this.attachEvent("onBeforeDataSending",t)}setAutoUpdate(t,e){t=t||2e3,this._user=e||(new Date).valueOf(),this._needUpdate=!1,this._updateBusy=!1,this.attachEvent("onAfterUpdate",this.afterAutoUpdate),this.attachEvent("onFullSync",this.fullSync),setInterval((()=>{this.loadUpdate()}),t)}afterAutoUpdate(t,e,i,n){return"collision"!==e||(this._needUpdate=!0,!1)}fullSync(){return this._needUpdate&&(this._needUpdate=!1,this.loadUpdate()),!0}getUpdates(t,e){const i=this.$gantt.ajax;if(this._updateBusy)return!1;this._updateBusy=!0,i.get(t,e)}loadUpdate(){const t=this.$gantt.ajax,e=this.$gantt.getUserData(0,"version",this._ganttMode);let i=this.serverProcessor+t.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+e].join("&");i=i.replace("editing=true&",""),this.getUpdates(i,(e=>{const i=t.xpath("//userdata",e);this.$gantt.setUserData(0,"version",this._getXmlNodeValue(i[0]),this._ganttMode);const n=t.xpath("//update",e);if(n.length){this._silent_mode=!0;for(let t=0;t<n.length;t++){const e=n[t].getAttribute("status"),i=n[t].getAttribute("id"),a=n[t].getAttribute("parent");switch(e){case"inserted":this.callEvent("insertCallback",[n[t],i,a]);break;case"updated":this.callEvent("updateCallback",[n[t],i,a]);break;case"deleted":this.callEvent("deleteCallback",[n[t],i,a])}}this._silent_mode=!1}this._updateBusy=!1}))}destructor(){this.callEvent("onDestroy",[]),this.detachAllEvents(),this.updatedRows=[],this._in_progress={},this._invalid={},this._storage.clear(),this._storage=null,this._headers=null,this._payload=null,delete this._initialized}setGanttMode(t){"tasks"===t?t="task":"links"===t&&(t="link");const e=this.modes||{},i=this.getGanttMode();i&&(e[i]={_in_progress:this._in_progress,_invalid:this._invalid,_storage:this._storage,updatedRows:this.updatedRows});let n=e[t];n||(n=e[t]={_in_progress:{},_invalid:{},_storage:Vt.create(),updatedRows:[]}),this._in_progress=n._in_progress,this._invalid=n._invalid,this._storage=n._storage,this.updatedRows=n.updatedRows,this.modes=e,this._ganttMode=t}getGanttMode(){return this._ganttMode}storeItem(t){this._storage.storeItem(t)}url(t){this.serverProcessor=this._serverProcessor=t}_beforeSendData(t,e){if(!this.callEvent("onBeforeUpdate",[e,this.getState(e),t]))return!1;this._sendData(t,e)}_serializeAsJSON(t){if("string"==typeof t)return t;const e=X(t);return"REST-JSON"===this._tMode&&(delete e.id,delete e[this.action_param]),JSON.stringify(e)}_applyPayload(t){const e=this.$gantt.ajax;if(this._payload)for(const i in this._payload)t=t+e.urlSeparator(t)+this.escape(i)+"="+this.escape(this._payload[i]);return t}_cleanupArgumentsBeforeSend(t){let e;if(void 0===t[this.action_param]){e={};for(const i in t)e[i]=this._cleanupArgumentsBeforeSend(t[i])}else e=this._cleanupItemBeforeSend(t);return e}_cleanupItemBeforeSend(t){let e=null;return t&&("deleted"===t[this.action_param]?(e={},e.id=t.id,e[this.action_param]=t[this.action_param]):e=t),e}_sendData(t,e){if(!t)return;if(!this.callEvent("onBeforeDataSending",e?[e,this.getState(e),t]:[null,null,t]))return!1;e&&(this._in_progress[e]=(new Date).valueOf());const i=this.$gantt.ajax;if("CUSTOM"===this._tMode){const i=this.getState(e),n=this.getActionByState(i);delete t[this.action_param];const a=this.getGanttMode(),r=t=>{let n=i||"updated",r=e,s=e;t&&(n=t.action||i,r=t.sid||r,s=t.id||t.tid||s),this.afterUpdateCallback(r,s,n,t,a)};let s;if(this._router instanceof Function)if("object"===this._routerParametersFormat){const i={entity:a,action:n,data:t,id:e};s=this._router(i)}else s=this._router(a,n,t,e);else if(this._router[a]instanceof Function)s=this._router[a](n,t,e);else{const n="Incorrect configuration of gantt.createDataProcessor",r="\nYou need to either add missing properties to the dataProcessor router object or to use a router function.\nSee https://docs.dhtmlx.com/gantt/desktop__server_side.html#customrouting and https://docs.dhtmlx.com/gantt/api__gantt_createdataprocessor.html for details.";if(!this._router[a])throw new Error(`${n}: router for the **${a}** entity is not defined. ${r}`);switch(i){case"inserted":if(!this._router[a].create)throw new Error(`${n}: **create** action for the **${a}** entity is not defined. ${r}`);s=this._router[a].create(t);break;case"deleted":if(!this._router[a].delete)throw new Error(`${n}: **delete** action for the **${a}** entity is not defined. ${r}`);s=this._router[a].delete(e);break;default:if(!this._router[a].update)throw new Error(`${n}: **update**" action for the **${a}** entity is not defined. ${r}`);s=this._router[a].update(t,e)}}if(s){if(!s.then&&void 0===s.id&&void 0===s.tid&&void 0===s.action)throw new Error("Incorrect router return value. A Promise or a response object is expected");s.then?s.then(r).catch((t=>{t&&t.action?r(t):r({action:"error",value:t})})):r(s)}else r(null);return}let n;n={callback:i=>{const n=[];if(e)n.push(e);else if(t)for(const e in t)n.push(e);return this.afterUpdate(this,i,n)},headers:this._headers};const a="dhx_version="+this.$gantt.getUserData(0,"version",this._ganttMode),r=this.serverProcessor+(this._user?i.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,a].join("&"):"");let s,o=this._applyPayload(r);switch(this._tMode){case"GET":s=this._cleanupArgumentsBeforeSend(t),n.url=o+i.urlSeparator(o)+this.serialize(s,e),n.method="GET";break;case"POST":s=this._cleanupArgumentsBeforeSend(t),n.url=o,n.method="POST",n.data=this.serialize(s,e);break;case"JSON":s={};const a=this._cleanupItemBeforeSend(t);for(const t in a)t!==this.action_param&&"id"!==t&&"gr_id"!==t&&(s[t]=a[t]);n.url=o,n.method="POST",n.data=JSON.stringify({id:e,action:t[this.action_param],data:s});break;case"REST":case"REST-JSON":switch(o=r.replace(/(&|\?)editing=true/,""),s="",this.getState(e)){case"inserted":n.method="POST",n.data=this.serialize(t,e);break;case"deleted":n.method="DELETE",o=o+("/"===o.slice(-1)?"":"/")+e;break;default:n.method="PUT",n.data=this.serialize(t,e),o=o+("/"===o.slice(-1)?"":"/")+e}n.url=this._applyPayload(o)}return this._waitMode++,i.query(n)}_forEachUpdatedRow(t){const e=this.updatedRows.slice();for(let i=0;i<e.length;i++){const n=e[i];this.$gantt.getUserData(n,this.action_param,this._ganttMode)&&t.call(this,n)}}_setDefaultTransactionMode(){this.serverProcessor&&(this.setTransactionMode("POST",!0),this.serverProcessor+=(-1!==this.serverProcessor.indexOf("?")?"&":"?")+"editing=true",this._serverProcessor=this.serverProcessor)}_getXmlNodeValue(t){return t.firstChild?t.firstChild.nodeValue:""}_getAllData(){const t={};let e=!1;return this._forEachUpdatedRow((function(i){if(this._in_progress[i]||this.is_invalid(i))return;const n=this._getRowData(i);this.callEvent("onBeforeUpdate",[i,this.getState(i),n])&&(t[i]=n,e=!0,this._in_progress[i]=(new Date).valueOf())})),e?t:null}_prepareDate(t){return this.$gantt.defined(this.$gantt.templates.xml_format)?this.$gantt.templates.xml_format(t):this.$gantt.templates.format_date(t)}_prepareArray(t,e){return e.push(t),t.map((t=>B(t)?this._prepareDate(t):Array.isArray(t)&&!H(e,t)?this._prepareArray(t,e):t&&"object"==typeof t&&!H(e,t)?this._prepareObject(t,e):t))}_prepareObject(t,e){const i={};e.push(t);for(const n in t){if("$"===n.substr(0,1))continue;const a=t[n];B(a)?i[n]=this._prepareDate(a):null===a?i[n]="":Array.isArray(a)&&!H(e,a)?i[n]=this._prepareArray(a,e):a&&"object"==typeof a&&!H(e,a)?i[n]=this._prepareObject(a,e):i[n]=a}return i}_prepareDataItem(t){const e=this._prepareObject(t,[]);return e[this.action_param]=this.$gantt.getUserData(t.id,this.action_param,this._ganttMode),e}getStoredItem(t){return this._storage.getStoredItem(t)}_getRowData(t){let e;const i=this.$gantt;return"task"===this.getGanttMode()?i.isTaskExists(t)&&(e=this.$gantt.getTask(t)):"assignment"===this.getGanttMode()?this.$gantt.$data.assignmentsStore.exists(t)&&(e=this.$gantt.$data.assignmentsStore.getItem(t)):"baseline"===this.getGanttMode()?this.$gantt.$data.baselineStore.exists(t)&&(e=this.$gantt.$data.baselineStore.getItem(t)):i.isLinkExists(t)&&(e=this.$gantt.getLink(t)),e||(e=this.getStoredItem(t)),e||(e={id:t}),this._prepareDataItem(e)}};const qt=function(t){return new Ut(t)},Gt=function(t){let e,i,n;t instanceof Function?e=t:t.hasOwnProperty("router")?e=t.router:t.hasOwnProperty("assignment")||t.hasOwnProperty("baseline")||t.hasOwnProperty("link")||t.hasOwnProperty("task")?e=t:t.hasOwnProperty("headers")&&(n=t.headers),i=e?"CUSTOM":t.mode||"REST-JSON";const a=new Ut(t.url);return a.init(this),a.setTransactionMode({mode:i,router:e,headers:n},t.batchUpdate),t.deleteAfterConfirmation&&(a.deleteAfterConfirmation=t.deleteAfterConfirmation),a};function Yt(t){var e={},i=!1;function n(t,i){i="function"==typeof i?i:function(){},e[t]||(e[t]=this[t],this[t]=i)}function a(t){e[t]&&(this[t]=e[t],e[t]=null)}function r(t){for(var e in t)n.call(this,e,t[e])}function s(){for(var t in e)a.call(this,t)}function o(t){try{t()}catch(t){D.console.error(t)}}return t.$services.getService("state").registerProvider("batchUpdate",(function(){return{batch_update:i}}),!1),function(t,e){if(i)o(t);else{var n,a=this._dp&&"off"!=this._dp.updateMode;a&&(n=this._dp.updateMode,this._dp.setUpdateMode("off"));var l={},d={render:!0,refreshData:!0,refreshTask:!0,refreshLink:!0,resetProjectDates:function(t){l[t.id]=t}};for(var c in r.call(this,d),i=!0,this.callEvent("onBeforeBatchUpdate",[]),o(t),this.callEvent("onAfterBatchUpdate",[]),s.call(this),l)this.resetProjectDates(l[c]);i=!1,e||this.render(),a&&(this._dp.setUpdateMode(n),this._dp.setGanttMode("task"),this._dp.sendData(),this._dp.setGanttMode("link"),this._dp.sendData())}}}function Jt(t){t.batchUpdate=Yt(t)}function Kt(t){const e=(i=t,{_needRecalc:!0,reset:function(){this._needRecalc=!0},_isRecalcNeeded:function(){return!this._isGroupSort()&&this._needRecalc},_isGroupSort:function(){return!!i.getState().group_mode},_getWBSCode:function(t){return t?(this._isRecalcNeeded()&&this._calcWBS(),t.$virtual?"":this._isGroupSort()?t.$wbs||"":(t.$wbs||(this.reset(),this._calcWBS()),t.$wbs)):""},_setWBSCode:function(t,e){t.$wbs=e},getWBSCode:function(t){return this._getWBSCode(t)},getByWBSCode:function(t){let e=t.split("."),n=i.config.root_id;for(let t=0;t<e.length;t++){const a=i.getChildren(n);let r=1*e[t]-1;if(!i.isTaskExists(a[r]))return null;n=a[r]}return i.isTaskExists(n)?i.getTask(n):null},_calcWBS:function(){if(!this._isRecalcNeeded())return;let t=!0;i.eachTask((function(e){if(e.type==i.config.types.placeholder)return;if(t)return t=!1,void this._setWBSCode(e,"1");const n=this._getPrevNonPlaceholderSibling(e.id);if(null!==n)this._increaseWBS(e,n);else{let t=i.getParent(e.id);this._setWBSCode(e,i.getTask(t).$wbs+".1")}}),i.config.root_id,this),this._needRecalc=!1},_increaseWBS:function(t,e){let n=i.getTask(e).$wbs;n&&(n=n.split("."),n[n.length-1]++,this._setWBSCode(t,n.join(".")))},_getPrevNonPlaceholderSibling:function(t){let e,n=t;do{e=i.getPrevSibling(n),n=e}while(null!==e&&i.getTask(e).type==i.config.types.placeholder);return e}});var i;function n(){return e.reset(),!0}t.getWBSCode=function(t){return e.getWBSCode(t)},t.getTaskByWBSCode=function(t){return e.getByWBSCode(t)},t.attachEvent("onAfterTaskMove",n),t.attachEvent("onBeforeParse",n),t.attachEvent("onAfterTaskDelete",n),t.attachEvent("onAfterTaskAdd",n),t.attachEvent("onAfterSort",n)}function Xt(t){var e=function(t){var e={},i=!1;t.$data.tasksStore.attachEvent("onStoreUpdated",(function(){e={},i=!1})),t.attachEvent("onBeforeGanttRender",(function(){e={}}));var n=String(Math.random());function a(t){return null===t?n+String(t):String(t)}function r(t,e,i){return Array.isArray(t)?t.map((function(t){return a(t)})).join("_")+`_${e}_${i}`:a(t)+`_${e}_${i}`}function s(n,s,o){var l,d=r(s,n,JSON.stringify(o)),c={};return P(s,(function(t){c[a(t)]=!0})),e[d]?l=e[d]:(l=e[d]=[],t.eachTask((function(s){if(o){if(!o[t.getTaskType(s)])return}else if(s.type==t.config.types.project)return;n in s&&P(O(s[n])?s[n]:[s[n]],(function(t){var o=t&&t.resource_id?t.resource_id:t;if(c[a(o)])l.push(s);else if(!i){var d=r(t,n);e[d]||(e[d]=[]),e[d].push(s)}}))})),i=!0),l}function o(e,i,n){var a=t.config.resource_property,r=[];if(t.getDatastore("task").exists(i)){var s=t.getTask(i);r=s[a]||[]}Array.isArray(r)||(r=[r]);for(var o=0;o<r.length;o++)r[o].resource_id==e&&n.push({task_id:s.id,resource_id:r[o].resource_id,value:r[o].value})}return{getTaskBy:function(e,i,n){return"function"==typeof e?(a=e,r=[],t.eachTask((function(t){a(t)&&r.push(t)})),r):O(i)?s(e,i,n):s(e,[i],n);var a,r},getResourceAssignments:function(e,i){var n=[],a=t.config.resource_property;return void 0!==i?o(e,i,n):t.getTaskBy(a,e).forEach((function(t){o(e,t.id,n)})),n}}}(t);t.ext.resources=function(t){const e={renderEditableLabel:function(e,i,n,a,r){const s=t.config.readonly?"":"contenteditable";if(e<n.end_date&&i>n.start_date){for(let a=0;a<r.length;a++){const o=r[a];return"<div "+s+" data-assignment-cell data-assignment-id='"+o.id+"' data-row-id='"+n.id+"' data-task='"+n.$task_id+"' data-start-date='"+t.templates.format_date(e)+"' data-end-date='"+t.templates.format_date(i)+"'>"+o.value+"</div>"}return"<div "+s+" data-assignment-cell data-empty  data-row-id='"+n.id+"' data-resource-id='"+n.$resource_id+"' data-task='"+n.$task_id+"' data-start-date='"+t.templates.format_date(e)+"''  data-end-date='"+t.templates.format_date(i)+"'>-</div>"}return""},renderSummaryLabel:function(t,e,i,n,a){let r=a.reduce((function(t,e){return t+Number(e.value)}),0);return r%1&&(r=Math.round(10*r)/10),r?"<div>"+r+"</div>":""},editableResourceCellTemplate:function(t,i,n,a,r){return"task"===n.$role?e.renderEditableLabel(t,i,n,a,r):e.renderSummaryLabel(t,i,n,a,r)},editableResourceCellClass:function(t,e,i,n,a){const r=[];r.push("resource_marker"),"task"===i.$role?r.push("task_cell"):r.push("resource_cell");const s=a.reduce((function(t,e){return t+Number(e.value)}),0);let o=Number(i.capacity);return isNaN(o)&&(o=8),s<=o?r.push("workday_ok"):r.push("workday_over"),r.join(" ")},getSummaryResourceAssignments:function(e){let i;const n=t.getDatastore(t.config.resource_store),a=n.getItem(e);return"task"===a.$role?i=t.getResourceAssignments(a.$resource_id,a.$task_id):(i=t.getResourceAssignments(e),n.eachItem&&n.eachItem((function(e){"task"!==e.$role&&(i=i.concat(t.getResourceAssignments(e.id)))}),e)),i},initEditableDiagram:function(){t.config.resource_render_empty_cells=!0,function(){let e=null;function i(){return e&&cancelAnimationFrame(e),e=requestAnimationFrame((function(){t.$container&&Array.prototype.slice.call(t.$container.querySelectorAll(".resourceTimeline_cell [data-assignment-cell]")).forEach((function(t){t.contentEditable=!0}))})),!0}t.attachEvent("onGanttReady",(function(){t.getDatastore(t.config.resource_assignment_store).attachEvent("onStoreUpdated",i),t.getDatastore(t.config.resource_store).attachEvent("onStoreUpdated",i)}),{once:!0}),t.attachEvent("onGanttLayoutReady",(function(){t.$layout.getCellsByType("viewCell").forEach((function(t){t.$config&&"resourceTimeline"===t.$config.view&&t.$content&&t.$content.attachEvent("onScroll",i)}))}))}();let e=null;function i(){setTimeout((function(){const i=s(t.$container);e>-1&&i[e+1].focus()}),300)}t.attachEvent("onGanttReady",(function(){let n=!1;t.event(t.$container,"keypress",(function(t){var e=t.target.closest(".resourceTimeline_cell [data-assignment-cell]");e&&(13!==t.keyCode&&27!==t.keyCode||e.blur())})),t.event(t.$container,"keydown",(function(i){"Tab"===i.key&&(e=s(t.$container).indexOf(document.activeElement))})),t.event(t.$container,"focusout",(function(e){if(!n){n=!0,setTimeout((function(){n=!1}),300);var a=e.target.closest(".resourceTimeline_cell [data-assignment-cell]");if(a){var r=(a.innerText||"").trim();"-"==r&&(r="0");var s=Number(r),o=a.getAttribute("data-row-id"),l=a.getAttribute("data-assignment-id"),d=a.getAttribute("data-task"),c=a.getAttribute("data-resource-id"),u=t.templates.parse_date(a.getAttribute("data-start-date")),h=t.templates.parse_date(a.getAttribute("data-end-date")),_=t.getDatastore(t.config.resource_assignment_store);if(isNaN(s))t.getDatastore(t.config.resource_store).refresh(o);else{var g=t.getTask(d);if(t.plugins().undo&&t.ext.undo.saveState(d,"task"),l){if(s===(p=_.getItem(l)).value)return;if(p.start_date.valueOf()===u.valueOf()&&p.end_date.valueOf()===h.valueOf())p.value=s,s?_.updateItem(p.id):_.removeItem(p.id);else{if(p.end_date.valueOf()>h.valueOf()){var f=t.copy(p);f.id=t.uid(),f.start_date=h,f.duration=t.calculateDuration({start_date:f.start_date,end_date:f.end_date,task:g}),f.delay=t.calculateDuration({start_date:g.start_date,end_date:f.start_date,task:g}),f.mode=p.mode||"default",0!==f.duration&&_.addItem(f)}p.start_date.valueOf()<u.valueOf()?(p.end_date=u,p.duration=t.calculateDuration({start_date:p.start_date,end_date:p.end_date,task:g}),p.mode="fixedDuration",0===p.duration?_.removeItem(p.id):_.updateItem(p.id)):_.removeItem(p.id),s&&_.addItem({task_id:p.task_id,resource_id:p.resource_id,value:s,start_date:u,end_date:h,duration:t.calculateDuration({start_date:u,end_date:h,task:g}),delay:t.calculateDuration({start_date:g.start_date,end_date:u,task:g}),mode:"fixedDuration"})}t.updateTaskAssignments(g.id),t.updateTask(g.id),i()}else if(s){var p={task_id:d,resource_id:c,value:s,start_date:u,end_date:h,duration:t.calculateDuration({start_date:u,end_date:h,task:g}),delay:t.calculateDuration({start_date:g.start_date,end_date:u,task:g}),mode:"fixedDuration"};_.addItem(p),t.updateTaskAssignments(g.id),t.updateTask(g.id),i()}}}}}))}),{once:!0})}};return e}(t),t.config.resources={dataprocessor_assignments:!1,dataprocessor_resources:!1,editable_resource_diagram:!1,resource_store:{type:"treeDataStore",fetchTasks:!1,initItem:function(e){return e.parent=e.parent||t.config.root_id,e[t.config.resource_property]=e.parent,e.open=!0,e}},lightbox_resources:function(e){const i=[],n=t.getDatastore(t.config.resource_store);return e.forEach((function(e){if(!n.hasChild(e.id)){const n=t.copy(e);n.key=e.id,n.label=e.text,i.push(n)}})),i}},t.attachEvent("onBeforeGanttReady",(function(){if(t.getDatastore(t.config.resource_store))return;const e=t.config.resources?t.config.resources.resource_store:void 0;let i=e?e.fetchTasks:void 0;t.config.resources&&t.config.resources.editable_resource_diagram&&(i=!0);let n=function(e){return e.parent=e.parent||t.config.root_id,e[t.config.resource_property]=e.parent,e.open=!0,e};e&&e.initItem&&(n=e.initItem);const a=e&&e.type?e.type:"treeDatastore";t.$resourcesStore=t.createDatastore({name:t.config.resource_store,type:a,fetchTasks:void 0!==i&&i,initItem:n}),t.$data.resourcesStore=t.$resourcesStore,t.$resourcesStore.attachEvent("onParse",(function(){let e,i=function(e){const i=[];return e.forEach((function(e){const n=t.copy(e);n.key=e.id,n.label=e.text,i.push(n)})),i};t.config.resources&&t.config.resources.lightbox_resources&&(i=t.config.resources.lightbox_resources),e=t.config.resources&&t.config.resources.editable_resource_diagram?i(t.$resourcesStore.getItems().filter((e=>{let i=t.getResourceAssignments(e.id);if(!t.$resourcesStore.hasChild(e.id)||i&&i.length)return!e.$resource_id||!e.$task_id}))):i(t.$resourcesStore.getItems()),t.updateCollection("resourceOptions",e)}))})),t.getTaskBy=e.getTaskBy,t.getResourceAssignments=e.getResourceAssignments,t.config.resource_property="owner_id",t.config.resource_store="resource",t.config.resource_render_empty_cells=!1,t.templates.histogram_cell_class=function(t,e,i,n,a){},t.templates.histogram_cell_label=function(t,e,i,n,a){return n.length+"/3"},t.templates.histogram_cell_allocated=function(t,e,i,n,a){return n.length/3},t.templates.histogram_cell_capacity=function(t,e,i,n,a){return 0};const i=function(t,e,i,n,a){return n.length<=1?"gantt_resource_marker_ok":"gantt_resource_marker_overtime"},n=function(t,e,i,n,a){return 8*n.length};t.templates.resource_cell_value=n,t.templates.resource_cell_class=i,t.attachEvent("onBeforeGanttReady",(function(){t.config.resources&&t.config.resources.editable_resource_diagram&&(t.config.resource_render_empty_cells=!0,t.templates.resource_cell_value===n&&(t.templates.resource_cell_value=t.ext.resources.editableResourceCellTemplate),t.templates.resource_cell_class===i&&(t.templates.resource_cell_class=t.ext.resources.editableResourceCellClass),t.ext.resources.initEditableDiagram(t))}))}function Zt(t){var e="$resourceAssignments";t.config.resource_assignment_store="resourceAssignments",t.config.process_resource_assignments=!0;var i="auto",n="singleValue",a="valueArray",r="resourceValueArray",s="assignmentsArray",o=i,l="fixedDates",d="fixedDuration",c="default";function u(e,i){e.start_date?e.start_date=t.date.parseDate(e.start_date,"parse_date"):e.start_date=null,e.end_date?e.end_date=t.date.parseDate(e.end_date,"parse_date"):e.end_date=null;var n=Number(e.delay),a=!1;if(isNaN(n)?(e.delay=0,a=!0):e.delay=n,t.defined(e.value)||(e.value=null),!e.task_id||!e.resource_id)return!1;if(e.mode=e.mode||c,e.mode===d&&(isNaN(Number(e.duration))&&(i=i||t.getTask(e.task_id),e.duration=t.calculateDuration({start_date:e.start_date,end_date:e.end_date,id:i})),a&&(i=i||t.getTask(e.task_id),e.delay=t.calculateDuration({start_date:i.start_date,end_date:e.start_date,id:i}))),e.mode!==l&&(i||t.isTaskExists(e.task_id))){var r=_(e,i=i||t.getTask(e.task_id));e.start_date=r.start_date,e.end_date=r.end_date,e.duration=r.duration}}var h=t.createDatastore({name:t.config.resource_assignment_store,initItem:function(e){return e.id||(e.id=t.uid()),u(e),e}});function _(e,i){if(e.mode===l)return{start_date:e.start_date,end_date:e.end_date,duration:e.duration};var n,a,r=e.delay?t.calculateEndDate({start_date:i.start_date,duration:e.delay,task:i}):new Date(i.start_date);return e.mode===d?(n=t.calculateEndDate({start_date:r,duration:e.duration,task:i}),a=e.duration):(n=new Date(i.end_date),a=i.duration-e.delay),{start_date:r,end_date:n,duration:a}}function g(e){const l=t.config.resource_property;let h=e[l];const _=[];let g=o===i;if(t.defined(h)&&h){Array.isArray(h)||(h=[h],g&&(o=n,g=!1));const i={};h.forEach((function(n){n.resource_id||(n={resource_id:n},g&&(o=a,g=!1)),g&&(n.id&&n.resource_id?(o=s,g=!1):(o=r,g=!1));let l,h=c;n.mode||(n.start_date&&n.end_date||n.start_date&&n.duration)&&(h=d),l=n.id||!n.$id||i[n.$id]?n.id&&!i[n.id]?n.id:t.uid():n.$id,i[l]=!0;const f={id:l,start_date:n.start_date,duration:n.duration,end_date:n.end_date,delay:n.delay,task_id:e.id,resource_id:n.resource_id,value:n.value,mode:n.mode||h};Object.keys(n).forEach((t=>{"$id"!=t&&(f[t]=n[t])})),f.start_date&&f.start_date.getMonth&&f.end_date&&f.end_date.getMonth&&"number"==typeof f.duration||u(f,e),_.push(f)}))}return _}function f(e){if(t.isTaskExists(e)){var i=t.getTask(e);p(i,t.getTaskAssignments(i.id))}}function p(i,n){n.sort((function(t,e){return t.start_date&&e.start_date&&t.start_date.valueOf()!=e.start_date.valueOf()?t.start_date-e.start_date:0})),o==s?i[t.config.resource_property]=n:o==r&&(i[t.config.resource_property]=n.map((function(t){return{$id:t.id,start_date:t.start_date,duration:t.duration,end_date:t.end_date,delay:t.delay,resource_id:t.resource_id,value:t.value,mode:t.mode}}))),i[e]=n}function m(e){var i=g(e);return i.forEach((function(e){e.id=e.id||t.uid()})),i}function v(t,e){var i=function(t,e){var i={inBoth:[],inTaskNotInStore:[],inStoreNotInTask:[]};if(o==n){var l=t[0],d=l?l.resource_id:null,c=!1;e.forEach((function(t){t.resource_id!=d?i.inStoreNotInTask.push(t):t.resource_id==d&&(i.inBoth.push({store:t,task:l}),c=!0)})),!c&&l&&i.inTaskNotInStore.push(l)}else if(o==a){var u={},h={},_={};t.forEach((function(t){u[t.resource_id]=t})),e.forEach((function(t){h[t.resource_id]=t})),t.concat(e).forEach((function(t){if(!_[t.resource_id]){_[t.resource_id]=!0;var e=u[t.resource_id],n=h[t.resource_id];e&&n?i.inBoth.push({store:n,task:e}):e&&!n?i.inTaskNotInStore.push(e):!e&&n&&i.inStoreNotInTask.push(n)}}))}else o!=s&&o!=r||(u={},h={},_={},t.forEach((function(t){u[t.id||t.$id]=t})),e.forEach((function(t){h[t.id]=t})),t.concat(e).forEach((function(t){var e=t.id||t.$id;if(!_[e]){_[e]=!0;var n=u[e],a=h[e];n&&a?i.inBoth.push({store:a,task:n}):n&&!a?i.inTaskNotInStore.push(n):!n&&a&&i.inStoreNotInTask.push(a)}})));return i}(g(t),e);i.inStoreNotInTask.forEach((function(t){h.removeItem(t.id)})),i.inTaskNotInStore.forEach((function(t){h.addItem(t)})),i.inBoth.forEach((function(e){if(function(t,e){var i={id:!0};for(var n in t)if(!i[n]&&String(t[n])!==String(e[n]))return!0;return!1}(e.task,e.store))(function(t,e){var i={id:!0};for(var n in t)i[n]||(e[n]=t[n])})(e.task,e.store),h.updateItem(e.store.id);else if(e.task.start_date&&e.task.end_date&&e.task.mode!==l){var i=_(e.store,t);e.store.start_date.valueOf()==i.start_date.valueOf()&&e.store.end_date.valueOf()==i.end_date.valueOf()||(e.store.start_date=i.start_date,e.store.end_date=i.end_date,e.store.duration=i.duration,h.updateItem(e.store.id))}})),f(t.id)}function k(t){var i=t[e]||h.find((function(e){return e.task_id==t.id}));v(t,i)}t.$data.assignmentsStore=h,t.attachEvent("onGanttReady",(function(){if(t.config.process_resource_assignments){t.attachEvent("onParse",(function(){t.silent((function(){h.clearAll();var e=[];t.eachTask((function(i){if(i.type!==t.config.types.project){var n=m(i);p(i,n),n.forEach((function(t){e.push(t)}))}})),h.parse(e)}))}));var e=!1,i=!1,n={},a=!1;t.attachEvent("onBeforeBatchUpdate",(function(){e=!0})),t.attachEvent("onAfterBatchUpdate",(function(){if(i){var a={};for(var r in n)a[r]=t.getTaskAssignments(n[r].id);for(var r in t.config.process_resource_assignments&&"resourceValueArray"===o&&(l=null),n)v(n[r],a[r])}i=!1,e=!1,n={}})),t.attachEvent("onTaskCreated",(function(t){var e=m(t);return h.parse(e),p(t,e),!0})),t.attachEvent("onAfterTaskUpdate",(function(t,a){e?(i=!0,n[t]=a):a.unscheduled||k(a)})),t.attachEvent("onAfterTaskAdd",(function(t,a){e?(i=!0,n[t]=a):k(a)})),t.attachEvent("onRowDragEnd",(function(e){k(t.getTask(e))})),t.$data.tasksStore.attachEvent("onAfterDeleteConfirmed",(function(e,i){var n,a=[e];t.eachTask((function(t){a.push(t.id)}),e),n={},a.forEach((function(t){n[t]=!0})),h.find((function(t){return n[t.task_id]})).forEach((function(t){h.removeItem(t.id)}))})),t.$data.tasksStore.attachEvent("onClearAll",(function(){return r=null,s=null,l=null,h.clearAll(),!0})),t.attachEvent("onTaskIdChange",(function(t,e){h.find((function(e){return e.task_id==t})).forEach((function(t){t.task_id=e,h.updateItem(t.id)})),f(e)})),t.attachEvent("onBeforeUndo",(function(t){return a=!0,!0})),t.attachEvent("onAfterUndo",(function(t){a=!0}));var r=null,s=null,l=null;h.attachEvent("onStoreUpdated",(function(){return e&&!a||(r=null,s=null,l=null),!0})),t.getResourceAssignments=function(e,i){var n=t.defined(i)&&null!==i;return null===r&&(r={},s={},h.eachItem((function(t){r[t.resource_id]||(r[t.resource_id]=[]),r[t.resource_id].push(t);var e=t.resource_id+"-"+t.task_id;s[e]||(s[e]=[]),s[e].push(t)}))),n?(s[e+"-"+i]||[]).slice():(r[e]||[]).slice()},t.getTaskAssignments=function(t){if(null===l){var e=[];l={},h.eachItem((function(i){l[i.task_id]||(l[i.task_id]=[]),l[i.task_id].push(i),i.task_id==t&&e.push(i)}))}return(l[t]||[]).slice()},t.getTaskResources=function(e){const i=t.getDatastore("resource"),n=t.getTaskAssignments(e),a={};n.forEach((function(t){a[t.resource_id]||(a[t.resource_id]=t.resource_id)}));const r=[];for(const t in a){const e=i.getItem(a[t]);e&&r.push(e)}return r},t.updateTaskAssignments=f}}),{once:!0})}function Qt(t){function e(e){return function(){return!t.config.placeholder_task||e.apply(this,arguments)}}function i(){var e=t.getTaskBy("type",t.config.types.placeholder);if(!e.length||!t.isTaskExists(e[0].id)){var i={unscheduled:!0,type:t.config.types.placeholder,duration:0,text:t.locale.labels.new_task};if(!1===t.callEvent("onTaskCreated",[i]))return;t.addTask(i)}}function n(e){var i=t.getTask(e);i.type==t.config.types.placeholder&&(i.start_date&&i.end_date&&i.unscheduled&&(i.unscheduled=!1),t.batchUpdate((function(){var e=t.copy(i);t.silent((function(){t.deleteTask(i.id)})),delete e["!nativeeditor_status"],e.type=t.config.types.task,e.id=t.uid(),t.addTask(e)})))}t.config.types.placeholder="placeholder",t.attachEvent("onDataProcessorReady",e((function(i){i&&!i._silencedPlaceholder&&(i._silencedPlaceholder=!0,i.attachEvent("onBeforeUpdate",e((function(e,n,a){return a.type!=t.config.types.placeholder||(i.setUpdated(e,!1),!1)}))))})));var a=!1;function r(e){return!(!t.config.types.placeholder||!t.isTaskExists(e)||t.getTask(e).type!=t.config.types.placeholder)}function s(t){return!(!r(t.source)&&!r(t.target))}t.attachEvent("onGanttReady",(function(){a||(a=!0,t.attachEvent("onAfterTaskUpdate",e(n)),t.attachEvent("onAfterTaskAdd",e((function(e,n){n.type!=t.config.types.placeholder&&(t.getTaskBy("type",t.config.types.placeholder).forEach((function(e){t.silent((function(){t.isTaskExists(e.id)&&t.deleteTask(e.id)}))})),i())}))),t.attachEvent("onParse",e(i)))})),t.attachEvent("onLinkValidation",(function(t){return!s(t)})),t.attachEvent("onBeforeLinkAdd",(function(t,e){return!s(e)})),t.attachEvent("onBeforeUndoStack",(function(e){for(var i=0;i<e.commands.length;i++){var n=e.commands[i];"task"===n.entity&&n.value.type===t.config.types.placeholder&&(e.commands.splice(i,1),i--)}return!0}))}function te(t){function e(e){return function(){return!t.config.auto_types||t.getTaskType(t.config.types.project)!=t.config.types.project||e.apply(this,arguments)}}function i(e,i){var n=t.getTask(e),a=r(n);!1!==a&&t.getTaskType(n)!==a&&(i.$needsUpdate=!0,i[n.id]={task:n,type:a})}function n(e){if(!t.getState().group_mode){var n=(i(a=e,r=r||{}),t.eachParent((function(t){i(t.id,r)}),a),r);n.$needsUpdate&&t.batchUpdate((function(){!function(e){for(var i in e)if(e[i]&&e[i].task){var n=e[i].task;n.type=e[i].type,t.updateTask(n.id)}}(n)}))}var a,r}var a;function r(e){var i=t.config.types,n=t.hasChild(e.id),a=t.getTaskType(e.type);return n&&a===i.task?i.project:!n&&a===i.project&&i.task}var s,o,l=!0;function d(e){e!=t.config.root_id&&t.isTaskExists(e)&&n(e)}t.attachEvent("onParse",e((function(){l=!1,t.getState().group_mode||(t.batchUpdate((function(){t.eachTask((function(e){var i,n,a=r(e);!1!==a&&(i=e,n=a,t.getState().group_mode||(i.type=n,t.updateTask(i.id)))}))})),l=!0)}))),t.attachEvent("onAfterTaskAdd",e((function(t){l&&n(t)}))),t.attachEvent("onAfterTaskUpdate",e((function(t){l&&n(t)}))),t.attachEvent("onBeforeTaskDelete",e((function(e,i){return a=t.getParent(e),!0}))),t.attachEvent("onAfterTaskDelete",e((function(t,e){d(a)}))),t.attachEvent("onRowDragStart",e((function(e,i,n){return s=t.getParent(e),!0}))),t.attachEvent("onRowDragEnd",e((function(t,e){d(s),n(t)}))),t.attachEvent("onBeforeTaskMove",e((function(e,i,n){return o=t.getParent(e),!0}))),t.attachEvent("onAfterTaskMove",e((function(t,e,i){document.querySelector(".gantt_drag_marker")||(d(o),n(t))})))}const ee=class{constructor(){this.canParse=t=>!isNaN(this.parse(t)),this.format=t=>String(t),this.parse=t=>parseInt(t,10)}};ee.create=(t=null)=>new ee;let ie=ee;const ne=class{constructor(t){this.format=t=>this._getWBSCode(t.source),this.canParse=t=>this._linkReg.test(t),this.parse=t=>{if(!this.canParse(t))return null;const e=this._linkReg.exec(t)[0].trim();return{id:void 0,source:this._findSource(e)||null,target:null,type:this._gantt.config.links.finish_to_start,lag:0}},this._getWBSCode=t=>{const e=this._gantt.getTask(t);return this._gantt.getWBSCode(e)},this._findSource=t=>{const e=new RegExp("^[0-9.]+","i");if(e.exec(t)){const i=e.exec(t)[0],n=this._gantt.getTaskByWBSCode(i);if(n)return n.id}return null},this._linkReg=/^[0-9\.]+/,this._gantt=t}};ne.create=(t=null,e)=>new ne(e);let ae=ne;function re(t){t.ext.formatters={durationFormatter:function(e){return e||(e={}),e.store||(e.store=t.config.duration_unit),e.enter||(e.enter=t.config.duration_unit),ie.create(e,t)},linkFormatter:function(e){return ae.create(e,t)}}}function se(t){t.ext=t.ext||{},t.config.show_empty_state=!1,t.ext.emptyStateElement=t.ext.emptyStateElement||{isEnabled:()=>!0===t.config.show_empty_state,isGanttEmpty:()=>!t.getTaskByTime().length,renderContent(e){const i=`<div class='gantt_empty_state'><div class='gantt_empty_state_image'></div><div class='gantt_empty_state_text'>\n    <div class='gantt_empty_state_text_link' data-empty-state-create-task>${t.locale.labels.empty_state_text_link}</div>\n    <div class='gantt_empty_state_text_description'>${t.locale.labels.empty_state_text_description}</div>\n    </div></div>`;e.innerHTML=i},clickEvents:[],attachAddTaskEvent(){const e=t.attachEvent("onEmptyClick",(function(e){t.utils.dom.closest(e.target,"[data-empty-state-create-task]")&&t.createTask({id:t.uid(),text:"New Task"})}));this.clickEvents.push(e)},detachAddTaskEvents(){this.clickEvents.forEach((function(e){t.detachEvent(e)})),this.clickEvents=[]},getContainer(){if(t.$container){const e=t.utils.dom;if(t.$container.contains(t.$grid_data))return e.closest(t.$grid_data,".gantt_layout_content");if(t.$container.contains(t.$task_data))return e.closest(t.$task_data,".gantt_layout_content")}return null},getNode(){const t=this.getContainer();return t?t.querySelector(".gantt_empty_state_wrapper"):null},show(){const e=this.getContainer();if(!e&&this.isGanttEmpty())return null;const i=document.createElement("div");i.className="gantt_empty_state_wrapper",i.style.marginTop=t.config.scale_height-e.offsetHeight+"px";const n=t.$container.querySelectorAll(".gantt_empty_state_wrapper");Array.prototype.forEach.call(n,(function(t){t.parentNode.removeChild(t)})),this.detachAddTaskEvents(),this.attachAddTaskEvent(),e.appendChild(i),this.renderContent(i)},hide(){const t=this.getNode();if(!t)return!1;t.parentNode.removeChild(t)},init(){}},t.attachEvent("onDataRender",(function(){const e=t.ext.emptyStateElement;e.isEnabled()&&e.isGanttEmpty()?e.show():e.hide()}))}const oe=function(t,e){const i=e.baselines&&e.baselines.length,n="separateRow"==t.config.baselines.render_mode||"individualRow"==t.config.baselines.render_mode;if(i&&n)return!0},le=function(t){return t.render&&"split"==t.render&&!t.$open};function de(t){t.config.baselines={datastore:"baselines",render_mode:!1,dataprocessor_baselines:!1,row_height:16,bar_height:8};const e=t.createDatastore({name:t.config.baselines.datastore,initItem:function(e){return e.id||(e.id=t.uid()),function(e){if(!e.task_id||!e.start_date&&!e.end_date)return!1;e.start_date?e.start_date=t.date.parseDate(e.start_date,"parse_date"):e.start_date=null,e.end_date?e.end_date=t.date.parseDate(e.end_date,"parse_date"):e.end_date=null,e.duration=e.duration||1,e.start_date&&!e.end_date?e.end_date=t.calculateEndDate(e.start_date,e.duration):e.end_date&&!e.start_date&&(e.start_date=t.calculateEndDate(e.end_date,-e.duration))}(e),e}});function i(e){let i=0;t.adjustTaskHeightForBaselines(e),t.eachTask((function(e){let n=e.row_height||t.config.row_height;i=i||n,n>i&&(i=n)}),e.id),e.row_height<i&&(e.row_height=i)}function n(e){t.eachParent((function(i){if(le(i)){const n=i.row_height||t.getLayoutView("timeline").getBarHeight(i.id);let a=e.row_height;t.getChildren(i.id).forEach((function(i){const n=t.getTask(i);if(n.id==e.id)return;const r=n.row_height||t.getLayoutView("timeline").getBarHeight(n.id);a=a||r,r>a&&(a=r)})),i.row_height=a,i.bar_height=i.bar_height||n}}),e.id)}t.$data.baselineStore=e,t.adjustTaskHeightForBaselines=function(e){let i,a,r=e.baselines&&e.baselines.length||0;const s=t.config.baselines.row_height,o=t.getLayoutView("timeline");if(o&&t.config.show_chart)switch(t.config.baselines.render_mode){case"taskRow":default:e.row_height=e.bar_height+8;break;case"separateRow":i=o.getBarHeight(e.id),r?(e.bar_height=e.bar_height||i,e.bar_height>i&&(i=e.bar_height),e.row_height=i+s):e.bar_height&&(e.row_height=e.bar_height+4),n(e);break;case"individualRow":i=o.getBarHeight(e.id),r?(e.bar_height=e.bar_height||i,e.bar_height>i&&(i=e.bar_height),a=s*r,e.row_height=i+a+2):e.bar_height&&(e.row_height=e.bar_height+4),n(e)}},t.attachEvent("onGanttReady",(function(){t.config.baselines&&(t.attachEvent("onParse",(function(){e.eachItem((function(e){const n=e.task_id;if(t.isTaskExists(n)){const a=t.getTask(n);a.baselines=a.baselines||[];let r=!0;for(let i=0;i<a.baselines.length;i++){let n=a.baselines[i];if(n.id==e.id){r=!1,t.mixin(n,e,!0);break}}r&&a.baselines.push(e),It(t)||(le(a)?i(a):t.adjustTaskHeightForBaselines(a))}}))})),t.attachEvent("onBeforeTaskUpdate",(function(n,a){return function(n){let a=!1;const r={},s=n.baselines||[],o=t.getTaskBaselines(n.id);s.length!=o.length&&(a=!0),s.forEach((function(t){r[t.id]=!0;const i=e.getItem(t.id);if(i){const n=+i.start_date!=+t.start_date,a=+i.end_date!=+t.end_date;(n||a)&&e.updateItem(t.id,t)}else e.addItem(t)})),o.forEach((function(t){r[t.id]||e.removeItem(t.id)})),a&&(le(n)?i(n):t.adjustTaskHeightForBaselines(n),t.render())}(a),!0})),t.attachEvent("onAfterUndo",(function(e){if(("separateRow"==t.config.baselines.render_mode||"individualRow"==t.config.baselines.render_mode)&&e){let n=!1;e.commands.forEach((function(e){if("task"==e.entity){const a=e.value.id;if(t.isTaskExists(a)){const e=t.getTask(a);if(e.parent&&t.isTaskExists(e.parent)){const a=t.getTask(e.parent);le(a)&&(i(a),n=!0)}}}})),n&&t.render()}})),t.attachEvent("onAfterTaskDelete",(function(n,a){if(oe&&a.parent&&t.isTaskExists(a.parent)){const e=t.getTask(a.parent);le(e)&&i(e)}e.eachItem((function(i){t.isTaskExists(i.task_id)||e.removeItem(i.id)}))})),t.getTaskBaselines=function(t){const i=[];return e.eachItem((function(e){e.task_id==t&&i.push(e)})),i},t.$data.baselineStore.attachEvent("onClearAll",(function(){return t.eachTask((function(t){t.baselines&&delete t.baselines})),!0})),t.$data.tasksStore.attachEvent("onClearAll",(function(){return e.clearAll(),!0})),t.attachEvent("onTaskIdChange",(function(t,i){e.find((function(e){return e.task_id==t})).forEach((function(t){t.task_id=i,e.updateItem(t.id)}))})))}),{once:!0})}function ce(t,e,i,n,a){return this.date=t,this.unit=e,this.task=i,this.id=n,this.calendar=a,this}function ue(t,e,i,n,a,r){return this.date=t,this.dir=e,this.unit=i,this.task=n,this.id=a,this.calendar=r,this}function he(t,e,i,n,a,r,s){return this.start_date=t,this.duration=e,this.unit=i,this.step=n,this.task=a,this.id=r,this.calendar=s,this}function _e(t,e,i,n){return this.start_date=t,this.end_date=e,this.task=i,this.calendar=n,this.unit=null,this.step=null,this}var ge=function(t){return{getWorkHoursArguments:function(){var e=arguments[0];if(!z((e=B(e)?{date:e}:Z({},e)).date))throw t.assert(!1,"Invalid date argument for getWorkHours method"),new Error("Invalid date argument for getWorkHours method");return e},setWorkTimeArguments:function(){return arguments[0]},unsetWorkTimeArguments:function(){return arguments[0]},isWorkTimeArguments:function(){var e,i=arguments[0];if(i instanceof ce)return i;if((e=i.date?new ce(i.date,i.unit,i.task,null,i.calendar):new ce(arguments[0],arguments[1],arguments[2],null,arguments[3])).unit=e.unit||t.config.duration_unit,!z(e.date))throw t.assert(!1,"Invalid date argument for isWorkTime method"),new Error("Invalid date argument for isWorkTime method");return e},getClosestWorkTimeArguments:function(e){var i,n=arguments[0];if(n instanceof ue)return n;if(i=B(n)?new ue(n):new ue(n.date,n.dir,n.unit,n.task,null,n.calendar),n.id&&(i.task=n),i.dir=n.dir||"any",i.unit=n.unit||t.config.duration_unit,!z(i.date))throw t.assert(!1,"Invalid date argument for getClosestWorkTime method"),new Error("Invalid date argument for getClosestWorkTime method");return i},_getStartEndConfig:function(e){var i,n=_e;if(e instanceof n)return e;if(B(e)?i=new n(arguments[0],arguments[1],arguments[2],arguments[3]):(i=new n(e.start_date,e.end_date,e.task),null!==e.id&&void 0!==e.id&&(i.task=e)),i.unit=i.unit||t.config.duration_unit,i.step=i.step||t.config.duration_step,i.start_date=i.start_date||i.start||i.date,!z(i.start_date))throw t.assert(!1,"Invalid start_date argument for getDuration method"),new Error("Invalid start_date argument for getDuration method");if(!z(i.end_date))throw t.assert(!1,"Invalid end_date argument for getDuration method"),new Error("Invalid end_date argument for getDuration method");return i},getDurationArguments:function(t,e,i,n){return this._getStartEndConfig.apply(this,arguments)},hasDurationArguments:function(t,e,i,n){return this._getStartEndConfig.apply(this,arguments)},calculateEndDateArguments:function(e,i,n,a){var r,s=arguments[0];if(s instanceof he)return s;if(r=B(s)?new he(arguments[0],arguments[1],arguments[2],void 0,arguments[3],void 0,arguments[4]):new he(s.start_date,s.duration,s.unit,s.step,s.task,null,s.calendar),null!==s.id&&void 0!==s.id&&(r.task=s,r.unit=null,r.step=null),r.unit=r.unit||t.config.duration_unit,r.step=r.step||t.config.duration_step,!z(r.start_date))throw t.assert(!1,"Invalid start_date argument for calculateEndDate method"),new Error("Invalid start_date argument for calculateEndDate method");return r}}};function fe(){}fe.prototype={_getIntervals:function(t){for(var e=[],i=0;i<t.length;i+=2)e.push({start:t[i],end:t[i+1]});return e},_toHoursArray:function(t){var e=[];function i(t){var e,i=Math.floor(t/3600),n=t-60*i*60,a=Math.floor(n/60);return i+":"+((e=String(a)).length<2&&(e="0"+e),e)}for(var n=0;n<t.length;n++)e.push(i(t[n].start)+"-"+i(t[n].end));return e},_intersectHourRanges:function(t,e){var i=[],n=t.length>e.length?t:e,a=t===n?e:t;n=n.slice(),a=a.slice(),i=[];for(var r=0;r<n.length;r++)for(var s=n[r],o=0;o<a.length;o++){var l=a[o];l.start<s.end&&l.end>s.start&&(i.push({start:Math.max(s.start,l.start),end:Math.min(s.end,l.end)}),s.end>l.end&&(a.splice(o,1),o--,r--))}return i},_mergeAdjacentIntervals:function(t){var e=t.slice();e.sort((function(t,e){return t.start-e.start}));for(var i=e[0],n=1;n<e.length;n++){var a=e[n];a.start<=i.end?(a.end>i.end&&(i.end=a.end),e.splice(n,1),n--):i=a}return e},_mergeHoursConfig:function(t,e){return this._mergeAdjacentIntervals(this._intersectHourRanges(t,e))},merge:function(t,e){const i=X(t.getConfig()),n=X(e.getConfig()),a=i.parsed,r=n.parsed;a.customWeeks=i.customWeeks,r.customWeeks=n.customWeeks;var s={hours:this._toHoursArray(this._mergeHoursConfig(a.hours,r.hours)),dates:{},customWeeks:{}};const o=(t,e)=>{for(let i in t.dates){const n=t.dates[i];+i>1e3&&(s.dates[i]=!1);for(const t in e.dates){const a=e.dates[t];if(t==i&&(s.dates[i]=!(!n||!a)),Array.isArray(n)){const t=Array.isArray(a)?a:e.hours;s.dates[i]=this._toHoursArray(this._mergeHoursConfig(n,t))}}}};if(o(a,r),o(r,a),a.customWeeks)for(var l in a.customWeeks)s.customWeeks[l]=a.customWeeks[l];if(r.customWeeks)for(var l in r.customWeeks)s.customWeeks[l]?s.customWeeks[l+"_second"]=r.customWeeks[l]:s.customWeeks[l]=r.customWeeks[l];return s}};class pe{constructor(){this.clear()}getItem(t,e,i){if(this._cache.has(t)){const n=this._cache.get(t)[i.getFullYear()];if(n&&n.has(e))return n.get(e)}return-1}setItem(t,e,i,n){if(!t||!e)return;const a=this._cache,r=n.getFullYear();let s;a.has(t)?s=a.get(t):(s=[],a.set(t,s));let o=s[r];o||(o=s[r]=new Map),o.set(e,i)}clear(){this._cache=new Map}}class me{constructor(){this.clear()}getItem(t,e,i){const n=this._cache;if(n&&n[t]){const a=n[t];if(void 0===a)return-1;const r=a[i.getFullYear()];if(r&&void 0!==r[e])return r[e]}return-1}setItem(t,e,i,n){if(!t||!e)return;const a=this._cache;if(!a)return;a[t]||(a[t]=[]);const r=a[t],s=n.getFullYear();let o=r[s];o||(o=r[s]={}),o[e]=i}clear(){this._cache={}}}class ve{constructor(t){this.getMinutesPerWeek=t=>{const e=t.valueOf();if(this._weekCache.has(e))return this._weekCache.get(e);const i=this._calendar,n=this._calendar.$gantt;let a=0,r=n.date.week_start(new Date(t));for(let t=0;t<7;t++)a+=60*i.getHoursPerDay(r),r=n.date.add(r,1,"day");return this._weekCache.set(e,a),a},this.getMinutesPerMonth=t=>{const e=t.valueOf();if(this._monthCache.has(e))return this._monthCache.get(e);const i=this._calendar,n=this._calendar.$gantt;let a=0,r=n.date.week_start(new Date(t));const s=n.date.add(r,1,"month").valueOf();for(;r.valueOf()<s;)a+=60*i.getHoursPerDay(r),r=n.date.add(r,1,"day");return this._monthCache.set(e,a),a},this.clear=()=>{this._weekCache=new Map,this._monthCache=new Map},this.clear(),this._calendar=t}}class ke{constructor(){this.clear()}_getCacheObject(t,e,i){const n=this._cache;n[e]||(n[e]=[]);let a=n[e];a||(a=n[e]={});let r=a[i];r||(r=a[i]={});const s=t.getFullYear();let o=r[s];return o||(o=r[s]={durations:{},endDates:{}}),o}_endDateCacheKey(t,e){return String(t)+"-"+String(e)}_durationCacheKey(t,e){return String(t)+"-"+String(e)}getEndDate(t,e,i,n,a){const r=this._getCacheObject(t,i,n),s=t.valueOf(),o=this._endDateCacheKey(s,e);let l;if(void 0===r.endDates[o]){const t=a(),i=t.valueOf();r.endDates[o]=i,r.durations[this._durationCacheKey(s,i)]=e,l=t}else l=new Date(r.endDates[o]);return l}getDuration(t,e,i,n,a){const r=this._getCacheObject(t,i,n),s=t.valueOf(),o=e.valueOf(),l=this._durationCacheKey(s,o);let d;if(void 0===r.durations[l]){const t=a();r.durations[l]=t.valueOf(),d=t}else d=r.durations[l];return d}clear(){this._cache={}}}function ye(t,e){this.argumentsHelper=e,this.$gantt=t,this._workingUnitsCache=typeof Map<"u"?new pe:new me,this._largeUnitsCache=new ve(this),this._dateDurationCache=new ke,this._worktime=null,this._cached_timestamps={},this._cached_timestamps_count=0}ye.prototype={units:["year","month","week","day","hour","minute"],_clearCaches:function(){this._workingUnitsCache.clear(),this._largeUnitsCache.clear(),this._dateDurationCache.clear()},_getUnitOrder:function(t){for(var e=0,i=this.units.length;e<i;e++)if(this.units[e]==t)return e},_resetTimestampCache:function(){this._cached_timestamps={},this._cached_timestamps_count=0},_timestamp:function(t){this._cached_timestamps_count>1e6&&this._resetTimestampCache();var e=null;if(t.day||0===t.day)e=t.day;else if(t.date){var i=String(t.date.valueOf());this._cached_timestamps[i]?e=this._cached_timestamps[i]:(e=Date.UTC(t.date.getFullYear(),t.date.getMonth(),t.date.getDate()),this._cached_timestamps[i]=e,this._cached_timestamps_count++)}return e},_checkIfWorkingUnit:function(t,e){if(!this["_is_work_"+e]){const i=this.$gantt.date[`${e}_start`](new Date(t)),n=this.$gantt.date.add(i,1,e);return this.hasDuration(i,n)}return this["_is_work_"+e](t)},_is_work_day:function(t){var e=this._getWorkHours(t);return!!Array.isArray(e)&&e.length>0},_is_work_hour:function(t){for(var e=this._getWorkHours(t),i=t.getHours(),n=0;n<e.length;n++)if(i>=e[n].startHour&&i<e[n].endHour)return!0;return!1},_getTimeOfDayStamp:function(t,e){var i=t.getHours();return t.getHours()||t.getMinutes()||!e||(i=24),60*i*60+60*t.getMinutes()},_is_work_minute:function(t){for(var e=this._getWorkHours(t),i=this._getTimeOfDayStamp(t),n=0;n<e.length;n++)if(i>=e[n].start&&i<e[n].end)return!0;return!1},_nextDate:function(t,e,i){return this.$gantt.date.add(t,i,e)},_getWorkUnitsBetweenGeneric:function(t,e,i,n){var a=this.$gantt.date,r=new Date(t),s=new Date(e);n=n||1;var o,l,d=0,c=null,u=!1;(o=a[i+"_start"](new Date(r))).valueOf()!=r.valueOf()&&(u=!0);var h=!1;(l=a[i+"_start"](new Date(e))).valueOf()!=e.valueOf()&&(h=!0);for(var _=!1;r.valueOf()<s.valueOf();){if(_=(c=this._nextDate(r,i,n)).valueOf()>s.valueOf(),this._isWorkTime(r,i))(u||h&&_)&&(o=a[i+"_start"](new Date(r)),l=a.add(o,n,i)),u?(u=!1,c=this._nextDate(o,i,n),d+=(l.valueOf()-r.valueOf())/(l.valueOf()-o.valueOf())):h&&_?(h=!1,d+=(s.valueOf()-r.valueOf())/(l.valueOf()-o.valueOf())):d++;else{var g=this._getUnitOrder(i),f=this.units[g-1];f&&!this._isWorkTime(r,f)&&(c=this._getClosestWorkTimeFuture(r,f))}r=c}return d},_getMinutesPerHour:function(t){var e=this._getTimeOfDayStamp(t),i=this._getTimeOfDayStamp(this._nextDate(t,"hour",1));0===i&&(i=86400);for(var n=this._getWorkHours(t),a=0;a<n.length;a++){var r=n[a];if(e>=r.start&&i<=r.end)return 60;if(e<r.end&&i>r.start)return(Math.min(i,r.end)-Math.max(e,r.start))/60}return 0},_getMinutesPerDay:function(t){var e=this._getWorkHours(t),i=0;return e.forEach((function(t){i+=t.durationMinutes})),i},getHoursPerDay:function(t){var e=this._getWorkHours(t),i=0;return e.forEach((function(t){i+=t.durationHours})),i},_getWorkUnitsForRange:function(t,e,i,n){var a,r=0,s=new Date(t),o=new Date(e);for(a=et("minute"==i?this._getMinutesPerDay:this.getHoursPerDay,this);s.valueOf()<o.valueOf();)if(o-s>27648e5&&0===s.getDate()){var l=this._largeUnitsCache.getMinutesPerMonth(s);"hour"==i&&(l/=60),r+=l,s=this.$gantt.date.add(s,1,"month")}else{if(o-s>13824e5){var d=this.$gantt.date.week_start(new Date(s));if(s.valueOf()===d.valueOf()){l=this._largeUnitsCache.getMinutesPerWeek(s),"hour"==i&&(l/=60),r+=l,s=this.$gantt.date.add(s,7,"day");continue}}r+=a(s),s=this._nextDate(s,"day",1)}return r/n},_getMinutesBetweenSingleDay:function(t,e){for(var i=this._getIntervalTimestamp(t,e),n=this._getWorkHours(t),a=0,r=0;r<n.length;r++){var s=n[r];if(i.end>=s.start&&i.start<=s.end){var o=Math.max(s.start,i.start),l=Math.min(s.end,i.end);a+=(l-o)/60,i.start=l}}return Math.floor(a)},_getMinutesBetween:function(t,e,i,n){var a=new Date(t),r=new Date(e);n=n||1;var s=new Date(a),o=this.$gantt.date.add(this.$gantt.date.day_start(new Date(a)),1,"day");if(r.valueOf()<=o.valueOf())return this._getMinutesBetweenSingleDay(t,e);var l=this.$gantt.date.day_start(new Date(r)),d=r,c=this._getMinutesBetweenSingleDay(s,o),u=this._getMinutesBetweenSingleDay(l,d);return c+this._getWorkUnitsForRange(o,l,i,n)+u},_getHoursBetween:function(t,e,i,n){var a=new Date(t),r=new Date(e);n=n||1;var s=new Date(a),o=this.$gantt.date.add(this.$gantt.date.day_start(new Date(a)),1,"day");if(r.valueOf()<=o.valueOf())return Math.round(this._getMinutesBetweenSingleDay(t,e)/60);var l=this.$gantt.date.day_start(new Date(r)),d=r,c=this._getMinutesBetweenSingleDay(s,o,i,n)/60,u=this._getMinutesBetweenSingleDay(l,d,i,n)/60,h=c+this._getWorkUnitsForRange(o,l,i,n)+u;return Math.round(h)},getConfig:function(){return this._worktime},_setConfig:function(t){this._worktime=t,this._parseSettings(),this._clearCaches()},_parseSettings:function(){var t=this.getConfig();for(var e in t.parsed={dates:{},hours:null,haveCustomWeeks:!1,customWeeks:{},customWeeksRangeStart:null,customWeeksRangeEnd:null,customWeeksBoundaries:[]},t.parsed.hours=this._parseHours(t.hours),t.dates)t.parsed.dates[e]=this._parseHours(t.dates[e]);if(t.customWeeks){var i=null,n=null;for(var e in t.customWeeks){var a=t.customWeeks[e];if(a.from&&a.to){var r=a.from,s=a.to;(!i||i>r.valueOf())&&(i=r.valueOf()),(!n||n<s.valueOf())&&(n=s.valueOf()),t.parsed.customWeeksBoundaries.push({from:r.valueOf(),fromReadable:new Date(r),to:s.valueOf(),toReadable:new Date(s),name:e}),t.parsed.haveCustomWeeks=!0;var o=t.parsed.customWeeks[e]={from:a.from,to:a.to,hours:this._parseHours(a.hours),dates:{}};if(a.days&&!a.dates){for(a.dates=a.dates||{},e=0;e<a.days.length;e++)a.dates[e]=a.days[e],a.days[e]instanceof Array||(a.dates[e]=!!a.days[e]);delete a.days}for(var l in a.dates)o.dates[l]=this._parseHours(a.dates[l])}}t.parsed.customWeeksRangeStart=i,t.parsed.customWeeksRangeEnd=n}},_tryChangeCalendarSettings:function(t){var e=JSON.stringify(this.getConfig());return t(),!!this.hasWorkTime()||(this._setConfig(JSON.parse(e)),this._clearCaches(),!1)},_arraysEqual:function(t,e){if(t===e)return!0;if(!t||!e||t.length!=e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0},_compareSettings:function(t,e){if(!this._arraysEqual(t.hours,e.hours))return!1;var i=Object.keys(t.dates),n=Object.keys(e.dates);if(i.sort(),n.sort(),!this._arraysEqual(i,n))return!1;for(var a=0;a<i.length;a++){var r=i[a],s=t.dates[r],o=t.dates[r];if(s!==o&&!(Array.isArray(s)&&Array.isArray(o)&&this._arraysEqual(s,o)))return!1}return!0},equals:function(t){if(!(t instanceof ye))return!1;var e=this.getConfig(),i=t.getConfig();if(!this._compareSettings(e,i))return!1;if(e.parsed.haveCustomWeeks&&i.parsed.haveCustomWeeks){if(e.parsed.customWeeksBoundaries.length!=i.parsed.customWeeksBoundaries.length)return!1;for(var n in e.parsed.customWeeks){var a=e.parsed.customWeeks[n],r=i.parsed.customWeeks[n];if(!r||!this._compareSettings(a,r))return!1}}else if(e.parse.haveCustomWeeks!==i.parsed.haveCustomWeeks)return!1;return!0},getWorkHours:function(){var t=this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper,arguments);return this._getWorkHours(t.date,!1)},_getWorkHours:function(t,e){var i=this.getConfig();if(!1!==e&&(i=i.parsed),!t)return i.hours;var n=this._timestamp({date:t});if(i.haveCustomWeeks&&i.customWeeksRangeStart<=n&&i.customWeeksRangeEnd>n)for(var a=0;a<i.customWeeksBoundaries.length;a++)if(i.customWeeksBoundaries[a].from<=n&&i.customWeeksBoundaries[a].to>n){i=i.customWeeks[i.customWeeksBoundaries[a].name];break}var r=!0;return void 0!==i.dates[n]?r=i.dates[n]:void 0!==i.dates[t.getDay()]&&(r=i.dates[t.getDay()]),!0===r?i.hours:r||[]},_getIntervalTimestamp:function(t,e){var i={start:0,end:0};i.start=60*t.getHours()*60+60*t.getMinutes()+t.getSeconds();var n=e.getHours();return!n&&!e.getMinutes()&&!e.getSeconds()&&t.valueOf()<e.valueOf()&&(n=24),i.end=60*n*60+60*e.getMinutes()+e.getSeconds(),i},_parseHours:function(t){if(Array.isArray(t)){var e=[];t.forEach((function(t){"number"==typeof t?e.push(60*t*60):"string"==typeof t&&t.split("-").map((function(t){return t.trim()})).forEach((function(t){var i=t.split(":").map((function(t){return t.trim()})),n=parseInt(60*i[0]*60);i[1]&&(n+=parseInt(60*i[1])),i[2]&&(n+=parseInt(i[2])),e.push(n)}))}));for(var i=[],n=0;n<e.length;n+=2){var a=e[n],r=e[n+1],s=r-a;i.push({start:a,end:r,startHour:Math.floor(a/3600),startMinute:Math.floor(a/60),endHour:Math.ceil(r/3600),endMinute:Math.ceil(r/60),durationSeconds:s,durationMinutes:s/60,durationHours:s/3600})}return i}return t},setWorkTime:function(t){return this._tryChangeCalendarSettings(et((function(){var e=void 0===t.hours||t.hours,i=this._timestamp(t),n=this.getConfig();if(null!==i?n.dates[i]=e:t.customWeeks||(n.hours=e),t.customWeeks)if(n.customWeeks||(n.customWeeks={}),"string"==typeof t.customWeeks)null!==i?n.customWeeks[t.customWeeks].dates[i]=e:t.customWeeks||(n.customWeeks[t.customWeeks].hours=e);else if("object"==typeof t.customWeeks&&t.customWeeks.constructor===Object)for(var a in t.customWeeks)n.customWeeks[a]=t.customWeeks[a];this._parseSettings(),this._clearCaches()}),this))},unsetWorkTime:function(t){return this._tryChangeCalendarSettings(et((function(){if(t){var e=this._timestamp(t);null!==e&&delete this.getConfig().dates[e]}else this.reset_calendar();this._parseSettings(),this._clearCaches()}),this))},_isWorkTime:function(t,e){var i,n=-1;return i=String(t.valueOf()),-1==(n=this._workingUnitsCache.getItem(e,i,t))&&(n=this._checkIfWorkingUnit(t,e),this._workingUnitsCache.setItem(e,i,n,t)),n},isWorkTime:function(){var t=this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper,arguments);return this._isWorkTime(t.date,t.unit)},calculateDuration:function(){var t=this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper,arguments);if(!t.unit)return!1;var e=this;return this._dateDurationCache.getDuration(t.start_date,t.end_date,t.unit,t.step,(function(){return e._calculateDuration(t.start_date,t.end_date,t.unit,t.step)}))},_calculateDuration:function(t,e,i,n){var a,r=1;if(t.valueOf()>e.valueOf()){var s=e;e=t,t=s,r=-1}return a="hour"==i&&1==n?this._getHoursBetween(t,e,i,n):"minute"==i&&1==n?this._getMinutesBetween(t,e,i,n):this._getWorkUnitsBetweenGeneric(t,e,i,n),r*Math.round(a)},hasDuration:function(){var t=this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper,arguments),e=t.start_date,i=t.end_date,n=t.unit,a=t.step;if(!n)return!1;var r=new Date(e),s=new Date(i);for(a=a||1;r.valueOf()<s.valueOf();){if(this._isWorkTime(r,n))return!0;r=this._nextDate(r,n,a)}return!1},calculateEndDate:function(){var t=this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper,arguments),e=t.start_date,i=t.duration,n=t.unit,a=t.step;if(!n)return!1;var r=t.duration>=0?1:-1;i=Math.abs(1*i);var s=this;return this._dateDurationCache.getEndDate(e,i,n,a*r,(function(){return s._calculateEndDate(e,i,n,a*r)}))},_calculateEndDate:function(t,e,i,n){return!!i&&(1==n&&"minute"==i?this._calculateMinuteEndDate(t,e,n):-1==n&&"minute"==i?this._subtractMinuteDate(t,e,n):1==n&&"hour"==i?this._calculateHourEndDate(t,e,n):this._addInterval(t,e,i,n,null).end)},_addInterval:function(t,e,i,n,a){for(var r=0,s=t,o=!1;r<e&&(!a||!a(s));){var l=this._nextDate(s,i,n);"day"==i&&(o=o||!s.getHours()&&l.getHours())&&(l.setHours(0),l.getHours()||(o=!1));var d=new Date(l.valueOf()+1);n>0&&(d=new Date(l.valueOf()-1)),this._isWorkTime(d,i)&&!o&&r++,s=l}return{end:s,start:t,added:r}},_addHoursUntilDayEnd:function(t,e){for(var i=this.$gantt.date.add(this.$gantt.date.day_start(new Date(t)),1,"day"),n=0,a=e,r=this._getIntervalTimestamp(t,i),s=this._getWorkHours(t),o=0;o<s.length&&n<e;o++){var l=s[o];if(r.end>=l.start&&r.start<=l.end){var d=Math.max(l.start,r.start),c=Math.min(l.end,r.end),u=(c-d)/3600;u>a&&(u=a,c=d+60*a*60);var h=Math.round((c-d)/3600);n+=h,a-=h,r.start=c}}var _=i;return n===e&&(_=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,r.start)),{added:n,end:_}},_calculateHourEndDate:function(t,e,i){var n=new Date(t),a=0;i=i||1,e=Math.abs(1*e);var r=this._addHoursUntilDayEnd(n,e);if(a=r.added,n=r.end,d=e-a){for(var s=n;a<e;){var o=this._nextDate(s,"day",i);o.setHours(0),o.setMinutes(0),o.setSeconds(0);var l;if(a+(l=i>0?this.getHoursPerDay(new Date(o.valueOf()-1)):this.getHoursPerDay(new Date(o.valueOf()+1)))>=e)break;a+=l,s=o}n=s}if(a<e){var d=e-a;n=(r=this._addHoursUntilDayEnd(n,d)).end}return n},_addMinutesUntilHourEnd:function(t,e){if(0===t.getMinutes())return{added:0,end:new Date(t)};for(var i=this.$gantt.date.add(this.$gantt.date.hour_start(new Date(t)),1,"hour"),n=0,a=e,r=this._getIntervalTimestamp(t,i),s=this._getWorkHours(t),o=0;o<s.length&&n<e;o++){var l=s[o];if(r.end>=l.start&&r.start<=l.end){var d=Math.max(l.start,r.start),c=Math.min(l.end,r.end),u=(c-d)/60;u>a&&(u=a,c=d+60*a);var h=Math.round((c-d)/60);a-=h,n+=h,r.start=c}}var _=i;return n===e&&(_=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,r.start)),{added:n,end:_}},_subtractMinutesUntilHourStart:function(t,e){for(var i=this.$gantt.date.hour_start(new Date(t)),n=0,a=e,r=60*i.getHours()*60+60*i.getMinutes()+i.getSeconds(),s=60*t.getHours()*60+60*t.getMinutes()+t.getSeconds(),o=this._getWorkHours(t),l=o.length-1;l>=0&&n<e;l--){var d=o[l];if(s>d.start&&r<=d.end){var c=Math.min(s,d.end),u=Math.max(r,d.start),h=(c-u)/60;h>a&&(h=a,u=c-60*a);var _=Math.abs(Math.round((c-u)/60));a-=_,n+=_,s=u}}var g=i;return n===e&&(g=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,s)),{added:n,end:g}},_subtractMinuteDate:function(t,e,i){var n=this.getClosestWorkTime({date:t,dir:"past",unit:"minute"}),a=0;i=i||-1,e=Math.abs(1*e),e=Math.round(e);const r=this._isMinutePrecision(n);let s=this._subtractMinutesUntilHourStart(n,e);a+=s.added,n=s.end;for(var o=0,l=[],d=0;a<e;){var c=this.$gantt.date.day_start(new Date(n)),u=!1;n.valueOf()===c.valueOf()&&(c=this.$gantt.date.add(c,-1,"day"),u=!0);var h=new Date(c.getFullYear(),c.getMonth(),c.getDate(),23,59,59,999).valueOf();h!==o&&(l=this._getWorkHours(c),d=this._getMinutesPerDay(c),o=h);var _=e-a,g=this._getTimeOfDayStamp(n,u);if(l.length&&d)if(l[l.length-1].end<=g&&_>d)a+=d,n=this.$gantt.date.add(n,-1,"day");else{for(var f=!1,p=null,m=null,v=l.length-1;v>=0;v--)if(l[v].start<g-1&&l[v].end>=g-1){f=!0,p=l[v],m=l[v-1];break}if(f)if(g===p.end&&_>=p.durationMinutes)a+=p.durationMinutes,n=this.$gantt.date.add(n,-p.durationMinutes,"minute");else if(!r&&_<=g/60-p.startMinute)a+=_,n=this.$gantt.date.add(n,-_,"minute");else if(r)_<=g/60-p.startMinute?(a+=_,n=this.$gantt.date.add(n,-_,"minute")):(a+=g/60-p.startMinute,n=m?new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,m.end):this.$gantt.date.day_start(n));else{var k=this._getMinutesPerHour(n);k<=_?(a+=k,n=this._nextDate(n,"hour",i)):(s=this._subtractMinutesUntilHourStart(n,_),a+=s.added,n=s.end)}else if(0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()){if((y=this._getClosestWorkTimePast(n,"hour")).valueOf()===n.valueOf()){var y=this.$gantt.date.add(n,-1,"day"),b=this._getWorkHours(y);if(b.length){var x=b[b.length-1];y.setSeconds(x.durationSeconds)}}n=y}else n=this._getClosestWorkTimePast(new Date(n-1),"hour")}else n=this.$gantt.date.add(n,-1,"day")}if(a<e){var $=e-a;s=this._subtractMinutesUntilHourStart(n,$),a+=s.added,n=s.end}return n},_calculateMinuteEndDate:function(t,e,i){var n=new Date(t),a=0;i=i||1,e=Math.abs(1*e),e=Math.round(e);var r=this._addMinutesUntilHourEnd(n,e);a+=r.added,n=r.end;for(var s=0,o=[],l=0,d=this._isMinutePrecision(n);a<e;){var c=this.$gantt.date.day_start(new Date(n)).valueOf();c!==s&&(o=this._getWorkHours(n),l=this._getMinutesPerDay(n),s=c);var u=e-a,h=this._getTimeOfDayStamp(n);if(o.length&&l)if(o[0].start>=h&&u>=l){if(a+=l,u==l){n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,o[o.length-1].end);break}n=this.$gantt.date.add(n,1,"day"),n=this.$gantt.date.day_start(n)}else{for(var _=!1,g=null,f=0;f<o.length;f++)if(o[f].start<=h&&o[f].end>h){_=!0,g=o[f];break}if(_)if(h===g.start&&u>=g.durationMinutes)a+=g.durationMinutes,n=this.$gantt.date.add(n,g.durationMinutes,"minute");else if(u<=g.endMinute-h/60)a+=u,n=this.$gantt.date.add(n,u,"minute");else{var p=this._getMinutesPerHour(n);p<=u?(a+=p,n=d?this.$gantt.date.add(n,p,"minute"):this._nextDate(n,"hour",i)):(a+=(r=this._addMinutesUntilHourEnd(n,u)).added,n=r.end)}else n=this._getClosestWorkTimeFuture(n,"hour")}else n=this.$gantt.date.add(this.$gantt.date.day_start(n),1,"day")}if(a<e){var m=e-a;a+=(r=this._addMinutesUntilHourEnd(n,m)).added,n=r.end}return n},getClosestWorkTime:function(){var t=this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper,arguments);return this._getClosestWorkTime(t.date,t.unit,t.dir)},_getClosestWorkTime:function(t,e,i){var n=new Date(t);if(this._isWorkTime(n,e))return n;if(n=this.$gantt.date[e+"_start"](n),"any"!=i&&i)n="past"==i?this._getClosestWorkTimePast(n,e):this._getClosestWorkTimeFuture(n,e);else{var a=this._getClosestWorkTimeFuture(n,e),r=this._getClosestWorkTimePast(n,e);n=Math.abs(a-t)<=Math.abs(t-r)?a:r}return n},_getClosestWorkTimeFuture:function(t,e){return this._getClosestWorkTimeGeneric(t,e,1)},_getClosestWorkTimePast:function(t,e){var i=this._getClosestWorkTimeGeneric(t,e,-1);return this.$gantt.date.add(i,1,e)},_findClosestTimeInDay:function(t,e,i){var n=new Date(t),a=null,r=!1;this._getWorkHours(n).length||(n=this._getClosestWorkTime(n,"day",e<0?"past":"future"),e<0&&(n=new Date(n.valueOf()-1),r=!0),i=this._getWorkHours(n));var s=this._getTimeOfDayStamp(n);if(r&&(s=this._getTimeOfDayStamp(new Date(n.valueOf()+1),r)),e>0){for(var o=0;o<i.length;o++)if(i[o].start>=s){a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,i[o].start);break}}else for(o=i.length-1;o>=0;o--){if(i[o].end<=s){a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,i[o].end);break}if(i[o].end>s&&i[o].start<=s){a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,s);break}}return a},_getClosestWorkMinute:function(t,e,i){var n=new Date(t),a=this._getWorkHours(n),r=this._findClosestTimeInDay(n,i,a);return r||(i>0?(n=this.calculateEndDate(n,i,e),n=this.$gantt.date.day_start(n)):(n=this.calculateEndDate(n,i,"day"),n=this.$gantt.date.day_start(n),n=this.$gantt.date.add(n,1,"day"),n=new Date(n.valueOf()-1)),a=this._getWorkHours(n),r=this._findClosestTimeInDay(n,i,a)),i<0&&(r=this.$gantt.date.add(r,-1,e)),r},_getClosestWorkTimeGeneric:function(t,e,i){if("hour"===e||"minute"===e)return this._getClosestWorkMinute(t,e,i);for(var n=this._getUnitOrder(e),a=this.units[n-1],r=t,s=0;!this._isWorkTime(r,e)&&(!a||this._isWorkTime(r,a)||(r=i>0?this._getClosestWorkTimeFuture(r,a):this._getClosestWorkTimePast(r,a),!this._isWorkTime(r,e)));){if(++s>3e3)return this.$gantt.assert(!1,"Invalid working time check"),!1;var o=r.getTimezoneOffset();r=this.$gantt.date.add(r,i,e),r=this.$gantt._correct_dst_change(r,o,i,e),this.$gantt.date[e+"_start"]&&(r=this.$gantt.date[e+"_start"](r))}return r},hasWorkTime:function(){var t=this.getConfig(),e=t.dates;for(var i in t.dates);var n=this._checkWorkHours(t.hours),a=!1;return[0,1,2,3,4,5,6].forEach(function(t){if(!a){var i=e[t];!0===i?a=n:Array.isArray(i)&&(a=this._checkWorkHours(i))}}.bind(this)),a},_checkWorkHours:function(t){if(0===t.length)return!1;for(var e=!1,i=0;i<t.length;i+=2)t[i]!==t[i+1]&&(e=!0);return e},_isMinutePrecision:function(t){let e=!1;return this._getWorkHours(t).forEach((function(t){(t.startMinute%60||t.endMinute%60)&&(e=!0)})),e}};const be={isLegacyResourceCalendarFormat:function(t){if(!t)return!1;for(var e in t)if(t[e]&&"object"==typeof t[e])return!0;return!1},getResourceProperty:function(t){var e=t.resource_calendars,i=t.resource_property;if(this.isLegacyResourceCalendarFormat(e))for(var n in t){i=n;break}return i},getCalendarIdFromLegacyConfig:function(t,e){if(e)for(var i in e){var n=e[i];if(t[i]){var a=n[t[i]];if(a)return a}}return null}},xe=($e={},{getCalendarIdFromMultipleResources:function(t,e){var i=t.map((function(t){return t&&t.resource_id?t.resource_id:t})).sort().join("-");if(t.length){if(1===t.length)return e.getResourceCalendar(i).id;if($e[i])return $e[i].id;var n=function(t,e){return e.mergeCalendars(t.map((function(t){var i=t&&t.resource_id?t.resource_id:t;return e.getResourceCalendar(i)})))}(t,e);return $e[i]=n,e.addCalendar(n)}return null}});var $e;function we(t){this.$gantt=t,this._calendars={},this._legacyConfig=void 0,this.$gantt.attachEvent("onGanttReady",function(){this.$gantt.config.resource_calendars&&(this._isLegacyConfig=be.isLegacyResourceCalendarFormat(this.$gantt.config.resource_calendars))}.bind(this)),this.$gantt.attachEvent("onBeforeGanttReady",function(){this.createDefaultCalendars()}.bind(this)),this.$gantt.attachEvent("onBeforeGanttRender",function(){this.createDefaultCalendars()}.bind(this))}function Se(t,e){this.argumentsHelper=e,this.$gantt=t}function Te(t){this.$gantt=t.$gantt,this.argumentsHelper=ge(this.$gantt),this.calendarManager=t,this.$disabledCalendar=new Se(this.$gantt,this.argumentsHelper)}we.prototype={_calendars:{},_convertWorkTimeSettings:function(t){var e=t.days;if(e&&!t.dates){t.dates=t.dates||{};for(var i=0;i<e.length;i++)t.dates[i]=e[i],e[i]instanceof Array||(t.dates[i]=!!e[i])}return delete t.days,t},mergeCalendars:function(){var t=[],e=arguments;if(Array.isArray(e[0]))t=e[0].slice();else for(var i=0;i<arguments.length;i++)t.push(arguments[i]);var n,a=new fe;return t.forEach(function(t){n=n?this._createCalendarFromConfig(a.merge(n,t)):t}.bind(this)),this.createCalendar(n)},_createCalendarFromConfig:function(t){var e=new ye(this.$gantt,ge(this.$gantt));e.id=String(tt());var i=this._convertWorkTimeSettings(t);if(i.customWeeks)for(var n in i.customWeeks)i.customWeeks[n]=this._convertWorkTimeSettings(i.customWeeks[n]);return e._setConfig(i),e},createCalendar:function(t){var e;return t||(t={}),Z(e=t.getConfig?X(t.getConfig()):t.worktime?X(t.worktime):X(t),X(this.defaults.fulltime.worktime)),this._createCalendarFromConfig(e)},getCalendar:function(t){t=t||"global";var e=this._calendars[t];return e||(this.createDefaultCalendars(),e=this._calendars[t]),e},getCalendars:function(){var t=[];for(var e in this._calendars)t.push(this.getCalendar(e));return t},_getOwnCalendar:function(t){var e=this.$gantt.config;if(t[e.calendar_property])return this.getCalendar(t[e.calendar_property]);if(e.resource_calendars){var i;if(i=!1===this._legacyConfig?e.resource_property:be.getResourceProperty(e),Array.isArray(t[i])&&t[i].length)e.dynamic_resource_calendars?n=xe.getCalendarIdFromMultipleResources(t[i],this):a=this.getResourceCalendar(t[i]);else if(void 0===this._legacyConfig&&(this._legacyConfig=be.isLegacyResourceCalendarFormat(e.resource_calendars)),this._legacyConfig)var n=be.getCalendarIdFromLegacyConfig(t,e.resource_calendars);else if(i&&t[i]&&e.resource_calendars[t[i]])var a=this.getResourceCalendar(t[i]);if(n&&(a=this.getCalendar(n)),a)return a}return null},getResourceCalendar:function(t){if(null==t)return this.getCalendar();var e=null;e="number"==typeof t||"string"==typeof t?t:t.id||t.key;var i=this.$gantt.config,n=i.resource_calendars,a=null;if(Array.isArray(t)&&1===t.length&&(e="object"==typeof t[0]?t[0].resource_id:t[0]),n){if(void 0===this._legacyConfig&&(this._legacyConfig=be.isLegacyResourceCalendarFormat(i.resource_calendars)),this._legacyConfig){for(var r in n)if(n[r][e]){a=n[r][e];break}}else a=n[e];if(a)return this.getCalendar(a)}return this.getCalendar()},getTaskCalendar:function(t){var e,i=this.$gantt;if(null==t)return this.getCalendar();if(!(e="number"!=typeof t&&"string"!=typeof t||!i.isTaskExists(t)?t:i.getTask(t)))return this.getCalendar();var n=this._getOwnCalendar(e),a=!!i.getState().group_mode;if(!n&&i.config.inherit_calendar&&i.isTaskExists(e.parent)){for(var r=e;i.isTaskExists(r.parent)&&(r=i.getTask(r.parent),!i.isSummaryTask(r)||!(n=this._getOwnCalendar(r))););a&&!n&&t.$effective_calendar&&(n=this.getCalendar(t.$effective_calendar))}return n||this.getCalendar()},addCalendar:function(t){if(!this.isCalendar(t)){var e=t.id;(t=this.createCalendar(t)).id=e}if(t._tryChangeCalendarSettings((function(){}))){var i=this.$gantt.config;return t.id=t.id||tt(),this._calendars[t.id]=t,i.worktimes||(i.worktimes={}),i.worktimes[t.id]=t.getConfig(),t.id}return this.$gantt.callEvent("onCalendarError",[{message:"Invalid calendar settings, no worktime available"},t]),null},deleteCalendar:function(t){var e=this.$gantt.config;return!!t&&!!this._calendars[t]&&(delete this._calendars[t],e.worktimes&&e.worktimes[t]&&delete e.worktimes[t],!0)},restoreConfigCalendars:function(t){for(var e in t)if(!this._calendars[e]){var i=t[e],n=this.createCalendar(i);n.id=e,this.addCalendar(n)}},defaults:{global:{id:"global",worktime:{hours:[8,12,13,17],days:[0,1,1,1,1,1,0]}},fulltime:{id:"fulltime",worktime:{hours:[0,24],days:[1,1,1,1,1,1,1]}}},createDefaultCalendars:function(){var t=this.$gantt.config;this.restoreConfigCalendars(this.defaults),this.restoreConfigCalendars(t.worktimes)},isCalendar:function(t){return[t.isWorkTime,t.setWorkTime,t.getWorkHours,t.unsetWorkTime,t.getClosestWorkTime,t.calculateDuration,t.hasDuration,t.calculateEndDate].every((function(t){return t instanceof Function}))}},Se.prototype={getWorkHours:function(){return[0,24]},setWorkTime:function(){return!0},unsetWorkTime:function(){return!0},isWorkTime:function(){return!0},getClosestWorkTime:function(t){return this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper,arguments).date},calculateDuration:function(){var t=this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper,arguments),e=t.start_date,i=t.end_date,n=t.unit,a=t.step;return this._calculateDuration(e,i,n,a)},_calculateDuration:function(t,e,i,n){var a=this.$gantt.date,r={week:6048e5,day:864e5,hour:36e5,minute:6e4},s=0;if(r[i])s=Math.round((e-t)/(n*r[i]));else{for(var o=new Date(t),l=new Date(e);o.valueOf()<l.valueOf();)s+=1,o=a.add(o,n,i);o.valueOf()!=e.valueOf()&&(s+=(l-o)/(a.add(o,n,i)-o))}return Math.round(s)},hasDuration:function(){var t=this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper,arguments),e=t.start_date,i=t.end_date;return!!t.unit&&(e=new Date(e),i=new Date(i),e.valueOf()<i.valueOf())},hasWorkTime:function(){return!0},equals:function(t){return t instanceof Se},calculateEndDate:function(){var t=this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper,arguments),e=t.start_date,i=t.duration,n=t.unit,a=t.step;return this.$gantt.date.add(e,a*i,n)}},Te.prototype={_getCalendar:function(t){var e;if(this.$gantt.config.work_time){var i=this.calendarManager;t.task?e=i.getTaskCalendar(t.task):t.id?e=i.getTaskCalendar(t):t.calendar&&(e=t.calendar),e||(e=i.getTaskCalendar())}else e=this.$disabledCalendar;return e},getWorkHours:function(t){return t=this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper,arguments),this._getCalendar(t).getWorkHours(t.date)},setWorkTime:function(t,e){return t=this.argumentsHelper.setWorkTimeArguments.apply(this.argumentsHelper,arguments),e||(e=this.calendarManager.getCalendar()),e.setWorkTime(t)},unsetWorkTime:function(t,e){return t=this.argumentsHelper.unsetWorkTimeArguments.apply(this.argumentsHelper,arguments),e||(e=this.calendarManager.getCalendar()),e.unsetWorkTime(t)},isWorkTime:function(t,e,i,n){var a=this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper,arguments);return(n=this._getCalendar(a)).isWorkTime(a)},getClosestWorkTime:function(t){return t=this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper,arguments),this._getCalendar(t).getClosestWorkTime(t)},calculateDuration:function(){var t=this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper,arguments);return this._getCalendar(t).calculateDuration(t)},hasDuration:function(){var t=this.argumentsHelper.hasDurationArguments.apply(this.argumentsHelper,arguments);return this._getCalendar(t).hasDuration(t)},calculateEndDate:function(t){return t=this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper,arguments),this._getCalendar(t).calculateEndDate(t)}};function Ee(t){t.isUnscheduledTask=function(e){return t.assert(e&&e instanceof Object,"Invalid argument <b>task</b>="+e+" of gantt.isUnscheduledTask. Task object was expected"),!!e.unscheduled||!e.start_date},t._isAllowedUnscheduledTask=function(e){return!(!e.unscheduled||!t.config.show_unscheduled)},t._isTaskInTimelineLimits=function(t){var e=t.start_date?t.start_date.valueOf():null,i=t.end_date?t.end_date.valueOf():null;return!!(e&&i&&e<=this._max_date.valueOf()&&i>=this._min_date.valueOf())},t.isTaskVisible=function(t){if(!this.isTaskExists(t))return!1;var e=this.getTask(t);return!(!this._isAllowedUnscheduledTask(e)&&!this._isTaskInTimelineLimits(e))&&this.getGlobalTaskIndex(t)>=0},t._getProjectEnd=function(){if(t.config.project_end)return t.config.project_end;var e=t.getTaskByTime();return(e=e.sort((function(t,e){return+t.end_date>+e.end_date?1:-1}))).length?e[e.length-1].end_date:null},t._getProjectStart=function(){if(t.config.project_start)return t.config.project_start;if(t.config.start_date)return t.config.start_date;if(t.getState().min_date)return t.getState().min_date;var e=t.getTaskByTime();return(e=e.sort((function(t,e){return+t.start_date>+e.start_date?1:-1}))).length?e[0].start_date:null};var e=function(i,n){var a=!(!n||n==t.config.root_id||!t.isTaskExists(n))&&t.getTask(n),r=null;if(a)if(t.config.schedule_from_end)r=t.calculateEndDate({start_date:a.end_date,duration:-t.config.duration_step,task:i});else{if(!a.start_date)return e(a,t.getParent(a));r=a.start_date}else if(t.config.schedule_from_end)r=t.calculateEndDate({start_date:t._getProjectEnd(),duration:-t.config.duration_step,task:i});else{const e=t.getTaskByIndex(0),n=t.config.start_date||t.getState().min_date;r=e?e.start_date?e.start_date:e.end_date?t.calculateEndDate({start_date:e.end_date,duration:-t.config.duration_step,task:i}):n:n}return t.assert(r,"Invalid dates"),new Date(r)};t._set_default_task_timing=function(i){i.start_date=i.start_date||e(i,t.getParent(i)),i.duration=i.duration||t.config.duration_step,i.end_date=i.end_date||t.calculateEndDate(i)},t.createTask=function(i,n,a){if(i=i||{},t.defined(i.id)||(i.id=t.uid()),i.start_date||(i.start_date=e(i,n)),void 0===i.text&&(i.text=t.locale.labels.new_task),void 0===i.duration&&(i.duration=1),this.isTaskExists(n)){this.setParent(i,n,!0);var r=this.getTask(n);r.$open=!0,this.config.details_on_create||this.callEvent("onAfterParentExpand",[n,r])}return this.callEvent("onTaskCreated",[i])?(this.config.details_on_create?(t.isTaskExists(i.id)?t.getTask(i.id).$index!=i.$index&&(i.start_date&&"string"==typeof i.start_date&&(i.start_date=this.date.parseDate(i.start_date,"parse_date")),i.end_date&&"string"==typeof i.end_date&&(i.end_date=this.date.parseDate(i.end_date,"parse_date")),this.$data.tasksStore.updateItem(i.id,i)):(i.$new=!0,this.silent((function(){t.$data.tasksStore.addItem(i,a)}))),this.selectTask(i.id),this.refreshData(),this.showLightbox(i.id)):this.addTask(i,n,a)&&(this.showTask(i.id),this.selectTask(i.id)),i.id):null},t._update_flags=function(e,i){var n=t.$data.tasksStore;void 0===e?(this._lightbox_id=null,n.silent((function(){n.unselect()})),this.getSelectedTasks&&this._multiselect.reset(),this._tasks_dnd&&this._tasks_dnd.drag&&(this._tasks_dnd.drag.id=null)):(this._lightbox_id==e&&(this._lightbox_id=i),n.getSelectedId()==e&&n.silent((function(){n.unselect(e),n.select(i)})),this._tasks_dnd&&this._tasks_dnd.drag&&this._tasks_dnd.drag.id==e&&(this._tasks_dnd.drag.id=i))};var i=function(e,i){var n=t.getTaskType(e.type),a={type:n,$no_start:!1,$no_end:!1,scheduled_summary:!1};return n===t.config.types.project&&!1===e.auto_scheduling&&(a.scheduled_summary=!0),i||n!=e.$rendered_type?(n==t.config.types.project?a.$no_end=a.$no_start=!0:n!=t.config.types.milestone&&(a.$no_end=!(e.end_date||e.duration),a.$no_start=!e.start_date,t._isAllowedUnscheduledTask(e)&&(a.$no_end=a.$no_start=!1)),a):(a.$no_start=e.$no_start,a.$no_end=e.$no_end,a)};function n(e){e.$effective_calendar=t.getTaskCalendar(e).id,e.start_date=t.getClosestWorkTime({dir:"future",date:e.start_date,unit:t.config.duration_unit,task:e}),e.end_date=t.calculateEndDate(e)}function a(i,n,a,r){let s;s=i.type===t.config.types.project&&!1===i.auto_scheduling?{start:"$auto_start_date",end:"$auto_end_date"}:{start:"start_date",end:"end_date"},n.$no_start&&(i[s.start]=a?new Date(a):e(i,this.getParent(i))),n.$no_end&&(i[s.end]=r?new Date(r):this.calculateEndDate({start_date:i[s.start],duration:this.config.duration_step,task:i})),(n.$no_start||n.$no_end)&&this._init_task_timing(i)}function r(e){var i=null,n=null,a=void 0!==e?e:t.config.root_id,r=[];return t.eachTask((function(e){const a=t.getTaskType(e.type)==t.config.types.project&&!1===e.auto_scheduling;t.getTaskType(e.type)==t.config.types.project&&!a||t.isUnscheduledTask(e)||(e.rollup&&r.push(e.id),!e.start_date||e.$no_start&&!a||i&&!(i>e.start_date.valueOf())||(i=e.start_date.valueOf()),!e.end_date||e.$no_end&&!a||n&&!(n<e.end_date.valueOf())||(n=e.end_date.valueOf()))}),a),{start_date:i?new Date(i):null,end_date:n?new Date(n):null,rollup:r}}t._init_task_timing=function(e){var a=i(e,!0),r=e.$rendered_type!=a.type,s=a.type;r&&(e.$no_start=a.$no_start,e.$no_end=a.$no_end,e.$rendered_type=a.type),r&&s!=this.config.types.milestone&&s==this.config.types.project&&(this._set_default_task_timing(e),e.$calculate_duration=!1),s==this.config.types.milestone&&(e.end_date=e.start_date),e.start_date&&e.end_date&&!1!==e.$calculate_duration&&(e.duration=this.calculateDuration(e)),e.$calculate_duration||(e.$calculate_duration=!0),e.end_date||(e.end_date=e.start_date),e.duration=e.duration||0,0===this.config.min_duration&&0===e.duration&&(e.$no_end=!1,e.type===t.config.types.project&&t.hasChild(e.id)&&(e.$no_end=!0));var o=this.getTaskCalendar(e);e.$effective_calendar&&e.$effective_calendar!==o.id&&(n(e),this.config.inherit_calendar&&this.isSummaryTask(e)&&this.eachTask((function(t){n(t)}),e.id)),e.$effective_calendar=o.id},t.isSummaryTask=function(e){t.assert(e&&e instanceof Object,"Invalid argument <b>task</b>="+e+" of gantt.isSummaryTask. Task object was expected");var n=i(e);return!(!n.$no_end&&!n.$no_start)},t.resetProjectDates=function(t){var e=i(t);if(e.$no_end||e.$no_start){var n=r(t.id);a.call(this,t,e,n.start_date,n.end_date),t.$rollup=n.rollup}},t.getSubtaskDuration=function(e){var i=0,n=void 0!==e?e:t.config.root_id;return this.eachTask((function(e){this.getTaskType(e.type)==t.config.types.project||this.isUnscheduledTask(e)||(i+=e.duration)}),n),i},t.getSubtaskDates=function(t){var e=r(t);return{start_date:e.start_date,end_date:e.end_date}},t._update_parents=function(e,n,a){if(e){var r=this.getTask(e);r.rollup&&(a=!0);var s=this.getParent(r),o=i(r),l=!0;if(a||r.start_date&&r.end_date&&(o.$no_start||o.$no_end)){const e=r.$auto_start_date?"$auto_start_date":"start_date",i=r.$auto_end_date?"$auto_end_date":"end_date";var d=r[e].valueOf(),c=r[i].valueOf();t.resetProjectDates(r),a||d!=r[e].valueOf()||c!=r[i].valueOf()||(l=!1),l&&!n&&this.refreshTask(r.id,!0),o.scheduled_summary&&(l=!0)}l&&s&&this.isTaskExists(s)&&this._update_parents(s,n,a)}},t.roundDate=function(e){var i=t.getScale();B(e)&&(e={date:e,unit:i?i.unit:t.config.duration_unit,step:i?i.step:t.config.duration_step});var n,a,r,s=e.date,o=e.step,l=e.unit;if(!i)return s;if(l==i.unit&&o==i.step&&+s>=+i.min_date&&+s<=+i.max_date)r=Math.floor(t.columnIndexByDate(s)),i.trace_x[r]||(r-=1,i.rtl&&(r=0)),a=new Date(i.trace_x[r]),n=t.date.add(a,o,l);else{for(r=Math.floor(t.columnIndexByDate(s)),n=t.date[l+"_start"](new Date(i.min_date)),i.trace_x[r]&&(n=t.date[l+"_start"](i.trace_x[r]));+n<+s;){var d=(n=t.date[l+"_start"](t.date.add(n,o,l))).getTimezoneOffset();n=t._correct_dst_change(n,d,n,l),t.date[l+"_start"]&&(n=t.date[l+"_start"](n))}a=t.date.add(n,-1*o,l)}return e.dir&&"future"==e.dir?n:e.dir&&"past"==e.dir||Math.abs(s-a)<Math.abs(n-s)?a:n},t.correctTaskWorkTime=function(e){t.config.work_time&&t.config.correct_work_time&&(this.isWorkTime(e.start_date,void 0,e)?this.isWorkTime(new Date(+e.end_date-1),void 0,e)||(e.end_date=this.calculateEndDate(e)):(e.start_date=this.getClosestWorkTime({date:e.start_date,dir:"future",task:e}),e.end_date=this.calculateEndDate(e)))},t.attachEvent("onBeforeTaskUpdate",(function(e,i){return t._init_task_timing(i),!0})),t.attachEvent("onBeforeTaskAdd",(function(e,i){return t._init_task_timing(i),!0})),t.attachEvent("onAfterTaskMove",(function(e,i,n){return t._init_task_timing(t.getTask(e)),!0}))}function Ce(t,e){var i,n=t.config.container_resize_timeout||20;let a=De(t);if("timeout"==t.config.container_resize_method)l();else try{t.event(e,"resize",(function(){if(t.$scrollbarRepaint)t.$scrollbarRepaint=null;else{let e=De(t);if(a.x==e.x&&a.y==e.y)return;a=e,r()}}))}catch{l()}function r(){clearTimeout(i),i=setTimeout((function(){t.$destroyed||t.render()}),n)}var s=t.$root.offsetHeight,o=t.$root.offsetWidth;function l(){t.$root.offsetHeight==s&&t.$root.offsetWidth==o||r(),s=t.$root.offsetHeight,o=t.$root.offsetWidth,setTimeout(l,n)}}function De(t){return{x:t.$root.offsetWidth,y:t.$root.offsetHeight}}const Ae={date:{month_full:["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],month_short:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],day_full:["الأحد","الأثنين","ألثلاثاء","الأربعاء","ألحميس","ألجمعة","السبت"],day_short:["احد","اثنين","ثلاثاء","اربعاء","خميس","جمعة","سبت"]},labels:{new_task:"مهمة جديد",icon_save:"اخزن",icon_cancel:"الغاء",icon_details:"تفاصيل",icon_edit:"تحرير",icon_delete:"حذف",confirm_closing:"التغييرات سوف تضيع, هل انت متأكد؟",confirm_deleting:"الحدث سيتم حذفها نهائيا ، هل أنت متأكد؟",section_description:"الوصف",section_time:"الفترة الزمنية",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"الغاء",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ie={date:{month_full:["Студзень","Люты","Сакавік","Красавік","Maй","Чэрвень","Ліпень","Жнівень","Верасень","Кастрычнік","Лістапад","Снежань"],month_short:["Студз","Лют","Сак","Крас","Maй","Чэр","Ліп","Жнів","Вер","Каст","Ліст","Снеж"],day_full:["Нядзеля","Панядзелак","Аўторак","Серада","Чацвер","Пятніца","Субота"],day_short:["Нд","Пн","Аўт","Ср","Чцв","Пт","Сб"]},labels:{new_task:"Новае заданне",icon_save:"Захаваць",icon_cancel:"Адмяніць",icon_details:"Дэталі",icon_edit:"Змяніць",icon_delete:"Выдаліць",confirm_closing:"",confirm_deleting:"Падзея будзе выдалена незваротна, працягнуць?",section_description:"Апісанне",section_time:"Перыяд часу",section_type:"Тып",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"ІСР",column_text:"Задача",column_start_date:"Пачатак",column_duration:"Працяг",column_add:"",link:"Сувязь",confirm_link_deleting:"будзе выдалена",link_start:"(пачатак)",link_end:"(канец)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Хвiлiна",hours:"Гадзiна",days:"Дзень",weeks:"Тыдзень",months:"Месяц",years:"Год",message_ok:"OK",message_cancel:"Адмяніць",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Me={date:{month_full:["Gener","Febrer","Març","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],month_short:["Gen","Feb","Mar","Abr","Mai","Jun","Jul","Ago","Set","Oct","Nov","Des"],day_full:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte"],day_short:["Dg","Dl","Dm","Dc","Dj","Dv","Ds"]},labels:{new_task:"Nova tasca",icon_save:"Guardar",icon_cancel:"Cancel·lar",icon_details:"Detalls",icon_edit:"Editar",icon_delete:"Esborrar",confirm_closing:"",confirm_deleting:"L'esdeveniment s'esborrarà definitivament, continuar ?",section_description:"Descripció",section_time:"Periode de temps",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Cancel·lar",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ne={date:{month_full:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],month_short:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],day_full:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],day_short:["日","一","二","三","四","五","六"]},labels:{new_task:"新任務",icon_save:"保存",icon_cancel:"关闭",icon_details:"详细",icon_edit:"编辑",icon_delete:"删除",confirm_closing:"请确认是否撤销修改!",confirm_deleting:"是否删除日程?",section_description:"描述",section_time:"时间范围",section_type:"类型",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"工作分解结构",column_text:"任务名",column_start_date:"开始时间",column_duration:"持续时间",column_add:"",link:"关联",confirm_link_deleting:"将被删除",link_start:" (开始)",link_end:" (结束)",type_task:"任务",type_project:"项目",type_milestone:"里程碑",minutes:"分钟",hours:"小时",days:"天",weeks:"周",months:"月",years:"年",message_ok:"OK",message_cancel:"关闭",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Le={date:{month_full:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],month_short:["Led","Ún","Bře","Dub","Kvě","Čer","Čec","Srp","Září","Říj","List","Pro"],day_full:["Neděle","Pondělí","Úterý","Středa","Čtvrtek","Pátek","Sobota"],day_short:["Ne","Po","Út","St","Čt","Pá","So"]},labels:{new_task:"Nová práce",icon_save:"Uložit",icon_cancel:"Zpět",icon_details:"Detail",icon_edit:"Edituj",icon_delete:"Smazat",confirm_closing:"",confirm_deleting:"Událost bude trvale smazána, opravdu?",section_description:"Poznámky",section_time:"Doba platnosti",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Zpět",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Pe={date:{month_full:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"],day_short:["Søn","Man","Tir","Ons","Tor","Fre","Lør"]},labels:{new_task:"Ny opgave",icon_save:"Gem",icon_cancel:"Fortryd",icon_details:"Detaljer",icon_edit:"Tilret",icon_delete:"Slet",confirm_closing:"Dine rettelser vil gå tabt.. Er dy sikker?",confirm_deleting:"Bigivenheden vil blive slettet permanent. Er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Fortryd",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Re={date:{month_full:[" Januar"," Februar"," März "," April"," Mai"," Juni"," Juli"," August"," September "," Oktober"," November "," Dezember"],month_short:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],day_full:["Sonntag","Montag","Dienstag"," Mittwoch"," Donnerstag","Freitag","Samstag"],day_short:["So","Mo","Di","Mi","Do","Fr","Sa"]},labels:{new_task:"Neue Aufgabe",icon_save:"Speichern",icon_cancel:"Abbrechen",icon_details:"Details",icon_edit:"Ändern",icon_delete:"Löschen",confirm_closing:"",confirm_deleting:"Der Eintrag wird gelöscht",section_description:"Beschreibung",section_time:"Zeitspanne",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"PSP",column_text:"Task-Namen",column_start_date:"Startzeit",column_duration:"Dauer",column_add:"",link:"Link",confirm_link_deleting:"werden gelöscht",link_start:"(starten)",link_end:"(ende)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minuten",hours:"Stunden",days:"Tage",weeks:"Wochen",months:"Monate",years:"Jahre",message_ok:"OK",message_cancel:"Abbrechen",section_constraint:"Regel",constraint_type:"Regel",constraint_date:"Regel - Datum",asap:"So bald wie möglich",alap:"So spät wie möglich",snet:"Beginn nicht vor",snlt:"Beginn nicht später als",fnet:"Fertigstellung nicht vor",fnlt:"Fertigstellung nicht später als",mso:"Muss beginnen am",mfo:"Muss fertig sein am",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},He={date:{month_full:["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάϊος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],month_short:["ΙΑΝ","ΦΕΒ","ΜΑΡ","ΑΠΡ","ΜΑΙ","ΙΟΥΝ","ΙΟΥΛ","ΑΥΓ","ΣΕΠ","ΟΚΤ","ΝΟΕ","ΔΕΚ"],day_full:["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Κυριακή"],day_short:["ΚΥ","ΔΕ","ΤΡ","ΤΕ","ΠΕ","ΠΑ","ΣΑ"]},labels:{new_task:"Νέα εργασία",icon_save:"Αποθήκευση",icon_cancel:"Άκυρο",icon_details:"Λεπτομέρειες",icon_edit:"Επεξεργασία",icon_delete:"Διαγραφή",confirm_closing:"",confirm_deleting:"Το έργο θα διαγραφεί οριστικά. Θέλετε να συνεχίσετε;",section_description:"Περιγραφή",section_time:"Χρονική περίοδος",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Άκυρο",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Oe={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{new_task:"New task",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Task will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Cancel",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Be={date:{month_full:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],month_short:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],day_full:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],day_short:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"]},labels:{new_task:"Nueva tarea",icon_save:"Guardar",icon_cancel:"Cancelar",icon_details:"Detalles",icon_edit:"Editar",icon_delete:"Eliminar",confirm_closing:"",confirm_deleting:"El evento se borrará definitivamente, ¿continuar?",section_description:"Descripción",section_time:"Período",section_type:"Tipo",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"EDT",column_text:"Tarea",column_start_date:"Inicio",column_duration:"Duración",column_add:"",link:"Enlace",confirm_link_deleting:"será borrada",link_start:" (inicio)",link_end:" (fin)",type_task:"Tarea",type_project:"Proyecto",type_milestone:"Hito",minutes:"Minutos",hours:"Horas",days:"Días",weeks:"Semanas",months:"Meses",years:"Años",message_ok:"OK",message_cancel:"Cancelar",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ze={date:{month_full:["ژانویه","فوریه","مارس","آوریل","مه","ژوئن","ژوئیه","اوت","سپتامبر","اکتبر","نوامبر","دسامبر"],month_short:["1","2","3","4","5","6","7","8","9","10","11","12"],day_full:["يکشنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنجشنبه","جمعه","شنبه"],day_short:["ی","د","س","چ","پ","ج","ش"]},labels:{new_task:"وظیفه جدید",icon_save:"ذخیره",icon_cancel:"لغو",icon_details:"جزییات",icon_edit:"ویرایش",icon_delete:"حذف",confirm_closing:"تغییرات شما ازدست خواهد رفت، آیا مطمئن هستید؟",confirm_deleting:"این مورد برای همیشه حذف خواهد شد، آیا مطمئن هستید؟",section_description:"توضیحات",section_time:"مدت زمان",section_type:"نوع",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"عنوان",column_start_date:"زمان شروع",column_duration:"مدت",column_add:"",link:"ارتباط",confirm_link_deleting:"حذف خواهد شد",link_start:" (آغاز)",link_end:" (پایان)",type_task:"وظیفه",type_project:"پروژه",type_milestone:"نگارش",minutes:"دقایق",hours:"ساعات",days:"روزها",weeks:"هفته",months:"ماه‌ها",years:"سال‌ها",message_ok:"تایید",message_cancel:"لغو",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},We={date:{month_full:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kes&auml;kuu","Hein&auml;kuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],month_short:["Tam","Hel","Maa","Huh","Tou","Kes","Hei","Elo","Syy","Lok","Mar","Jou"],day_full:["Sunnuntai","Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai"],day_short:["Su","Ma","Ti","Ke","To","Pe","La"]},labels:{new_task:"Uusi tehtävä",icon_save:"Tallenna",icon_cancel:"Peru",icon_details:"Tiedot",icon_edit:"Muokkaa",icon_delete:"Poista",confirm_closing:"",confirm_deleting:"Haluatko varmasti poistaa tapahtuman?",section_description:"Kuvaus",section_time:"Aikajakso",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Peru",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},je={date:{month_full:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],month_short:["Jan","Fév","Mar","Avr","Mai","Juin","Juil","Aoû","Sep","Oct","Nov","Déc"],day_full:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],day_short:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},labels:{new_task:"Nouvelle tâche",icon_save:"Enregistrer",icon_cancel:"Annuler",icon_details:"Détails",icon_edit:"Modifier",icon_delete:"Effacer",confirm_closing:"",confirm_deleting:"L'événement sera effacé sans appel, êtes-vous sûr ?",section_description:"Description",section_time:"Période",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"OTP",column_text:"Nom de la tâche",column_start_date:"Date initiale",column_duration:"Durée",column_add:"",link:"Le lien",confirm_link_deleting:"sera supprimé",link_start:"(début)",link_end:"(fin)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Heures",days:"Jours",weeks:"Semaines",months:"Mois",years:"Années",message_ok:"OK",message_cancel:"Annuler",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Fe={date:{month_full:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],month_short:["ינו","פבר","מרץ","אפר","מאי","יונ","יול","אוג","ספט","אוק","נוב","דצמ"],day_full:["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"],day_short:["א","ב","ג","ד","ה","ו","ש"]},labels:{new_task:"משימה חדש",icon_save:"שמור",icon_cancel:"בטל",icon_details:"פרטים",icon_edit:"ערוך",icon_delete:"מחק",confirm_closing:"",confirm_deleting:"ארוע ימחק סופית.להמשיך?",section_description:"הסבר",section_time:"תקופה",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"בטל",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ve={date:{month_full:["Siječanj","Veljača","Ožujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],month_short:["Sij","Velj","Ožu","Tra","Svi","Lip","Srp","Kol","Ruj","Lis","Stu","Pro"],day_full:["Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota"],day_short:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"]},labels:{new_task:"Novi Zadatak",icon_save:"Spremi",icon_cancel:"Odustani",icon_details:"Detalji",icon_edit:"Izmjeni",icon_delete:"Obriši",confirm_closing:"",confirm_deleting:"Zadatak će biti trajno izbrisan, jeste li sigurni?",section_description:"Opis",section_time:"Vremenski Period",section_type:"Tip",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Naziv Zadatka",column_start_date:"Početno Vrijeme",column_duration:"Trajanje",column_add:"",link:"Poveznica",confirm_link_deleting:"će biti izbrisan",link_start:" (početak)",link_end:" (kraj)",type_task:"Zadatak",type_project:"Projekt",type_milestone:"Milestone",minutes:"Minute",hours:"Sati",days:"Dani",weeks:"Tjedni",months:"Mjeseci",years:"Godine",message_ok:"OK",message_cancel:"Odustani",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ue={date:{month_full:["Január","Február","Március","Április","Május","Június","Július","Augusztus","Szeptember","Október","November","December"],month_short:["Jan","Feb","Már","Ápr","Máj","Jún","Júl","Aug","Sep","Okt","Nov","Dec"],day_full:["Vasárnap","Hétfõ","Kedd","Szerda","Csütörtök","Péntek","szombat"],day_short:["Va","Hé","Ke","Sze","Csü","Pé","Szo"]},labels:{new_task:"Új feladat",icon_save:"Mentés",icon_cancel:"Mégse",icon_details:"Részletek",icon_edit:"Szerkesztés",icon_delete:"Törlés",confirm_closing:"",confirm_deleting:"Az esemény törölve lesz, biztosan folytatja?",section_description:"Leírás",section_time:"Idõszak",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Mégse",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},qe={date:{month_full:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Ags","Sep","Okt","Nov","Des"],day_full:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],day_short:["Ming","Sen","Sel","Rab","Kam","Jum","Sab"]},labels:{new_task:"Tugas baru",icon_save:"Simpan",icon_cancel:"Batal",icon_details:"Detail",icon_edit:"Edit",icon_delete:"Hapus",confirm_closing:"",confirm_deleting:"Acara akan dihapus",section_description:"Keterangan",section_time:"Periode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Batal",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ge={date:{month_full:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],month_short:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],day_full:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"],day_short:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"]},labels:{new_task:"Nuovo compito",icon_save:"Salva",icon_cancel:"Chiudi",icon_details:"Dettagli",icon_edit:"Modifica",icon_delete:"Elimina",confirm_closing:"",confirm_deleting:"Sei sicuro di confermare l'eliminazione?",section_description:"Descrizione",section_time:"Periodo di tempo",section_type:"Tipo",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Nome Attività",column_start_date:"Inizio",column_duration:"Durata",column_add:"",link:"Link",confirm_link_deleting:"sarà eliminato",link_start:" (inizio)",link_end:" (fine)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minuti",hours:"Ore",days:"Giorni",weeks:"Settimane",months:"Mesi",years:"Anni",message_ok:"OK",message_cancel:"Chiudi",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ye={date:{month_full:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],month_short:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],day_full:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],day_short:["日","月","火","水","木","金","土"]},labels:{new_task:"新しい仕事",icon_save:"保存",icon_cancel:"キャンセル",icon_details:"詳細",icon_edit:"編集",icon_delete:"削除",confirm_closing:"",confirm_deleting:"イベント完全に削除されます、宜しいですか？",section_description:"デスクリプション",section_time:"期間",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"キャンセル",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Je={date:{month_full:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],month_short:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],day_full:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],day_short:["일","월","화","수","목","금","토"]},labels:{new_task:"이름없는 작업",icon_save:"저장",icon_cancel:"취소",icon_details:"세부 사항",icon_edit:"수정",icon_delete:"삭제",confirm_closing:"",confirm_deleting:"작업을 삭제하시겠습니까?",section_description:"설명",section_time:"기간",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"작업명",column_start_date:"시작일",column_duration:"기간",column_add:"",link:"전제",confirm_link_deleting:"삭제 하시겠습니까?",link_start:" (start)",link_end:" (end)",type_task:"작업",type_project:"프로젝트",type_milestone:"마일스톤",minutes:"분",hours:"시간",days:"일",weeks:"주",months:"달",years:"년",message_ok:"OK",message_cancel:"취소",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}};class Ke{constructor(t){this.addLocale=(t,e)=>{this._locales[t]=e},this.getLocale=t=>this._locales[t],this._locales={};for(const e in t)this._locales[e]=t[e]}}const Xe={date:{month_full:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],day_full:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"],day_short:["Søn","Mon","Tir","Ons","Tor","Fre","Lør"]},labels:{new_task:"Ny oppgave",icon_save:"Lagre",icon_cancel:"Avbryt",icon_details:"Detaljer",icon_edit:"Rediger",icon_delete:"Slett",confirm_closing:"",confirm_deleting:"Hendelsen vil bli slettet permanent. Er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Avbryt",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Ze={date:{month_full:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],month_short:["Jan","Feb","mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag"],day_short:["Zo","Ma","Di","Wo","Do","Vr","Za"]},labels:{new_task:"Nieuwe taak",icon_save:"Opslaan",icon_cancel:"Annuleren",icon_details:"Details",icon_edit:"Bewerken",icon_delete:"Verwijderen",confirm_closing:"",confirm_deleting:"Item zal permanent worden verwijderd, doorgaan?",section_description:"Beschrijving",section_time:"Tijd periode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Taak omschrijving",column_start_date:"Startdatum",column_duration:"Duur",column_add:"",link:"Koppeling",confirm_link_deleting:"zal worden verwijderd",link_start:" (start)",link_end:" (eind)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"minuten",hours:"uren",days:"dagen",weeks:"weken",months:"maanden",years:"jaren",message_ok:"OK",message_cancel:"Annuleren",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},Qe={date:{month_full:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],month_short:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],day_full:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"],day_short:["Søn","Man","Tir","Ons","Tor","Fre","Lør"]},labels:{new_task:"Ny oppgave",icon_save:"Lagre",icon_cancel:"Avbryt",icon_details:"Detaljer",icon_edit:"Endre",icon_delete:"Slett",confirm_closing:"Endringer blir ikke lagret, er du sikker?",confirm_deleting:"Oppføringen vil bli slettet, er du sikker?",section_description:"Beskrivelse",section_time:"Tidsperiode",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Avbryt",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ti={date:{month_full:["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],month_short:["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","Paź","Lis","Gru"],day_full:["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],day_short:["Nie","Pon","Wto","Śro","Czw","Pią","Sob"]},labels:{new_task:"Nowe zadanie",icon_save:"Zapisz",icon_cancel:"Anuluj",icon_details:"Szczegóły",icon_edit:"Edytuj",icon_delete:"Usuń",confirm_closing:"",confirm_deleting:"Zdarzenie zostanie usunięte na zawsze, kontynuować?",section_description:"Opis",section_time:"Okres czasu",section_type:"Typ",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Nazwa zadania",column_start_date:"Początek",column_duration:"Czas trwania",column_add:"",link:"Link",confirm_link_deleting:"zostanie usunięty",link_start:" (początek)",link_end:" (koniec)",type_task:"Zadanie",type_project:"Projekt",type_milestone:"Milestone",minutes:"Minuty",hours:"Godziny",days:"Dni",weeks:"Tydzień",months:"Miesiące",years:"Lata",message_ok:"OK",message_cancel:"Anuluj",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ei={date:{month_full:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],month_short:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],day_full:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],day_short:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]},labels:{new_task:"Nova tarefa",icon_save:"Salvar",icon_cancel:"Cancelar",icon_details:"Detalhes",icon_edit:"Editar",icon_delete:"Excluir",confirm_closing:"",confirm_deleting:"As tarefas serão excluidas permanentemente, confirme?",section_description:"Descrição",section_time:"Período",section_type:"Tipo",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"EAP",column_text:"Nome tarefa",column_start_date:"Data início",column_duration:"Duração",column_add:"",link:"Link",confirm_link_deleting:"Será excluído!",link_start:" (início)",link_end:" (fim)",type_task:"Task",type_project:"Projeto",type_milestone:"Marco",minutes:"Minutos",hours:"Horas",days:"Dias",weeks:"Semanas",months:"Meses",years:"Anos",message_ok:"OK",message_cancel:"Cancelar",section_constraint:"Restrição",constraint_type:"Tipo Restrição",constraint_date:"Data restrição",asap:"Mais breve possível",alap:"Mais tarde possível",snet:"Não começar antes de",snlt:"Não começar depois de",fnet:"Não terminar antes de",fnlt:"Não terminar depois de",mso:"Precisa começar em",mfo:"Precisa terminar em",resources_filter_placeholder:"Tipo de filtros",resources_filter_label:"Ocultar vazios",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ii={date:{month_full:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","November","December"],month_short:["Ian","Feb","Mar","Apr","Mai","Iun","Iul","Aug","Sep","Oct","Nov","Dec"],day_full:["Duminica","Luni","Marti","Miercuri","Joi","Vineri","Sambata"],day_short:["Du","Lu","Ma","Mi","Jo","Vi","Sa"]},labels:{new_task:"Sarcina noua",icon_save:"Salveaza",icon_cancel:"Anuleaza",icon_details:"Detalii",icon_edit:"Editeaza",icon_delete:"Sterge",confirm_closing:"Schimbarile nu vor fi salvate, esti sigur?",confirm_deleting:"Evenimentul va fi sters permanent, esti sigur?",section_description:"Descriere",section_time:"Interval",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Anuleaza",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ni={date:{month_full:["Январь","Февраль","Март","Апрель","Maй","Июнь","Июль","Август","Сентябрь","Oктябрь","Ноябрь","Декабрь"],month_short:["Янв","Фев","Maр","Aпр","Maй","Июн","Июл","Aвг","Сен","Окт","Ноя","Дек"],day_full:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],day_short:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]},labels:{new_task:"Новое задание",icon_save:"Сохранить",icon_cancel:"Отменить",icon_details:"Детали",icon_edit:"Изменить",icon_delete:"Удалить",confirm_closing:"",confirm_deleting:"Событие будет удалено безвозвратно, продолжить?",section_description:"Описание",section_time:"Период времени",section_type:"Тип",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"ИСР",column_text:"Задача",column_start_date:"Начало",column_duration:"Длительность",column_add:"",link:"Связь",confirm_link_deleting:"будет удалена",link_start:" (начало)",link_end:" (конец)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Минута",hours:"Час",days:"День",weeks:"Неделя",months:"Месяц",years:"Год",message_ok:"OK",message_cancel:"Отменить",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"начните вводить слово для фильтрации",resources_filter_label:"спрятать не установленные",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ai={date:{month_full:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Nedelja","Ponedeljek","Torek","Sreda","Četrtek","Petek","Sobota"],day_short:["Ned","Pon","Tor","Sre","Čet","Pet","Sob"]},labels:{new_task:"Nova naloga",icon_save:"Shrani",icon_cancel:"Prekliči",icon_details:"Podrobnosti",icon_edit:"Uredi",icon_delete:"Izbriši",confirm_closing:"",confirm_deleting:"Dogodek bo izbrisan. Želite nadaljevati?",section_description:"Opis",section_time:"Časovni okvir",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Prekliči",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},ri={date:{month_full:["Január","Február","Marec","Apríl","Máj","Jún","Júl","August","September","Október","November","December"],month_short:["Jan","Feb","Mar","Apr","Máj","Jún","Júl","Aug","Sept","Okt","Nov","Dec"],day_full:["Nedeľa","Pondelok","Utorok","Streda","Štvrtok","Piatok","Sobota"],day_short:["Ne","Po","Ut","St","Št","Pi","So"]},labels:{new_task:"Nová úloha",icon_save:"Uložiť",icon_cancel:"Späť",icon_details:"Detail",icon_edit:"Edituj",icon_delete:"Zmazať",confirm_closing:"Vaše zmeny nebudú uložené. Skutočne?",confirm_deleting:"Udalosť bude natrvalo vymazaná. Skutočne?",section_description:"Poznámky",section_time:"Doba platnosti",section_type:"Type",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Späť",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},si={date:{month_full:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],month_short:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],day_full:["Söndag","Måndag","Tisdag","Onsdag","Torsdag","Fredag","Lördag"],day_short:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"]},labels:{new_task:"Ny uppgift",icon_save:"Spara",icon_cancel:"Avbryt",icon_details:"Detajer",icon_edit:"Ändra",icon_delete:"Ta bort",confirm_closing:"",confirm_deleting:"Är du säker på att du vill ta bort händelsen permanent?",section_description:"Beskrivning",section_time:"Tid",section_type:"Typ",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Uppgiftsnamn",column_start_date:"Starttid",column_duration:"Varaktighet",column_add:"",link:"Länk",confirm_link_deleting:"kommer tas bort",link_start:" (start)",link_end:" (slut)",type_task:"Uppgift",type_project:"Projekt",type_milestone:"Milstolpe",minutes:"Minuter",hours:"Timmar",days:"Dagar",weeks:"Veckor",months:"Månader",years:"År",message_ok:"OK",message_cancel:"Avbryt",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},oi={date:{month_full:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],month_short:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],day_full:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],day_short:["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"]},labels:{new_task:"Yeni görev",icon_save:"Kaydet",icon_cancel:"İptal",icon_details:"Detaylar",icon_edit:"Düzenle",icon_delete:"Sil",confirm_closing:"",confirm_deleting:"Görev silinecek, emin misiniz?",section_description:"Açıklama",section_time:"Zaman Aralığı",section_type:"Tip",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Görev Adı",column_start_date:"Başlangıç",column_duration:"Süre",column_add:"",link:"Bağlantı",confirm_link_deleting:"silinecek",link_start:" (başlangıç)",link_end:" (bitiş)",type_task:"Görev",type_project:"Proje",type_milestone:"Kilometretaşı",minutes:"Dakika",hours:"Saat",days:"Gün",weeks:"Hafta",months:"Ay",years:"Yıl",message_ok:"OK",message_cancel:"Ýptal",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}},li={date:{month_full:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],month_short:["Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],day_full:["Неділя","Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"],day_short:["Нед","Пон","Вів","Сер","Чет","Птн","Суб"]},labels:{new_task:"Нове завдання",icon_save:"Зберегти",icon_cancel:"Відміна",icon_details:"Деталі",icon_edit:"Редагувати",icon_delete:"Вилучити",confirm_closing:"",confirm_deleting:"Подія вилучиться назавжди. Ви впевнені?",section_description:"Опис",section_time:"Часовий проміжок",section_type:"Тип",section_deadline:"Deadline",section_baselines:"Baselines",column_wbs:"WBS",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years",message_ok:"OK",message_cancel:"Відміна",section_constraint:"Constraint",constraint_type:"Constraint type",constraint_date:"Constraint date",asap:"As Soon As Possible",alap:"As Late As Possible",snet:"Start No Earlier Than",snlt:"Start No Later Than",fnet:"Finish No Earlier Than",fnlt:"Finish No Later Than",mso:"Must Start On",mfo:"Must Finish On",resources_filter_placeholder:"type to filter",resources_filter_label:"hide empty",empty_state_text_link:"Click here",empty_state_text_description:"to create your first task",baselines_section_placeholder:"Start adding a new baseline",baselines_add_button:"Add Baseline",baselines_remove_button:"Remove",baselines_remove_all_button:"Remove All",deadline_enable_button:"Set",deadline_disable_button:"Remove"}};function di(){this.constants=_t,this.version="9.0.15",this.license="gpl",this.templates={},this.ext={},this.keys={edit_save:this.constants.KEY_CODES.ENTER,edit_cancel:this.constants.KEY_CODES.ESC}}function ci(t){var e,i=new di,n=new gt(t),a={};i.plugins=function(t){for(var e in t)if(t[e]&&!a[e]){var r=n.getExtension(e);r&&(r(i),a[e]=!0)}return a},i.$services=(e={},{services:{},setService:function(t,i){e[t]=i},getService:function(t){return e[t]?e[t]():null},dropService:function(t){e[t]&&delete e[t]},destructor:function(){for(var t in e)if(e[t]){var i=e[t];i&&i.destructor&&i.destructor()}e=null}}),i.config={layout:{css:"gantt_container",rows:[{cols:[{view:"grid",scrollX:"scrollHor",scrollY:"scrollVer"},{resizer:!0,width:1},{view:"timeline",scrollX:"scrollHor",scrollY:"scrollVer"},{view:"scrollbar",id:"scrollVer"}]},{view:"scrollbar",id:"scrollHor",height:20}]},links:{finish_to_start:"0",start_to_start:"1",finish_to_finish:"2",start_to_finish:"3"},types:{task:"task",project:"project",milestone:"milestone"},auto_types:!1,duration_unit:"day",work_time:!1,correct_work_time:!1,skip_off_time:!1,cascade_delete:!0,autosize:!1,autosize_min_width:0,autoscroll:!0,autoscroll_speed:30,deepcopy_on_parse:!1,show_links:!0,show_task_cells:!0,static_background:!1,static_background_cells:!0,branch_loading:!1,branch_loading_property:"$has_child",show_loading:!1,show_chart:!0,show_grid:!0,min_duration:36e5,date_format:"%d-%m-%Y %H:%i",xml_date:void 0,start_on_monday:!0,server_utc:!1,show_progress:!0,fit_tasks:!1,select_task:!0,scroll_on_click:!0,smart_rendering:!0,preserve_scroll:!0,readonly:!1,container_resize_timeout:20,deadlines:!0,date_grid:"%Y-%m-%d",drag_links:!0,drag_progress:!0,drag_resize:!0,drag_project:!1,drag_move:!0,drag_mode:{resize:"resize",progress:"progress",move:"move",ignore:"ignore"},round_dnd_dates:!0,link_wrapper_width:20,link_arrow_size:12,root_id:0,autofit:!1,columns:[{name:"text",tree:!0,width:"*",resize:!0},{name:"start_date",align:"center",resize:!0},{name:"duration",align:"center"},{name:"add",width:44}],scale_offset_minimal:!0,inherit_scale_class:!1,scales:[{unit:"day",step:1,date:"%d %M"}],time_step:60,duration_step:1,task_date:"%d %F %Y",time_picker:"%H:%i",task_attribute:"data-task-id",link_attribute:"data-link-id",layer_attribute:"data-layer",buttons_left:["gantt_save_btn","gantt_cancel_btn"],_migrate_buttons:{dhx_save_btn:"gantt_save_btn",dhx_cancel_btn:"gantt_cancel_btn",dhx_delete_btn:"gantt_delete_btn"},buttons_right:["gantt_delete_btn"],lightbox:{sections:[{name:"description",height:70,map_to:"text",type:"textarea",focus:!0},{name:"time",type:"duration",map_to:"auto"}],project_sections:[{name:"description",height:70,map_to:"text",type:"textarea",focus:!0},{name:"type",type:"typeselect",map_to:"type"},{name:"time",type:"duration",readonly:!0,map_to:"auto"}],milestone_sections:[{name:"description",height:70,map_to:"text",type:"textarea",focus:!0},{name:"type",type:"typeselect",map_to:"type"},{name:"time",type:"duration",single_date:!0,map_to:"auto"}]},drag_lightbox:!0,sort:!1,details_on_create:!0,details_on_dblclick:!0,initial_scroll:!0,task_scroll_offset:100,order_branch:!1,order_branch_free:!1,task_height:void 0,bar_height:"full",bar_height_padding:9,min_column_width:70,min_grid_column_width:70,grid_resizer_column_attribute:"data-column-index",keep_grid_width:!1,grid_resize:!1,grid_elastic_columns:!1,show_tasks_outside_timescale:!1,show_unscheduled:!0,resize_rows:!1,task_grid_row_resizer_attribute:"data-row-index",min_task_grid_row_height:30,row_height:36,readonly_property:"readonly",editable_property:"editable",calendar_property:"calendar_id",resource_calendars:{},dynamic_resource_calendars:!1,inherit_calendar:!1,type_renderers:{},open_tree_initially:!1,optimize_render:!0,prevent_default_scroll:!1,show_errors:!0,wai_aria_attributes:!0,smart_scales:!0,rtl:!1,placeholder_task:!1,horizontal_scroll_key:"shiftKey",drag_timeline:{useKey:void 0,ignore:".gantt_task_line, .gantt_task_link",render:!1},drag_multiple:!0,csp:"auto"},i.ajax=function(t){return{cache:!0,method:"get",parse:function(t){return"string"!=typeof t?t:(t=t.replace(/^[\s]+/,""),typeof DOMParser>"u"||pt.isIE?void 0!==D.ActiveXObject&&((e=new D.ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml"),e);var e},xmltop:function(e,i,n){if(void 0===i.status||i.status<400){var a=i.responseXML?i.responseXML||i:this.parse(i.responseText||i);if(a&&null!==a.documentElement&&!a.getElementsByTagName("parsererror").length)return a.getElementsByTagName(e)[0]}return-1!==n&&t.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],n]),document.createElement("DIV")},xpath:function(t,e){if(e.nodeName||(e=e.responseXML||e),pt.isIE)return e.selectNodes(t)||[];for(var i,n=[],a=(e.ownerDocument||e).evaluate(t,e,null,XPathResult.ANY_TYPE,null);i=a.iterateNext();)n.push(i);return n},query:function(t){return this._call(t.method||"GET",t.url,t.data||"",t.async||!0,t.callback,t.headers)},get:function(t,e,i){var n=vt("GET",arguments);return this.query(n)},getSync:function(t,e){var i=vt("GET",arguments);return i.async=!1,this.query(i)},put:function(t,e,i,n){var a=vt("PUT",arguments);return this.query(a)},del:function(t,e,i){var n=vt("DELETE",arguments);return this.query(n)},post:function(t,e,i,n){1==arguments.length?e="":2==arguments.length&&"function"==typeof e&&(i=e,e="");var a=vt("POST",arguments);return this.query(a)},postSync:function(t,e,i){e=null===e?"":String(e);var n=vt("POST",arguments);return n.async=!1,this.query(n)},_call:function(e,i,n,a,r,s){return new t.Promise((function(o,l){var d=void 0!==typeof XMLHttpRequest?new XMLHttpRequest:new D.ActiveXObject("Microsoft.XMLHTTP"),c=null!==navigator.userAgent.match(/AppleWebKit/)&&null!==navigator.userAgent.match(/Qt/)&&null!==navigator.userAgent.match(/Safari/);a&&(d.onreadystatechange=function(){if(4==d.readyState||c&&3==d.readyState){if((d.status<200||d.status>299||""===d.responseText)&&!t.callEvent("onAjaxError",[d]))return;setTimeout((function(){"function"==typeof r&&r.apply(D,[{xmlDoc:d,filePath:i}]),o(d),"function"==typeof r&&(r=null,d=null)}),0)}});var u=!this||!this.cache;if("GET"==e&&u&&(i+=(i.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),d.open(e,i,a),s)for(var h in s)d.setRequestHeader(h,s[h]);else"POST"==e.toUpperCase()||"PUT"==e||"DELETE"==e?d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==e&&(n=null);if(d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.send(n),!a)return{xmlDoc:d,filePath:i}}))},urlSeparator:function(t){return-1!=t.indexOf("?")?"&":"?"}}}(i),i.date=function(t){var e=null;function i(){var i=!1;return"auto"===t.config.csp?(null===e&&function(){try{new Function("canUseCsp = false;")}catch{e=!0}}(),i=e):i=t.config.csp,i}return{init:function(){for(var e=t.locale,i=e.date.month_short,n=e.date.month_short_hash={},a=0;a<i.length;a++)n[i[a]]=a;for(i=e.date.month_full,n=e.date.month_full_hash={},a=0;a<i.length;a++)n[i[a]]=a},date_part:function(t){var e=new Date(t);return t.setHours(0),this.hour_start(t),t.getHours()&&(t.getDate()<e.getDate()||t.getMonth()<e.getMonth()||t.getFullYear()<e.getFullYear())&&t.setTime(t.getTime()+36e5*(24-t.getHours())),t},time_part:function(t){return(t.valueOf()/1e3-60*t.getTimezoneOffset())%86400},week_start:function(e){var i=e.getDay();return t.config.start_on_monday&&(0===i?i=6:i--),this.date_part(this.add(e,-1*i,"day"))},month_start:function(t){return t.setDate(1),this.date_part(t)},quarter_start:function(t){this.month_start(t);var e,i=t.getMonth();return e=i>=9?9:i>=6?6:i>=3?3:0,t.setMonth(e),t},year_start:function(t){return t.setMonth(0),this.month_start(t)},day_start:function(t){return this.date_part(t)},hour_start:function(t){return t.getMinutes()&&t.setMinutes(0),this.minute_start(t),t},minute_start:function(t){return t.getSeconds()&&t.setSeconds(0),t.getMilliseconds()&&t.setMilliseconds(0),t},_add_days:function(t,e,i){t.setDate(t.getDate()+e);var n=e>=0,a=!i.getHours()&&t.getHours(),r=t.getDate()<=i.getDate()||t.getMonth()<i.getMonth()||t.getFullYear()<i.getFullYear();return n&&a&&r&&t.setTime(t.getTime()+36e5*(24-t.getHours())),e>1&&a&&t.setHours(0),t},add:function(t,e,i){var n=new Date(t.valueOf());switch(i){case"day":n=this._add_days(n,e,t);break;case"week":n=this._add_days(n,7*e,t);break;case"month":n.setMonth(n.getMonth()+e);break;case"year":n.setYear(n.getFullYear()+e);break;case"hour":n.setTime(n.getTime()+60*e*60*1e3);break;case"minute":n.setTime(n.getTime()+60*e*1e3);break;default:return this["add_"+i](t,e,i)}return n},add_quarter:function(t,e){return this.add(t,3*e,"month")},to_fixed:function(t){return t<10?"0"+t:t},copy:function(t){return new Date(t.valueOf())},date_to_str:function(e,n){var a=kt;return i()&&(a=yt),a.date_to_str(e,n,t)},str_to_date:function(e,n){var a=kt;return i()&&(a=yt),a.str_to_date(e,n,t)},getISOWeek:function(e){return t.date._getWeekNumber(e,!0)},_getWeekNumber:function(t,e){if(!t)return!1;var i=t.getDay();e&&0===i&&(i=7);var n=new Date(t.valueOf());n.setDate(t.getDate()+(4-i));var a=n.getFullYear(),r=Math.round((n.getTime()-new Date(a,0,1).getTime())/864e5);return 1+Math.floor(r/7)},getWeek:function(e){return t.date._getWeekNumber(e,t.config.start_on_monday)},getUTCISOWeek:function(e){return t.date.getISOWeek(e)},convert_to_utc:function(t){return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())},parseDate:function(e,i){return e&&!e.getFullYear&&("function"!=typeof i&&(i="string"==typeof i?"parse_date"===i||"xml_date"===i?t.defined(t.templates.xml_date)?t.templates.xml_date:t.templates.parse_date:t.defined(t.templates[i])?t.templates[i]:t.date.str_to_date(i):t.defined(t.templates.xml_date)?t.templates.xml_date:t.templates.parse_date),e=e?i(e):null),e}}}(i),i.RemoteEvents=xt;var r=function(t){function e(t){return{target:t.target||t.srcElement,pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY,metaKey:t.metaKey,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey}}function i(i,n){this._obj=i,this._settings=n||{},M(this);var a=this.getInputMethods();this._drag_start_timer=null,t.attachEvent("onGanttScroll",et((function(t,e){this.clearDragTimer()}),this));for(var r={passive:!1},s=0;s<a.length;s++)et((function(a){t.event(i,a.down,et((function(r){a.accessor(r)&&(void 0!==r.button&&0!==r.button||(n.preventDefault&&n.selector&&$(r.target,n.selector)&&r.preventDefault(),t.config.touch&&r.timeStamp&&r.timeStamp-0<300||(this._settings.original_target=e(r),this._settings.original_element_sizes={...y(r,w(i)),width:r.target.offsetWidth,height:r.target.offsetHeight},t.config.touch?(this.clearDragTimer(),this._drag_start_timer=setTimeout(et((function(){t.getState().lightbox||this.dragStart(i,r,a)}),this),t.config.touch_drag)):this.dragStart(i,r,a))))}),this),r);var s=document.body;t.event(s,a.up,et((function(t){a.accessor(t)&&this.clearDragTimer()}),this),r)}),this)(a[s])}return i.prototype={traceDragEvents:function(e,i){var n=et((function(t){return this.dragMove(e,t,i.accessor)}),this);et((function(t){return this.dragScroll(e,t)}),this);var a=et((function(t){if(!this.config.started||!Q(this.config.updates_per_second)||$t(this,this.config.updates_per_second)){var e=n(t);if(e)try{t&&t.preventDefault&&t.cancelable&&t.preventDefault()}catch{}return e}}),this),r=E(t.$root),s=this.config.mousemoveContainer||E(t.$root),o={passive:!1},l=et((function(n){return t.eventRemove(s,i.move,a),t.eventRemove(r,i.up,l,o),this.dragEnd(e)}),this);t.event(s,i.move,a,o),t.event(r,i.up,l,o)},checkPositionChange:function(t){var e=t.x-this.config.pos.x,i=t.y-this.config.pos.y;return Math.sqrt(Math.pow(Math.abs(e),2)+Math.pow(Math.abs(i),2))>this.config.sensitivity},initDnDMarker:function(){var t=this.config.marker=document.createElement("div");t.className="gantt_drag_marker",t.innerHTML="",document.body.appendChild(t)},backupEventTarget:function(i,n){if(t.config.touch){var a=n(i),r=a.target||a.srcElement,s=r.cloneNode(!0);this.config.original_target=e(a),this.config.original_target.target=s,this.config.backup_element=r,r.parentNode.appendChild(s),r.style.display="none",(this.config.mousemoveContainer||document.body).appendChild(r)}},getInputMethods:function(){var e=[];if(e.push({move:"mousemove",down:"mousedown",up:"mouseup",accessor:function(t){return t}}),t.config.touch){var i=!0;try{document.createEvent("TouchEvent")}catch{i=!1}i?e.push({move:"touchmove",down:"touchstart",up:"touchend",accessor:function(t){return t.touches&&t.touches.length>1?null:t.touches[0]?{target:document.elementFromPoint(t.touches[0].clientX,t.touches[0].clientY),pageX:t.touches[0].pageX,pageY:t.touches[0].pageY,clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}:t}}):D.navigator.pointerEnabled?e.push({move:"pointermove",down:"pointerdown",up:"pointerup",accessor:function(t){return"mouse"==t.pointerType?null:t}}):D.navigator.msPointerEnabled&&e.push({move:"MSPointerMove",down:"MSPointerDown",up:"MSPointerUp",accessor:function(t){return t.pointerType==t.MSPOINTER_TYPE_MOUSE?null:t}})}return e},clearDragTimer:function(){this._drag_start_timer&&(clearTimeout(this._drag_start_timer),this._drag_start_timer=null)},dragStart:function(e,i,n){this.config&&this.config.started||(this.config={obj:e,marker:null,started:!1,pos:this.getPosition(i),sensitivity:4},this._settings&&Z(this.config,this._settings,!0),this.traceDragEvents(e,n),t._prevent_touch_scroll=!0,i.target.closest(".gantt_row")&&!t.config.order_branch&&(t._prevent_touch_scroll=!1),document.body.classList.add("gantt_noselect"),t.config.touch&&this.dragMove(e,i,n.accessor))},dragMove:function(e,i,n){var a=n(i);if(!a)return!1;if(!this.config.marker&&!this.config.started){var r=this.getPosition(a);if(t.config.touch||this.checkPositionChange(r)){if(this.config.started=!0,this.config.ignore=!1,t._touch_drag=!0,!1===this.callEvent("onBeforeDragStart",[e,this.config.original_target]))return this.config.ignore=!0,!1;this.backupEventTarget(i,n),this.initDnDMarker(),t._touch_feedback(),this.callEvent("onAfterDragStart",[e,this.config.original_target])}else this.config.ignore=!0}return!this.config.ignore&&(i.targetTouches&&!a.target?void 0:(a.pos=this.getPosition(a),this.config.marker.style.left=a.pos.x+"px",this.config.marker.style.top=a.pos.y+"px",this.callEvent("onDragMove",[e,a]),!0))},dragEnd:function(e){var i=this.config.backup_element;i&&i.parentNode&&i.parentNode.removeChild(i),t._prevent_touch_scroll=!1,this.config.marker&&(this.config.marker.parentNode.removeChild(this.config.marker),this.config.marker=null,this.callEvent("onDragEnd",[])),this.config.started=!1,t._touch_drag=!1,document.body.classList.remove("gantt_noselect")},getPosition:function(t){var e=0,i=0;return t.pageX||t.pageY?(e=t.pageX,i=t.pageY):(t.clientX||t.clientY)&&(e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:e,y:i}}},i}(i);i.$services.setService("dnd",(function(){return r}));var s=function(t){var e={};function i(i,n,a){a=a||i;var r=t.config,s=t.templates;t.config[i]&&e[a]!=r[i]&&(n&&s[a]||(s[a]=t.date.date_to_str(r[i]),e[a]=r[i]))}return{initTemplates:function(){var e=t.date,n=e.date_to_str,a=t.config,r=n(a.xml_date||a.date_format,a.server_utc),s=e.str_to_date(a.xml_date||a.date_format,a.server_utc);i("date_scale",!0,void 0,t.config,t.templates),i("date_grid",!0,"grid_date_format",t.config,t.templates),i("task_date",!0,void 0,t.config,t.templates),t.mixin(t.templates,{xml_format:void 0,format_date:r,xml_date:void 0,parse_date:s,progress_text:function(t,e,i){return""},grid_header_class:function(t,e){return""},task_text:function(t,e,i){return i.text},task_class:function(t,e,i){return""},task_end_date:function(e){return t.templates.task_date(e)},grid_row_class:function(t,e,i){return""},task_row_class:function(t,e,i){return""},timeline_cell_class:function(t,e){return""},timeline_cell_content:function(t,e){return""},scale_cell_class:function(t){return""},scale_row_class:function(t){return""},grid_indent:function(t){return"<div class='gantt_tree_indent'></div>"},grid_folder:function(t){return"<div class='gantt_tree_icon gantt_folder_"+(t.$open?"open":"closed")+"'></div>"},grid_file:function(t){return"<div class='gantt_tree_icon gantt_file'></div>"},grid_open:function(t){return"<div class='gantt_tree_icon gantt_"+(t.$open?"close":"open")+"'></div>"},grid_blank:function(t){return"<div class='gantt_tree_icon gantt_blank'></div>"},date_grid:function(e,i,n){return i&&t.isUnscheduledTask(i)&&t.config.show_unscheduled?t.templates.task_unscheduled_time(i):t.templates.grid_date_format(e,n)},task_time:function(e,i,n){return t.isUnscheduledTask(n)&&t.config.show_unscheduled?t.templates.task_unscheduled_time(n):t.templates.task_date(e)+" - "+t.templates.task_end_date(i)},task_unscheduled_time:function(t){return""},time_picker:n(a.time_picker),link_class:function(t){return""},link_description:function(e){var i=t.getTask(e.source),n=t.getTask(e.target);return"<b>"+i.text+"</b> &ndash;  <b>"+n.text+"</b>"},drag_link:function(e,i,n,a){e=t.getTask(e);var r=t.locale.labels,s="<b>"+e.text+"</b> "+(i?r.link_start:r.link_end)+"<br/>";return n&&(s+="<b> "+(n=t.getTask(n)).text+"</b> "+(a?r.link_start:r.link_end)+"<br/>"),s},drag_link_class:function(e,i,n,a){var r="";return e&&n&&(r=" "+(t.isLinkAllowed(e,n,i,a)?"gantt_link_allow":"gantt_link_deny")),"gantt_link_tooltip"+r},tooltip_date_format:e.date_to_str("%Y-%m-%d"),tooltip_text:function(e,i,n){return`<div>Task: ${n.text}</div>\n\t\t\t\t<div>Start date: ${t.templates.tooltip_date_format(e)}</div>\n\t\t\t\t<div>End date: ${t.templates.tooltip_date_format(i)}</div>`},baseline_text:function(t,e,i){return""}})},initTemplate:i}}(i);i.$services.setService("templateLoader",(function(){return s})),M(i);var o=new wt;o.registerProvider("global",(function(){var t={min_date:i._min_date,max_date:i._max_date,selected_task:null};return i.$data&&i.$data.tasksStore&&(t.selected_task=i.$data.tasksStore.getSelectedId()),t})),i.getState=o.getState,i.$services.setService("state",(function(){return o})),Z(i,at),i.Promise=St,i.env=pt,function(t){var e=Lt();Z(t,e);var i,n=t.createDatastore({name:"task",type:"treeDatastore",rootId:function(){return t.config.root_id},initItem:et((function(e){this.defined(e.id)||(e.id=this.uid()),e.start_date&&(e.start_date=t.date.parseDate(e.start_date,"parse_date")),e.end_date&&(e.end_date=t.date.parseDate(e.end_date,"parse_date"));var i=null;(e.duration||0===e.duration)&&(e.duration=i=1*e.duration),i&&(e.start_date&&!e.end_date?e.end_date=this.calculateEndDate(e):!e.start_date&&e.end_date&&(e.start_date=this.calculateEndDate({start_date:e.end_date,duration:-e.duration,task:e}))),!1!==t.config.deadlines&&e.deadline&&(e.deadline=t.date.parseDate(e.deadline,"parse_date")),e.progress=Number(e.progress)||0,this._isAllowedUnscheduledTask(e)&&this._set_default_task_timing(e),this._init_task_timing(e),e.start_date&&e.end_date&&this.correctTaskWorkTime(e),e.$source=[],e.$target=[];var n=this.$data.tasksStore.getItem(e.id);return n&&!Q(e.open)&&(e.$open=n.$open),void 0===e.parent&&(e.parent=this.config.root_id),e.open&&(e.$open=!0),e}),t),getConfig:function(){return t.config}}),a=t.createDatastore({name:"link",initItem:et((function(t){return this.defined(t.id)||(t.id=this.uid()),t}),t)});function r(e){var i=t.isTaskVisible(e);if(!i&&t.isTaskExists(e)){var n=t.getParent(e);t.isTaskExists(n)&&t.isTaskVisible(n)&&(n=t.getTask(n),t.isSplitTask(n)&&(i=!0))}return i}function s(e){if(t.isTaskExists(e.source)){var i=t.getTask(e.source);i.$source=i.$source||[],o(e.id,i.$source)&&i.$source.push(e.id)}if(t.isTaskExists(e.target)){var n=t.getTask(e.target);n.$target=n.$target||[],o(e.id,n.$target)&&n.$target.push(e.id)}}function o(t,e){return-1===e.indexOf(String(t))&&-1===e.indexOf(Number(t))}function l(e){if(t.isTaskExists(e.source))for(var i=t.getTask(e.source),n=0;n<i.$source.length;n++)if(i.$source[n]==e.id){i.$source.splice(n,1);break}if(t.isTaskExists(e.target)){var a=t.getTask(e.target);for(n=0;n<a.$target.length;n++)if(a.$target[n]==e.id){a.$target.splice(n,1);break}}}function d(){for(var e=null,i=t.$data.tasksStore.getItems(),n=0,a=i.length;n<a;n++)(e=i[n]).$source=[],e.$target=[];var r=t.$data.linksStore.getItems();for(n=0,a=r.length;n<a;n++)s(r[n])}function c(t){var e=t.source,i=t.target;for(var n in t.events)!function(t,n){e.attachEvent(t,(function(){return i.callEvent(n,Array.prototype.slice.call(arguments))}),n)}(n,t.events[n])}t.attachEvent("onDestroy",(function(){n.destructor(),a.destructor()})),t.attachEvent("onLinkValidation",(function(e){if(t.isLinkExists(e.id)||"predecessor_generated"===e.id)return!0;for(var i=t.getTask(e.source).$source,n=0;n<i.length;n++){var a=t.getLink(i[n]),r=e.source==a.source,s=e.target==a.target,o=e.type==a.type;if(r&&s&&o)return!1}return!0})),n.attachEvent("onBeforeRefreshAll",(function(){if(!n._skipTaskRecalculation)for(var e=n.getVisibleItems(),i=0;i<e.length;i++){var a=e[i];a.$index=i,a.$local_index=t.getTaskIndex(a.id),t.resetProjectDates(a)}})),n.attachEvent("onFilterItem",(function(e,i){if(t.config.show_tasks_outside_timescale)return!0;var n=null,a=null;if(t.config.start_date&&t.config.end_date){if(t._isAllowedUnscheduledTask(i))return!0;if(n=t.config.start_date.valueOf(),a=t.config.end_date.valueOf(),+i.start_date>a||+i.end_date<+n)return!1}return!0})),n.attachEvent("onIdChange",(function(e,i){t._update_flags(e,i);var a=t.getTask(i);n.isSilent()||(a.$split_subtask||a.rollup)&&t.eachParent((function(e){t.refreshTask(e.id)}),i)})),n.attachEvent("onAfterUpdate",(function(e){if(t._update_parents(e),t.getState("batchUpdate").batch_update)return!0;var i=n.getItem(e);i.$source||(i.$source=[]);for(var r=0;r<i.$source.length;r++)a.refresh(i.$source[r]);for(i.$target||(i.$target=[]),r=0;r<i.$target.length;r++)a.refresh(i.$target[r])})),n.attachEvent("onBeforeItemMove",(function(e,i,a){return!Et(e,t,n)||(console.log("The placeholder task cannot be moved to another position."),!1)})),n.attachEvent("onAfterItemMove",(function(e,i,n){var a=t.getTask(e);null!==this.getNextSibling(e)?a.$drop_target=this.getNextSibling(e):null!==this.getPrevSibling(e)?a.$drop_target="next:"+this.getPrevSibling(e):a.$drop_target="next:null"})),n.attachEvent("onStoreUpdated",(function(e,i,n){if("delete"==n&&t._update_flags(e,null),!t.$services.getService("state").getState("batchUpdate").batch_update){if(t.config.fit_tasks&&"paint"!==n){var r=t.getState();Ht(t);var s=t.getState();if(+r.min_date!=+s.min_date||+r.max_date!=+s.max_date)return t.render(),t.callEvent("onScaleAdjusted",[]),!0}"add"==n||"move"==n||"delete"==n?t.$layout&&("task"!=this.$config.name||"add"!=n&&"delete"!=n||"lightbox"!=this._skipTaskRecalculation&&(this._skipTaskRecalculation=!0),t.$layout.resize()):e||a.refresh()}})),a.attachEvent("onAfterAdd",(function(t,e){s(e)})),a.attachEvent("onAfterUpdate",(function(t,e){d()})),a.attachEvent("onAfterDelete",(function(t,e){l(e)})),a.attachEvent("onAfterSilentDelete",(function(t,e){l(e)})),a.attachEvent("onBeforeIdChange",(function(e,i){l(t.mixin({id:e},t.$data.linksStore.getItem(i))),s(t.$data.linksStore.getItem(i))})),a.attachEvent("onFilterItem",(function(e,i){if(!t.config.show_links)return!1;var n=r(i.source),a=r(i.target);return!(!n||!a||t._isAllowedUnscheduledTask(t.getTask(i.source))||t._isAllowedUnscheduledTask(t.getTask(i.target)))&&t.callEvent("onBeforeLinkDisplay",[e,i])})),i={},t.attachEvent("onBeforeTaskDelete",(function(e,n){return i[e]=zt(t,e),!0})),t.attachEvent("onAfterTaskDelete",(function(e,n){i[e]&&t.$data.linksStore.silent((function(){for(var n in i[e])t.isLinkExists(n)&&t.$data.linksStore.removeItem(n),l(i[e][n]);i[e]=null}))})),t.attachEvent("onAfterLinkDelete",(function(e,i){t.isTaskExists(i.source)&&t.refreshTask(i.source),t.isTaskExists(i.target)&&t.refreshTask(i.target)})),t.attachEvent("onParse",d),c({source:a,target:t,events:{onItemLoading:"onLinkLoading",onBeforeAdd:"onBeforeLinkAdd",onAfterAdd:"onAfterLinkAdd",onBeforeUpdate:"onBeforeLinkUpdate",onAfterUpdate:"onAfterLinkUpdate",onBeforeDelete:"onBeforeLinkDelete",onAfterDelete:"onAfterLinkDelete",onIdChange:"onLinkIdChange"}}),c({source:n,target:t,events:{onItemLoading:"onTaskLoading",onBeforeAdd:"onBeforeTaskAdd",onAfterAdd:"onAfterTaskAdd",onBeforeUpdate:"onBeforeTaskUpdate",onAfterUpdate:"onAfterTaskUpdate",onBeforeDelete:"onBeforeTaskDelete",onAfterDelete:"onAfterTaskDelete",onIdChange:"onTaskIdChange",onBeforeItemMove:"onBeforeTaskMove",onAfterItemMove:"onAfterTaskMove",onFilterItem:"onBeforeTaskDisplay",onItemOpen:"onTaskOpened",onItemClose:"onTaskClosed",onBeforeSelect:"onBeforeTaskSelected",onAfterSelect:"onTaskSelected",onAfterUnselect:"onTaskUnselected"}}),t.$data={tasksStore:n,linksStore:a}}(i),i.dataProcessor=qt,i.createDataProcessor=Gt,function(t){t.ext||(t.ext={});for(var e=[Jt,Kt,Xt,Zt,Qt,te,re,se,de],i=0;i<e.length;i++)e[i]&&e[i](t)}(i),function(t){t.getGridColumn=function(e){for(var i=t.config.columns,n=0;n<i.length;n++)if(i[n].name==e)return i[n];return null},t.getGridColumns=function(){return t.config.columns.slice()}}(i),function(t){t.isReadonly=function(e){return"number"!=typeof e&&"string"!=typeof e||!t.isTaskExists(e)||(e=t.getTask(e)),(!e||!e[this.config.editable_property])&&(e&&e[this.config.readonly_property]||this.config.readonly)}}(i),function(t){function e(e){throw t.assert(!1,"Can't parse data: incorrect value of gantt.parse or gantt.load method. Actual argument value: "+JSON.stringify(e)),new Error("Invalid argument for gantt.parse or gantt.load. An object or a JSON string of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#json is expected. Actual argument value: "+JSON.stringify(e))}t.load=function(){throw new Error("gantt.load() method is not available in the node.js, use gantt.parse() instead")},t.parse=function(t,e){this.on_load({xmlDoc:{responseText:t}},e)},t.serialize=function(t){return this[t=t||"json"].serialize()},t.on_load=function(e,i){if(e.xmlDoc&&404===e.xmlDoc.status)this.assert(!1,"Failed to load the data from <a href='"+e.xmlDoc.responseURL+"' target='_blank'>"+e.xmlDoc.responseURL+"</a>, server returns 404");else if(!t.$destroyed){this.callEvent("onBeforeParse",[]),i||(i="json"),this.assert(this[i],"Invalid data type:'"+i+"'");var n=e.xmlDoc.responseText,a=this[i].parse(n,e);this._process_loading(a)}},t._process_loading=function(e){e.collections&&this._load_collections(e.collections),e.resources&&this.$data.resourcesStore&&this.$data.resourcesStore.parse(e.resources),t.config.baselines&&e.baselines&&this.$data.baselineStore&&this.$data.baselineStore.parse(e.baselines);const i=e.data||e.tasks;e.assignments&&function(e,i){const n={};i.forEach((t=>{n[t.task_id]||(n[t.task_id]=[]),n[t.task_id].push(t)})),e.forEach((e=>{e[t.config.resource_property]=n[e.id]||[]}))}(i,e.assignments),this.$data.tasksStore.parse(i);var n=e.links||(e.collections&&e.collections.links?e.collections.links:[]);this.$data.linksStore.parse(n),this.callEvent("onParse",[]),this.render()},t._load_collections=function(t){var e=!1;for(var i in t)if(t.hasOwnProperty(i)){e=!0;var n=t[i];this.serverList[i]=this.serverList[i]||[];var a=this.serverList[i];if(!a)continue;a.splice(0,a.length);for(var r=0;r<n.length;r++){var s=n[r],o=this.copy(s);for(var l in o.key=o.value,s)if(s.hasOwnProperty(l)){if("value"==l||"label"==l)continue;o[l]=s[l]}a.push(o)}}e&&this.callEvent("onOptionsLoad",[])},t.attachEvent("onBeforeTaskDisplay",(function(t,e){return!e.$ignore})),t.json={parse:function(i){if(i||e(i),"string"==typeof i)if(null!=typeof JSON)try{i=JSON.parse(i)}catch{e(i)}else t.assert(!1,"JSON is not supported");return i.data||i.tasks||e(i),i.dhx_security&&(t.security_key=i.dhx_security),i},serializeTask:function(t){return this._copyObject(t)},serializeLink:function(t){return this._copyLink(t)},_copyLink:function(t){var e={};for(var i in t)e[i]=t[i];return e},_copyObject:function(e){var i={};for(var n in e)"$"!=n.charAt(0)&&(i[n]=e[n],B(i[n])&&(i[n]=t.defined(t.templates.xml_format)?t.templates.xml_format(i[n]):t.templates.format_date(i[n])));return i},serialize:function(){var e=[],i=[];let n=[];t.eachTask((function(i){t.resetProjectDates(i),e.push(this.serializeTask(i))}),t.config.root_id,this);for(var a=t.getLinks(),r=0;r<a.length;r++)i.push(this.serializeLink(a[r]));return t.getDatastore("baselines").eachItem((function(e){const i=t.json.serializeTask(e);n.push(i)})),{data:e,links:i,baselines:n}}},t.xml={_xmlNodeToJSON:function(t,e){for(var i={},n=0;n<t.attributes.length;n++)i[t.attributes[n].name]=t.attributes[n].value;if(!e){for(n=0;n<t.childNodes.length;n++){var a=t.childNodes[n];1==a.nodeType&&(i[a.tagName]=a.firstChild?a.firstChild.nodeValue:"")}i.text||(i.text=t.firstChild?t.firstChild.nodeValue:"")}return i},_getCollections:function(e){for(var i={},n=t.ajax.xpath("//coll_options",e),a=0;a<n.length;a++)for(var r=i[n[a].getAttribute("for")]=[],s=t.ajax.xpath(".//item",n[a]),o=0;o<s.length;o++){for(var l=s[o].attributes,d={key:s[o].getAttribute("value"),label:s[o].getAttribute("label")},c=0;c<l.length;c++){var u=l[c];"value"!=u.nodeName&&"label"!=u.nodeName&&(d[u.nodeName]=u.nodeValue)}r.push(d)}return i},_getXML:function(e,i,n){n=n||"data",i.getXMLTopNode||(i=t.ajax.parse(i));var a=t.ajax.xmltop(n,i.xmlDoc);a&&a.tagName==n||function(e){throw t.assert(!1,"Can't parse data: incorrect value of gantt.parse or gantt.load method. Actual argument value: "+JSON.stringify(e)),new Error("Invalid argument for gantt.parse or gantt.load. An XML of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#xmldhtmlxgantt20 is expected. Actual argument value: "+JSON.stringify(e))}(e);var r=a.getAttribute("dhx_security");return r&&(t.security_key=r),a},parse:function(e,i){i=this._getXML(e,i);for(var n={},a=n.data=[],r=t.ajax.xpath("//task",i),s=0;s<r.length;s++)a[s]=this._xmlNodeToJSON(r[s]);return n.collections=this._getCollections(i),n},_copyLink:function(t){return"<item id='"+t.id+"' source='"+t.source+"' target='"+t.target+"' type='"+t.type+"' />"},_copyObject:function(t){return"<task id='"+t.id+"' parent='"+(t.parent||"")+"' start_date='"+t.start_date+"' duration='"+t.duration+"' open='"+!!t.open+"' progress='"+t.progress+"' end_date='"+t.end_date+"'><![CDATA["+t.text+"]]></task>"},serialize:function(){for(var e=[],i=[],n=t.json.serialize(),a=0,r=n.data.length;a<r;a++)e.push(this._copyObject(n.data[a]));for(a=0,r=n.links.length;a<r;a++)i.push(this._copyLink(n.links[a]));return"<data>"+e.join("")+"<coll_options for='links'>"+i.join("")+"</coll_options></data>"}},t.oldxml={parse:function(e,i){i=t.xml._getXML(e,i,"projects");for(var n={collections:{links:[]}},a=n.data=[],r=t.ajax.xpath("//task",i),s=0;s<r.length;s++){a[s]=t.xml._xmlNodeToJSON(r[s]);var o=r[s].parentNode;"project"==o.tagName?a[s].parent="project-"+o.getAttribute("id"):a[s].parent=o.parentNode.getAttribute("id")}for(r=t.ajax.xpath("//project",i),s=0;s<r.length;s++)(l=t.xml._xmlNodeToJSON(r[s],!0)).id="project-"+l.id,a.push(l);for(s=0;s<a.length;s++){var l;(l=a[s]).start_date=l.startdate||l.est,l.end_date=l.enddate,l.text=l.name,l.duration=l.duration/8,l.open=1,l.duration||l.end_date||(l.duration=1),l.predecessortasks&&n.collections.links.push({target:l.id,source:l.predecessortasks,type:t.config.links.finish_to_start})}return n},serialize:function(){t.message("Serialization to 'old XML' is not implemented")}},t.serverList=function(t,e){return e?this.serverList[t]=e.slice(0):this.serverList[t]||(this.serverList[t]=[]),this.serverList[t]}}(i),function(t){var e=new we(t);Z(t,function(t,e){return{getWorkHours:function(t){return e.getWorkHours(t)},setWorkTime:function(t){return e.setWorkTime(t)},unsetWorkTime:function(t){e.unsetWorkTime(t)},isWorkTime:function(t,i,n){return e.isWorkTime(t,i,n)},getClosestWorkTime:function(t){return e.getClosestWorkTime(t)},calculateDuration:function(t,i,n){return e.calculateDuration(t,i,n)},_hasDuration:function(t,i,n){return e.hasDuration(t,i,n)},calculateEndDate:function(t,i,n,a){return e.calculateEndDate(t,i,n,a)},mergeCalendars:et(t.mergeCalendars,t),createCalendar:et(t.createCalendar,t),addCalendar:et(t.addCalendar,t),getCalendar:et(t.getCalendar,t),getCalendars:et(t.getCalendars,t),getResourceCalendar:et(t.getResourceCalendar,t),getTaskCalendar:et(t.getTaskCalendar,t),deleteCalendar:et(t.deleteCalendar,t)}}(e,new Te(e)))}(i),Ee(i),function(t){t.getTaskType=function(t){return"task"}}(i),function(t){function e(){return t._cached_functions.update_if_changed(t),t._cached_functions.active||t._cached_functions.activate(),!0}t._cached_functions={cache:{},mode:!1,critical_path_mode:!1,wrap_methods:function(t,e){if(e._prefetch_originals)for(var i in e._prefetch_originals)e[i]=e._prefetch_originals[i];for(e._prefetch_originals={},i=0;i<t.length;i++)this.prefetch(t[i],e)},prefetch:function(t,e){var i=e[t];if(i){var n=this;e._prefetch_originals[t]=i,e[t]=function(){for(var e=new Array(arguments.length),a=0,r=arguments.length;a<r;a++)e[a]=arguments[a];if(n.active){var s=n.get_arguments_hash(Array.prototype.slice.call(e));n.cache[t]||(n.cache[t]={});var o=n.cache[t];if(n.has_cached_value(o,s))return n.get_cached_value(o,s);var l=i.apply(this,e);return n.cache_value(o,s,l),l}return i.apply(this,e)}}return i},cache_value:function(t,e,i){this.is_date(i)&&(i=new Date(i)),t[e]=i},has_cached_value:function(t,e){return t.hasOwnProperty(e)},get_cached_value:function(t,e){var i=t[e];return this.is_date(i)&&(i=new Date(i)),i},is_date:function(t){return t&&t.getUTCDate},get_arguments_hash:function(t){for(var e=[],i=0;i<t.length;i++)e.push(this.stringify_argument(t[i]));return"("+e.join(";")+")"},stringify_argument:function(t){return(t.id?t.id:this.is_date(t)?t.valueOf():t)+""},activate:function(){this.clear(),this.active=!0},deactivate:function(){this.clear(),this.active=!1},clear:function(){this.cache={}},setup:function(t){var e=[],i=["_isProjectEnd","_getProjectEnd","_getSlack"];"auto"==this.mode?t.config.highlight_critical_path&&(e=i):!0===this.mode&&(e=i),this.wrap_methods(e,t)},update_if_changed:function(t){(this.critical_path_mode!=t.config.highlight_critical_path||this.mode!==t.config.optimize_render)&&(this.critical_path_mode=t.config.highlight_critical_path,this.mode=t.config.optimize_render,this.setup(t))}},t.attachEvent("onBeforeGanttRender",e),t.attachEvent("onBeforeDataRender",e),t.attachEvent("onBeforeSmartRender",(function(){e()})),t.attachEvent("onBeforeParse",e),t.attachEvent("onDataRender",(function(){t._cached_functions.deactivate()}));var i=null;t.attachEvent("onSmartRender",(function(){i&&clearTimeout(i),i=setTimeout((function(){t._cached_functions.deactivate()}),1e3)})),t.attachEvent("onBeforeGanttReady",(function(){return t._cached_functions.update_if_changed(t),!0}))}(i),function(t){var e;t.assert=(e=t,function(t,i){t||e.config.show_errors&&!1!==e.callEvent("onError",[i])&&(e.message?e.message({type:"error",text:i,expire:-1}):console.log(i))});var i="Invalid value of the first argument of `gantt.init`. Supported values: HTMLElement, String (element id).This error means that either invalid object is passed into `gantt.init` or that the element with the specified ID doesn't exist on the page when `gantt.init` is called.";function n(e){if(!e||"string"==typeof e&&document.getElementById(e)||function(t){try{t.cloneNode(!1)}catch{return!1}return!0}(e))return!0;throw t.assert(!1,i),new Error(i)}t.init=function(e,i,a){t.env.isNode?e=null:n(e),i&&a&&(this.config.start_date=this._min_date=new Date(i),this.config.end_date=this._max_date=new Date(a)),this.date.init(),this.init=function(e){t.env.isNode?e=null:n(e),this.$container&&this.$container.parentNode&&(this.$container.parentNode.removeChild(this.$container),this.$container=null),this.$layout&&this.$layout.clear(),this._reinit(e)},this._reinit(e)},t._quickRefresh=function(t){for(var e=this._getDatastores.call(this),i=0;i<e.length;i++)e[i]._quick_refresh=!0;for(t(),i=0;i<e.length;i++)e[i]._quick_refresh=!1};var a=function(){this._clearTaskLayers&&this._clearTaskLayers(),this._clearLinkLayers&&this._clearLinkLayers(),this.$layout&&(this.$layout.destructor(),this.$layout=null,this.$ui.reset())}.bind(t),r=function(){It(t)||(this.$root.innerHTML="",this.$root.gantt=this,Ht(this),this.config.layout.id="main",this.$layout=this.$ui.createView("layout",this.$root,this.config.layout),this.$layout.attachEvent("onBeforeResize",(function(){for(var e=t.$services.getService("datastores"),i=0;i<e.length;i++)t.getDatastore(e[i]).filter(),t.$data.tasksStore._skipTaskRecalculation?"lightbox"!=t.$data.tasksStore._skipTaskRecalculation&&(t.$data.tasksStore._skipTaskRecalculation=!1):t.getDatastore(e[i]).callEvent("onBeforeRefreshAll",[])})),this.$layout.attachEvent("onResize",(function(){t._quickRefresh((function(){t.refreshData()}))})),this.callEvent("onGanttLayoutReady",[]),this.$layout.render(),this.$container=this.$layout.$container.firstChild,function(t){"static"==window.getComputedStyle(t.$root).getPropertyValue("position")&&(t.$root.style.position="relative");var e=document.createElement("iframe");e.className="gantt_container_resize_watcher",e.tabIndex=-1,t.config.wai_aria_attributes&&(e.setAttribute("role","none"),e.setAttribute("aria-hidden",!0)),t.env.isSalesforce&&(t.config.container_resize_method="timeout"),t.$root.appendChild(e),e.contentWindow?Ce(t,e.contentWindow):(t.$root.removeChild(e),Ce(t,window))}(this))}.bind(t);t.resetLayout=function(){a(),r(),this.render()},t._reinit=function(e){var i;this.callEvent("onBeforeGanttReady",[]),this._update_flags(),this.$services.getService("templateLoader").initTemplates(this),a(),this.$root=null,e&&(this.$root=u(e),r(),this.$mouseEvents.reset(this.$root),(i=t).$container&&!i.config.autosize&&i.$root.offsetHeight<50&&console.warn("The Gantt container has a small height, so you cannot see its content. If it is not intended, you need to set the 'height' style rule to the container:\nhttps://docs.dhtmlx.com/gantt/faq.html#theganttchartisntrenderedcorrectly")),this.callEvent("onTemplatesReady",[]),this.callEvent("onGanttReady",[]),this.render()},t.$click={buttons:{edit:function(e){t.isReadonly(t.getTask(e))||t.showLightbox(e)},delete:function(e){var i=t.getTask(e);if(!t.isReadonly(i)){var n=t.locale.labels.confirm_deleting,a=t.locale.labels.confirm_deleting_title;t._delete_task_confirm({task:i,message:n,title:a,callback:function(){t.isTaskExists(e)&&(i.$new?(t.$data.tasksStore._skipTaskRecalculation="lightbox",t.silent((function(){t.deleteTask(e,!0)})),t.$data.tasksStore._skipTaskRecalculation=!1,t.refreshData()):(t.$data.tasksStore._skipTaskRecalculation=!0,t.deleteTask(e))),t.hideLightbox()}})}}}},t.render=function(){var e;if(this.callEvent("onBeforeGanttRender",[]),!It(t)){!this.config.sort&&this._sort&&(this._sort=void 0),this.$root&&(this.config.rtl?(this.$root.classList.add("gantt_rtl"),this.$root.firstChild.classList.add("gantt_rtl")):(this.$root.classList.remove("gantt_rtl"),this.$root.firstChild.classList.remove("gantt_rtl")));var i=this.getScrollState(),n=i?i.x:0;this._getHorizontalScrollbar()&&(n=this._getHorizontalScrollbar().$config.codeScrollLeft||n||0),e=null,n&&(e=t.dateFromPos(n+this.config.task_scroll_offset))}if(Ht(this),It(t))t.refreshData();else{this.$layout.$config.autosize=this.config.autosize;var a=this.config.preserve_scroll;if(this.config.preserve_scroll=!1,this.$layout.resize(),this.config.preserve_scroll=a,this.config.preserve_scroll&&i){if(n||i.y){var r=t.getScrollState();if(+e!=+t.dateFromPos(r.x)||r.y!=i.y){n=null;var s=null;e&&(n=Math.max(t.posFromDate(e)-t.config.task_scroll_offset,0)),i.y&&(s=i.y),t.scrollTo(n,s)}}this.$layout.getScrollbarsInfo().forEach((e=>{const n=t.$ui.getView(e.id),a=t.utils.dom.isChildOf(n.$view,t.$container);e.boundViews.forEach((n=>{const r=t.$ui.getView(n);e.y&&e.y!=i.y&&r&&!a&&r.scrollTo(void 0,0),e.x_pos&&e.x_pos!=i.x&&r&&a&&r.scrollTo(e.x_pos,void 0)}))}))}}this.callEvent("onGanttRender",[])},t.setSizes=t.render,t.getTaskRowNode=function(t){for(var e=this.$grid_data.childNodes,i=this.config.task_attribute,n=0;n<e.length;n++)if(e[n].getAttribute&&e[n].getAttribute(i)==t)return e[n];return null},t.changeLightboxType=function(e){if(this.getLightboxType()==e)return!0;t._silent_redraw_lightbox(e)},t._get_link_type=function(e,i){var n=null;return e&&i?n=t.config.links.start_to_start:!e&&i?n=t.config.links.finish_to_start:e||i?e&&!i&&(n=t.config.links.start_to_finish):n=t.config.links.finish_to_finish,n},t.isLinkAllowed=function(t,e,i,n){var a;if(!(a="object"==typeof t?t:{source:t,target:e,type:this._get_link_type(i,n)})||!(a.source&&a.target&&a.type)||a.source==a.target)return!1;var r=!0;return this.checkEvent("onLinkValidation")&&(r=this.callEvent("onLinkValidation",[a])),r},t._correct_dst_change=function(e,i,n,a){var r=L(a)*n;if(r>3600&&r<86400){var s=e.getTimezoneOffset()-i;s&&(e=t.date.add(e,s,"minute"))}return e},t.isSplitTask=function(e){return t.assert(e&&e instanceof Object,"Invalid argument <b>task</b>="+e+" of gantt.isSplitTask. Task object was expected"),this.$data.tasksStore._isSplitItem(e)},t._is_icon_open_click=function(t){if(!t)return!1;var e=t.target||t.srcElement;if(!e||!e.className)return!1;var i=l(e);return-1!==i.indexOf("gantt_tree_icon")&&(-1!==i.indexOf("gantt_close")||-1!==i.indexOf("gantt_open"))}}(i),function(t){t.destructor=function(){for(var t in this.clearAll(),this.callEvent("onDestroy",[]),this._getDatastores().forEach((function(t){t.destructor()})),this.$root&&delete this.$root.gantt,this._eventRemoveAll&&this._eventRemoveAll(),this.$layout&&this.$layout.destructor(),this.resetLightbox&&this.resetLightbox(),this.ext.inlineEditors&&this.ext.inlineEditors.destructor&&this.ext.inlineEditors.destructor(),this._dp&&this._dp.destructor&&this._dp.destructor(),this.$services.destructor(),this.detachAllEvents(),this)0===t.indexOf("$")&&delete this[t];this.$destroyed=!0}}(i);var d=new Ke({en:Oe,ar:Ae,be:Ie,ca:Me,cn:Ne,cs:Le,da:Pe,de:Re,el:He,es:Be,fa:ze,fi:We,fr:je,he:Fe,hr:Ve,hu:Ue,id:qe,it:Ge,jp:Ye,kr:Je,nb:Xe,nl:Ze,no:Qe,pl:ti,pt:ei,ro:ii,ru:ni,si:ai,sk:ri,sv:si,tr:oi,ua:li});return i.i18n={addLocale:d.addLocale,setLocale:function(t){if("string"==typeof t){var e=d.getLocale(t);e||(e=d.getLocale("en")),i.locale=e}else if(t)if(i.locale)for(var n in t)t[n]&&"object"==typeof t[n]?(i.locale[n]||(i.locale[n]={}),i.mixin(i.locale[n],t[n],!0)):i.locale[n]=t[n];else i.locale=t;const a=i.locale.labels;a.gantt_save_btn=a.gantt_save_btn||a.icon_save,a.gantt_cancel_btn=a.gantt_cancel_btn||a.icon_cancel,a.gantt_delete_btn=a.gantt_delete_btn||a.icon_delete},getLocale:d.getLocale},i.i18n.setLocale("en"),i}function ui(t){var e="data-dhxbox",i=null;function n(t,e){var n=t.callback;m.hide(t.box),i=t.box=null,n&&n(e)}function a(t){if(i){var e=t.which||t.keyCode,a=!1;if(v.keyboard){if(13==e||32==e){var r=t.target||t.srcElement;l(r).indexOf("gantt_popup_button")>-1&&r.click?r.click():(n(i,!0),a=!0)}27==e&&(n(i,!1),a=!0)}return a?(t.preventDefault&&t.preventDefault(),!(t.cancelBubble=!0)):void 0}}var r=E(t.$root)||document;function o(t){o.cover||(o.cover=document.createElement("div"),o.cover.onkeydown=a,o.cover.className="dhx_modal_cover",document.body.appendChild(o.cover)),o.cover.style.display=t?"inline-block":"none"}function d(e,i,n){return"<div "+t._waiAria.messageButtonAttrString(e)+" class='gantt_popup_button gantt_"+i.toLowerCase().replace(/ /g,"_")+"_button' data-result='"+n+"' result='"+n+"' ><div>"+e+"</div></div>"}function c(){for(var t=[].slice.apply(arguments,[0]),e=0;e<t.length;e++)if(t[e])return t[e]}function u(r,s,l){var u=r.tagName?r:function(a,r,s){var o=document.createElement("div"),l=tt();t._waiAria.messageModalAttr(o,l),o.className=" gantt_modal_box gantt-"+a.type,o.setAttribute(e,1);var u="";if(a.width&&(o.style.width=a.width),a.height&&(o.style.height=a.height),a.title&&(u+='<div class="gantt_popup_title">'+a.title+"</div>"),u+='<div class="gantt_popup_text" id="'+l+'"><span>'+(a.content?"":a.text)+'</span></div><div  class="gantt_popup_controls">',r&&(u+=d(c(a.ok,t.locale.labels.message_ok,"OK"),"ok",!0)),s&&(u+=d(c(a.cancel,t.locale.labels.message_cancel,"Cancel"),"cancel",!1)),a.buttons)for(var h=0;h<a.buttons.length;h++){var _=a.buttons[h];u+="object"==typeof _?d(_.label,_.css||"gantt_"+_.label.toLowerCase()+"_button",_.value||h):d(_,_,h)}if(u+="</div>",o.innerHTML=u,a.content){var g=a.content;"string"==typeof g&&(g=document.getElementById(g)),"none"==g.style.display&&(g.style.display=""),o.childNodes[a.title?1:0].appendChild(g)}return o.onclick=function(t){var e=t.target||t.srcElement;if(e.className||(e=e.parentNode),$(e,".gantt_popup_button")){var i=e.getAttribute("data-result");n(a,i="true"==i||"false"!=i&&i)}},a.box=o,(r||s)&&(i=a),o}(r,s,l);r.hidden||o(!0),document.body.appendChild(u);var h=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-u.offsetWidth)/2)),_=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-u.offsetHeight)/2));return"top"==r.position?u.style.top="-3px":u.style.top=_+"px",u.style.left=h+"px",u.onkeydown=a,m.focus(u),r.hidden&&m.hide(u),t.callEvent("onMessagePopup",[u]),u}function h(t){return u(t,!0,!1)}function _(t){return u(t,!0,!0)}function g(t){return u(t)}function f(t,e,i){return"object"!=typeof t&&("function"==typeof e&&(i=e,e=""),t={text:t,type:e,callback:i}),t}function p(t,e,i,n){return"object"!=typeof t&&(t={text:t,type:e,expire:i,id:n}),t.id=t.id||tt(),t.expire=t.expire||v.expire,t}t.event(r,"keydown",a,!0);var m=function(){var t=f.apply(this,arguments);return t.type=t.type||"alert",g(t)};m.hide=function(i){for(;i&&i.getAttribute&&!i.getAttribute(e);)i=i.parentNode;i&&(i.parentNode.removeChild(i),o(!1),t.callEvent("onAfterMessagePopup",[i]))},m.focus=function(t){setTimeout((function(){var e=s(t);e.length&&e[0].focus&&e[0].focus()}),1)};var v=function(e,i,n,a){switch((e=p.apply(this,arguments)).type=e.type||"info",e.type.split("-")[0]){case"alert":return h(e);case"confirm":return _(e);case"modalbox":return g(e);default:return function(e){v.area||(v.area=document.createElement("div"),v.area.className="gantt_message_area",v.area.style[v.position]="5px"),x(v.area,document.body)||document.body.appendChild(v.area),v.hide(e.id);var i=document.createElement("div");return i.innerHTML="<div>"+e.text+"</div>",i.className="gantt-info gantt-"+e.type,i.onclick=function(){v.hide(e.id),e=null},t._waiAria.messageInfoAttr(i),"bottom"==v.position&&v.area.firstChild?v.area.insertBefore(i,v.area.firstChild):v.area.appendChild(i),e.expire>0&&(v.timers[e.id]=window.setTimeout((function(){v&&v.hide(e.id)}),e.expire)),v.pull[e.id]=i,i=null,e.id}(e)}};v.seed=(new Date).valueOf(),v.uid=tt,v.expire=4e3,v.keyboard=!0,v.position="top",v.pull={},v.timers={},v.hideAll=function(){for(var t in v.pull)v.hide(t)},v.hide=function(t){var e=v.pull[t];e&&e.parentNode&&(window.setTimeout((function(){e.parentNode.removeChild(e),e=null}),2e3),e.className+=" hidden",v.timers[t]&&window.clearTimeout(v.timers[t]),delete v.pull[t])};var k=[];return t.attachEvent("onMessagePopup",(function(t){k.push(t)})),t.attachEvent("onAfterMessagePopup",(function(t){for(var e=0;e<k.length;e++)k[e]===t&&(k.splice(e,1),e--)})),t.attachEvent("onDestroy",(function(){o.cover&&o.cover.parentNode&&o.cover.parentNode.removeChild(o.cover);for(var t=0;t<k.length;t++)k[t].parentNode&&k[t].parentNode.removeChild(k[t]);k=null,v.area&&v.area.parentNode&&v.area.parentNode.removeChild(v.area),v=null})),{alert:function(){var t=f.apply(this,arguments);return t.type=t.type||"confirm",h(t)},confirm:function(){var t=f.apply(this,arguments);return t.type=t.type||"alert",_(t)},message:v,modalbox:m}}function hi(t,e){var i=this.$config[t];return i?(i.$extendedConfig||(i.$extendedConfig=!0,Object.setPrototypeOf(i,e)),i):e}const _i=function(t){var e={},i={};function n(n,a,r,s){var o=e[n];if(!o||!o.create)return!1;"resizer"!=n||r.mode||(s.$config.cols?r.mode="x":r.mode="y"),"viewcell"!=n||"scrollbar"!=r.view||r.scroll||(s.$config.cols?r.scroll="y":r.scroll="x"),(r=X(r)).id||i[r.view]||(r.id=r.view),r.id&&!r.css&&(r.css=r.id+"_cell");var l=new o.create(a,r,this,t);return o.configure&&o.configure(l),function(t,e){var i,n,a;Z(t,(i=e,{$getConfig:function(){return n||(n=i?i.$getConfig():this.$gantt.config),this.$config.config?hi.call(this,"config",n):n},$getTemplates:function(){return a||(a=i?i.$getTemplates():this.$gantt.templates),this.$config.templates?hi.call(this,"templates",a):a}}))}(l,s),l.$id||(l.$id=r.id||t.uid()),l.$parent||"object"!=typeof a||(l.$parent=a),l.$config||(l.$config=r),i[l.$id]&&(l.$id=t.uid()),i[l.$id]=l,l}return{initUI:function(t,e){var i="cell";return t.view?i="viewcell":t.resizer?i="resizer":t.rows||t.cols?i="layout":t.views&&(i="multiview"),n.call(this,i,null,t,e)},reset:function(){i={}},registerView:function(t,i,n){e[t]={create:i,configure:n}},createView:n,getView:function(t){return i[t]}}};var gi;const fi={init:(gi=C,function(t){var e={click:{},doubleclick:{},contextMenu:{}};function i(t,i,n,a){e[t][i]||(e[t][i]=[]),e[t][i].push({handler:n,root:a})}function n(i){i=i||window.event;var n=t.locate(i),a=r(i,e.click),o=!0;if(null!==n?o=!t.checkEvent("onTaskClick")||t.callEvent("onTaskClick",[n,i]):t.callEvent("onEmptyClick",[i]),o){if(!s(a,i,n))return;switch(i.target.nodeName){case"SELECT":case"INPUT":return}n&&t.getTask(n)&&!t._multiselect&&t.config.select_task&&t.selectTask(n)}}function a(e){var i=(e=e||window.event).target||e.srcElement,n=t.locate(i),a=t.locate(i,t.config.link_attribute),r=!t.checkEvent("onContextMenu")||t.callEvent("onContextMenu",[n,a,e]);return r||(e.preventDefault?e.preventDefault():e.returnValue=!1),r}function r(t,e){for(var i=t.target||t.srcElement,n=[];i;){var a=gi.getClassName(i);if(a){a=a.split(" ");for(var r=0;r<a.length;r++)if(a[r]&&e[a[r]])for(var s=e[a[r]],o=0;o<s.length;o++)s[o].root&&!gi.isChildOf(i,s[o].root)||n.push(s[o].handler)}i=i.parentNode}return n}function s(e,i,n){for(var a=!0,r=0;r<e.length;r++){var s=e[r].call(t,i,n,i.target||i.srcElement);a=a&&!(void 0!==s&&!0!==s)}return a}function o(i){i=i||window.event;var n=t.locate(i),a=r(i,e.doubleclick),o=!t.checkEvent("onTaskDblClick")||null===n||t.callEvent("onTaskDblClick",[n,i]);if(o){if(!s(a,i,n))return;null!==n&&t.getTask(n)&&o&&t.config.details_on_dblclick&&!t.isReadonly(n)&&t.showLightbox(n)}}function l(e){if(t.checkEvent("onMouseMove")){var i=t.locate(e);t._last_move_event=e,t.callEvent("onMouseMove",[i,e])}}var d=t._createDomEventScope();function c(t){d.detachAll(),t&&(d.attach(t,"click",n),d.attach(t,"dblclick",o),d.attach(t,"mousemove",l),d.attach(t,"contextmenu",a))}return{reset:c,global:function(t,e,n){i(t,e,n,null)},delegate:i,detach:function(t,i,n,a){if(e[t]&&e[t][i]){for(var r=e[t],s=r[i],o=0;o<s.length;o++)s[o].root==a&&(s.splice(o,1),o--);s.length||delete r[i]}},callHandler:function(t,i,n,a){var r=e[t][i];if(r)for(var s=0;s<r.length;s++)(n||r[s].root)&&r[s].root!==n||r[s].handler.apply(this,a)},onDoubleClick:o,onMouseMove:l,onContextMenu:a,onClick:n,destructor:function(){c(),e=null,d=null}}})};function pi(t,e,i){return!!e&&!(e.left>t.x_end||e.left+e.width<t.x)&&!(e.top>t.y_end||e.top+e.height<t.y)}function mi(t){return t.config.smart_rendering&&t._smart_render}function vi(t,e,i){return{top:e.getItemTop(t.id),height:e.getItemHeight(t.id),left:0,right:1/0}}function ki(t,e,i,n,a){var r=e.getItemIndexByTopPosition(a.y)||0,s=e.getItemIndexByTopPosition(a.y_end)||n.count(),o=Math.max(0,r-1),l=Math.min(n.count(),s+1);const d=[];if(t.config.keyboard_navigation&&t.getSelectedId()){let e=t.getTask(t.getSelectedId());e.$expanded_branch&&!e.$split_subtask&&d.push(t.getSelectedId())}if(t.$ui.getView("grid")&&t.ext.inlineEditors&&t.ext.inlineEditors.getState().id){let e=t.ext.inlineEditors.getState().id;n.exists(e)&&d.push(e)}return{start:o,end:l,ids:d}}function yi(t){return t instanceof Array||(t=Array.prototype.slice.call(arguments,0)),function(e){for(var i=!0,n=0,a=t.length;n<a;n++){var r=t[n];r&&(i=i&&!1!==r(e.id,e))}return i}}function bi(t,e,i){if(!t.start_date||!t.end_date)return null;var n=e.posFromDate(t.start_date),a=e.posFromDate(t.end_date),r=Math.min(n,a)-200,s=Math.max(n,a)+200;return{top:e.getItemTop(t.id),height:e.getItemHeight(t.id),left:r,width:s-r}}function xi(){var t=[],e=!1;function i(){t=[],e=!1}var n=!1;return function(a,r,s,o,l){var d;d=o,n||(n=!0,d.attachEvent("onPreFilter",i),d.attachEvent("onStoreUpdated",i),d.attachEvent("onClearAll",i),d.attachEvent("onBeforeStoreUpdate",i)),e||function(i,n,a){n.$getConfig(),i.getVisibleItems().forEach((function(e){var i=function(t,e,i,n){if(!n.isTaskExists(t.source)||!n.isTaskExists(t.target))return null;var a=bi(n.getTask(t.source),e),r=bi(n.getTask(t.target),e);if(!a||!r)return null;var s=100,o=Math.min(a.left,r.left)-s,l=Math.max(a.left+a.width,r.left+r.width)+s,d=Math.min(a.top,r.top)-s,c=Math.max(a.top+a.height,r.top+r.height)+s;return{top:d,height:c-d,bottom:c,left:o,width:l-o,right:l}}(e,n,0,a);i&&t.push({id:e.id,rec:i})})),t.sort((function(t,e){return t.rec.right<e.rec.right?-1:1})),e=!0}(o,r,a);for(var c=[],u=0;u<t.length;u++){var h=t[u],_=h.rec;_.right<l.x||_.left<l.x_end&&_.right>l.x&&_.top<l.y_end&&_.bottom>l.y&&c.push(h.id)}return{ids:c}}}function $i(t,e,i,n,a){var r=i.$gantt.getTask(t.source),s=i.$gantt.getTask(t.target),o=i.getItemTop(r.id),l=i.getItemHeight(r.id),d=i.getItemTop(s.id),c=i.getItemHeight(s.id);if(e.y>o+l&&e.y>d+c||e.y_end<d&&e.y_end<o)return!1;var u=i.posFromDate(r.start_date),h=i.posFromDate(r.end_date),_=i.posFromDate(s.start_date),g=i.posFromDate(s.end_date);if(u>h){var f=h;h=u,u=f}return _>g&&(f=g,g=_,_=f),u+=-100,h+=100,_+=-100,g+=100,!(e.x>h&&e.x>g||e.x_end<u&&e.x_end<_)}function wi(t,e){if(t.view){var i=t.view;"string"==typeof i&&(i=e.$ui.getView(i)),i&&i.attachEvent&&i.attachEvent("onScroll",(function(){e.$services.getService("state").getState("batchUpdate").batch_update||i.$config.$skipSmartRenderOnScroll||t.requestUpdate&&t.requestUpdate()}))}}var Si=function(){function t(t,e,i,n){t&&(this.$container=u(t),this.$parent=t),this.$config=Z(e,{headerHeight:33}),this.$gantt=n,this.$domEvents=n._createDomEventScope(),this.$id=e.id||"c"+tt(),this.$name="cell",this.$factory=i,this.$externalComponent=null,M(this)}return t.prototype.destructor=function(){this.$parent=this.$container=this.$view=null,this.$gantt.$services.getService("mouseEvents").detach("click","gantt_header_arrow",this._headerClickHandler),this.$domEvents.detachAll(),this.callEvent("onDestroy",[]),this.detachAllEvents()},t.prototype.cell=function(t){return null},t.prototype.scrollTo=function(t,e){var i=this.$view;this.$config.html&&(i=this.$view.firstChild),1*t==t&&(i.scrollLeft=t),1*e==e&&(i.scrollTop=e)},t.prototype.clear=function(){this.getNode().innerHTML="",this.getNode().className="gantt_layout_content",this.getNode().style.padding="0"},t.prototype.resize=function(t){if(this.$parent)return this.$parent.resize(t);!1===t&&(this.$preResize=!0);var e=this.$container,i=e.offsetWidth,n=e.offsetHeight,a=this.getSize();e===document.body&&(i=document.body.offsetWidth,n=document.body.offsetHeight),i<a.minWidth&&(i=a.minWidth),i>a.maxWidth&&(i=a.maxWidth),n<a.minHeight&&(n=a.minHeight),n>a.maxHeight&&(n=a.maxHeight),this.setSize(i,n),this.$preResize,this.$preResize=!1},t.prototype.hide=function(){this._hide(!0),this.resize()},t.prototype.show=function(t){this._hide(!1),t&&this.$parent&&this.$parent.show(),this.resize()},t.prototype._hide=function(t){if(!0===t&&this.$view.parentNode)this.$view.parentNode.removeChild(this.$view);else if(!1===t&&!this.$view.parentNode){var e=this.$parent.cellIndex(this.$id);this.$parent.moveView(this,e)}this.$config.hidden=t},t.prototype.$toHTML=function(t,e){void 0===t&&(t=""),e=[e||"",this.$config.css||""].join(" ");var i=this.$config,n="";if(i.raw)t="string"==typeof i.raw?i.raw:"";else{if(!t){let n=null;n="function"==typeof i.html?i.html():i.html,this.$gantt.config.external_render&&this.$gantt.config.external_render.isElement(n)&&(this.$externalComponent=n,n=null),t="<div class='gantt_layout_content' "+(e?" class='"+e+"' ":"")+" >"+(n||"")+"</div>"}i.header&&(n="<div class='gantt_layout_header'>"+(i.canCollapse?"<div class='gantt_layout_header_arrow'></div>":"")+"<div class='gantt_layout_header_content'>"+i.header+"</div></div>")}return"<div class='gantt_layout_cell "+e+"' data-cell-id='"+this.$id+"'>"+n+t+"</div>"},t.prototype.$fill=function(t,e){this.$view=t,this.$parent=e,this.init()},t.prototype.getNode=function(){return this.$view.querySelector("gantt_layout_cell")||this.$view},t.prototype.init=function(){var t=this;this._headerClickHandler=function(e){m(e,"data-cell-id")==t.$id&&t.toggle()},this.$gantt.$services.getService("mouseEvents").delegate("click","gantt_header_arrow",this._headerClickHandler),this.callEvent("onReady",[])},t.prototype.toggle=function(){this.$config.collapsed=!this.$config.collapsed,this.resize()},t.prototype.getSize=function(){var t={height:this.$config.height||0,width:this.$config.width||0,gravity:this.$config.gravity||1,minHeight:this.$config.minHeight||0,minWidth:this.$config.minWidth||0,maxHeight:this.$config.maxHeight||1e11,maxWidth:this.$config.maxWidth||1e11};if(this.$config.collapsed){var e="x"===this.$config.mode;t[e?"width":"height"]=t[e?"maxWidth":"maxHeight"]=this.$config.headerHeight}return t},t.prototype.getContentSize=function(){var t=this.$lastSize.contentX;t!==1*t&&(t=this.$lastSize.width);var e=this.$lastSize.contentY;return e!==1*e&&(e=this.$lastSize.height),{width:t,height:e}},t.prototype._getBorderSizes=function(){var t={top:0,right:0,bottom:0,left:0,horizontal:0,vertical:0};return this._currentBorders&&(this._currentBorders[this._borders.left]&&(t.left=1,t.horizontal++),this._currentBorders[this._borders.right]&&(t.right=1,t.horizontal++),this._currentBorders[this._borders.top]&&(t.top=1,t.vertical++),this._currentBorders[this._borders.bottom]&&(t.bottom=1,t.vertical++)),t},t.prototype.setSize=function(t,e){this.$view.style.width=t+"px",this.$view.style.height=e+"px";var i=this._getBorderSizes(),n=e-i.vertical,a=t-i.horizontal;this.$lastSize={x:t,y:e,contentX:a,contentY:n},this.$config.header?this._sizeHeader():this._sizeContent()},t.prototype._borders={left:"gantt_layout_cell_border_left",right:"gantt_layout_cell_border_right",top:"gantt_layout_cell_border_top",bottom:"gantt_layout_cell_border_bottom"},t.prototype._setBorders=function(t,e){e||(e=this);var i=e.$view;for(var n in this._borders)c(i,this._borders[n]);"string"==typeof t&&(t=[t]);var a={};for(n=0;n<t.length;n++)d(i,t[n]),a[t[n]]=!0;e._currentBorders=a},t.prototype._sizeContent=function(){var t=this.$view.childNodes[0];t&&"gantt_layout_content"==t.className&&(t.style.height=this.$lastSize.contentY+"px")},t.prototype._sizeHeader=function(){var t=this.$lastSize;t.contentY-=this.$config.headerHeight;var e=this.$view.childNodes[0],i=this.$view.childNodes[1],n="x"===this.$config.mode;if(this.$config.collapsed)if(i.style.display="none",n){e.className="gantt_layout_header collapsed_x",e.style.width=t.y+"px";var a=Math.floor(t.y/2-t.x/2);e.style.transform="rotate(90deg) translate("+a+"px, "+a+"px)",i.style.display="none"}else e.className="gantt_layout_header collapsed_y";else e.className=n?"gantt_layout_header":"gantt_layout_header vertical",e.style.width="auto",e.style.transform="",i.style.display="",i.style.height=t.contentY+"px";e.style.height=this.$config.headerHeight+"px"},t}();function Ti(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Ei=function(t){function e(e,i,n){var a=t.apply(this,arguments)||this;return e&&(a.$root=!0),a._parseConfig(i),a.$name="layout",a}return Ti(e,t),e.prototype.destructor=function(){this.$container&&this.$view&&g(this.$view);for(var e=0;e<this.$cells.length;e++)this.$cells[e].destructor();this.$cells=[],t.prototype.destructor.call(this)},e.prototype._resizeScrollbars=function(t,e){var i=!1,n=[],a=[];const r=[];function s(t){t.$parent.show(),i=!0,n.push(t)}function o(t){t.$parent.hide(),i=!0,a.push(t)}for(var l,d=0;d<e.length;d++)t[(l=e[d]).$config.scroll]?o(l):l.shouldHide()?r.push(l):l.shouldShow()?s(l):l.isVisible()?n.push(l):a.push(l);var c={};for(d=0;d<n.length;d++)n[d].$config.group&&(c[n[d].$config.group]=!0);for(r.forEach((function(t){t.$config.group&&c[t.$config.group]||o(t)})),d=0;d<a.length;d++)if((l=a[d]).$config.group&&c[l.$config.group]){s(l);for(var u=0;u<n.length;u++)if(n[u]==l){this.$gantt.$scrollbarRepaint=!0;break}}return i},e.prototype.getScrollbarsInfo=function(){const t=this.getCellsByType("scroller"),e=[];return t.forEach((t=>{let i={};const{visible:n,direction:a,size:r,scrollSize:s,position:o}=t.getScrollState();let l=t._getLinkedViews().map((t=>t.$config.id));i.id=t.$id,i.visible=n,i.boundViews=l,"x"===a?(i.x=r,i.x_inner=s,i.x_pos=o||0):(i.y=r,i.y_inner=s,i.y_pos=o||0),e.push(i)})),e},e.prototype._syncCellSizes=function(t,e){if(t){var i={};return this._eachChild((function(t){t.$config.group&&"scrollbar"!=t.$name&&"resizer"!=t.$name&&(i[t.$config.group]||(i[t.$config.group]=[]),i[t.$config.group].push(t))})),i[t]&&this._syncGroupSize(i[t],e),i[t]}},e.prototype._syncGroupSize=function(t,e){if(t.length)for(var i=t[0].$parent._xLayout?"width":"height",n=t[0].$parent.getNextSibling(t[0].$id)?1:-1,a=e.value,r=e.isGravity,s=0;s<t.length;s++){var o=t[s].getSize(),l=n>0?t[s].$parent.getNextSibling(t[s].$id):t[s].$parent.getPrevSibling(t[s].$id);"resizer"==l.$name&&(l=n>0?l.$parent.getNextSibling(l.$id):l.$parent.getPrevSibling(l.$id));var d=l.getSize();if(r)t[s].$config.gravity=a;else if(l[i]){var c=o.gravity+d.gravity,u=o[i]+d[i],h=c/u;t[s].$config.gravity=h*a,l.$config[i]=u-a,l.$config.gravity=c-h*a}else t[s].$config[i]=a;var _=this.$gantt.$ui.getView("grid");!_||t[s].$content!==_||_.$config.scrollable||r||(this.$gantt.config.grid_width=a)}},e.prototype.resize=function(e){var i=!1;if(this.$root&&!this._resizeInProgress&&(this.callEvent("onBeforeResize",[]),i=!0,this._resizeInProgress=!0),t.prototype.resize.call(this,!0),t.prototype.resize.call(this,!1),i){var n=[];n=(n=(n=n.concat(this.getCellsByType("viewCell"))).concat(this.getCellsByType("viewLayout"))).concat(this.getCellsByType("hostCell"));for(var a=this.getCellsByType("scroller"),r=0;r<n.length;r++)n[r].$config.hidden||n[r].setContentSize();var s=this._getAutosizeMode(this.$config.autosize),o=this._resizeScrollbars(s,a);if(this.$config.autosize&&(this.autosize(this.$config.autosize),n.forEach((function(t){const e=t.$parent,i=e.getContentSize(s);s.x&&(e.$config.$originalWidthStored||(e.$config.$originalWidthStored=!0,e.$config.$originalWidth=e.$config.width),e.$config.width=i.width),s.y&&(e.$config.$originalHeightStored||(e.$config.$originalHeightStored=!0,e.$config.$originalHeight=e.$config.height),e.$config.height=i.height)})),o=!0),o)for(this.resize(),r=0;r<n.length;r++)n[r].$config.hidden||n[r].setContentSize();this.callEvent("onResize",[])}i&&(this._resizeInProgress=!1)},e.prototype._eachChild=function(t,e){if(t(e=e||this),e.$cells)for(var i=0;i<e.$cells.length;i++)this._eachChild(t,e.$cells[i])},e.prototype.isChild=function(t){var e=!1;return this._eachChild((function(i){i!==t&&i.$content!==t||(e=!0)})),e},e.prototype.getCellsByType=function(t){var i=[];if(t===this.$name&&i.push(this),this.$content&&this.$content.$name==t&&i.push(this.$content),this.$cells)for(var n=0;n<this.$cells.length;n++){var a=e.prototype.getCellsByType.call(this.$cells[n],t);a.length&&i.push.apply(i,a)}return i},e.prototype.getNextSibling=function(t){var e=this.cellIndex(t);return e>=0&&this.$cells[e+1]?this.$cells[e+1]:null},e.prototype.getPrevSibling=function(t){var e=this.cellIndex(t);return e>=0&&this.$cells[e-1]?this.$cells[e-1]:null},e.prototype.cell=function(t){for(var e=0;e<this.$cells.length;e++){var i=this.$cells[e];if(i.$id===t)return i;var n=i.cell(t);if(n)return n}},e.prototype.cellIndex=function(t){for(var e=0;e<this.$cells.length;e++)if(this.$cells[e].$id===t)return e;return-1},e.prototype.moveView=function(t,e){if(this.$cells[e]!==t)return window.alert("Not implemented");e+=this.$config.header?1:0;var i=this.$view;e>=i.childNodes.length?i.appendChild(t.$view):i.insertBefore(t.$view,i.childNodes[e])},e.prototype._parseConfig=function(t){this.$cells=[],this._xLayout=!t.rows;for(var e=t.rows||t.cols||t.views,i=0;i<e.length;i++){var n=e[i];n.mode=this._xLayout?"x":"y";var a=this.$factory.initUI(n,this);a?(a.$parent=this,this.$cells.push(a)):(e.splice(i,1),i--)}},e.prototype.getCells=function(){return this.$cells},e.prototype.render=function(){var t=_(this.$container,this.$toHTML());this.$fill(t,null);const e=this.$gantt;this._eachChild((t=>{t.$externalComponent&&(e.config.external_render.renderElement(t.$externalComponent,t.$view.querySelector(".gantt_layout_content")),t.$externalComponent=null)})),this.callEvent("onReady",[]),this.resize(),this.render=this.resize},e.prototype.$fill=function(t,e){this.$view=t,this.$parent=e;for(var i=f(t,"gantt_layout_cell"),n=i.length-1;n>=0;n--){var a=this.$cells[n];a.$fill(i[n],this),a.$config.hidden&&a.$view.parentNode.removeChild(a.$view)}},e.prototype.$toHTML=function(){for(var e=this._xLayout?"x":"y",i=[],n=0;n<this.$cells.length;n++)i.push(this.$cells[n].$toHTML());return t.prototype.$toHTML.call(this,i.join(""),(this.$root?"gantt_layout_root ":"")+"gantt_layout gantt_layout_"+e)},e.prototype.getContentSize=function(t){for(var e,i,n,a=0,r=0,s=0;s<this.$cells.length;s++)(i=this.$cells[s]).$config.hidden||(e=i.getContentSize(t),"scrollbar"===i.$config.view&&t[i.$config.scroll]&&(e.height=0,e.width=0),i.$config.resizer&&(this._xLayout?e.height=0:e.width=0),n=i._getBorderSizes(),this._xLayout?(a+=e.width+n.horizontal,r=Math.max(r,e.height+n.vertical)):(a=Math.max(a,e.width+n.horizontal),r+=e.height+n.vertical));return{width:a+=(n=this._getBorderSizes()).horizontal,height:r+=n.vertical}},e.prototype._cleanElSize=function(t){return 1*(t||"").toString().replace("px","")||0},e.prototype._getBoxStyles=function(t){var e,i=["width","height","paddingTop","paddingBottom","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],n={boxSizing:"border-box"==(e=window.getComputedStyle?window.getComputedStyle(t,null):{width:t.clientWidth,height:t.clientHeight}).boxSizing};e.MozBoxSizing&&(n.boxSizing="border-box"==e.MozBoxSizing);for(var a=0;a<i.length;a++)n[i[a]]=e[i[a]]?this._cleanElSize(e[i[a]]):0;var r={horPaddings:n.paddingLeft+n.paddingRight+n.borderLeftWidth+n.borderRightWidth,vertPaddings:n.paddingTop+n.paddingBottom+n.borderTopWidth+n.borderBottomWidth,borderBox:n.boxSizing,innerWidth:n.width,innerHeight:n.height,outerWidth:n.width,outerHeight:n.height};return r.borderBox?(r.innerWidth-=r.horPaddings,r.innerHeight-=r.vertPaddings):(r.outerWidth+=r.horPaddings,r.outerHeight+=r.vertPaddings),r},e.prototype._getAutosizeMode=function(t){var e={x:!1,y:!1};return"xy"===t?e.x=e.y=!0:"y"===t||!0===t?e.y=!0:"x"===t&&(e.x=!0),e},e.prototype.autosize=function(t){var e=this._getAutosizeMode(t),i=this._getBoxStyles(this.$container),n=this.getContentSize(t),a=this.$container;e.x&&(i.borderBox&&(n.width+=i.horPaddings),a.style.width=n.width+"px"),e.y&&(i.borderBox&&(n.height+=i.vertPaddings),a.style.height=n.height+"px")},e.prototype.getSize=function(){this._sizes=[];for(var e=0,i=0,n=1e11,a=0,r=1e11,s=0,o=0;o<this.$cells.length;o++){var l=this._sizes[o]=this.$cells[o].getSize();this.$cells[o].$config.hidden||(this._xLayout?(!l.width&&l.minWidth?e+=l.minWidth:e+=l.width,n+=l.maxWidth,i+=l.minWidth,a=Math.max(a,l.height),r=Math.min(r,l.maxHeight),s=Math.max(s,l.minHeight)):(!l.height&&l.minHeight?a+=l.minHeight:a+=l.height,r+=l.maxHeight,s+=l.minHeight,e=Math.max(e,l.width),n=Math.min(n,l.maxWidth),i=Math.max(i,l.minWidth)))}var d=t.prototype.getSize.call(this);return d.maxWidth>=1e5&&(d.maxWidth=n),d.maxHeight>=1e5&&(d.maxHeight=r),d.minWidth=d.minWidth!=d.minWidth?0:d.minWidth,d.minHeight=d.minHeight!=d.minHeight?0:d.minHeight,this._xLayout?(d.minWidth+=this.$config.margin*this.$cells.length||0,d.minWidth+=2*this.$config.padding||0,d.minHeight+=2*this.$config.padding||0):(d.minHeight+=this.$config.margin*this.$cells.length||0,d.minHeight+=2*this.$config.padding||0),d},e.prototype._calcFreeSpace=function(t,e,i){var n=i?e.minWidth:e.minHeight,a=e.maxWidth,r=t;return r?(r>a&&(r=a),r<n&&(r=n),this._free-=r):((r=Math.floor(this._free/this._gravity*e.gravity))>a&&(r=a,this._free-=r,this._gravity-=e.gravity),r<n&&(r=n,this._free-=r,this._gravity-=e.gravity)),r},e.prototype._calcSize=function(t,e,i){var n=t,a=i?e.minWidth:e.minHeight,r=i?e.maxWidth:e.maxHeight;return n||(n=Math.floor(this._free/this._gravity*e.gravity)),n>r&&(n=r),n<a&&(n=a),n},e.prototype._configureBorders=function(){this.$root&&this._setBorders([this._borders.left,this._borders.top,this._borders.right,this._borders.bottom],this);for(var t=this._xLayout?this._borders.right:this._borders.bottom,e=this.$cells,i=e.length-1,n=i;n>=0;n--)if(!e[n].$config.hidden){i=n;break}for(n=0;n<e.length;n++)if(!e[n].$config.hidden){var a=n>=i,r="";!a&&e[n+1]&&"scrollbar"==e[n+1].$config.view&&(this._xLayout?a=!0:r="gantt_layout_cell_border_transparent"),this._setBorders(a?[]:[t,r],e[n])}},e.prototype._updateCellVisibility=function(){for(var t=this._visibleCells||{},e=!this._visibleCells,i={},n=null,a=[],r=0;r<this._sizes.length;r++)(n=this.$cells[r]).$config.hide_empty&&a.push(n),!e&&n.$config.hidden&&t[n.$id]?n._hide(!0):n.$config.hidden||t[n.$id]||n._hide(!1),n.$config.hidden||(i[n.$id]=!0);for(this._visibleCells=i,r=0;r<a.length;r++){var s=(n=a[r]).$cells,o=!0;s.forEach((function(t){t.$config.hidden||t.$config.resizer||(o=!1)})),n.$config.hidden=o}},e.prototype.setSize=function(e,i){this._configureBorders(),t.prototype.setSize.call(this,e,i),i=this.$lastSize.contentY,e=this.$lastSize.contentX;var n,a,r=this.$config.padding||0;this.$view.style.padding=r+"px",this._gravity=0,this._free=this._xLayout?e:i,this._free-=2*r,this._updateCellVisibility();for(var s=0;s<this._sizes.length;s++)if(!(n=this.$cells[s]).$config.hidden){var o=this.$config.margin||0;"resizer"!=n.$name||o||(o=-1);var l=n.$view,d=this._xLayout?"marginRight":"marginBottom";s!==this.$cells.length-1&&(l.style[d]=o+"px",this._free-=o),a=this._sizes[s],this._xLayout?a.width||(this._gravity+=a.gravity):a.height||(this._gravity+=a.gravity)}for(s=0;s<this._sizes.length;s++)if(!(n=this.$cells[s]).$config.hidden){var c=(a=this._sizes[s]).width,u=a.height;this._xLayout?this._calcFreeSpace(c,a,!0):this._calcFreeSpace(u,a,!1)}for(s=0;s<this.$cells.length;s++)if(!(n=this.$cells[s]).$config.hidden){a=this._sizes[s];var h=void 0,_=void 0;this._xLayout?(h=this._calcSize(a.width,a,!0),_=i-2*r):(h=e-2*r,_=this._calcSize(a.height,a,!1)),n.setSize(h,_)}},e}(Si),Ci=function(t){function e(e,i,n){for(var a=t.apply(this,arguments)||this,r=0;r<a.$cells.length;r++)a.$cells[r].$config.hidden=0!==r;return a.$cell=a.$cells[0],a.$name="viewLayout",a}return Ti(e,t),e.prototype.cell=function(e){var i=t.prototype.cell.call(this,e);return i.$view||this.$fill(null,this),i},e.prototype.moveView=function(t){var e=this.$view;this.$cell&&(this.$cell.$config.hidden=!0,e.removeChild(this.$cell.$view)),this.$cell=t,e.appendChild(t.$view)},e.prototype.setSize=function(t,e){Si.prototype.setSize.call(this,t,e)},e.prototype.setContentSize=function(){var t=this.$lastSize;this.$cell.setSize(t.contentX,t.contentY)},e.prototype.getSize=function(){var e=t.prototype.getSize.call(this);if(this.$cell){var i=this.$cell.getSize();if(this.$config.byMaxSize)for(var n=0;n<this.$cells.length;n++){var a=this.$cells[n].getSize();for(var r in i)i[r]=Math.max(i[r],a[r])}for(var s in e)e[s]=e[s]||i[s];e.gravity=Math.max(e.gravity,i.gravity)}return e},e}(Ei),Di=function(t){function e(e,i,n){var a=t.apply(this,arguments)||this;if(i.view){i.id&&(this.$id=tt());var r=X(i);if(delete r.config,delete r.templates,this.$content=this.$factory.createView(i.view,this,r,this),!this.$content)return!1}return a.$name="viewCell",a}return Ti(e,t),e.prototype.destructor=function(){this.clear(),t.prototype.destructor.call(this)},e.prototype.clear=function(){if(this.$initialized=!1,this.$content){var e=this.$content.unload||this.$content.destructor;e&&e.call(this.$content)}t.prototype.clear.call(this)},e.prototype.scrollTo=function(e,i){this.$content&&this.$content.scrollTo?this.$content.scrollTo(e,i):t.prototype.scrollTo.call(this,e,i)},e.prototype._setContentSize=function(t,e){var i=this._getBorderSizes();if("number"==typeof t){var n=t+i.horizontal;this.$config.width=n}if("number"==typeof e){var a=e+i.vertical;this.$config.height=a}},e.prototype.setSize=function(e,i){if(t.prototype.setSize.call(this,e,i),!this.$preResize&&this.$content&&!this.$initialized){this.$initialized=!0;var n=this.$view.childNodes[0],a=this.$view.childNodes[1];a||(a=n),this.$content.init(a)}},e.prototype.setContentSize=function(){!this.$preResize&&this.$content&&this.$initialized&&this.$content.setSize(this.$lastSize.contentX,this.$lastSize.contentY)},e.prototype.getContentSize=function(){var e=t.prototype.getContentSize.call(this);if(this.$content&&this.$initialized){var i=this.$content.getSize();e.width=void 0===i.contentX?i.width:i.contentX,e.height=void 0===i.contentY?i.height:i.contentY}var n=this._getBorderSizes();return e.width+=n.horizontal,e.height+=n.vertical,e},e}(Si),Ai=function(t){var e=["altKey","shiftKey","metaKey"];function i(e,i,n,a){var r=t.apply(this,arguments)||this;this.$config=Z(i,{scroll:"x"}),r._scrollHorizontalHandler=et(r._scrollHorizontalHandler,r),r._scrollVerticalHandler=et(r._scrollVerticalHandler,r),r._outerScrollVerticalHandler=et(r._outerScrollVerticalHandler,r),r._outerScrollHorizontalHandler=et(r._outerScrollHorizontalHandler,r),r._mouseWheelHandler=et(r._mouseWheelHandler,r),this.$config.hidden=!0;var s=a.config.scroll_size;return a.env.isIE&&(s+=1),this._isHorizontal()?(r.$config.height=s,r.$parent.$config.height=s):(r.$config.width=s,r.$parent.$config.width=s),this.$config.scrollPosition=0,r.$name="scroller",r}function n(t,e){if(e.push(t),t.$cells)for(var i=0;i<t.$cells.length;i++)n(t.$cells[i],e)}return Ti(i,t),i.prototype.init=function(t){t.innerHTML=this.$toHTML(),this.$view=t.firstChild,this.$view||this.init(),this._isVertical()?this._initVertical():this._initHorizontal(),this._initMouseWheel(),this._initLinkedViews()},i.prototype.$toHTML=function(){return"<div class='gantt_layout_cell "+(this._isHorizontal()?"gantt_hor_scroll":"gantt_ver_scroll")+"'><div style='"+(this._isHorizontal()?"width:2000px":"height:2000px")+"'></div></div>"},i.prototype._getRootParent=function(){for(var t=this.$parent;t&&t.$parent;)t=t.$parent;if(t)return t},i.prototype._eachView=function(){var t=[];return n(this._getRootParent(),t),t},i.prototype._getLinkedViews=function(){for(var t=this._eachView(),e=[],i=0;i<t.length;i++)t[i].$config&&(this._isVertical()&&t[i].$config.scrollY==this.$id||this._isHorizontal()&&t[i].$config.scrollX==this.$id)&&e.push(t[i]);return e},i.prototype._initHorizontal=function(){this.$scroll_hor=this.$view,this.$domEvents.attach(this.$view,"scroll",this._scrollHorizontalHandler)},i.prototype._initLinkedViews=function(){for(var t=this._getLinkedViews(),e=this._isVertical()?"gantt_layout_outer_scroll gantt_layout_outer_scroll_vertical":"gantt_layout_outer_scroll gantt_layout_outer_scroll_horizontal",i=0;i<t.length;i++)d(t[i].$view||t[i].getNode(),e)},i.prototype._initVertical=function(){this.$scroll_ver=this.$view,this.$domEvents.attach(this.$view,"scroll",this._scrollVerticalHandler)},i.prototype._updateLinkedViews=function(){},i.prototype._initMouseWheel=function(){pt.isFF?this.$domEvents.attach(this._getRootParent().$view,"wheel",this._mouseWheelHandler,{passive:!1}):this.$domEvents.attach(this._getRootParent().$view,"mousewheel",this._mouseWheelHandler,{passive:!1})},i.prototype.scrollHorizontally=function(t){if(!this._scrolling){this._scrolling=!0,this.$scroll_hor.scrollLeft=t,this.$config.codeScrollLeft=t,t=this.$scroll_hor.scrollLeft;for(var e=this._getLinkedViews(),i=0;i<e.length;i++)e[i].scrollTo&&e[i].scrollTo(t,void 0);var n=this.$config.scrollPosition;this.$config.scrollPosition=t,this.callEvent("onScroll",[n,t,this.$config.scroll]),this._scrolling=!1}},i.prototype.scrollVertically=function(t){if(!this._scrolling){this._scrolling=!0,this.$scroll_ver.scrollTop=t,t=this.$scroll_ver.scrollTop;for(var e=this._getLinkedViews(),i=0;i<e.length;i++)e[i].scrollTo&&e[i].scrollTo(void 0,t);var n=this.$config.scrollPosition;this.$config.scrollPosition=t,this.callEvent("onScroll",[n,t,this.$config.scroll]),this._scrolling=!1}},i.prototype._isVertical=function(){return"y"==this.$config.scroll},i.prototype._isHorizontal=function(){return"x"==this.$config.scroll},i.prototype._scrollHorizontalHandler=function(t){if(!this._isVertical()&&!this._scrolling){if(new Date-(this._wheel_time||0)<100)return!0;var e=this.$scroll_hor.scrollLeft;this.scrollHorizontally(e),this._oldLeft=this.$scroll_hor.scrollLeft}},i.prototype._outerScrollHorizontalHandler=function(t){this._isVertical()},i.prototype.show=function(){this.$parent.show()},i.prototype.hide=function(){this.$parent.hide()},i.prototype._getScrollSize=function(){for(var t,e=0,i=0,n=this._isHorizontal(),a=this._getLinkedViews(),r=n?"scrollWidth":"scrollHeight",s=n?"contentX":"contentY",o=n?"x":"y",l=this._getScrollOffset(),d=0;d<a.length;d++)if((t=a[d])&&t.$content&&t.$content.getSize&&!t.$config.hidden){var c,u=t.$content.getSize();if(c=u.hasOwnProperty(r)?u[r]:u[s],l)u[s]>u[o]&&u[s]>e&&c>u[o]-l+2&&(e=c+(n?0:2),i=u[o]);else{var h=Math.max(u[s]-c,0);(c+=h)>Math.max(u[o]-h,0)&&c>e&&(e=c,i=u[o])}}return{outerScroll:i,innerScroll:e}},i.prototype.scroll=function(t){this._isHorizontal()?this.scrollHorizontally(t):this.scrollVertically(t)},i.prototype.getScrollState=function(){return{visible:this.isVisible(),direction:this.$config.scroll,size:this.$config.outerSize,scrollSize:this.$config.scrollSize||0,position:this.$config.scrollPosition||0}},i.prototype.setSize=function(e,i){t.prototype.setSize.apply(this,arguments);var n=this._getScrollSize(),a=(this._isVertical()?i:e)-this._getScrollOffset()+(this._isHorizontal()?1:0);n.innerScroll&&a>n.outerScroll&&(n.innerScroll+=a-n.outerScroll),this.$config.scrollSize=n.innerScroll,this.$config.width=e,this.$config.height=i,this._setScrollSize(n.innerScroll)},i.prototype.isVisible=function(){return!(!this.$parent||!this.$parent.$view.parentNode)},i.prototype.shouldShow=function(){var t=this._getScrollSize();return!(!t.innerScroll&&this.$parent&&this.$parent.$view.parentNode||!t.innerScroll||this.$parent&&this.$parent.$view.parentNode)},i.prototype.shouldHide=function(){return!(this._getScrollSize().innerScroll||!this.$parent||!this.$parent.$view.parentNode)},i.prototype.toggleVisibility=function(){this.shouldHide()?this.hide():this.shouldShow()&&this.show()},i.prototype._getScaleOffset=function(t){var e=0;return!t||"timeline"!=t.$config.view&&"grid"!=t.$config.view||(e=t.$content.$getConfig().scale_height),e},i.prototype._getScrollOffset=function(){var t=0;if(this._isVertical()){var e=this.$parent.$parent;t=Math.max(this._getScaleOffset(e.getPrevSibling(this.$parent.$id)),this._getScaleOffset(e.getNextSibling(this.$parent.$id)))}else for(var i=this._getLinkedViews(),n=0;n<i.length;n++){var a=i[n].$parent.$cells,r=a[a.length-1];if(r&&"scrollbar"==r.$config.view&&!1===r.$config.hidden){t=r.$config.width;break}}return t||0},i.prototype._setScrollSize=function(t){var e=this._isHorizontal()?"width":"height",i=this._isHorizontal()?this.$scroll_hor:this.$scroll_ver,n=this._getScrollOffset(),a=i.firstChild;n?this._isVertical()?(this.$config.outerSize=this.$config.height-n+3,i.style.height=this.$config.outerSize+"px",i.style.top=n-1+"px",d(i,this.$parent._borders.top),d(i.parentNode,"gantt_task_vscroll")):(this.$config.outerSize=this.$config.width-n+1,i.style.width=this.$config.outerSize+"px"):(i.style.top="auto",c(i,this.$parent._borders.top),c(i.parentNode,"gantt_task_vscroll"),this.$config.outerSize=this.$config.height),a.style[e]=t+"px"},i.prototype._scrollVerticalHandler=function(t){if(!this._scrollHorizontalHandler()&&!this._scrolling){var e=this.$scroll_ver.scrollTop;e!=this._oldTop&&(this.scrollVertically(e),this._oldTop=this.$scroll_ver.scrollTop)}},i.prototype._outerScrollVerticalHandler=function(t){this._scrollHorizontalHandler()},i.prototype._checkWheelTarget=function(t){for(var e=this._getLinkedViews().concat(this),i=0;i<e.length;i++)if(x(t,e[i].$view))return!0;return!1},i.prototype._mouseWheelHandler=function(t){var i=t.target||t.srcElement;if(this._checkWheelTarget(i)){this._wheel_time=new Date;var n={},a={x:1,y:1},r=this.$gantt.config.wheel_scroll_sensitivity;"number"==typeof r&&r?a={x:r,y:r}:"[object Object]"=={}.toString.apply(r)&&(a={x:r.x,y:r.y});var s=pt.isFF,o=s?t.deltaX:t.wheelDeltaX,l=s?t.deltaY:t.wheelDelta,d=-20;if(s){const e=parseInt(navigator.userAgent.split("Firefox/")[1]);d=e<=87?0!==t.deltaMode?-40:-10:e<=90?-3:e<=96?-1.5:-1}var c=s?o*d*a.x:2*o*a.x,u=s?l*d*a.y:l*a.y,h=this.$gantt.config.horizontal_scroll_key;if(!1!==h&&e.indexOf(h)>=0&&(!t[h]||t.deltaX||t.wheelDeltaX||(c=2*u,u=0)),c&&Math.abs(c)>Math.abs(u)){if(this._isVertical())return;if(n.x||!this.$scroll_hor||!this.$scroll_hor.offsetWidth)return!0;var _=c/-40,g=this._oldLeft,f=g+30*_;if(this.scrollHorizontally(f),this.$scroll_hor.scrollLeft=f,g==this.$scroll_hor.scrollLeft)return!0;this._oldLeft=this.$scroll_hor.scrollLeft}else{if(this._isHorizontal())return;if(n.y||!this.$scroll_ver||!this.$scroll_ver.offsetHeight)return!0;_=u/-40,void 0===u&&(_=t.detail);var p=this._oldTop,m=this.$scroll_ver.scrollTop+30*_;if(this.scrollVertically(m),this.$scroll_ver.scrollTop=m,p==this.$scroll_ver.scrollTop)return!0;this._oldTop=this.$scroll_ver.scrollTop}return t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,!1}},i}(Si);function Ii(t){var e,i,n,a={},r={},s=null,o=-1,l=null,d=(e=t,i=-1,n=-1,{resetCache:function(){i=-1,n=-1},_getRowHeight:function(){return-1===i&&(i=e.$getConfig().row_height),i},_refreshState:function(){this.resetCache(),n=!0;var t=e.$config.rowStore;if(t)for(var i=this._getRowHeight(),a=0;a<t.fullOrder.length;a++){var r=t.getItem(t.fullOrder[a]);if(r&&r.row_height&&r.row_height!==i){n=!1;break}}},canUseSimpleCalculation:function(){return-1===n&&this._refreshState(),n},getRowTop:function(t){return e.$config.rowStore?t*this._getRowHeight():0},getItemHeight:function(t){return this._getRowHeight()},getTotalHeight:function(){return e.$config.rowStore?e.$config.rowStore.countVisible()*this._getRowHeight():0},getItemIndexByTopPosition:function(t){return e.$config.rowStore?Math.floor(t/this._getRowHeight()):0}});return{_resetTopPositionHeight:function(){a={},r={},d.resetCache()},_resetHeight:function(){var t=this.$config.rowStore,e=this.getCacheStateTotalHeight(t);l?this.shouldClearHeightCache(l,e)&&(l=e,s=null):l=e,o=-1,d.resetCache()},getRowTop:function(t){if(d.canUseSimpleCalculation())return d.getRowTop(t);var e=this.$config.rowStore;if(!e)return 0;if(void 0!==r[t])return r[t];for(var i=e.getIndexRange(),n=0,a=0,s=0;s<i.length;s++)r[s]=n,n+=this.getItemHeight(i[s].id),s<t&&(a=n);return a},getItemTop:function(t){if(this.$config.rowStore){if(void 0!==a[t])return a[t];var e=this.$config.rowStore;if(!e)return 0;var i=e.getIndexById(t);if(-1===i&&e.getParent&&e.exists(t)){var n=e.getParent(t);if(e.exists(n)){var r=e.getItem(n);if(this.$gantt.isSplitTask(r))return this.getItemTop(n)}}return a[t]=this.getRowTop(i),a[t]}return 0},getItemHeight:function(t){if(d.canUseSimpleCalculation())return d.getItemHeight(t);if(!s&&this.$config.rowStore&&this._fillHeightCache(this.$config.rowStore),void 0!==s[t])return s[t];var e=this.$getConfig().row_height;if(this.$config.rowStore){var i=this.$config.rowStore;if(!i)return e;var n=i.getItem(t);return s[t]=n&&n.row_height||e}return e},_fillHeightCache:function(t){if(t){s={};var e=this.$getConfig().row_height;t.eachItem((function(t){return s[t.id]=t&&t.row_height||e}))}},getCacheStateTotalHeight:function(t){var e=this.$getConfig().row_height,i={},n=[],a=0;return t&&t.eachItem((function(t){n.push(t),i[t.id]=t.row_height,a+=t.row_height||e})),{globalHeight:e,items:n,count:n.length,sumHeight:a}},shouldClearHeightCache:function(t,e){if(t.count!=e.count||t.globalHeight!=e.globalHeight||t.sumHeight!=e.sumHeight)return!0;for(var i in t.items){var n=e.items[i];if(void 0!==n&&n!=t.items[i])return!0}return!1},getTotalHeight:function(){if(d.canUseSimpleCalculation())return d.getTotalHeight();if(-1!=o)return o;if(this.$config.rowStore){var t=this.$config.rowStore;this._fillHeightCache(t);var e=this.getItemHeight.bind(this),i=t.getVisibleItems(),n=0;return i.forEach((function(t){n+=e(t.id)})),o=n,n}return 0},getItemIndexByTopPosition:function(t){if(this.$config.rowStore){if(d.canUseSimpleCalculation())return d.getItemIndexByTopPosition(t);for(var e=this.$config.rowStore,i=0;i<e.countVisible();i++){var n=this.getRowTop(i),a=this.getRowTop(i+1);if(!a){var r=e.getIdByIndex(i);a=n+this.getItemHeight(r)}if(t>=n&&t<a)return i}return e.countVisible()+2}return 0}}}var Mi=function(t,e,i,n){this.$config=Z({},e||{}),this.$scaleHelper=new Pt(n),this.$gantt=n,this._posFromDateCache={},this._timelineDragScroll=null,Z(this,Ii(this)),M(this)};Mi.prototype={init:function(t){t.innerHTML+="<div class='gantt_task' style='width:inherit;height:inherit;'></div>",this.$task=t.childNodes[0],this.$task.innerHTML="<div class='gantt_task_scale'></div><div class='gantt_data_area'></div>",this.$task_scale=this.$task.childNodes[0],this.$task_data=this.$task.childNodes[1],this.$task_data.innerHTML="<div class='gantt_task_bg'></div><div class='gantt_task_baselines'></div><div class='gantt_links_area'></div><div class='gantt_bars_area'></div><div class='gantt_task_constraints'></div><div class='gantt_task_deadlines'></div>",this.$task_bg=this.$task_data.childNodes[0],this.$task_baselines=this.$task_data.childNodes[1],this.$task_links=this.$task_data.childNodes[2],this.$task_bars=this.$task_data.childNodes[3],this.$task_constraints=this.$task_data.childNodes[4],this.$task_deadlines=this.$task_data.childNodes[5],this._tasks={col_width:0,width:[],full_width:0,trace_x:[],rendered:{}};var e=this.$getConfig(),i=e[this.$config.bind+"_attribute"],n=e[this.$config.bindLinks+"_attribute"];!i&&this.$config.bind&&(i="data-"+this.$config.bind+"-id"),!n&&this.$config.bindLinks&&(n="data-"+this.$config.bindLinks+"-id"),this.$config.item_attribute=i||null,this.$config.link_attribute=n||null;var a=this._createLayerConfig();this.$config.layers||(this.$config.layers=a.tasks),this.$config.linkLayers||(this.$config.linkLayers=a.links),this._attachLayers(this.$gantt),this.callEvent("onReady",[]),this.$gantt.ext.dragTimeline&&(this._timelineDragScroll=this.$gantt.ext.dragTimeline.create(),this._timelineDragScroll.attach(this))},setSize:function(t,e){var i=this.$getConfig();if(1*t===t&&(this.$config.width=t),1*e===e){this.$config.height=e;var n=Math.max(this.$config.height-i.scale_height);this.$task_data.style.height=n+"px"}this.refresh(),this.$task_bg.style.backgroundImage="",i.smart_rendering&&this.$config.rowStore?this.$task_bg.style.height=this.getTotalHeight()+"px":this.$task_bg.style.height="";for(var a=this._tasks,r=this.$task_data.childNodes,s=0,o=r.length;s<o;s++){var l=r[s];l.hasAttribute("data-layer")&&l.style&&(l.style.width=a.full_width+"px")}},isVisible:function(){return this.$parent&&this.$parent.$config?!this.$parent.$config.hidden:this.$task.offsetWidth},getSize:function(){var t=this.$getConfig(),e=this.$config.rowStore?this.getTotalHeight():0,i=this.isVisible()?this._tasks.full_width:0;return{x:this.isVisible()?this.$config.width:0,y:this.isVisible()?this.$config.height:0,contentX:this.isVisible()?i:0,contentY:this.isVisible()?t.scale_height+e:0,scrollHeight:this.isVisible()?e:0,scrollWidth:this.isVisible()?i:0}},scrollTo:function(t,e){if(this.isVisible()){var i=!1;this.$config.scrollTop=this.$config.scrollTop||0,this.$config.scrollLeft=this.$config.scrollLeft||0,1*e===e&&(this.$config.scrollTop=e,this.$task_data.scrollTop=this.$config.scrollTop,i=!0),1*t===t&&(this.$task.scrollLeft=t,this.$config.scrollLeft=this.$task.scrollLeft,this._refreshScales(),i=!0),i&&this.callEvent("onScroll",[this.$config.scrollLeft,this.$config.scrollTop])}},_refreshScales:function(){if(this.isVisible()&&this.$getConfig().smart_scales){var t=this.getViewPort(),e=this._scales;this.$task_scale.innerHTML=this._getScaleChunkHtml(e,t.x,t.x_end)}},getViewPort:function(){var t=this.$config.scrollLeft||0,e=this.$config.scrollTop||0,i=this.$config.height||0,n=this.$config.width||0;return{y:e,y_end:e+i,x:t,x_end:t+n,height:i,width:n}},_createLayerConfig:function(){var t=this,e=function(){return t.isVisible()};this.$gantt;var i=[{expose:!0,renderer:this.$gantt.$ui.layers.taskBar(),container:this.$task_bars,filter:[e,function(t,e){return!e.hide_bar}]}];return i.push({renderer:this.$gantt.$ui.layers.taskBg(),container:this.$task_bg,filter:[e]}),{tasks:i,links:[{expose:!0,renderer:this.$gantt.$ui.layers.link(),container:this.$task_links,filter:[e]}]}},_attachLayers:function(t){this._taskLayers=[],this._linkLayers=[];var e=this,i=this.$gantt.$services.getService("layers");if(this.$config.bind){this._bindStore();var n=i.getDataRender(this.$config.bind);n||(n=i.createDataRender({name:this.$config.bind,defaultContainer:function(){return e.$task_data}})),n.container=function(){return e.$task_data};for(var a=this.$config.layers,r=0;a&&r<a.length;r++){"string"==typeof(d=a[r])&&(d=this.$gantt.$ui.layers[d]()),("function"==typeof d||d&&d.render&&d.update)&&(d={renderer:d}),d.view=this;var s=n.addLayer(d);this._taskLayers.push(s),d.expose&&(this._taskRenderer=n.getLayer(s))}this._initStaticBackgroundRender()}if(this.$config.bindLinks){e.$config.linkStore=e.$gantt.getDatastore(e.$config.bindLinks);var o=i.getDataRender(this.$config.bindLinks);o||(o=i.createDataRender({name:this.$config.bindLinks,defaultContainer:function(){return e.$task_data}}));var l=this.$config.linkLayers;for(r=0;l&&r<l.length;r++){var d;"string"==typeof d&&(d=this.$gantt.$ui.layers[d]()),(d=l[r]).view=this;var c=o.addLayer(d);this._taskLayers.push(c),l[r].expose&&(this._linkRenderer=o.getLayer(c))}}},_initStaticBackgroundRender:function(){var t=this,e={render:function(){},destroy:function(){}},i=t.$config.rowStore;i&&(this._staticBgHandler=i.attachEvent("onStoreUpdated",(function(i,n,a){if(null===i&&t.isVisible()){var r=t.$getConfig();if(r.static_background||r.timeline_placeholder){var s=t.$gantt.getDatastore(t.$config.bind),o=t.$task_bg_static;if(o||((o=document.createElement("div")).className="gantt_task_bg",t.$task_bg_static=o,t.$task_bg.nextSibling?t.$task_data.insertBefore(o,t.$task_bg.nextSibling):t.$task_data.appendChild(o)),s){var l=t.getTotalHeight();r.timeline_placeholder&&(l=r.timeline_placeholder.height||t.$task_data.offsetHeight||99999),e.render(o,r,t.getScale(),l,t.getItemHeight(n?n.id:null))}}else r.static_background&&t.$task_bg_static&&t.$task_bg_static.parentNode&&t.$task_bg_static.parentNode.removeChild(t.$task_bg_static)}})),this.attachEvent("onDestroy",(function(){})),this._initStaticBackgroundRender=function(){})},_clearLayers:function(t){var e=this.$gantt.$services.getService("layers"),i=e.getDataRender(this.$config.bind),n=e.getDataRender(this.$config.bindLinks);if(this._taskLayers)for(var a=0;a<this._taskLayers.length;a++)i.removeLayer(this._taskLayers[a]);if(this._linkLayers)for(a=0;a<this._linkLayers.length;a++)n.removeLayer(this._linkLayers[a]);this._linkLayers=[],this._taskLayers=[]},_render_tasks_scales:function(){var t=this.$getConfig(),e="",i=0,n=0,a=this.$gantt.getState();if(this.isVisible()){var r=this.$scaleHelper,s=this._getScales();n=t.scale_height;var o=this.$config.width;"x"!=t.autosize&&"xy"!=t.autosize||(o=Math.max(t.autosize_min_width,0));var l=r.prepareConfigs(s,t.min_column_width,o,n-1,a.min_date,a.max_date,t.rtl),d=this._tasks=l[l.length-1];this._scales=l,this._posFromDateCache={},e=this._getScaleChunkHtml(l,0,this.$config.width),i=d.full_width+"px",n+="px"}this.$task_scale.style.height=n,this.$task_data.style.width=this.$task_scale.style.width=i,this.$task_scale.innerHTML=e},_getScaleChunkHtml:function(t,e,i){for(var n=[],a=this.$gantt.templates.scale_row_class,r=0;r<t.length;r++){var s="gantt_scale_line",o=a(t[r]);o&&(s+=" "+o),n.push('<div class="'+s+'" style="height:'+t[r].height+"px;position:relative;line-height:"+t[r].height+'px">'+this._prepareScaleHtml(t[r],e,i,r)+"</div>")}return n.join("")},_prepareScaleHtml:function(t,e,i,n){var a=this.$getConfig(),r=this.$gantt.templates,s=[],o=null,l=null,d=t.format||t.template||t.date;"string"==typeof d&&(d=this.$gantt.date.date_to_str(d));var c=0,u=t.count;!a.smart_scales||isNaN(e)||isNaN(i)||(c=V(t.left,e),u=V(t.left,i)+1),l=t.css||function(){},!t.css&&a.inherit_scale_class&&(l=r.scale_cell_class);for(var h=c;h<u&&t.trace_x[h];h++){o=new Date(t.trace_x[h]);var _=d.call(this,o),g=t.width[h];t.height;var f=t.left[h],p="",m="",v="";if(g){p="width:"+g+"px;"+(a.smart_scales?"position:absolute;left:"+f+"px":"");const e=this.getViewPort(),i=(a.scales[n]||{}).sticky;let r="";const d=70;if(!1!==i&&g>d||!0===i)if(f<e.x&&f+g/2-d/2<e.x)r=` style='position:absolute;left: ${e.x-f+10}px;' `;else if(f+g/2+d/2>e.x_end&&g>d){let t=e.x_end-f-10,i="-100%";t<d&&(t=d,i=`-${t}px`),r=` style='position:absolute;left: ${t}px;transform: translate(${i},0);' `}v="gantt_scale_cell"+(h==t.count-1?" gantt_last_cell":""),(m=l.call(this,o))&&(v+=" "+m);var k=`<div class='${v}' ${this.$gantt._waiAria.getTimelineCellAttr(_)} style='${p}'><span ${r}>${_}</span></div>`;s.push(k)}}return s.join("")},dateFromPos:function(t){var e=this._tasks;if(t<0||t>e.full_width||!e.full_width)return null;var i=V(this._tasks.left,t),n=this._tasks.left[i],a=e.width[i]||e.col_width,r=0;a&&(r=(t-n)/a,e.rtl&&(r=1-r));var s=0;return r&&(s=this._getColumnDuration(e,e.trace_x[i])),new Date(e.trace_x[i].valueOf()+Math.round(r*s))},posFromDate:function(t){if(!this.isVisible()||!t)return 0;var e=String(t.valueOf());if(void 0!==this._posFromDateCache[e])return this._posFromDateCache[e];var i=this.columnIndexByDate(t);this.$gantt.assert(i>=0,"Invalid day index");var n=Math.floor(i),a=i%1,r=this._tasks.left[Math.min(n,this._tasks.width.length-1)];n==this._tasks.width.length&&(r+=this._tasks.width[this._tasks.width.length-1]),a&&(n<this._tasks.width.length?r+=this._tasks.width[n]*(a%1):r+=1);var s=Math.round(r);return this._posFromDateCache[e]=s,Math.round(s)},_getNextVisibleColumn:function(t,e,i){for(var n=+e[t],a=t;i[n];)n=+e[++a];return a},_getPrevVisibleColumn:function(t,e,i){for(var n=+e[t],a=t;i[n];)n=+e[--a];return a},_getClosestVisibleColumn:function(t,e,i){var n=this._getNextVisibleColumn(t,e,i);return e[n]||(n=this._getPrevVisibleColumn(t,e,i)),n},columnIndexByDate:function(t){var e=new Date(t).valueOf(),i=this._tasks.trace_x_ascending,n=this._tasks.ignore_x,a=this.$gantt.getState();if(e<=a.min_date)return this._tasks.rtl?i.length:0;if(e>=a.max_date)return this._tasks.rtl?0:i.length;var r=V(i,e),s=this._getClosestVisibleColumn(r,i,n),o=i[s],l=this._tasks.trace_index_transition;if(!o)return l?l[0]:0;var d=(t-i[s])/this._getColumnDuration(this._tasks,i[s]);return l?l[s]+(1-d):s+d},getItemPosition:function(t,e,i){var n,a,r;let s=e||t.start_date||t.$auto_start_date,o=i||t.end_date||t.$auto_end_date;return this._tasks.rtl?(a=this.posFromDate(s),n=this.posFromDate(o)):(n=this.posFromDate(s),a=this.posFromDate(o)),r=Math.max(a-n,0),{left:n,top:this.getItemTop(t.id),height:this.getBarHeight(t.id),width:r,rowHeight:this.getItemHeight(t.id)}},getBarHeight:function(t,e){var i=this.$getConfig(),n=this.$config.rowStore.getItem(t),a=n.task_height||n.bar_height||i.bar_height||i.task_height,r=this.getItemHeight(t);return"full"==a&&(a=r-(i.bar_height_padding||3)),a=Math.min(a,r),e&&(a=Math.round(a/Math.sqrt(2))),Math.max(a,0)},getScale:function(){return this._tasks},_getScales:function(){var t=this.$getConfig(),e=this.$scaleHelper,i=[e.primaryScale(t)].concat(e.getSubScales(t));return e.sortScales(i),i},_getColumnDuration:function(t,e){return this.$gantt.date.add(e,t.step,t.unit)-e},_bindStore:function(){if(this.$config.bind){var t=this.$gantt.getDatastore(this.$config.bind);if(this.$config.rowStore=t,t&&!t._timelineCacheAttached){var e=this;t._timelineCacheAttached=t.attachEvent("onBeforeFilter",(function(){e._resetTopPositionHeight()}))}}},_unbindStore:function(){if(this.$config.bind){var t=this.$gantt.getDatastore(this.$config.bind);t&&t._timelineCacheAttached&&(t.detachEvent(t._timelineCacheAttached),t._timelineCacheAttached=!1)}},refresh:function(){this._bindStore(),this.$config.bindLinks&&(this.$config.linkStore=this.$gantt.getDatastore(this.$config.bindLinks)),this._resetTopPositionHeight(),this._resetHeight(),this._initStaticBackgroundRender(),this._render_tasks_scales()},destructor:function(){var t=this.$gantt;this._clearLayers(t),this._unbindStore(),this.$task=null,this.$task_scale=null,this.$task_data=null,this.$task_bg=null,this.$task_links=null,this.$task_bars=null,this.$gantt=null,this.$config.rowStore&&(this.$config.rowStore.detachEvent(this._staticBgHandler),this.$config.rowStore=null),this.$config.linkStore&&(this.$config.linkStore=null),this._timelineDragScroll&&(this._timelineDragScroll.destructor(),this._timelineDragScroll=null),this.callEvent("onDestroy",[]),this.detachAllEvents()}};class Ni{constructor(t){this._scrollOrder=0;const{gantt:e,grid:i,dnd:n,getCurrentX:a}=t;this.$gantt=e,this.$grid=i,this._dnd=n,this.getCurrentX=a,this._scrollView=this.$gantt.$ui.getView(this.$grid.$config.scrollX),this.attachEvents()}attachEvents(){this.isScrollable()&&(this._dnd.attachEvent("onDragMove",((t,e)=>{const i=this.$grid.$grid.getBoundingClientRect(),n=i.right,a=i.left,r=this.getCurrentX(e.clientX);return r>=n-20&&(this.autoscrollRight(),this.autoscrollStart()),r<=a+20&&(this.autoscrollLeft(),this.autoscrollStart()),r<n-20&&r>a+20&&this.autoscrollStop(),!0})),this._dnd.attachEvent("onDragEnd",(()=>{this.autoscrollStop()})))}autoscrollStart(){if(0===this._scrollOrder)return;const t=10*this._scrollOrder,e=this._scrollView.getScrollState();this._scrollView.scrollTo(e.position+t),setTimeout((()=>{this.autoscrollStart()}),50)}autoscrollRight(){this._scrollOrder=1}autoscrollLeft(){this._scrollOrder=-1}autoscrollStop(){this._scrollOrder=0}getCorrection(){return this.isScrollable()?this._scrollView.getScrollState().position:0}isScrollable(){return!!this.$grid.$config.scrollable}}const Li="data-column-id";class Pi{constructor(t,e){this._targetMarker=null,this.calculateCurrentPosition=t=>{const e=this.$grid.$grid.getBoundingClientRect(),i=e.right,n=e.left;let a=t;return a>i&&(a=i),a<n&&(a=n),a},this.$gantt=t,this.$grid=e}init(){const t=this.$gantt.$services.getService("dnd");this._dnd=new t(this.$grid.$grid_scale,{updates_per_second:60}),this._scrollableGrid=new Ni({gantt:this.$gantt,grid:this.$grid,dnd:this._dnd,getCurrentX:this.calculateCurrentPosition}),this.attachEvents()}attachEvents(){this._dnd.attachEvent("onBeforeDragStart",((t,e)=>{if(this._draggedCell=this.$gantt.utils.dom.closest(e.target,".gantt_grid_head_cell"),!this._draggedCell)return;const i=this.$grid.$getConfig().columns,n=this._draggedCell.getAttribute(Li);let a,r;return i.map((function(t,e){t.name===n&&(a=t,r=e)})),!1!==this.$grid.callEvent("onBeforeColumnDragStart",[{draggedColumn:a,draggedIndex:r}])&&!(!this._draggedCell||!a)&&(this._gridConfig=this.$grid.$getConfig(),this._originAutoscroll=this.$gantt.config.autoscroll,this.$gantt.config.autoscroll=!1,!0)})),this._dnd.attachEvent("onAfterDragStart",((t,e)=>{this._draggedCell&&(this._dnd.config.column=this._draggedCell.getAttribute(Li),this._dnd.config.marker.innerHTML=this._draggedCell.outerHTML,this._dnd.config.marker.classList.add("gantt_column_drag_marker"),this._dnd.config.marker.style.height=this._gridConfig.scale_height+"px",this._dnd.config.marker.style.lineHeight=this._gridConfig.scale_height+"px",this._draggedCell.classList.add("gantt_grid_head_cell_dragged"))})),this._dnd.attachEvent("onDragMove",((t,e)=>{if(!this._draggedCell)return;this._dragX=e.clientX;const i=this.calculateCurrentPosition(e.clientX),n=this.findColumnsIndexes();return this.setMarkerPosition(i),this.drawTargetMarker(n),!0})),this._dnd.attachEvent("onDragEnd",(()=>{if(!this._draggedCell)return;const t=this.findColumnsIndexes(),e=t.targetIndex,i=t.draggedIndex,n=this.$grid.$getConfig().columns,a=n[i],r=n[e];if(!1===this.$grid.callEvent("onColumnDragMove",[{draggedColumn:a,targetColumn:r,draggedIndex:i,targetIndex:e}]))return this.cleanTargetMarker(),void this.$gantt.render();this.$gantt.config.autoscroll=this._originAutoscroll,this._draggedCell.classList.remove("gantt_grid_head_cell_dragged"),this.cleanTargetMarker(),this.reorderColumns()}))}reorderColumns(){const{targetIndex:t,draggedIndex:e}=this.findColumnsIndexes(),i=this.$grid.$getConfig().columns,n=i[e],a=i[t];!1!==this.$grid.callEvent("onBeforeColumnReorder",[{draggedColumn:n,targetColumn:a,draggedIndex:e,targetIndex:t}])&&t!==e&&(i.splice(e,1),i.splice(t,0,n),this.$gantt.render(),this.$grid.callEvent("onAfterColumnReorder",[{draggedColumn:n,targetColumn:a,draggedIndex:e,targetIndex:t}]))}findColumnsIndexes(){const t=this._dnd.config.column,e=this.$grid.$getConfig().columns;let i,n,a,r;const s={startX:0,endX:0};let o,l=0,d=e.length-1,c=(t,e)=>t<=e,u=t=>++t;this.$gantt.config.rtl&&(l=e.length-1,d=0,c=(t,e)=>t>=e,u=t=>--t);const h=this._dragX-this.$grid.$grid.getBoundingClientRect().left+this._scrollableGrid.getCorrection();for(let _=l;c(_,d)&&(void 0===i||void 0===n);_=u(_))e[_].hide||(s.startX=s.endX,s.endX+=e[_].width,h>=s.startX&&(h<=s.endX||!c(u(_),d))&&(i=_,a=s.startX,r=s.endX,o=(h-s.startX)/(s.endX-s.startX)),t===e[_].name&&(n=_));return{targetIndex:i,draggedIndex:n,xBefore:a,xAfter:r,columnRelativePos:o}}setMarkerPosition(t,e=10){const{marker:i}=this._dnd.config,n=this._dnd._obj.getBoundingClientRect();i.style.top=`${n.y+e}px`,i.style.left=`${t}px`}drawTargetMarker({targetIndex:t,draggedIndex:e,xBefore:i,xAfter:n,columnRelativePos:a}){let r;this._targetMarker||(this._targetMarker=document.createElement("div"),d(this._targetMarker,"gantt_grid_target_marker"),this._targetMarker.style.display="none",this._targetMarker.style.height=`${this._gridConfig.scale_height}px`),this._targetMarker.parentNode||this.$grid.$grid_scale.appendChild(this._targetMarker),r=t>e?n:t<e?i:a>.5?n:i,this._targetMarker.style.left=`${r}px`,this._targetMarker.style.display="block"}cleanTargetMarker(){this._targetMarker&&this._targetMarker.parentNode&&this.$grid.$grid_scale.removeChild(this._targetMarker),this._targetMarker=null}}function Ri(t){var e=[];return{delegate:function(i,n,a,r){e.push([i,n,a,r]),t.$services.getService("mouseEvents").delegate(i,n,a,r)},destructor:function(){for(var i=t.$services.getService("mouseEvents"),n=0;n<e.length;n++){var a=e[n];i.detach(a[0],a[1],a[2],a[3])}e=[]}}}var Hi=function(t,e,i,n){this.$config=Z({},e||{}),this.$gantt=n,this.$parent=t,M(this),this.$state={},Z(this,Ii(this))};Hi.prototype={init:function(t){var i=this.$gantt,n=i._waiAria.gridAttrString(),a=i._waiAria.gridDataAttrString(),r=this.$getConfig(),s=r.reorder_grid_columns||!1;void 0!==this.$config.reorder_grid_columns&&(s=this.$config.reorder_grid_columns),t.innerHTML="<div class='gantt_grid' style='height:inherit;width:inherit;' "+n+"></div>",this.$grid=t.childNodes[0],this.$grid.innerHTML="<div class='gantt_grid_scale' "+i._waiAria.gridScaleRowAttrString()+"></div><div class='gantt_grid_data' "+a+"></div>",this.$grid_scale=this.$grid.childNodes[0],this.$grid_data=this.$grid.childNodes[1];var o=r[this.$config.bind+"_attribute"];if(!o&&this.$config.bind&&(o="data-"+this.$config.bind+"-id"),this.$config.item_attribute=o||null,!this.$config.layers){var l=this._createLayerConfig();this.$config.layers=l}var d,c,u;this._renderHeaderResizers=function(){},this._mouseDelegates=Ri(i),(c=this,u={row_before_start:(d=i).bind((function(t,e,i){var n=c.$getConfig(),a=c.$config.rowStore;if(!m(i,n.task_grid_row_resizer_attribute))return!1;var r=this.locate(i,n.task_grid_row_resizer_attribute),s=a.getItem(r);return!1!==c.callEvent("onBeforeRowResize",[s])&&void 0}),d),row_after_start:d.bind((function(t,e,i){var n=c.$getConfig(),a=this.locate(i,n.task_grid_row_resizer_attribute);t.config.marker.innerHTML="",t.config.marker.className+=" gantt_row_grid_resize_area",t.config.marker.style.width=c.$grid.offsetWidth+"px",t.config.drag_id=a}),d),row_drag_move:d.bind((function(t,i,n){var a=c.$config.rowStore,r=c.$getConfig(),s=t.config,o=s.drag_id,l=c.getItemHeight(o),d=c.getItemTop(o)-i.scrollTop,u=e(c.$grid_data),h=parseInt(s.marker.style.top,10),_=d+u.y,g=0,f=r.min_task_grid_row_height;return(g=h-_)<f&&(g=f),s.marker.style.left=u.x+"px",s.marker.style.top=_-1+"px",s.marker.style.height=Math.abs(g)+1+"px",s.marker_height=g,c.callEvent("onRowResize",[o,a.getItem(o),g+l]),!0}),d),row_drag_end:d.bind((function(t,e,i){var n=c.$config.rowStore,a=t.config,r=a.drag_id,s=n.getItem(r),o=c.getItemHeight(r),l=a.marker_height;!1!==c.callEvent("onBeforeRowResizeEnd",[r,s,l])&&s.row_height!=l&&(s.row_height=l,n.updateItem(r),c.callEvent("onAfterRowResize",[r,s,o,l]),this.render())}),d)},{init:function(){var t=d.$services.getService("dnd"),e=c.$getConfig(),i=new t(c.$grid_data,{updates_per_second:60});d.defined(e.dnd_sensitivity)&&(i.config.sensitivity=e.dnd_sensitivity),i.attachEvent("onBeforeDragStart",(function(t,e){return u.row_before_start(i,t,e)})),i.attachEvent("onAfterDragStart",(function(t,e){return u.row_after_start(i,t,e)})),i.attachEvent("onDragMove",(function(t,e){return u.row_drag_move(i,t,e)})),i.attachEvent("onDragEnd",(function(t,e){return u.row_drag_end(i,t,e)}))}}).init(),this._addLayers(this.$gantt),this._initEvents(),s&&(this._columnDND=new Pi(i,this),this._columnDND.init()),this.callEvent("onReady",[])},_validateColumnWidth:function(t,e){var i=t[e];if(i&&"*"!=i){var n=this.$gantt,a=1*i;isNaN(a)?n.assert(!1,"Wrong "+e+" value of column "+t.name):t[e]=a}},setSize:function(t,e){this.$config.width=this.$state.width=t,this.$config.height=this.$state.height=e;for(var i,n=this.getGridColumns(),a=0,r=(d=this.$getConfig()).grid_elastic_columns,s=0,o=n.length;s<o;s++)this._validateColumnWidth(n[s],"min_width"),this._validateColumnWidth(n[s],"max_width"),this._validateColumnWidth(n[s],"width"),a+=1*n[s].width;if(!isNaN(a)&&this.$config.scrollable||(a=i=this._setColumnsWidth(t+1)),this.$config.scrollable&&r&&!isNaN(a)){let e="width";"min_width"==r&&(e="min_width");let s=0;n.forEach((function(t){s+=t[e]||d.min_grid_column_width}));var l=Math.max(s,t);a=this._setColumnsWidth(l),i=t}this.$config.scrollable?(this.$grid_scale.style.width=a+"px",this.$grid_data.style.width=a+"px"):(this.$grid_scale.style.width="inherit",this.$grid_data.style.width="inherit"),this.$config.width-=1;var d=this.$getConfig();i!==t&&(void 0!==i?(d.grid_width=i,this.$config.width=i-1):isNaN(a)||(this._setColumnsWidth(a),d.grid_width=a,this.$config.width=a-1));var c=Math.max(this.$state.height-d.scale_height,0);this.$grid_data.style.height=c+"px",this.refresh()},getSize:function(){var t=this.$getConfig(),e=this.$config.rowStore?this.getTotalHeight():0,i=this._getGridWidth();return{x:this.$state.width,y:this.$state.height,contentX:this.isVisible()?i:0,contentY:this.isVisible()?t.scale_height+e:0,scrollHeight:this.isVisible()?e:0,scrollWidth:this.isVisible()?i:0}},_bindStore:function(){if(this.$config.bind){var t=this.$gantt.getDatastore(this.$config.bind);if(this.$config.rowStore=t,t&&!t._gridCacheAttached){var e=this;t._gridCacheAttached=t.attachEvent("onBeforeFilter",(function(){e._resetTopPositionHeight()}))}}},_unbindStore:function(){if(this.$config.bind){var t=this.$gantt.getDatastore(this.$config.bind);t&&t._gridCacheAttached&&(t.detachEvent(t._gridCacheAttached),t._gridCacheAttached=!1)}},refresh:function(){this._bindStore(),this._resetTopPositionHeight(),this._resetHeight(),this._initSmartRenderingPlaceholder(),this._calculateGridWidth(),this._renderGridHeader()},getViewPort:function(){var t=this.$config.scrollLeft||0,e=this.$config.scrollTop||0,i=this.$config.height||0,n=this.$config.width||0;return{y:e,y_end:e+i,x:t,x_end:t+n,height:i,width:n}},scrollTo:function(t,e){if(this.isVisible()){var i=!1;this.$config.scrollTop=this.$config.scrollTop||0,this.$config.scrollLeft=this.$config.scrollLeft||0,1*t==t&&(this.$config.scrollLeft=this.$state.scrollLeft=this.$grid.scrollLeft=t,i=!0),1*e==e&&(this.$config.scrollTop=this.$state.scrollTop=this.$grid_data.scrollTop=e,i=!0),i&&this.callEvent("onScroll",[this.$config.scrollLeft,this.$config.scrollTop])}},getColumnIndex:function(t,e){for(var i=this.$getConfig().columns,n=0,a=0;a<i.length;a++)if(e&&i[a].hide&&n++,i[a].name==t)return a-n;return null},getColumn:function(t){var e=this.getColumnIndex(t);return null===e?null:this.$getConfig().columns[e]},getGridColumns:function(){return this.$getConfig().columns.slice()},isVisible:function(){return this.$parent&&this.$parent.$config?!this.$parent.$config.hidden:this.$grid.offsetWidth},_createLayerConfig:function(){var t=this.$gantt,e=this;return[{renderer:t.$ui.layers.gridLine(),container:this.$grid_data,filter:[function(){return e.isVisible()}]},{renderer:t.$ui.layers.gridTaskRowResizer(),container:this.$grid_data,append:!0,filter:[function(){return t.config.resize_rows}]}]},_addLayers:function(t){if(this.$config.bind){this._taskLayers=[];var e=this,i=this.$gantt.$services.getService("layers"),n=i.getDataRender(this.$config.bind);n||(n=i.createDataRender({name:this.$config.bind,defaultContainer:function(){return e.$grid_data}}));for(var a=this.$config.layers,r=0;a&&r<a.length;r++){var s=a[r];s.view=this;var o=n.addLayer(s);this._taskLayers.push(o)}this._bindStore(),this._initSmartRenderingPlaceholder()}},_refreshPlaceholderOnStoreUpdate:function(t){var e=this.$getConfig(),i=this.$config.rowStore;if(i&&null===t&&this.isVisible()&&e.smart_rendering){var n;if(this.$config.scrollY){var a=this.$gantt.$ui.getView(this.$config.scrollY);a&&(n=a.getScrollState().scrollSize)}if(n||(n=i?this.getTotalHeight():0),n){this.$rowsPlaceholder&&this.$rowsPlaceholder.parentNode&&this.$rowsPlaceholder.parentNode.removeChild(this.$rowsPlaceholder);var r=this.$rowsPlaceholder=document.createElement("div");r.style.visibility="hidden",r.style.height=n+"px",r.style.width="1px",this.$grid_data.appendChild(r)}}},_initSmartRenderingPlaceholder:function(){var t=this.$config.rowStore;t&&(this._initSmartRenderingPlaceholder=function(){},this._staticBgHandler=t.attachEvent("onStoreUpdated",et(this._refreshPlaceholderOnStoreUpdate,this)))},_initEvents:function(){var t=this.$gantt;this._mouseDelegates.delegate("click","gantt_close",t.bind((function(t,e,i){var n=this.$config.rowStore;if(!n)return!0;var a=m(t,this.$config.item_attribute);return a&&n.close(a.getAttribute(this.$config.item_attribute)),!1}),this),this.$grid),this._mouseDelegates.delegate("click","gantt_open",t.bind((function(t,e,i){var n=this.$config.rowStore;if(!n)return!0;var a=m(t,this.$config.item_attribute);return a&&n.open(a.getAttribute(this.$config.item_attribute)),!1}),this),this.$grid)},_clearLayers:function(t){var e=this.$gantt.$services.getService("layers").getDataRender(this.$config.bind);if(this._taskLayers)for(var i=0;i<this._taskLayers.length;i++)e.removeLayer(this._taskLayers[i]);this._taskLayers=[]},_getColumnWidth:function(t,e,i){var n=t.min_width||e.min_grid_column_width,a=Math.max(i,n||10);return t.max_width&&(a=Math.min(a,t.max_width)),a},_checkGridColumnMinWidthLimits:function(t,e){for(var i=0,n=t.length;i<n;i++){var a=1*t[i].width;!t[i].min_width&&a<e.min_grid_column_width&&(t[i].min_width=a)}},_getGridWidthLimits:function(){for(var t=this.$getConfig(),e=this.getGridColumns(),i=0,n=0,a=0;a<e.length;a++)i+=e[a].min_width?e[a].min_width:t.min_grid_column_width,void 0!==n&&(n=e[a].max_width?n+e[a].max_width:void 0);return this._checkGridColumnMinWidthLimits(e,t),[i,n]},_setColumnsWidth:function(t,e){var i=this.$getConfig(),n=this.getGridColumns(),a=0,r=t;e=window.isNaN(e)?-1:e;for(var s=0,o=n.length;s<o;s++)a+=1*n[s].width;if(window.isNaN(a))for(this._calculateGridWidth(),a=0,s=0,o=n.length;s<o;s++)a+=1*n[s].width;var l=r-a,d=0;for(s=0;s<e+1;s++)d+=n[s].width;for(a-=d,s=e+1;s<n.length;s++){var c=n[s],u=Math.round(l*(c.width/a));l<0?c.min_width&&c.width+u<c.min_width?u=c.min_width-c.width:!c.min_width&&i.min_grid_column_width&&c.width+u<i.min_grid_column_width&&(u=i.min_grid_column_width-c.width):c.max_width&&c.width+u>c.max_width&&(u=c.max_width-c.width),a-=c.width,c.width+=u,l-=u}for(var h=l>0?1:-1;l>0&&1===h||l<0&&-1===h;){var _=l;for(s=e+1;s<n.length;s++){var g;if((g=n[s].width+h)==this._getColumnWidth(n[s],i,g)&&(l-=h,n[s].width=g),!l)break}if(_==l)break}return l&&e>-1&&(g=n[e].width+l)==this._getColumnWidth(n[e],i,g)&&(n[e].width=g),this._getColsTotalWidth()},_getColsTotalWidth:function(){for(var t=this.getGridColumns(),e=0,i=0;i<t.length;i++){var n=parseFloat(t[i].width);if(window.isNaN(n))return!1;e+=n}return e},_calculateGridWidth:function(){for(var t=this.$getConfig(),e=this.getGridColumns(),i=0,n=[],a=[],r=0;r<e.length;r++){var s=parseFloat(e[r].width);window.isNaN(s)&&(s=t.min_grid_column_width||10,n.push(r)),a[r]=s,i+=s}var o=this._getGridWidth()+1;if(t.autofit||n.length){var l=o-i;if(t.autofit&&!t.grid_elastic_columns)for(r=0;r<a.length;r++){var d=Math.round(l/(a.length-r));a[r]+=d,(c=this._getColumnWidth(e[r],t,a[r]))!=a[r]&&(d=c-a[r],a[r]=c),l-=d}else if(n.length)for(r=0;r<n.length;r++){d=Math.round(l/(n.length-r));var c,u=n[r];a[u]+=d,(c=this._getColumnWidth(e[u],t,a[u]))!=a[u]&&(d=c-a[u],a[u]=c),l-=d}for(r=0;r<a.length;r++)e[r].width=a[r]}else{var h=o!=i;this.$config.width=i-1,t.grid_width=i,h&&this.$parent._setContentSize(this.$config.width,null)}},_renderGridHeader:function(){var t=this.$gantt,e=this.$getConfig(),i=this.$gantt.locale,n=this.$gantt.templates,a=this.getGridColumns();e.rtl&&(a=a.reverse());var r=[],s=0,o=i.labels,l=e.scale_height-1;const d={};for(var c=0;c<a.length;c++){var u=c==a.length-1,h=a[c];h.name||(h.name=t.uid()+"");var _=1*h.width,g=this._getGridWidth();u&&g>s+_&&(h.width=_=g-s),s+=_;var f=t._sort&&h.name==t._sort.name?`<div data-column-id="${h.name}" class="gantt_sort gantt_${t._sort.direction}"></div>`:"",p=["gantt_grid_head_cell","gantt_grid_head_"+h.name,u?"gantt_last_cell":"",n.grid_header_class(h.name,h)].join(" "),m="width:"+(_-(u?1:0))+"px;",v=h.label||o["column_"+h.name]||o[h.name];"function"==typeof v&&(v=v.call(t,h.name,h)),v=v||"";let e=!1;t.config.external_render&&t.config.external_render.isElement(v)&&(e=!0,d[h.name]=v);var k="<div class='"+p+"' style='"+m+"' "+t._waiAria.gridScaleCellAttrString(h,v)+" data-column-id='"+h.name+"' column_id='"+h.name+"' data-column-name='"+h.name+"' data-column-index='"+c+"'>"+(e?"<div data-component-container></div>":v)+f+"</div>";r.push(k)}this.$grid_scale.style.height=e.scale_height+"px",this.$grid_scale.style.lineHeight=l+"px",this.$grid_scale.innerHTML=r.join("");for(let e in d)t.config.external_render.renderElement(d[e],this.$grid_scale.querySelector("[data-column-id='"+e+"'] [data-component-container]"));this._renderHeaderResizers&&this._renderHeaderResizers()},_getGridWidth:function(){return this.$config.width},destructor:function(){this._clearLayers(this.$gantt),this._mouseDelegates&&(this._mouseDelegates.destructor(),this._mouseDelegates=null),this._unbindStore(),this.$grid=null,this.$grid_scale=null,this.$grid_data=null,this.$gantt=null,this.$config.rowStore&&(this.$config.rowStore.detachEvent(this._staticBgHandler),this.$config.rowStore=null),this.callEvent("onDestroy",[]),this.detachAllEvents()}};const Oi={init:function(t,e){var i=e.$gantt;i.attachEvent("onTaskClick",(function(e,n){if(i._is_icon_open_click(n))return!0;var a=t.getState(),r=t.locateCell(n.target);return!r||!t.getEditorConfig(r.columnName)||(t.isVisible()&&a.id==r.id&&a.columnName==r.columnName||t.startEdit(r.id,r.columnName),!1)})),i.attachEvent("onEmptyClick",(function(){return t.isVisible()&&t.isChanged()?t.save():t.hide(),!0})),i.attachEvent("onTaskDblClick",(function(e,i){var n=t.getState(),a=t.locateCell(i.target);return!a||!t.isVisible()||a.columnName!=n.columnName}))},onShow:function(t,e,i){var n=i.$gantt;n.ext&&n.ext.keyboardNavigation&&n.ext.keyboardNavigation.attachEvent("onKeyDown",(function(e,i){var a=n.constants.KEY_CODES,r=!1;return i.keyCode===a.SPACE&&t.isVisible()&&(r=!0),!r})),e.onkeydown=function(e){e=e||window.event;var i=n.constants.KEY_CODES;if(!(e.defaultPrevented||e.shiftKey&&e.keyCode!=i.TAB)){var a=!0;switch(e.keyCode){case n.keys.edit_save:t.save();break;case n.keys.edit_cancel:t.hide();break;case i.UP:case i.DOWN:t.isVisible()&&(t.hide(),a=!1);break;case i.TAB:e.shiftKey?t.editPrevCell(!0):t.editNextCell(!0);break;default:a=!1}a&&e.preventDefault()}}},onHide:function(){},destroy:function(){}},Bi={init:function(t,e){var i=t,n=e.$gantt,a=null,r=n.ext.keyboardNavigation;r.attachEvent("onBeforeFocus",(function(e){var n=t.locateCell(e);if(clearTimeout(a),n){var r=n.columnName,s=n.id,o=i.getState();if(i.isVisible()&&o.id==s&&o.columnName===r)return!1}return!0})),r.attachEvent("onFocus",(function(e){var n=t.locateCell(e),r=t.getState();return clearTimeout(a),!n||n.id==r.id&&n.columnName==r.columnName||i.isVisible()&&i.save(),!0})),t.attachEvent("onHide",(function(){clearTimeout(a)})),r.attachEvent("onBlur",(function(){return a=setTimeout((function(){i.save()})),!0})),n.attachEvent("onTaskDblClick",(function(e,i){var n=t.getState(),a=t.locateCell(i.target);return!a||!t.isVisible()||a.columnName!=n.columnName})),n.attachEvent("onTaskClick",(function(e,i){if(n._is_icon_open_click(i))return!0;var a=t.getState(),r=t.locateCell(i.target);return!r||!t.getEditorConfig(r.columnName)||(t.isVisible()&&a.id==r.id&&a.columnName==r.columnName||t.startEdit(r.id,r.columnName),!1)})),n.attachEvent("onEmptyClick",(function(){return i.save(),!0})),r.attachEvent("onKeyDown",(function(e,a){var s=t.locateCell(a.target),o=!!s&&t.getEditorConfig(s.columnName),l=t.getState(),d=n.constants.KEY_CODES,c=a.keyCode,u=!1;switch(c){case d.ENTER:t.isVisible()?(t.save(),a.preventDefault(),u=!0):o&&!(a.ctrlKey||a.metaKey||a.shiftKey)&&(i.startEdit(s.id,s.columnName),a.preventDefault(),u=!0);break;case d.ESC:t.isVisible()&&(t.hide(),a.preventDefault(),u=!0);break;case d.UP:case d.DOWN:break;case d.LEFT:case d.RIGHT:(o&&t.isVisible()||"date"===l.editorType)&&(u=!0);break;case d.SPACE:t.isVisible()&&(u=!0),o&&!t.isVisible()&&(i.startEdit(s.id,s.columnName),a.preventDefault(),u=!0);break;case d.DELETE:o&&!t.isVisible()?(i.startEdit(s.id,s.columnName),u=!0):o&&t.isVisible()&&(u=!0);break;case d.TAB:if(t.isVisible()){a.shiftKey?t.editPrevCell(!0):t.editNextCell(!0);var h=t.getState();h.id&&r.focus({type:"taskCell",id:h.id,column:h.columnName}),a.preventDefault(),u=!0}break;default:if(t.isVisible())u=!0;else if(c>=48&&c<=57||c>95&&c<112||c>=64&&c<=91||c>185&&c<193||c>218&&c<223){var _=e.modifiers,g=_.alt||_.ctrl||_.meta||_.shift;_.alt||g&&r.getCommandHandler(e,"taskCell")||o&&!t.isVisible()&&(i.startEdit(s.id,s.columnName),u=!0)}}return!u}))},onShow:function(t,e,i){},onHide:function(t,e,i){const n=i.$gantt;n&&n.focus()},destroy:function(){}};function zi(t){var e=function(){};return e.prototype={show:function(t,e,i,n){},hide:function(){},set_value:function(t,e,i,n){this.get_input(n).value=t},get_value:function(t,e,i){return this.get_input(i).value||""},is_changed:function(t,e,i,n){var a=this.get_value(e,i,n);return a&&t&&a.valueOf&&t.valueOf?a.valueOf()!=t.valueOf():a!=t},is_valid:function(t,e,i,n){return!0},save:function(t,e,i){},get_input:function(t){return t.querySelector("input")},focus:function(t){var e=this.get_input(t);e&&(e.focus&&e.focus(),e.select&&e.select())}},e}function Wi(t){var e=zi();function i(){return e.apply(this,arguments)||this}return Ti(i,e),Z(i.prototype,{show:function(t,e,i,n){var a=`<div role='cell'><input type='text' name='${e.name}' title='${e.name}'></div>`;n.innerHTML=a}},!0),i}function ji(t){var e=zi();function i(){return e.apply(this,arguments)||this}return Ti(i,e),Z(i.prototype,{show:function(t,e,i,n){var a=i.min||0,r=i.max||100,s=`<div role='cell'><input type='number' min='${a}' max='${r}' name='${e.name}' title='${e.name}'></div>`;n.innerHTML=s,n.oninput=function(t){+t.target.value<a&&(t.target.value=a),+t.target.value>r&&(t.target.value=r)}},get_value:function(t,e,i){return this.get_input(i).value||""},is_valid:function(t,e,i,n){return!isNaN(parseInt(t,10))}},!0),i}function Fi(t){var e=zi();function i(){return e.apply(this,arguments)||this}return Ti(i,e),Z(i.prototype,{show:function(t,e,i,n){for(var a=`<div role='cell'><select name='${e.name}' title='${e.name}'>`,r=[],s=i.options||[],o=0;o<s.length;o++)r.push("<option value='"+i.options[o].key+"'>"+s[o].label+"</option>");a+=r.join("")+"</select></div>",n.innerHTML=a},get_input:function(t){return t.querySelector("select")}},!0),i}function Vi(t){var e=zi(),i="%Y-%m-%d",n=null,a=null;function r(){return e.apply(this,arguments)||this}return Ti(r,e),Z(r.prototype,{show:function(e,r,s,o){n||(n=t.date.date_to_str(i)),a||(a=t.date.str_to_date(i));var l,d;l="function"==typeof s.min?s.min(e,r):s.min,d="function"==typeof s.max?s.max(e,r):s.max;var c=`<div style='width:140px' role='cell'><input type='date' ${l?" min='"+n(l)+"' ":""} ${d?" max='"+n(d)+"' ":""} name='${r.name}' title='${r.name}'></div>`;o.innerHTML=c,o.oninput=function(e){e.target.value&&(l||d)&&(+t.date.str_to_date("%Y-%m-%d")(e.target.value)<+l&&(e.target.value=t.date.date_to_str("%Y-%m-%d")(l)),+t.date.str_to_date("%Y-%m-%d")(e.target.value)>+d&&(e.target.value=t.date.date_to_str("%Y-%m-%d")(d)))}},set_value:function(t,e,i,a){t&&t.getFullYear?this.get_input(a).value=n(t):this.get_input(a).value=t},is_valid:function(t,e,i,n){return!(!t||isNaN(t.getTime()))},get_value:function(t,e,i){var n;try{n=a(this.get_input(i).value||"")}catch{n=null}return n}},!0),r}function Ui(t){var e=zi();function i(){return e.apply(this,arguments)||this}function n(e){return e.formatter||t.ext.formatters.linkFormatter()}function a(t,e){for(var i=(t||"").split(e.delimiter||","),n=0;n<i.length;n++){var a=i[n].trim();a?i[n]=a:(i.splice(n,1),n--)}return i.sort(),i}function r(t,e,i){for(var a=t.$target,r=[],s=0;s<a.length;s++){var o=i.getLink(a[s]);r.push(n(e).format(o))}return r.join((e.delimiter||",")+" ")}function s(t){return t.source+"_"+t.target+"_"+t.type+"_"+(t.lag||0)}return Ti(i,e),Z(i.prototype,{show:function(t,e,i,n){var a=`<div role='cell'><input type='text' name='${e.name}' title='${e.name}'></div>`;n.innerHTML=a},hide:function(){},set_value:function(e,i,n,a){this.get_input(a).value=r(e,n.editor,t)},get_value:function(t,e,i){return a(this.get_input(i).value||"",e.editor)},save:function(e,i,a){var r=function(e,i,a){var r,o,l,d=(r=e.id,o=a,l=[],[...new Set(i)].forEach((function(e){var i=n(o).parse(e);i&&(i.target=r,i.id="predecessor_generated",t.isLinkAllowed(i)&&(i.id=void 0,l.push(i)))})),l),c={};e.$target.forEach((function(e){var i=t.getLink(e);c[s(i)]=i.id}));var u=[];d.forEach((function(t){var e=s(t);c[e]?delete c[e]:u.push(t)}));var h=[];for(var _ in c)h.push(c[_]);return{add:u,remove:h}}(t.getTask(e),this.get_value(e,i,a),i.editor);(r.add.length||r.remove.length)&&t.batchUpdate((function(){r.add.forEach((function(e){t.addLink(e)})),r.remove.forEach((function(e){t.deleteLink(e)})),t.autoSchedule&&t.autoSchedule()}))},is_changed:function(e,i,n,s){var o=this.get_value(i,n,s),l=a(r(e,n.editor,t),n.editor);return o.join()!==l.join()}},!0),i}function qi(t){var e=zi();function i(){return e.apply(this,arguments)||this}function n(e){return e.formatter||t.ext.formatters.durationFormatter()}return Ti(i,e),Z(i.prototype,{show:function(t,e,i,n){var a=`<div role='cell'><input type='text' name='${e.name}' title='${e.name}'></div>`;n.innerHTML=a},set_value:function(t,e,i,a){this.get_input(a).value=n(i.editor).format(t)},get_value:function(t,e,i){return n(e.editor).parse(this.get_input(i).value||"")}},!0),i}function Gi(t){t.config.editor_types={text:new(Wi()),number:new(ji()),select:new(Fi()),date:new(Vi(t)),predecessor:new(Ui(t)),duration:new(qi(t))}}function Yi(t){var e,i,n=(e=t,i=null,{setMapping:function(t){i=t},getMapping:function(){return i||(e.config.keyboard_navigation_cells&&e.ext.keyboardNavigation?Bi:Oi)}}),a={};M(a);var r={init:Gi,createEditors:function(e){var i=function(t){return function(i,n,a){var r,s;"keepDates"==a?(r=i,"duration"==(s=n)?r.end_date=t.calculateEndDate(r):"end_date"!=s&&"start_date"!=s||(r.duration=t.calculateDuration(r))):"keepDuration"==a?function(i,n){"end_date"==n?i.start_date=e(i):"start_date"!=n&&"duration"!=n||(i.end_date=t.calculateEndDate(i))}(i,n):function(i,n){t.config.schedule_from_end?"end_date"==n||"duration"==n?i.start_date=e(i):"start_date"==n&&(i.duration=t.calculateDuration(i)):"start_date"==n||"duration"==n?i.end_date=t.calculateEndDate(i):"end_date"==n&&(i.duration=t.calculateDuration(i))}(i,n)};function e(e){return t.calculateEndDate({start_date:e.end_date,duration:-e.duration,task:e})}}(t),r=[],s=[],o=null,l={_itemId:null,_columnName:null,_editor:null,_editorType:null,_placeholder:null,locateCell:function(t){if(!x(t,e.$grid))return null;var i=m(t,e.$config.item_attribute),n=m(t,"data-column-name");if(i&&n){var a=n.getAttribute("data-column-name");return{id:i.getAttribute(e.$config.item_attribute),columnName:a}}return null},getEditorConfig:function(t){return e.getColumn(t).editor},init:function(){var i=n.getMapping();i.init&&i.init(this,e),o=e.$gantt.getDatastore(e.$config.bind);var a=this;r.push(o.attachEvent("onIdChange",(function(t,e){a._itemId==t&&(a._itemId=e)}))),r.push(o.attachEvent("onStoreUpdated",(function(){e.$gantt.getState("batchUpdate").batch_update||a.isVisible()&&!o.isVisible(a._itemId)&&a.hide()}))),s.push(t.attachEvent("onDataRender",(function(){a._editor&&a._placeholder&&!x(a._placeholder,t.$root)&&e.$grid_data.appendChild(a._placeholder)}))),this.init=function(){}},getState:function(){return{editor:this._editor,editorType:this._editorType,placeholder:this._placeholder,id:this._itemId,columnName:this._columnName}},startEdit:function(e,i){if(this.isVisible()&&this.save(),!o.exists(e))return;var n={id:e,columnName:i};if(t.isReadonly(o.getItem(e)))return void this.callEvent("onEditPrevent",[n]);if(!1===this.callEvent("onBeforeEditStart",[n]))return void this.callEvent("onEditPrevent",[n]);const a=this.show(n.id,n.columnName);a&&a.then?a.then(function(){this.setValue(),this.callEvent("onEditStart",[n])}.bind(this)):(this.setValue(),this.callEvent("onEditStart",[n]))},isVisible:function(){return!(!this._editor||!x(this._placeholder,t.$root))},show:function(i,a){this.isVisible()&&this.save();var r={id:i,columnName:a},s=e.getColumn(r.columnName),o=this.getEditorConfig(s.name);if(!o)return;var l=e.$getConfig().editor_types[o.type],d=function(i,n){var a=e.$getConfig(),r=function(t,i){for(var n=e.$getConfig(),a=e.getItemTop(t),r=e.getItemHeight(t),s=e.getGridColumns(),o=0,l=0,d=0,c=0;c<s.length;c++){if(s[c].name==i){d=s[c].width;break}n.rtl?l+=s[c].width:o+=s[c].width}return n.rtl?{top:a,right:l,height:r,width:d}:{top:a,left:o,height:r,width:d}}(i,n),s=document.createElement("div");s.className="gantt_grid_editor_placeholder",s.setAttribute(e.$config.item_attribute,i),s.setAttribute(e.$config.bind+"_id",i),s.setAttribute("data-column-name",n);var o=function(t,e){for(var i=t.getGridColumns(),n=0;n<i.length;n++)if(i[n].name==e)return n;return 0}(e,n);return s.setAttribute("data-column-index",o),t._waiAria.inlineEditorAttr(s),a.rtl?s.style.cssText=["top:"+r.top+"px","right:"+r.right+"px","width:"+r.width+"px","height:"+r.height+"px"].join(";"):s.style.cssText=["top:"+r.top+"px","left:"+r.left+"px","width:"+r.width+"px","height:"+r.height+"px"].join(";"),s}(r.id,r.columnName);e.$grid_data.appendChild(d);const c=function(){this._editor=l,this._placeholder=d,this._itemId=r.id,this._columnName=r.columnName,this._editorType=o.type;var t=n.getMapping();t.onShow&&t.onShow(this,d,e),d._onReMount=function(){this.setValue()}.bind(this)}.bind(this),u=l.show(r.id,s,o,d);if(u&&u.then)return u.then((()=>{c()}));c()},setValue:function(){var t=this.getState(),i=t.id,n=t.columnName,a=e.getColumn(n),r=o.getItem(i),s=this.getEditorConfig(n);if(s){var l=r[s.map_to];"auto"==s.map_to&&(l=o.getItem(i)),this._editor.set_value(l,i,a,this._placeholder),this.focus()}},focus:function(){this._editor.focus(this._placeholder)},getValue:function(){var t=e.getColumn(this._columnName);return this._editor.get_value(this._itemId,t,this._placeholder)},_getItemValue:function(){var e=this.getEditorConfig(this._columnName);if(e){var i=t.getTask(this._itemId)[e.map_to];return"auto"==e.map_to&&(i=o.getItem(this._itemId)),i}},isChanged:function(){var t=e.getColumn(this._columnName),i=this._getItemValue();return this._editor.is_changed(i,this._itemId,t,this._placeholder)},hide:function(){if(this._itemId){var t=this._itemId,i=this._columnName,a=n.getMapping();a.onHide&&a.onHide(this,this._placeholder,e),this._itemId=null,this._columnName=null,this._editorType=null,this._placeholder&&(this._editor&&this._editor.hide&&this._editor.hide(this._placeholder),this._editor=null,this._placeholder.parentNode&&this._placeholder.parentNode.removeChild(this._placeholder),this._placeholder=null,this.callEvent("onEditEnd",[{id:t,columnName:i}]))}},save:function(){if(this.isVisible()&&o.exists(this._itemId)&&this.isChanged()){var n=this._itemId,a=this._columnName;if(o.exists(n)){var r=o.getItem(n),s=this.getEditorConfig(a),l={id:n,columnName:a,newValue:this.getValue(),oldValue:this._getItemValue()};if(!1!==this.callEvent("onBeforeSave",[l])&&(!this._editor.is_valid||this._editor.is_valid(l.newValue,l.id,e.getColumn(a),this._placeholder))){var d=s.map_to,c=l.newValue;"auto"!=d?(r[d]=c,i(r,d,t.config.inline_editors_date_processing),o.updateItem(n)):this._editor.save(n,e.getColumn(a),this._placeholder),this.callEvent("onSave",[l])}this.hide()}}else this.hide()},_findEditableCell:function(t,i){var n=t,a=e.getGridColumns()[n],r=a?a.name:null;if(r){for(;r&&!this.getEditorConfig(r);)r=this._findEditableCell(t+i,i);return r}return null},getNextCell:function(t){return this._findEditableCell(e.getColumnIndex(this._columnName,!0)+t,t)},getFirstCell:function(){return this._findEditableCell(0,1)},getLastCell:function(){return this._findEditableCell(e.getGridColumns().length-1,-1)},editNextCell:function(t){var e=this.getNextCell(1);if(e){var i=this.getNextCell(1);i&&this.getEditorConfig(i)&&this.startEdit(this._itemId,i)}else if(t&&this.moveRow(1)){var n=this.moveRow(1);(e=this.getFirstCell())&&this.getEditorConfig(e)&&this.startEdit(n,e)}},editPrevCell:function(t){var e=this.getNextCell(-1);if(e){var i=this.getNextCell(-1);i&&this.getEditorConfig(i)&&this.startEdit(this._itemId,i)}else if(t&&this.moveRow(-1)){var n=this.moveRow(-1);(e=this.getLastCell())&&this.getEditorConfig(e)&&this.startEdit(n,e)}},moveRow:function(e){for(var i=e>0?t.getNext:t.getPrev,n=(i=t.bind(i,t))(this._itemId);t.isTaskExists(n)&&t.isReadonly(t.getTask(n));)n=i(n);return n},editNextRow:function(e){var i=this.getState().id;if(t.isTaskExists(i)){var n;n=e?this.moveRow(1):t.getNext(i),t.isTaskExists(n)&&this.startEdit(n,this._columnName)}},editPrevRow:function(e){var i=this.getState().id;if(t.isTaskExists(i)){var n;n=e?this.moveRow(-1):t.getPrev(i),t.isTaskExists(n)&&this.startEdit(n,this._columnName)}},detachStore:function(){r.forEach((function(t){o.detachEvent(t)})),s.forEach((function(e){t.detachEvent(e)})),r=[],s=[],o=null,this.hide()},destructor:function(){this.detachStore(),this.detachAllEvents()}};return Z(l,n),Z(l,a),l}};return Z(r,n),Z(r,a),r}function Ji(t,e,i,n,a){if(!t.start_date||!t.end_date)return null;var r=i.getItemTop(t.id),s=i.getItemHeight(t.id);if(r>e.y_end||r+s<e.y)return!1;var o=i.posFromDate(t.start_date),l=i.posFromDate(t.end_date),d=Math.min(o,l)-200,c=Math.max(o,l)+200;return!(d>e.x_end||c<e.x)}function Ki(t){function e(e,r,s){if(t._isAllowedUnscheduledTask(e)||!t._isTaskInTimelineLimits(e))return;var o=r.getItemPosition(e),l=s,d=r.$getTemplates(),c=t.getTaskType(e.type),u=r.getBarHeight(e.id,c==l.types.milestone),h=0;c==l.types.milestone&&(h=(u-o.height)/2);var _=Math.floor((r.getItemHeight(e.id)-u)/2);const g=t.config.baselines&&e.baselines&&e.baselines.length,f=t.config.baselines&&("separateRow"==t.config.baselines.render_mode||"individualRow"==t.config.baselines.render_mode);if(g&&f&&"full"!==e.bar_height&&e.bar_height<e.row_height)if(c===l.types.milestone){let t=r.getBarHeight(e.id,!0),i=Math.sqrt(2*t*t);_=Math.floor((i-u)/2)+2}else _=2;c==l.types.milestone&&(o.left-=Math.round(u/2),o.width=u);var p=document.createElement("div"),m=Math.round(o.width);r.$config.item_attribute&&(p.setAttribute(r.$config.item_attribute,e.id),p.setAttribute(r.$config.bind+"_id",e.id)),l.show_progress&&c!=l.types.milestone&&function(e,i,n,a,r){var s=1*e.progress||0;n=Math.max(n,0);var o=document.createElement("div"),l=Math.round(n*s);l=Math.min(n,l),o.style.width=l+"px",o.className="gantt_task_progress",o.innerHTML=r.progress_text(e.start_date,e.end_date,e),a.rtl&&(o.style.position="absolute",o.style.right="0px");var d=document.createElement("div");d.className="gantt_task_progress_wrapper",d.appendChild(o),i.appendChild(d);const c=!t.isReadonly(e),u=t.ext.dragTimeline&&t.ext.dragTimeline._isDragInProgress();if(t.config.drag_progress&&(c||u)){var h=document.createElement("div"),_=l;a.rtl&&(_=n-l),h.style.left=_+"px",h.className="gantt_task_progress_drag",h.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="9" viewBox="0 0 12 9" fill="none">\n<path d="M5.58397 1.52543C5.78189 1.22856 6.21811 1.22856 6.41602 1.52543L10.5475 7.72265C10.769 8.05493 10.5308 8.5 10.1315 8.5L1.86852 8.5C1.46917 8.5 1.23097 8.05493 1.45249 7.72265L5.58397 1.52543Z" fill="var(--dhx-gantt-progress-handle-background)" stroke="var(--dhx-gantt-progress-handle-border)"/>\n</svg>',o.appendChild(h),i.appendChild(h)}}(e,p,m,l,d);var v,k,y,b,x=(v=e,k=m,y=d,b=document.createElement("div"),t.getTaskType(v.type)!=t.config.types.milestone?b.innerHTML=y.task_text(v.start_date,v.end_date,v):t.getTaskType(v.type)==t.config.types.milestone&&k&&(b.style.height=b.style.width=k+"px"),b.className="gantt_task_content",b);p.appendChild(x);var $=function(e,i,n,a){var r=a.$getConfig(),s=["gantt_task_line"];i&&s.push(i);var o=t.getState(),l=t.getTask(n);if(t.getTaskType(l.type)==r.types.milestone?s.push("gantt_milestone"):t.getTaskType(l.type)==r.types.project&&s.push("gantt_project"),s.push("gantt_bar_"+t.getTaskType(l.type)),t.isSummaryTask(l)&&s.push("gantt_dependent_task"),t.isSplitTask(l)&&(r.open_split_tasks&&!l.$open||!r.open_split_tasks)&&s.push("gantt_split_parent"),r.select_task&&t.isSelectedTask(n)&&s.push("gantt_selected"),n==o.drag_id&&(s.push("gantt_drag_"+o.drag_mode),o.touch_drag&&s.push("gantt_touch_"+o.drag_mode)),o.link_source_id==n&&(s.push("gantt_link_source"),o.link_from_start?s.push("gantt_link_from_start"):s.push("gantt_link_from_end")),o.link_target_id==n&&s.push("gantt_link_target"),r.highlight_critical_path&&t.isCriticalTask&&t.isCriticalTask(l)&&s.push("gantt_critical_task"),o.link_landing_area&&o.link_target_id&&o.link_source_id&&o.link_target_id!=o.link_source_id&&(o.link_target_id==n||o.link_source_id==n)){var d,c=o.link_source_id,u=o.link_from_start,h=o.link_to_start;d=t.isLinkAllowed(c,n,u,h)?h?"link_start_allow":"link_finish_allow":h?"link_start_deny":"link_finish_deny",s.push(d)}return s.join(" ")}(0,d.task_class(e.start_date,e.end_date,e),e.id,r);(e.color||e.progressColor||e.textColor)&&($+=" gantt_task_inline_color"),o.width<20&&($+=" gantt_thin_task"),p.className=$;var w=["left:"+o.left+"px","top:"+(_+o.top)+"px","height:"+u+"px","line-height:"+Math.max(u<30?u-2:u,0)+"px","width:"+m+"px"];p.style.cssText=w.join(";"),e.color&&p.style.setProperty("--dhx-gantt-task-background",e.color),e.textColor&&p.style.setProperty("--dhx-gantt-task-color",e.textColor),e.progressColor&&p.style.setProperty("--dhx-gantt-task-progress-color",e.progressColor);var S=function(t,e,a,r){var s="gantt_left "+n(!e.rtl,t),o=null;return r&&(o={type:"marginRight",value:r}),i(t,a.leftside_text,s,o)}(e,l,d,h);S&&p.appendChild(S),S=function(t,e,a,r){var s="gantt_right "+n(!!e.rtl,t),o=null;return r&&(o={type:"marginLeft",value:r}),i(t,a.rightside_text,s,o)}(e,l,d,h),S&&p.appendChild(S),t._waiAria.setTaskBarAttr(e,p);var T=t.getState();const E=!t.isReadonly(e),C=t.ext.dragTimeline&&t.ext.dragTimeline._isDragInProgress();return(E||C)&&(l.drag_resize&&!t.isSummaryTask(e)&&c!=l.types.milestone&&a(p,"gantt_task_drag",e,(function(t){var e=document.createElement("div");return e.className=t,e}),l),l.drag_links&&l.show_links&&a(p,"gantt_link_control",e,(function(t){var e=document.createElement("div");e.className=t,e.style.cssText=["height:"+u+"px","line-height:"+u+"px"].join(";");var i=document.createElement("div");i.className="gantt_link_point";var n=!1;return T.link_source_id&&l.touch&&(n=!0),i.style.display=n?"block":"",e.appendChild(i),e}),l,h)),p}function i(t,e,i,n){if(!e)return null;var a=e(t.start_date,t.end_date,t);if(!a)return null;var r=document.createElement("div");return r.className="gantt_side_content "+i,r.innerHTML=a,n&&(r.style[n.type]=Math.abs(n.value)+"px"),r}function n(e,i){var n=e?{$source:[t.config.links.start_to_start],$target:[t.config.links.start_to_start,t.config.links.finish_to_start]}:{$source:[t.config.links.finish_to_start,t.config.links.finish_to_finish],$target:[t.config.links.finish_to_finish]};for(var a in n)for(var r=i[a],s=0;s<r.length;s++)for(var o=t.getLink(r[s]),l=0;l<n[a].length;l++)if(o.type==n[a][l])return"gantt_link_crossing";return""}function a(e,i,n,a,r,s){var o,l=t.getState();+n.start_date>=+l.min_date&&((o=a([i,r.rtl?"task_right":"task_left","task_start_date"].join(" "))).setAttribute("data-bind-property","start_date"),s&&(o.style.marginLeft=s+"px"),e.appendChild(o)),+n.end_date<=+l.max_date&&((o=a([i,r.rtl?"task_left":"task_right","task_end_date"].join(" "))).setAttribute("data-bind-property","end_date"),s&&(o.style.marginRight=s+"px"),e.appendChild(o))}return function(i,n,a){var r=(a=n.$getConfig()).type_renderers[t.getTaskType(i.type)],s=e;return r?r.call(t,i,(function(e){return s.call(t,e,n,a)}),n):s.call(t,i,n,a)}}function Xi(t){return{render:Ki(t),update:null,isInViewPort:Ji,getVisibleRange:ki}}function Zi(){return console.error("You are trying to use a Pro feature that is not available in the GPL version."),{render:function(){},isInViewPort:function(){},getVisibleRange:function(){}}}function Qi(t,e,i){return{top:e.getItemTop(t.id),height:e.getItemHeight(t.id),left:0,right:1/0}}function tn(t,e){var i=0,n=t.left.length-1;if(e)for(var a=0;a<t.left.length;a++){var r=t.left[a];if(r<e.x&&(i=a),r>e.x_end){n=a;break}}return{start:i,end:n}}function en(t,e,i,n){var a=e.width[t];if(a<=0)return!1;if(!n.config.smart_rendering||mi(n))return!0;var r=e.left[t]-a,s=e.left[t]+a;return r<=i.x_end&&s>=i.x}function nn(t,e){var i=e.config.timeline_placeholder;if(t=t||[],i&&0===t.filter((t=>"timeline_placeholder_task"===t.id)).length){var n=e.getState(),a=null,r=n.min_date,s=n.max_date;t.length&&(a=t[t.length-1].id);var o={start_date:r,end_date:s,row_height:i.height||0,id:"timeline_placeholder_task",unscheduled:!0,lastTaskId:a,calendar_id:i.calendar||"global",$source:[],$target:[]};t.push(o)}}function an(t,e,i,n,a){if(a.$ui.getView("grid")&&(a.config.keyboard_navigation&&a.getSelectedId()||a.ext.inlineEditors&&a.ext.inlineEditors.getState().id))return!!t.$expanded_branch;var r=i.getItemTop(t.id),s=i.getItemHeight(t.id);return!(r>e.y_end||r+s<e.y)}const rn=function(t,i){var n=t.$services.getService("dnd");if(i.$config.bind&&t.getDatastore(i.$config.bind)){var a=new n(i.$grid_data,{updates_per_second:60});t.defined(i.$getConfig().dnd_sensitivity)&&(a.config.sensitivity=i.$getConfig().dnd_sensitivity),a.attachEvent("onBeforeDragStart",t.bind((function(e,n){var l=r(n);if(!l||(t.hideQuickInfo&&t.hideQuickInfo(),$(n.target,".gantt_grid_editor_placeholder")))return!1;var d=l.getAttribute(i.$config.item_attribute);if(o(d))return!1;var c=s().getItem(d);return!t.isReadonly(c)&&(a.config.initial_open_state=c.$open,!!t.callEvent("onRowDragStart",[d,n.target||n.srcElement,n])&&void 0)}),t)),a.attachEvent("onAfterDragStart",t.bind((function(t,e){var n=r(e);a.config.marker.innerHTML=n.outerHTML;var o=a.config.marker.firstChild;o&&(o.style.position="static"),a.config.id=n.getAttribute(i.$config.item_attribute);var l=s(),d=l.getItem(a.config.id);a.config.index=l.getBranchIndex(a.config.id),a.config.parent=d.parent,d.$open=!1,d.$transparent=!0,this.refreshData()}),t)),a.lastTaskOfLevel=function(t){for(var e=null,i=s().getItems(),n=0,a=i.length;n<a;n++)i[n].$level==t&&(e=i[n]);return e?e.id:null},a._getGridPos=t.bind((function(t){var n=e(i.$grid_data),r=n.x+i.$grid.scrollLeft,s=t.pos.y-10,o=i.getItemHeight(a.config.id);s<n.y&&(s=n.y);var l=i.getTotalHeight();s>n.y+l-o&&(s=n.y+l-o);const d=n.y+n.height;return s>d-o&&(s=d-o),n.x=r,n.y=s,n}),t),a._getTargetY=t.bind((function(n){var a=e(i.$grid_data),r=i.$state.scrollTop||0,s=t.$grid_data.getBoundingClientRect().height+r,o=n.pageY-a.y+r;return o>s?o=s:o<r&&(o=r),o}),t),a._getTaskByY=t.bind((function(t,e){var n=s();t=t||0;var a=i.getItemIndexByTopPosition(t);return(a=e<a?a-1:a)>n.countVisible()-1?null:n.getIdByIndex(a)}),t),a.attachEvent("onDragMove",t.bind((function(n,r){var l=t.$grid_data.getBoundingClientRect(),d=l.height+l.y+(i.$state.scrollTop||0)+window.scrollY,c=a.config,u=a._getGridPos(r);t._waiAria.reorderMarkerAttr(c.marker);var h=i.$getConfig(),_=s();u.y<d?c.marker.style.top=u.y+"px":c.marker.style.top=d+"px",c.marker.style.left=u.x+10+"px";const g=e(t.$root);u.width>g.width&&(c.marker.style.width=g.width-10-2+"px",c.marker.style.overflow="hidden");var f=_.getItem(a.config.id),p=a._getTargetY(r),m=a._getTaskByY(p,_.getIndexById(f.id));function v(t,e){return!_.isChildOf(k.id,e.id)&&(t.$level==e.$level||h.order_branch_free)}if(_.exists(m)||(m=a.lastTaskOfLevel(h.order_branch_free?f.$level:0))==a.config.id&&(m=null),_.exists(m)){var k=_.getItem(m),y=i.getItemTop(k.id),b=i.getItemHeight(k.id);if(y+b/2<p){var x=_.getIndexById(k.id),$=_.getNext(k.id),w=_.getItem($);if(o($)){var S=_.getPrev(w.id);w=_.getItem(S)}if(w){if(w.id==f.id)return h.order_branch_free&&_.isChildOf(f.id,k.id)&&1==_.getChildren(k.id).length?void _.move(f.id,_.getBranchIndex(k.id)+1,_.getParent(k.id)):void 0;k=w}else if($=_.getIdByIndex(x),w=_.getItem($),o($)&&(S=_.getPrev(w.id),w=_.getItem(S)),v(w,f)&&w.id!=f.id)return void _.move(f.id,-1,_.getParent(w.id))}else if(h.order_branch_free&&k.id!=f.id&&v(k,f)&&!o(k.id)){if(!_.hasChild(k.id))return k.$open=!0,void _.move(f.id,-1,k.id);if(_.getIndexById(k.id)||b/3<p)return}x=_.getIndexById(k.id),S=_.getIdByIndex(x-1);for(var T=_.getItem(S),E=1;(!T||T.id==k.id)&&x-E>=0;)S=_.getIdByIndex(x-E),T=_.getItem(S),E++;if(f.id==k.id||o(k.id))return;v(k,f)&&f.id!=k.id?_.move(f.id,0,0,k.id):k.$level!=f.$level-1||_.getChildren(k.id).length?T&&v(T,f)&&f.id!=T.id&&_.move(f.id,-1,_.getParent(T.id)):_.move(f.id,0,k.id)}return!0}),t)),a.attachEvent("onDragEnd",t.bind((function(){var e=s(),i=e.getItem(a.config.id);i.$transparent=!1,i.$open=a.config.initial_open_state,!1===this.callEvent("onBeforeRowDragEnd",[a.config.id,a.config.parent,a.config.index])?(e.move(a.config.id,a.config.index,a.config.parent),i.$drop_target=null):this.callEvent("onRowDragEnd",[a.config.id,i.$drop_target]),t.render(),this.refreshData()}),t))}function r(t){return m(t,i.$config.item_attribute)}function s(){return t.getDatastore(i.$config.bind)}function o(e){return Et(e,t,s())}},sn={createDropTargetObject:function(t){var e={targetParent:null,targetIndex:0,targetId:null,child:!1,nextSibling:!1,prevSibling:!1};return t&&Z(e,t,!0),e},nextSiblingTarget:function(t,e,i){var n=this.createDropTargetObject();return n.targetId=e,n.nextSibling=!0,n.targetParent=i.getParent(n.targetId),n.targetIndex=i.getBranchIndex(n.targetId),(i.getParent(t)!=n.targetParent||n.targetIndex<i.getBranchIndex(t))&&(n.targetIndex+=1),n},prevSiblingTarget:function(t,e,i){var n=this.createDropTargetObject();return n.targetId=e,n.prevSibling=!0,n.targetParent=i.getParent(n.targetId),n.targetIndex=i.getBranchIndex(n.targetId),i.getParent(t)==n.targetParent&&n.targetIndex>i.getBranchIndex(t)&&(n.targetIndex-=1),n},firstChildTarget:function(t,e,i){var n=this.createDropTargetObject();return n.targetId=e,n.targetParent=n.targetId,n.targetIndex=0,n.child=!0,n},lastChildTarget:function(t,e,i){var n=i.getChildren(e),a=this.createDropTargetObject();return a.targetId=n[n.length-1],a.targetParent=e,a.targetIndex=n.length,a.nextSibling=!0,a}};function on(t,e,i,n,a){for(var r=e;n.exists(r);){var s=n.calculateItemLevel(n.getItem(r));if((s===i||s===i-1)&&n.getBranchIndex(r)>-1)break;r=a?n.getPrev(r):n.getNext(r)}return n.exists(r)?n.calculateItemLevel(n.getItem(r))===i?a?sn.nextSiblingTarget(t,r,n):sn.prevSiblingTarget(t,r,n):sn.firstChildTarget(t,r,n):null}function ln(t,e,i,n){return on(t,e,i,n,!0)}function dn(t,e,i,n){return on(t,e,i,n,!1)}function cn(t,e,i,n,a,r){var s;if(e!==a.$getRootId()){var o=a.getItem(e),l=a.calculateItemLevel(o);if(l===r){var d=a.getPrevSibling(e);i<.5&&!d?s=sn.prevSiblingTarget(t,e,a):(i<.5&&(e=d),s=sn.nextSiblingTarget(t,e,a))}else if(l>r)a.eachParent((function(t){a.calculateItemLevel(t)===r&&(e=t.id)}),o),s=ln(t,e,r,a);else{var c=ln(t,e,r,a),u=dn(t,e,r,a);s=i<.5?c:u}}else{var h=a.$getRootId(),_=a.getChildren(h);s=sn.createDropTargetObject(),s=_.length&&n>=0?ln(t,function(t){for(var e=t.getNext();t.exists(e);){var i=t.getNext(e);if(!t.exists(i))return e;e=i}return null}(a),r,a):dn(t,h,r,a)}return s}function un(t,i){var n=e(i.$grid_data);return t.x+=n.x+i.$grid.scrollLeft,t.y+=n.y-i.$grid_data.scrollTop,t}function hn(t,i,n=0){const a=e(t.$root);return i>a.width&&(i=a.width-n-2),i}const _n=function(t){t.markerLine&&t.markerLine.parentNode&&t.markerLine.parentNode.removeChild(t.markerLine),t.markerLine=null},gn=function(t,i,n){var a=function(t,i){var n=e(i.$grid_data),a=y(t,i.$grid_data),r=n.x+i.$grid.scrollLeft,s=a.y-10,o=i.getItemHeight(t.targetId);s<n.y&&(s=n.y);var l=i.getTotalHeight();return s>n.y+l-o&&(s=n.y+l-o),n.x=r,n.y=s,n.width=hn(i.$gantt,n.width,9),n}(t,n);i.marker.style.left=a.x+9+"px",i.marker.style.width=a.width+"px",i.marker.style.overflow="hidden";var r=i.markerLine;r||((r=document.createElement("div")).className="gantt_drag_marker gantt_grid_dnd_marker",r.innerHTML="<div class='gantt_grid_dnd_marker_line'></div>",r.style.pointerEvents="none"),t.child?function(t,e,i){var n=t.targetParent,a=un({x:0,y:i.getItemTop(n)},i),r=i.$grid_data.getBoundingClientRect().bottom+window.scrollY;let s=hn(i.$gantt,i.$grid_data.offsetWidth);e.innerHTML="<div class='gantt_grid_dnd_marker_folder'></div>",e.style.width=s+"px",e.style.top=a.y+"px",e.style.left=a.x+"px",e.style.height=i.getItemHeight(n)+"px",a.y>r&&(e.style.top=r+"px")}(t,r,n):function(t,e,i){var n=function(t,e){var i=e.$config.rowStore,n={x:0,y:0},a=e.$grid_data.querySelector(".gantt_tree_indent"),r=15,s=0;a&&(r=a.offsetWidth);if(t.targetId!==i.$getRootId()){var o=e.getItemTop(t.targetId),l=e.getItemHeight(t.targetId);if(s=i.exists(t.targetId)?i.calculateItemLevel(i.getItem(t.targetId)):0,t.prevSibling)n.y=o;else if(t.nextSibling){var d=0;i.eachItem((function(t){-1!==i.getIndexById(t.id)&&d++}),t.targetId),n.y=o+l+d*l}else n.y=o+l,s+=1}return n.x=40+s*r,n.width=hn(e.$gantt,Math.max(e.$grid_data.offsetWidth-n.x,0),n.x),un(n,e)}(t,i),a=i.$grid_data.getBoundingClientRect().bottom+window.scrollY;e.innerHTML="<div class='gantt_grid_dnd_marker_line'></div>",e.style.left=n.x+"px",e.style.height="4px";var r=n.y-2;e.style.top=r+"px",e.style.width=n.width+"px",r>a&&(e.style.top=a+"px")}(t,r,n),i.markerLine||(document.body.appendChild(r),i.markerLine=r)},fn=function(t,i){var n=t.$services.getService("dnd");if(i.$config.bind&&t.getDatastore(i.$config.bind)){var a=new n(i.$grid_data,{updates_per_second:60});t.defined(i.$getConfig().dnd_sensitivity)&&(a.config.sensitivity=i.$getConfig().dnd_sensitivity),a.attachEvent("onBeforeDragStart",t.bind((function(e,n){var o=r(n);if(!o||(t.hideQuickInfo&&t.hideQuickInfo(),$(n.target,".gantt_grid_editor_placeholder")))return!1;var l=o.getAttribute(i.$config.item_attribute),d=i.$config.rowStore.getItem(l);return!t.isReadonly(d)&&!s(l)&&(a.config.initial_open_state=d.$open,!!t.callEvent("onRowDragStart",[l,n.target||n.srcElement,n])&&void 0)}),t)),a.attachEvent("onAfterDragStart",t.bind((function(t,e){var n=r(e);a.config.marker.innerHTML=n.outerHTML;var s=a.config.marker.firstChild;s&&(a.config.marker.style.opacity=.4,s.style.position="static",s.style.pointerEvents="none"),a.config.id=n.getAttribute(i.$config.item_attribute);var o=i.$config.rowStore,l=o.getItem(a.config.id);a.config.level=o.calculateItemLevel(l),a.config.drop_target=sn.createDropTargetObject({targetParent:o.getParent(l.id),targetIndex:o.getBranchIndex(l.id),targetId:l.id,nextSibling:!0}),l.$open=!1,l.$transparent=!0,this.refreshData()}),t)),a.attachEvent("onDragMove",t.bind((function(n,r){var o=function(n){var r,o=function(n){var r=y(n,i.$grid_data).y,o=i.$config.rowStore;document.doctype||(r+=window.scrollY),r=r||0;var l=i.$state.scrollTop||0,d=t.$grid_data.getBoundingClientRect().height+l+window.scrollY,c=l,u=i.getItemIndexByTopPosition(i.$state.scrollTop);if(o.exists(u)||(u=o.countVisible()-1),u<0)return o.$getRootId();var h=o.getIdByIndex(u),_=i.$state.scrollTop/i.getItemHeight(h),g=_-Math.floor(_);g>.1&&g<.9&&(d-=i.getItemHeight(h)*g,c+=i.getItemHeight(h)*(1-g));const f=e(i.$grid_data),p=f.y+f.height,m=a.config.marker.offsetHeight;r+m+window.scrollY>=d&&(a.config.marker.style.top=p-m+"px"),r>=d?r=d:r<=c&&(r=c,a.config.marker.style.top=f.y+"px");var v=i.getItemIndexByTopPosition(r);if(v>o.countVisible()-1||v<0)return o.$getRootId();var k=o.getIdByIndex(v);return s(k)?o.getPrevSibling(k):o.getIdByIndex(v)}(n),l=null,d=i.$config.rowStore,c=!i.$getConfig().order_branch_free,u=y(n,i.$grid_data).y;return document.doctype||(u+=window.scrollY),o!==d.$getRootId()&&(l=(u-i.getItemTop(o))/i.getItemHeight(o)),c?(r=cn(a.config.id,o,l,u,d,a.config.level))&&r.targetParent&&s(r.targetParent)&&(o=d.getPrevSibling(r.targetParent),r=cn(a.config.id,o,l,u,d,a.config.level)):r=function(t,e,i,n,a){var r;if(e!==a.$getRootId())r=i<.25?sn.prevSiblingTarget(t,e,a):!(i>.6)||a.hasChild(e)&&a.getItem(e).$open?sn.firstChildTarget(t,e,a):sn.nextSiblingTarget(t,e,a);else{var s=a.$getRootId();r=a.hasChild(s)&&n>=0?sn.lastChildTarget(t,s,a):sn.firstChildTarget(t,s,a)}return r}(a.config.id,o,l,u,d),r}(r);return o&&!1!==t.callEvent("onBeforeRowDragMove",[a.config.id,o.targetParent,o.targetIndex])||(o=sn.createDropTargetObject(a.config.drop_target)),gn(o,a.config,i),a.config.drop_target=o,t._waiAria.reorderMarkerAttr(a.config.marker),this.callEvent("onRowDragMove",[a.config.id,o.targetParent,o.targetIndex]),!0}),t)),a.attachEvent("onDragEnd",t.bind((function(){var e=i.$config.rowStore,n=e.getItem(a.config.id);_n(a.config),n.$transparent=!1,n.$open=a.config.initial_open_state;var r=a.config.drop_target;!1===this.callEvent("onBeforeRowDragEnd",[a.config.id,r.targetParent,r.targetIndex])?n.$drop_target=null:(e.move(a.config.id,r.targetIndex,r.targetParent),t.render(),this.callEvent("onRowDragEnd",[a.config.id,r.targetParent,r.targetIndex])),e.refresh(n.id)}),t))}function r(t){return m(t,i.$config.item_attribute)}function s(e){return Et(e,t,t.getDatastore(i.$config.bind))}};var pn=function(t){return{onCreated:function(e){e.$config=Z(e.$config,{bind:"task"}),"grid"==e.$config.id&&(this.extendGantt(e),t.ext.inlineEditors=t.ext._inlineEditors.createEditors(e),t.ext.inlineEditors.init()),this._mouseDelegates=Ri(t)},onInitialized:function(e){var i=e.$getConfig();i.order_branch&&("marker"==i.order_branch?fn(e.$gantt,e):rn(e.$gantt,e)),this.initEvents(e,t),"grid"==e.$config.id&&this.extendDom(e)},onDestroyed:function(e){"grid"==e.$config.id&&t.ext.inlineEditors.detachStore(),this.clearEvents(e,t)},initEvents:function(t,e){this._mouseDelegates.delegate("click","gantt_row",e.bind((function(i,n,a){const r=t.$getConfig();if(null!==n){const t=this.getTask(n);if(r.scroll_on_click){const n=!e._is_icon_open_click(i),a=e.$ui.getView("timeline");n&&a&&this.showDate(t.start_date)}e.callEvent("onTaskRowClick",[n,a])}}),e),t.$grid),this._mouseDelegates.delegate("click","gantt_grid_head_cell",e.bind((function(i,n,a){var r=a.getAttribute("data-column-id");if(e.callEvent("onGridHeaderClick",[r,i])){var s=t.$getConfig();if("add"!=r){if(s.sort&&r){for(var o,l=r,d=0;d<s.columns.length;d++)if(s.columns[d].name==r){o=s.columns[d];break}if(o&&void 0!==o.sort&&!0!==o.sort&&!(l=o.sort))return;var c=this._sort&&this._sort.direction&&this._sort.name==r?this._sort.direction:"desc";c="desc"==c?"asc":"desc",this._sort={name:r,direction:c},this.sort(l,"desc"==c)}}else e.$services.getService("mouseEvents").callHandler("click","gantt_add",t.$grid,[i,s.root_id])}}),e),t.$grid),this._mouseDelegates.delegate("click","gantt_add",e.bind((function(i,n,a){if(!t.$getConfig().readonly)return this.createTask({},n||e.config.root_id),!1}),e),t.$grid)},clearEvents:function(t,e){this._mouseDelegates.destructor(),this._mouseDelegates=null},extendDom:function(e){t.$grid=e.$grid,t.$grid_scale=e.$grid_scale,t.$grid_data=e.$grid_data},extendGantt:function(e){t.getGridColumns=t.bind(e.getGridColumns,e),e.attachEvent("onColumnResizeStart",(function(){return t.callEvent("onColumnResizeStart",arguments)})),e.attachEvent("onColumnResize",(function(){return t.callEvent("onColumnResize",arguments)})),e.attachEvent("onColumnResizeEnd",(function(){return t.callEvent("onColumnResizeEnd",arguments)})),e.attachEvent("onColumnResizeComplete",(function(e,i){t.config.grid_width=i})),e.attachEvent("onBeforeRowResize",(function(){return t.callEvent("onBeforeRowResize",arguments)})),e.attachEvent("onRowResize",(function(){return t.callEvent("onRowResize",arguments)})),e.attachEvent("onBeforeRowResizeEnd",(function(){return t.callEvent("onBeforeRowResizeEnd",arguments)})),e.attachEvent("onAfterRowResize",(function(){return t.callEvent("onAfterRowResize",arguments)}))}}};const mn=function(){var t;return{extend:function(e){e.roundTaskDates=function(e){t.round_task_dates(e)}},init:function(e,i){return n=e,r=(a=i).$services,t={drag:null,dragMultiple:{},_events:{before_start:{},before_finish:{},after_finish:{}},_handlers:{},init:function(){this._domEvents=a._createDomEventScope(),this.clear_drag_state();var t=a.config.drag_mode;this.set_actions(),r.getService("state").registerProvider("tasksDnd",et((function(){return{drag_id:this.drag?this.drag.id:void 0,drag_mode:this.drag?this.drag.mode:void 0,drag_from_start:this.drag?this.drag.left:void 0}}),this));var e={before_start:"onBeforeTaskDrag",before_finish:"onBeforeTaskChanged",after_finish:"onAfterTaskDrag"};for(var i in this._events)for(var n in t)this._events[i][n]=e[i];this._handlers[t.move]=this._move,this._handlers[t.resize]=this._resize,this._handlers[t.progress]=this._resize_progress},set_actions:function(){var t=n.$task_data;this._domEvents.attach(t,"mousemove",a.bind((function(t){this.on_mouse_move(t)}),this)),this._domEvents.attach(t,"mousedown",a.bind((function(t){this.on_mouse_down(t)}),this)),this._domEvents.attach(document.body,"mouseup",a.bind((function(t){this.on_mouse_up(t)}),this))},clear_drag_state:function(){this.drag={id:null,mode:null,pos:null,start_x:null,start_y:null,obj:null,left:null},this.dragMultiple={}},_resize:function(t,e,i){var r=n.$getConfig(),s=this._drag_task_coords(t,i);i.left?(t.start_date=a.dateFromPos(s.start+e),t.start_date||(t.start_date=new Date(a.getState().min_date))):(t.end_date=a.dateFromPos(s.end+e),t.end_date||(t.end_date=new Date(a.getState().max_date)));var o=this._calculateMinDuration(r.min_duration,r.duration_unit);t.end_date-t.start_date<r.min_duration&&(i.left?t.start_date=a.calculateEndDate(t.end_date,-o,r.duration_unit,t):t.end_date=a.calculateEndDate(t.start_date,o,r.duration_unit,t)),a._init_task_timing(t)},_calculateMinDuration:function(t,e){return Math.ceil(t/{minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:31356e6}[e])},_resize_progress:function(t,e,i){var a=this._drag_task_coords(t,i),r=n.$getConfig().rtl?a.start-i.pos.x:i.pos.x-a.start,s=Math.max(0,r);t.progress=Math.min(1,s/Math.abs(a.end-a.start))},_find_max_shift:function(t,e){var i;for(var n in t){var r=t[n],s=a.getTask(r.id);if(!s.unscheduled){var o=this._drag_task_coords(s,r),l=a.posFromDate(new Date(a.getState().min_date)),d=a.posFromDate(new Date(a.getState().max_date));if(o.end+e>d){var c=d-o.end;(c<i||void 0===i)&&(i=c)}else if(o.start+e<l){var u=l-o.start;(u>i||void 0===i)&&(i=u)}}}return i},_move:function(t,e,i,n){var r=this._drag_task_coords(t,i),s=null,o=null;n?(s=new Date(+i.obj.start_date+n),o=new Date(+i.obj.end_date+n)):(s=a.dateFromPos(r.start+e),o=a.dateFromPos(r.end+e)),s?o?(t.start_date=s,t.end_date=o):(t.end_date=new Date(a.getState().max_date),t.start_date=a.dateFromPos(a.posFromDate(t.end_date)-(r.end-r.start))):(t.start_date=new Date(a.getState().min_date),t.end_date=a.dateFromPos(a.posFromDate(t.start_date)+(r.end-r.start)))},_drag_task_coords:function(t,e){return{start:e.obj_s_x=e.obj_s_x||a.posFromDate(t.start_date),end:e.obj_e_x=e.obj_e_x||a.posFromDate(t.end_date)}},_mouse_position_change:function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},_is_number:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},on_mouse_move:function(t){if(this.drag.start_drag){var e=y(t,a.$task_data),i=this.drag.start_drag.start_x,n=this.drag.start_drag.start_y;(Date.now()-this.drag.timestamp>50||this._is_number(i)&&this._is_number(n)&&this._mouse_position_change({x:i,y:n},e)>20)&&this._start_dnd(t)}if(this.drag.mode){if(!$t(this,40))return;this._update_on_move(t)}},_update_item_on_move:function(t,e,i,n,r,s){var o=a.getTask(e),l=a.mixin({},o),d=a.mixin({},o);this._handlers[i].apply(this,[d,t,n,s]),a.mixin(o,d,!0),a.callEvent("onTaskDrag",[o.id,i,d,l,r]),a.mixin(o,d,!0),a.refreshTask(e)},_update_on_move:function(t){var e=this.drag,i=n.$getConfig();if(e.mode){var r=y(t,n.$task_data);if(e.pos&&e.pos.x==r.x)return;e.pos=r;var s=a.dateFromPos(r.x);if(!s||isNaN(s.getTime()))return;var o=r.x-e.start_x,l=a.getTask(e.id);if(this._handlers[e.mode]){if(e.mode===i.drag_mode.move){var d={};this._isMultiselect()&&a.getSelectedTasks().indexOf(e.id)>=0&&(d=this.dragMultiple);var c=!1;if(a.isSummaryTask(l)&&a.config.drag_project){var u={};u[e.id]=X(e),c=!0,d=Z(u,this.dragMultiple)}var h=this._find_max_shift(d,o);let i;if(void 0!==h&&(o=h),this._update_item_on_move(o,e.id,e.mode,e,t),void 0===h){const t=a.posFromDate(e.obj.start_date),n=a.posFromDate(e.obj.end_date);if(void 0===e.handle_offset){const i=n-t,a=e.start_x-t;e.handle_offset=a/i}let r=t+Math.abs(n-t)*e.handle_offset;i=s-a.dateFromPos(r)}for(var _ in d){var g=d[_];c&&g.id!=e.id&&(a._bulk_dnd=!0),this._update_item_on_move(o,g.id,g.mode,g,t,i)}a._bulk_dnd=!1}else this._update_item_on_move(o,e.id,e.mode,e,t);a._update_parents(e.id)}}},on_mouse_down:function(t,e){if(2!=t.button||void 0===t.button){var i=n.$getConfig(),r=a.locate(t),s=null;if(a.isTaskExists(r)&&(s=a.getTask(r)),!a.isReadonly(s)&&!this.drag.mode){this.clear_drag_state();var o=l(e=e||t.target||t.srcElement),d=this._get_drag_mode(o,e);if(!o||!d)return e.parentNode?this.on_mouse_down(t,e.parentNode):void 0;if(d)if(d.mode&&d.mode!=i.drag_mode.ignore&&i["drag_"+d.mode]){if(r=a.locate(e),s=a.copy(a.getTask(r)||{}),a.isReadonly(s))return this.clear_drag_state(),!1;if(a.isSummaryTask(s)&&!1!==s.auto_scheduling&&!i.drag_project&&d.mode!=i.drag_mode.progress)return void this.clear_drag_state();d.id=r;var c=y(t,a.$task_data);d.start_x=c.x,d.start_y=c.y,d.obj=s,this.drag.start_drag=d,this.drag.timestamp=Date.now()}else this.clear_drag_state();else if(a.checkEvent("onMouseDown")&&a.callEvent("onMouseDown",[o.split(" ")[0]])&&e.parentNode)return this.on_mouse_down(t,e.parentNode)}}},_fix_dnd_scale_time:function(t,e){var i=n.$getConfig(),r=a.getScale().unit,s=a.getScale().step;function o(t){if(a.config.correct_work_time){var e=n.$getConfig();a.isWorkTime(t.start_date,void 0,t)||(t.start_date=a.calculateEndDate({start_date:t.start_date,duration:-1,unit:e.duration_unit,task:t}))}}i.round_dnd_dates||(r="minute",s=i.time_step),e.mode==i.drag_mode.resize?e.left?(t.start_date=a.roundDate({date:t.start_date,unit:r,step:s}),o(t)):(t.end_date=a.roundDate({date:t.end_date,unit:r,step:s}),function(t){if(a.config.correct_work_time){var e=n.$getConfig();a.isWorkTime(new Date(t.end_date-1),void 0,t)||(t.end_date=a.calculateEndDate({start_date:t.end_date,duration:1,unit:e.duration_unit,task:t}))}}(t)):e.mode==i.drag_mode.move&&(t.start_date=a.roundDate({date:t.start_date,unit:r,step:s}),o(t),t.end_date=a.calculateEndDate(t))},_fix_working_times:function(t,e){var i=n.$getConfig();(e=e||{mode:i.drag_mode.move}).mode==i.drag_mode.resize?e.left?t.start_date=a.getClosestWorkTime({date:t.start_date,dir:"future",task:t}):t.end_date=a.getClosestWorkTime({date:t.end_date,dir:"past",task:t}):e.mode==i.drag_mode.move&&a.correctTaskWorkTime(t)},_finalize_mouse_up:function(t,e,i,n){var r=a.getTask(t);if(e.work_time&&e.correct_work_time&&this._fix_working_times(r,i),this._fix_dnd_scale_time(r,i),this._fireEvent("before_finish",i.mode,[t,i.mode,a.copy(i.obj),n])){var s=t;a._init_task_timing(r),this.clear_drag_state(),a.updateTask(r.id),this._fireEvent("after_finish",i.mode,[s,i.mode,n])}else if(this.clear_drag_state(),t==i.id&&(i.obj._dhx_changed=!1,a.mixin(r,i.obj,!0)),a.refreshTask(r.id),r.$level>100){let t=!1;a.eachParent((function(e){if(!t&&e.type===a.config.types.project){const i={start_date:e.start_date,end_date:e.end_date};a.resetProjectDates(e),+i.start_date==+e.start_date&&+i.end_date==+e.end_date||(t=!0)}}),r.id),t&&a.refreshData()}else a.eachParent((function(t){if(t.type===a.config.types.project){const e={start_date:t.start_date,end_date:t.end_date};a.resetProjectDates(t),+e.start_date==+t.start_date&&+e.end_date==+t.end_date||a.refreshTask(t.id)}}),r.id)},on_mouse_up:function(t){var e=this.drag;if(e.mode&&e.id){var i=n.$getConfig(),r=a.getTask(e.id),s=this.dragMultiple,o=!1,l=0;e.mode===i.drag_mode.move&&(a.isSummaryTask(r)&&i.drag_project||this._isMultiselect())&&(o=!0,l=Object.keys(s).length);var d=function(){if(o)for(var n in s)s[n].id!=e.id&&this._finalize_mouse_up(s[n].id,i,s[n],t);this._finalize_mouse_up(e.id,i,e,t)};o&&l>10?a.batchUpdate(function(){d.call(this)}.bind(this)):d.call(this)}this.clear_drag_state()},_get_drag_mode:function(t,e){var i=n.$getConfig().drag_mode,a={mode:null,left:null};switch((t||"").split(" ")[0]){case"gantt_task_line":case"gantt_task_content":a.mode=i.move;break;case"gantt_task_drag":a.mode=i.resize;var r=e.getAttribute("data-bind-property");a.left="start_date"==r;break;case"gantt_task_progress_drag":a.mode=i.progress;break;case"gantt_link_control":case"gantt_link_point":a.mode=i.ignore;break;default:a=null}return a},_start_dnd:function(t){var e=this.drag=this.drag.start_drag;delete e.start_drag;var i=n.$getConfig(),r=e.id;if(i["drag_"+e.mode]&&a.callEvent("onBeforeDrag",[r,e.mode,t])&&this._fireEvent("before_start",e.mode,[r,e.mode,t])){delete e.start_drag;var s=a.getTask(r);if(a.isReadonly(s))return void this.clear_drag_state();if(this._isMultiselect()){var o=a.getSelectedTasks();o.indexOf(e.id)>=0&&P(o,a.bind((function(t){var n=a.getTask(t);a.isSummaryTask(n)&&a.config.drag_project&&e.mode==i.drag_mode.move&&this._addSubtasksToDragMultiple(n.id),this.dragMultiple[t]=a.mixin({id:n.id,obj:a.copy(n)},this.drag)}),this))}a.isSummaryTask(s)&&a.config.drag_project&&e.mode==i.drag_mode.move&&this._addSubtasksToDragMultiple(s.id),a.callEvent("onTaskDragStart",[])}else this.clear_drag_state()},_fireEvent:function(t,e,i){a.assert(this._events[t],"Invalid stage:{"+t+"}");var n=this._events[t][e];return a.assert(n,"Unknown after drop mode:{"+e+"}"),a.assert(i,"Invalid event arguments"),!a.checkEvent(n)||a.callEvent(n,i)},round_task_dates:function(t){var e=this.drag,i=n.$getConfig();e||(e={mode:i.drag_mode.move}),this._fix_dnd_scale_time(t,e)},destructor:function(){this._domEvents.detachAll()},_isMultiselect:function(){return a.config.drag_multiple&&!!(a.getSelectedTasks&&a.getSelectedTasks().length>0)},_addSubtasksToDragMultiple:function(t){a.eachTask((function(t){this.dragMultiple[t.id]=a.mixin({id:t.id,obj:a.copy(t)},this.drag)}),t,this)}},e._tasks_dnd=t,t.init(i);var n,a,r},destructor:function(){t&&(t.destructor(),t=null)}}};var vn=function(t,e){var i,n,a,r,s;function o(){return{link_source_id:r,link_target_id:n,link_from_start:s,link_to_start:a,link_landing_area:i}}var l=e.$services,d=l.getService("state"),c=l.getService("dnd");d.registerProvider("linksDnD",o);var u="gantt_link_point",h="gantt_link_control",_=new c(t.$task_bars,{sensitivity:0,updates_per_second:60,mousemoveContainer:e.$root,selector:"."+u,preventDefault:!0});function g(t){var i=o();i.link_source_id&&i.link_target_id&&e.isLinkAllowed(i.link_source_id,i.link_target_id,i.link_from_start,i.link_to_start);var n="<div class='"+e.templates.drag_link_class(i.link_source_id,i.link_from_start,i.link_target_id,i.link_to_start)+"'>"+e.templates.drag_link(i.link_source_id,i.link_from_start,i.link_target_id,i.link_to_start)+"</div>";t.innerHTML=n}function f(){r=s=n=null,a=!0}function m(i,n,a,r){var s=(_._direction&&_._direction.parentNode||(_._direction=document.createElement("div"),t.$task_links.appendChild(_._direction)),_._direction),l=o(),d=["gantt_link_direction"];e.templates.link_direction_class&&d.push(e.templates.link_direction_class(l.link_source_id,l.link_from_start,l.link_target_id,l.link_to_start));var c,u,h=Math.sqrt(Math.pow(a-i,2)+Math.pow(r-n,2));if(h=Math.max(0,h-3)){s.className=d.join(" ");var g=(r-n)/(a-i),f=Math.atan(g);2==v(i,a,n,r)?f+=Math.PI:3==v(i,a,n,r)&&(f-=Math.PI);var p=Math.sin(f),m=Math.cos(f),k=Math.round(n),y=Math.round(i),b=["-webkit-transform: rotate("+f+"rad)","-moz-transform: rotate("+f+"rad)","-ms-transform: rotate("+f+"rad)","-o-transform: rotate("+f+"rad)","transform: rotate("+f+"rad)","width:"+Math.round(h)+"px"];if(-1!=window.navigator.userAgent.indexOf("MSIE 8.0")){b.push('-ms-filter: "'+("progid:DXImageTransform.Microsoft.Matrix(M11 = "+(u=m)+",M12 = -"+(c=p)+",M21 = "+c+",M22 = "+u+",SizingMethod = 'auto expand')\""));var x=Math.abs(Math.round(i-a)),$=Math.abs(Math.round(r-n));switch(v(i,a,n,r)){case 1:k-=$;break;case 2:y-=x,k-=$;break;case 3:y-=x}}b.push("top:"+k+"px"),b.push("left:"+y+"px"),s.style.cssText=b.join(";")}}function v(t,e,i,n){return e>=t?n<=i?1:4:n<=i?2:3}_.attachEvent("onBeforeDragStart",e.bind((function(t,i){var n=i.target||i.srcElement;if(f(),e.getState("tasksDnd").drag_id)return!1;if(k(n,u)){k(n,"task_start_date")&&(s=!0);var a=e.locate(i);r=a;var o=e.getTask(a);return e.isReadonly(o)?(f(),!1):(this._dir_start={x:_.config.original_element_sizes.x+_.config.original_element_sizes.width/2,y:_.config.original_element_sizes.y+_.config.original_element_sizes.height/2},!0)}return!1}),this)),_.attachEvent("onAfterDragStart",e.bind((function(t,i){e.config.touch&&e.refreshData(),g(_.config.marker)}),this)),_.attachEvent("onDragMove",e.bind((function(r,s){var o,l,d=_.config,c=function(t,i){var n,a,r,s,o=_.getPosition(t),l=(r=0,s=0,(a=i)&&(r=a.offsetWidth||0,s=a.offsetHeight||0),{width:r,height:s}),d=(n=e.$root).offsetWidth,c=n.offsetHeight,u=e.config.tooltip_offset_x||10,h=e.config.tooltip_offset_y||10,g=e.config.scroll_size||18,f=e.$container.getBoundingClientRect().y+window.scrollY,p={y:o.y+h,x:o.x+u,bottom:o.y+l.height+h+g,right:o.x+l.width+u+g};return p.bottom>c+f&&(p.y=c+f-l.height-h),p.right>d&&(p.x=d-l.width-u),p}(s,d.marker);o=d.marker,l=c,o.style.left=l.x+"px",o.style.top=l.y+"px";var f=!!k(s,h),v=n,$=i,w=a,S=e.locate(s),T=!0;if(x(p(s),e.$root)||(f=!1,S=null),f&&(T=!k(s,"task_end_date"),f=!!S),n=S,i=f,a=T,f){const e=k(s,h).querySelector(`.${u}`);if(e){const i=b(e,t.$task_bg);this._dir_end={x:i.x+e.offsetWidth/2,y:i.y+e.offsetHeight/2}}}else this._dir_end=y(s,t.$task_data),e.env.isEdge&&(this._dir_end.y+=window.scrollY);var E=!($==f&&v==S&&w==T);return E&&(v&&e.refreshTask(v,!1),S&&e.refreshTask(S,!1)),E&&g(d.marker),m(this._dir_start.x,this._dir_start.y,this._dir_end.x,this._dir_end.y),!0}),this)),_.attachEvent("onDragEnd",e.bind((function(){var t=o();if(t.link_source_id&&t.link_target_id&&t.link_source_id!=t.link_target_id){var i=e._get_link_type(t.link_from_start,t.link_to_start),n={source:t.link_source_id,target:t.link_target_id,type:i};n.type&&e.isLinkAllowed(n)&&e.callEvent("onLinkCreated",[n])&&e.addLink(n)}f(),e.config.touch?e.refreshData():(t.link_source_id&&e.refreshTask(t.link_source_id,!1),t.link_target_id&&e.refreshTask(t.link_target_id,!1)),_._direction&&(_._direction.parentNode&&_._direction.parentNode.removeChild(_._direction),_._direction=null)}),this)),e.attachEvent("onGanttRender",e.bind((function(){_._direction&&m(this._dir_start.x,this._dir_start.y,this._dir_end.x,this._dir_end.y)}),this))};var kn=function(t){var e=t.$services;return{onCreated:function(e){var i=e.$config;i.bind=Q(i.bind)?i.bind:"task",i.bindLinks=Q(i.bindLinks)?i.bindLinks:"link",e._linksDnD={init:vn},e._tasksDnD=mn(),e._tasksDnD.extend(e),this._mouseDelegates=Ri(t)},onInitialized:function(e){this._attachDomEvents(t),this._attachStateProvider(t,e),e._tasksDnD.init(e,t),e._linksDnD.init(e,t),"timeline"==e.$config.id&&this.extendDom(e)},onDestroyed:function(e){this._clearDomEvents(t),this._clearStateProvider(t),e._tasksDnD&&e._tasksDnD.destructor()},extendDom:function(e){t.$task=e.$task,t.$task_scale=e.$task_scale,t.$task_data=e.$task_data,t.$task_bg=e.$task_bg,t.$task_links=e.$task_links,t.$task_bars=e.$task_bars},_clearDomEvents:function(){this._mouseDelegates.destructor(),this._mouseDelegates=null},_attachDomEvents:function(t){function e(e,i){if(e&&this.callEvent("onLinkDblClick",[e,i])){var n=this.getLink(e);if(this.isReadonly(n))return;var a=this.locale.labels.link+" "+this.templates.link_description(this.getLink(e))+" "+this.locale.labels.confirm_link_deleting;window.setTimeout((function(){t._delete_link_confirm({link:n,message:a,title:"",callback:function(){t.deleteLink(e)}})}),this.config.touch?300:1)}}this._mouseDelegates.delegate("click","gantt_task_link",t.bind((function(t,e){var i=this.locate(t,this.config.link_attribute);i&&this.callEvent("onLinkClick",[i,t])}),t),this.$task),this._mouseDelegates.delegate("click","gantt_scale_cell",t.bind((function(e,i){var n=y(e,t.$task_data),a=t.dateFromPos(n.x),r=Math.floor(t.columnIndexByDate(a)),s=t.getScale().trace_x[r];t.callEvent("onScaleClick",[e,s])}),t),this.$task),this._mouseDelegates.delegate("doubleclick","gantt_task_link",t.bind((function(i,n,a){n=this.locate(i,t.config.link_attribute),e.call(this,n,i)}),t),this.$task),this._mouseDelegates.delegate("doubleclick","gantt_link_point",t.bind((function(t,i,n){i=this.locate(t);var a=this.getTask(i),r=null;return n.parentNode&&l(n.parentNode)&&(r=l(n.parentNode).indexOf("_left")>-1?a.$target[0]:a.$source[0]),r&&e.call(this,r,t),!1}),t),this.$task)},_attachStateProvider:function(t,i){var n=i;e.getService("state").registerProvider("tasksTimeline",(function(){return{scale_unit:n._tasks?n._tasks.unit:void 0,scale_step:n._tasks?n._tasks.step:void 0}}))},_clearStateProvider:function(){e.getService("state").unregisterProvider("tasksTimeline")}}},yn=function(t){return{getVerticalScrollbar:function(){return t.$ui.getView("scrollVer")},getHorizontalScrollbar:function(){return t.$ui.getView("scrollHor")},_legacyGridResizerClass:function(t){for(var e=t.getCellsByType("resizer"),i=0;i<e.length;i++){var n=e[i],a=!1,r=n.$parent.getPrevSibling(n.$id);if(r&&r.$config&&"grid"===r.$config.id)a=!0;else{var s=n.$parent.getNextSibling(n.$id);s&&s.$config&&"grid"===s.$config.id&&(a=!0)}a&&(n.$config.css=(n.$config.css?n.$config.css+" ":"")+"gantt_grid_resize_wrap")}},onCreated:function(e){var i=!0;this._legacyGridResizerClass(e),e.attachEvent("onBeforeResize",(function(){var n=t.$ui.getView("timeline");n&&(n.$config.hidden=n.$parent.$config.hidden=!t.config.show_chart);var a=t.$ui.getView("grid");if(a){var r=a._getColsTotalWidth(),s=!t.config.show_grid||!t.config.grid_width||0===r;if(i&&!s&&!1!==r&&(t.config.grid_width=r),a.$config.hidden=a.$parent.$config.hidden=s,!a.$config.hidden){var o=a._getGridWidthLimits();if(o[0]&&t.config.grid_width<o[0]&&(t.config.grid_width=o[0]),o[1]&&t.config.grid_width>o[1]&&(t.config.grid_width=o[1]),n&&t.config.show_chart){if(a.$config.width=t.config.grid_width-1,!a.$config.scrollable&&a.$config.scrollY&&t.$root.offsetWidth){var l=a.$gantt.$layout.$container.offsetWidth,d=t.$ui.getView(a.$config.scrollY).$config.width,c=l-(a.$config.width+d)-4;c<0&&(a.$config.width+=c,t.config.grid_width+=c)}if(i)a.$parent.$config.width=t.config.grid_width,a.$parent.$config.group&&t.$layout._syncCellSizes(a.$parent.$config.group,{value:a.$parent.$config.width,isGravity:!1});else if(n&&!x(n.$task,e.$view)){if(!a.$config.original_grid_width){var u=t.skins[t.skin];u&&u.config&&u.config.grid_width?a.$config.original_grid_width=u.config.grid_width:a.$config.original_grid_width=0}t.config.grid_width=a.$config.original_grid_width,a.$parent.$config.width=t.config.grid_width}else a.$parent._setContentSize(a.$config.width,null),t.$layout._syncCellSizes(a.$parent.$config.group,{value:t.config.grid_width,isGravity:!1})}else n&&x(n.$task,e.$view)&&(a.$config.original_grid_width=t.config.grid_width),i||(a.$parent.$config.width=0)}i=!1}})),this._initScrollStateEvents(e)},_initScrollStateEvents:function(e){t._getVerticalScrollbar=this.getVerticalScrollbar,t._getHorizontalScrollbar=this.getHorizontalScrollbar;var i=this.getVerticalScrollbar(),n=this.getHorizontalScrollbar();i&&i.attachEvent("onScroll",(function(e,i,n){var a=t.getScrollState();t.callEvent("onGanttScroll",[a.x,e,a.x,i])})),n&&n.attachEvent("onScroll",(function(e,i,n){var a=t.getScrollState();t.callEvent("onGanttScroll",[e,a.y,i,a.y]);var r=t.$ui.getView("grid");r&&r.$grid_data&&!r.$config.scrollable&&(r.$grid_data.style.left=r.$grid.scrollLeft+"px",r.$grid_data.scrollLeft=r.$grid.scrollLeft)})),e.attachEvent("onResize",(function(){i&&!t.$scroll_ver&&(t.$scroll_ver=i.$scroll_ver),n&&!t.$scroll_hor&&(t.$scroll_hor=n.$scroll_hor)}))},_findGridResizer:function(t,e){for(var i,n=t.getCellsByType("resizer"),a=!0,r=0;r<n.length;r++){var s=n[r];s._getSiblings();var o=s._behind,l=s._front;if(o&&o.$content===e||o.isChild&&o.isChild(e)){i=s,a=!0;break}if(l&&l.$content===e||l.isChild&&l.isChild(e)){i=s,a=!1;break}}return{resizer:i,gridFirst:a}},onInitialized:function(e){var i=t.$ui.getView("grid"),n=this._findGridResizer(e,i);if(n.resizer){var a,r=n.gridFirst,s=n.resizer;if("x"!==s.$config.mode)return;s.attachEvent("onResizeStart",(function(e,i){var n=t.$ui.getView("grid"),s=n?n.$parent:null;if(s){var o=n._getGridWidthLimits();n.$config.scrollable||(s.$config.minWidth=o[0]),s.$config.maxWidth=o[1]}return a=r?e:i,t.callEvent("onGridResizeStart",[a])})),s.attachEvent("onResize",(function(e,i){var n=r?e:i;return t.callEvent("onGridResize",[a,n])})),s.attachEvent("onResizeEnd",(function(e,i,n,a){var s=r?e:i,o=r?n:a,l=t.$ui.getView("grid"),d=l?l.$parent:null;d&&(d.$config.minWidth=void 0);var c=t.callEvent("onGridResizeEnd",[s,o]);return c&&0!==o&&(t.config.grid_width=o),c}))}},onDestroyed:function(t){}}};const bn=function(t){function e(e,i){var n=i(t);n.onCreated&&n.onCreated(e),e.attachEvent("onReady",(function(){n.onInitialized&&n.onInitialized(e)})),e.attachEvent("onDestroy",(function(){n.onDestroyed&&n.onDestroyed(e)}))}var i=_i(t);i.registerView("cell",Si),i.registerView("resizer",null),i.registerView("scrollbar",Ai),i.registerView("layout",Ei,(function(t){"main"===(t.$config?t.$config.id:null)&&e(t,yn)})),i.registerView("viewcell",Di),i.registerView("multiview",Ci),i.registerView("timeline",Mi,(function(t){"timeline"!==(t.$config?t.$config.id:null)&&"task"!=t.$config.bind||e(t,kn)})),i.registerView("grid",Hi,(function(t){"grid"!==(t.$config?t.$config.id:null)&&"task"!=t.$config.bind||e(t,pn)})),i.registerView("resourceGrid",Hi),i.registerView("resourceTimeline",Mi),i.registerView("resourceHistogram",Mi);var n,a,r=(a=function(t){var e=function(t){var e={},i={};function n(e){var i=null;return"string"==typeof e.view?i=t.$ui.getView(e.view):e.view&&(i=e.view),i}function a(a,r,s){if(i[a])return i[a];r.renderer||t.assert(!1,"Invalid renderer call");var o=null,l=null,d=null,c=null,u=null;"function"==typeof r.renderer?(o=r.renderer,d=vi):(o=r.renderer.render,l=r.renderer.update,c=r.renderer.onrender,r.renderer.isInViewPort?u=r.renderer.isInViewPort:d=r.renderer.getRectangle,d||null===d||(d=vi));var h=r.filter;return s&&s.setAttribute(t.config.layer_attribute,!0),i[a]={render_item:function(e,i,a,l,_){if(i=i||s,!h||h(e)){var g=l||n(r),f=_||(g?g.$getConfig():null),p=a;!p&&f&&f.smart_rendering&&(p=g.getViewPort());var m=null;!mi(t)&&(d||u)&&p?(u?u(e,p,g,f,t):pi(p,d(e,g,f,t)))&&(m=o.call(t,e,g,f,p)):m=o.call(t,e,g,f,p),this.append(e,m,i);var v=11==i.nodeType;c&&!v&&m&&c.call(t,e,m,g)}else this.remove_item(e.id)},clear:function(t){this.rendered=e[a]={},r.append||this.clear_container(t)},clear_container:function(t){(t=t||s)&&(t.innerHTML="")},get_visible_range:function(e){var i,a,s=n(r),o=s?s.$getConfig():null;return o&&o.smart_rendering&&(i=s.getViewPort()),s&&i&&("function"==typeof r.renderer?a=ki(t,s,0,e,i):r.renderer&&r.renderer.getVisibleRange&&(a=r.renderer.getVisibleRange(t,s,o,e,i))),a||(a={start:0,end:e.count()}),a},prepare_data:function(e){if(r.renderer&&r.renderer.prepareData)return r.renderer.prepareData(e,t,r)},render_items:function(e,i){i=i||s;var a=document.createDocumentFragment();this.clear(i);var o=null,l=n(r),d=l?l.$getConfig():null;d&&d.smart_rendering&&(o=l.getViewPort());for(var u=0,h=e.length;u<h;u++)this.render_item(e[u],a,o,l,d);i.appendChild(a,i);var _={};e.forEach((function(t){_[t.id]=t}));var g={};if(c){var f={};for(var u in this.rendered)g[u]||(f[u]=this.rendered[u],c.call(t,_[u],this.rendered[u],l))}},update_items:function(e,i){var a=n(r),o=a?a.$getConfig():null;if(a&&a.$getConfig().smart_rendering&&!mi(t)&&this.rendered&&(d||u)){i=i||s;var h=document.createDocumentFragment(),_=null;a&&(_=a.getViewPort());var g={};e.forEach((function(t){g[t.id]=t}));var f={},p={};for(var m in this.rendered)p[m]=!0,f[m]=!0;for(var v={},k=(m=0,e.length);m<k;m++){var y=e[m],b=this.rendered[y.id];p[y.id]=!1,b&&b.parentNode?(u?u(y,_,a,o,t):pi(_,d(y,a,o,t)))?(l&&l.call(t,y,b,a,o,_),this.restore(y,h)):p[y.id]=!0:(v[e[m].id]=!0,this.render_item(e[m],h,_,a,o))}for(var m in p)p[m]&&this.hide(m);if(h.childNodes.length&&i.appendChild(h,i),c){var x={};for(var m in this.rendered)f[m]&&!v[m]||(x[m]=this.rendered[m],c.call(t,g[m],this.rendered[m],a))}}},append:function(t,e,i){this.rendered&&(e?(this.rendered[t.id]&&this.rendered[t.id].parentNode?this.replace_item(t.id,e):i.appendChild(e),this.rendered[t.id]=e):this.rendered[t.id]&&this.remove_item(t.id))},replace_item:function(t,e){var i=this.rendered[t];i&&i.parentNode&&i.parentNode.replaceChild(e,i),this.rendered[t]=e},remove_item:function(t){this.hide(t),delete this.rendered[t]},hide:function(t){var e=this.rendered[t];e&&e.parentNode&&e.parentNode.removeChild(e),delete this.rendered[t]},restore:function(t,e){var i=this.rendered[t.id];i?i.parentNode||this.append(t,i,e||s):this.render_item(t,e||s)},change_id:function(t,e){this.rendered[e]=this.rendered[t],delete this.rendered[t]},rendered:e[a],node:s,destructor:function(){this.clear(),delete i[a],delete e[a]}},i[a]}return{getRenderer:a,clearRenderers:function(){for(var t in i)a(t).destructor()}}}(t);return{createGroup:function(i,n,a,r){var s={tempCollection:[],renderers:{},container:i,filters:[],getLayers:function(){this._add();var t=[];for(var e in this.renderers)t.push(this.renderers[e]);return t},getLayer:function(t){return this.renderers[t]},_add:function(i){i&&(i.id=i.id||tt(),this.tempCollection.push(i));const a=this.container(),s=this.tempCollection;for(let o=0;o<s.length;o++){if(i=s[o],!(this.container()||i&&i.container&&i.container.isConnected))continue;let l=i.container,d=i.id,c=i.topmost;if(!l.parentNode)if(c)a.appendChild(l);else{let t=n?n():a.firstChild;t&&t.parentNode==a?a.insertBefore(l,t):a.appendChild(l)}this.renderers[d]=e.getRenderer(d,i,l),r&&r(i,t),this.tempCollection.splice(o,1),o--}},addLayer:function(e){if(e){"function"==typeof e&&(e={renderer:e}),void 0===e.filter?e.filter=yi(a||[]):e.filter instanceof Array&&(e.filter.push(a),e.filter=yi(e.filter)),e.container||(e.container=document.createElement("div"));var i=this;e.requestUpdate=function(){t.config.smart_rendering&&!mi(t)&&i.renderers[e.id]&&i.onUpdateRequest(i.renderers[e.id])}}return this._add(e),e?e.id:void 0},onUpdateRequest:function(t){},eachLayer:function(t){for(var e in this.renderers)t(this.renderers[e])},removeLayer:function(t){this.renderers[t]&&(this.renderers[t].destructor(),delete this.renderers[t])},clear:function(){for(var t in this.renderers)this.renderers[t].destructor();this.renderers={}}};return t.attachEvent("onDestroy",(function(){s.clear(),s=null})),s}}}(n=t),{getDataRender:function(t){return n.$services.getService("layer:"+t)||null},createDataRender:function(t){var e=t.name,i=t.defaultContainer,r=t.defaultContainerSibling,s=a.createGroup(i,r,(function(t,e){if(!s.filters)return!0;for(var i=0;i<s.filters.length;i++)if(!1===s.filters[i](t,e))return!1}),wi);return n.$services.setService("layer:"+e,(function(){return s})),n.attachEvent("onGanttReady",(function(){s.addLayer()})),s},init:function(){var t=this.createDataRender({name:"task",defaultContainer:function(){return n.$task_data?n.$task_data:n.$ui.getView("timeline")?n.$ui.getView("timeline").$task_data:void 0},defaultContainerSibling:function(){return n.$task_links?n.$task_links:n.$ui.getView("timeline")?n.$ui.getView("timeline").$task_links:void 0},filter:function(t){}},n),e=this.createDataRender({name:"link",defaultContainer:function(){return n.$task_data?n.$task_data:n.$ui.getView("timeline")?n.$ui.getView("timeline").$task_data:void 0}},n);return{addTaskLayer:function(e){const i=ki;return"function"==typeof e?e={renderer:{render:e,getVisibleRange:i}}:e.renderer&&!e.renderer.getVisibleRange&&(e.renderer.getVisibleRange=i),e.view="timeline",t.addLayer(e)},_getTaskLayers:function(){return t.getLayers()},removeTaskLayer:function(e){t.removeLayer(e)},_clearTaskLayers:function(){t.clear()},addLinkLayer:function(t){const i=xi();return"function"==typeof t?t={renderer:{render:t,getVisibleRange:i}}:t.renderer&&!t.renderer.getVisibleRange&&(t.renderer.getVisibleRange=i),t.view="timeline",t&&t.renderer&&(t.renderer.getRectangle||t.renderer.isInViewPort||(t.renderer.isInViewPort=$i)),e.addLayer(t)},_getLinkLayers:function(){return e.getLayers()},removeLinkLayer:function(t){e.removeLayer(t)},_clearLinkLayers:function(){e.clear()}}}}),s=Yi(t);return t.ext.inlineEditors=s,t.ext._inlineEditors=s,s.init(t),{factory:i,mouseEvents:fi.init(t),layersApi:r.init(),render:{gridLine:function(){return function(t){return{render:function(e,i,n,a){for(var r=i.getGridColumns(),s=i.$getTemplates(),o=i.$config.rowStore,l=[],d=0;d<r.length;d++){var c,u,h,_=d==r.length-1,g=r[d];"add"==g.name?(u="<div "+(y=t._waiAria.gridAddButtonAttrString(g))+" class='gantt_add'></div>",h=""):(B(u=g.template?g.template(e):e[g.name])&&(u=s.date_grid(u,e,g.name)),null==u&&(u=""),h=u,u="<div class='gantt_tree_content'>"+u+"</div>");var f="gantt_cell"+(_?" gantt_last_cell":""),p=[];if(g.tree){f+=" gantt_cell_tree";for(var m=0;m<e.$level;m++)p.push(s.grid_indent(e));!o.hasChild(e.id)||t.isSplitTask(e)&&!t.config.open_split_tasks?(p.push(s.grid_blank(e)),p.push(s.grid_file(e))):(p.push(s.grid_open(e)),p.push(s.grid_folder(e)))}var v="width:"+(g.width-(_?1:0))+"px;";if(this.defined(g.align)){var k={right:"flex-end",left:"flex-start",center:"center"}[g.align];v+="text-align:"+g.align+";justify-content:"+k+";"}var y=t._waiAria.gridCellAttrString(g,h,e);p.push(u),c="<div class='"+f+"' data-column-index='"+d+"' data-column-name='"+g.name+"' style='"+v+"' "+y+">"+p.join("")+"</div>",l.push(c)}switch(f="",o.$config.name){case"task":f=t.getGlobalTaskIndex(e.id)%2==0?"":" odd";break;case"resource":f=o.visibleOrder.indexOf(e.id)%2==0?"":" odd"}if(f+=e.$transparent?" gantt_transparent":"",f+=e.$dataprocessor_class?" "+e.$dataprocessor_class:"",s.grid_row_class){var b=s.grid_row_class.call(t,e.start_date,e.end_date,e);b&&(f+=" "+b)}o.isSelected(e.id)&&(f+=" gantt_selected");var x=document.createElement("div");x.className="gantt_row"+f+" gantt_row_"+t.getTaskType(e.type);var $=i.getItemHeight(e.id);return x.style.height=$+"px",x.style.lineHeight=$+"px",n.smart_rendering&&(x.style.position="absolute",x.style.left="0px",x.style.top=i.getItemTop(e.id)+"px"),i.$config.item_attribute&&(x.setAttribute(i.$config.item_attribute,e.id),x.setAttribute(i.$config.bind+"_id",e.id)),t._waiAria.taskRowAttr(e,x),x.innerHTML=l.join(""),x},update:null,getRectangle:vi,isInViewPort:an,getVisibleRange:ki,onrender:function(e,i,n){for(var a=n.getGridColumns(),r=0;r<a.length;r++){var s=a[r];if(s.onrender){var o=i.querySelector(`[data-column-name="${s.name}"]`);if(o){var l=s.onrender(e,o);if(l&&"string"==typeof l)o.innerHTML=l;else if(l&&"object"==typeof l&&t.config.external_render){var d=t.config.external_render;d.isElement(l)&&d.renderElement(l,o)}}}}}}}(t)},taskBg:function(){return function(t){var e={},i={};function n(t,i){return!(!e[t.id][i]||!e[t.id][i].parentNode)}function a(t,i){e[t]&&e[t][i]&&e[t][i].parentNode&&e[t][i].parentNode.removeChild(e[t][i])}function r(t){var e,i=t.$getTemplates();return void 0!==i.task_cell_class?(e=i.task_cell_class,(console.warn||console.log)("gantt.templates.task_cell_class template is deprecated and will be removed soon. Please use gantt.templates.timeline_cell_class instead.")):e=i.timeline_cell_class,e}function s(t){return t.$getTemplates().timeline_cell_content}function o(n,a,r,s,o,l,d,c){var u=n.width[a],h="";if(en(a,n,s,t)){var _=l(r,n.trace_x[a]),g="";if(d&&(g=d(r,n.trace_x[a])),c.static_background){var f=!(!_&&!g);if(!c.static_background_cells||!f)return null}if(e[r.id][a])return i[r.id][a]=a,e[r.id][a];var p=document.createElement("div");return p.style.width=u+"px",h="gantt_task_cell"+(a==o-1?" gantt_last_cell":""),_&&(h+=" "+_),p.className=h,g&&(p.innerHTML=g),p.style.position="absolute",p.style.left=n.left[a]+"px",e[r.id][a]=p,i[r.id][a]=a,p}return null}return{render:function(n,a,l,d){var c=a.$getTemplates(),u=a.getScale(),h=u.count;if(l.static_background&&!l.static_background_cells)return null;var _,g=document.createElement("div"),f=r(a),p=s(a);if(_=d&&l.smart_rendering&&!mi(t)?tn(u,d.x):{start:0,end:h-1},l.show_task_cells){e[n.id]={},i[n.id]={};for(var m=_.start;m<=_.end;m++){var v=o(u,m,n,d,h,f,p,l);v&&g.appendChild(v)}}const k=a.$config.rowStore,y=k.getIndexById(n.id)%2!=0;var b=c.task_row_class(n.start_date,n.end_date,n),x="gantt_task_row"+(y?" odd":"")+(b?" "+b:"");if(k.isSelected(n.id)&&(x+=" gantt_selected"),g.className=x,l.smart_rendering?(g.style.position="absolute",g.style.top=a.getItemTop(n.id)+"px",g.style.width="100%"):g.style.position="relative",g.style.height=a.getItemHeight(n.id)+"px","timeline_placeholder_task"==n.id){var $=0;n.lastTaskId&&($=a.getItemTop(n.lastTaskId)+a.getItemHeight(n.lastTaskId));var w=(n.row_height||a.$task_data.offsetHeight)-$;w<0&&(w=0),l.smart_rendering&&(g.style.top=$+"px"),g.style.height=w+"px"}return a.$config.item_attribute&&(g.setAttribute(a.$config.item_attribute,n.id),g.setAttribute(a.$config.bind+"_id",n.id)),g},update:function(t,l,d,c,u){var h=d.getScale(),_=h.count,g=r(d),f=s(d);if(c.show_task_cells){e[t.id]||(e[t.id]={}),i[t.id]||(i[t.id]={});var p=tn(h,u);for(var m in i[t.id]){var v=i[t.id][m];(Number(v)<p.start||Number(v)>p.end)&&a(t.id,v)}i[t.id]={};for(var k=p.start;k<=p.end;k++){var y=o(h,k,t,u,_,g,f,c);!y&&n(t,k)?a(t.id,k):y&&!y.parentNode&&l.appendChild(y)}}},getRectangle:Qi,getVisibleRange:ki,prepareData:nn}}(t)},taskBar:function(){return Xi(t)},timedProjectBar:function(){return Xi(t)},taskRollupBar:function(){return function(t){const e=Ki(t),i={};function n(t,e,i,n,a){let r=!0;return n.smart_rendering&&(r=Ji(t,e,i)),r}function a(i,n,a,r){const s=t.copy(t.getTask(n.id));if(s.$rendered_at=i.id,!1===t.callEvent("onBeforeRollupTaskDisplay",[s.id,s,i.id]))return;const o=e(s,a);if(!o)return;const l=a.getBarHeight(i.id,n.type==t.config.types.milestone),d=Math.floor((a.getItemHeight(i.id)-l)/2);return o.style.top=r.top+d+"px",o.classList.add("gantt_rollup_child"),o.setAttribute("data-rollup-parent-id",i.id),o}function r(t,e){return t+"_"+e}return{render:function(e,s,o,l){if(!1!==e.rollup&&e.$rollup&&e.$rollup.length){const d=document.createElement("div"),c=t.getTaskPosition(e);return l&&(l.y=0,l.y_end=t.$task_bg.scrollHeight),e.$rollup.forEach((function(u){if(!t.isTaskExists(u))return;const h=t.getTask(u);if(!n(h,l,s,o))return;const _=a(e,h,s,c);_?(i[r(h.id,e.id)]=_,d.appendChild(_)):i[r(h.id,e.id)]=!1})),d}return!1},update:function(e,s,o,l,d){const c=document.createElement("div"),u=t.getTaskPosition(e);d.y=0,d.y_end=t.$task_bg.scrollHeight,e.$rollup.forEach((function(h){const _=t.getTask(h),g=r(_.id,e.id);let f=n(_,d,o,l);if(f!==!!i[g])if(f){const t=a(e,_,o,u);i[g]=t||!1}else i[g]=!1;i[g]&&c.appendChild(i[g]),s.innerHTML="",s.appendChild(c)}))},isInViewPort:Ji,getVisibleRange:ki}}(t)},taskSplitBar:function(){return Zi()},taskConstraints:function(){return Zi()},taskDeadline:function(){return Zi()},taskBaselines:function(){return Zi()},link:function(){return function(t){var e={current_pos:null,dirs:{left:"left",right:"right",up:"up",down:"down"},path:[],clear:function(){this.current_pos=null,this.path=[]},point:function(e){this.current_pos=t.copy(e)},get_lines:function(t){this.clear(),this.point(t[0]);for(var e=1;e<t.length;e++)this.line_to(t[e]);return this.get_path()},line_to:function(e){var i=t.copy(e),n=this.current_pos,a=this._get_line(n,i);this.path.push(a),this.current_pos=i},get_path:function(){return this.path},get_wrapper_sizes:function(t,e,i){var n,a=e.$getConfig().link_wrapper_width,r=t.y-a/2;switch(t.direction){case this.dirs.left:n={top:r,height:a,lineHeight:a,left:t.x-t.size-a/2,width:t.size+a};break;case this.dirs.right:n={top:r,lineHeight:a,height:a,left:t.x-a/2,width:t.size+a};break;case this.dirs.up:n={top:r-t.size,lineHeight:t.size+a,height:t.size+a,left:t.x-a/2,width:a};break;case this.dirs.down:n={top:r,lineHeight:t.size+a,height:t.size+a,left:t.x-a/2,width:a}}return n},get_line_sizes:function(t,e){var i,n=e.$getConfig(),a=n.link_line_width,r=n.link_wrapper_width,s=t.size+a;switch(t.direction){case this.dirs.left:case this.dirs.right:i={height:a,width:s,marginTop:(r-a)/2,marginLeft:(r-a)/2};break;case this.dirs.up:case this.dirs.down:i={height:s,width:a,marginTop:(r-a)/2,marginLeft:(r-a)/2}}return i},render_line:function(t,e,i,n){var a=this.get_wrapper_sizes(t,i,n),r=document.createElement("div");r.style.cssText=["top:"+a.top+"px","left:"+a.left+"px","height:"+a.height+"px","width:"+a.width+"px"].join(";"),r.className="gantt_line_wrapper";var s=this.get_line_sizes(t,i),o=document.createElement("div");return o.style.cssText=["height:"+s.height+"px","width:"+s.width+"px","margin-top:"+s.marginTop+"px","margin-left:"+s.marginLeft+"px"].join(";"),o.className="gantt_link_line_"+t.direction,r.appendChild(o),r},render_corner:function(t,e){const i=t.radius,n=e.$getConfig(),a=n.link_line_width||2,r=document.createElement("div");let s,o;return r.classList.add("gantt_link_corner"),r.classList.add(`gantt_link_corner_${t.direction.from}_${t.direction.to}`),r.style.width=`${i}px`,r.style.height=`${i}px`,"right"===t.direction.from&&"down"===t.direction.to?(s="Right",o="Top",r.style.left=t.x-n.link_line_width/2+"px",r.style.top=`${t.y}px`):"down"===t.direction.from&&"right"===t.direction.to?(s="Left",o="Bottom",r.style.left=t.x-n.link_line_width/2+"px",r.style.top=`${t.y}px`):"right"===t.direction.from&&"up"===t.direction.to?(s="Right",o="Bottom",r.style.left=t.x-n.link_line_width/2+"px",r.style.top=t.y-i+"px"):"up"===t.direction.from&&"right"===t.direction.to?(s="Left",o="Top",r.style.left=t.x-n.link_line_width/2+"px",r.style.top=t.y-i+"px"):"left"===t.direction.from&&"down"===t.direction.to?(s="Left",o="Top",r.style.left=t.x-i-n.link_line_width/2+"px",r.style.top=`${t.y}px`):"down"===t.direction.from&&"left"===t.direction.to?(s="Right",o="Bottom",r.style.left=t.x-i-n.link_line_width/2+"px",r.style.top=`${t.y}px`):"left"===t.direction.from&&"up"===t.direction.to?(s="Left",o="Bottom",r.style.left=t.x-i-n.link_line_width/2+"px",r.style.top=t.y-i+"px"):"up"===t.direction.from&&"left"===t.direction.to&&(s="Right",o="Top",r.style.left=t.x-i-n.link_line_width/2+"px",r.style.top=t.y-i+"px"),r.style[`border${o}Width`]=`${a}px`,r.style[`border${s}Width`]=`${a}px`,r.style[`border${s}Style`]="solid",r.style[`border${o}Style`]="solid",r.style[`border${o}${s}Radius`]=`${i}px`,r},render_arrow(t,e){var i=document.createElement("div"),n=t.y,a=t.x,r=e.link_arrow_size;i.style.setProperty("--dhx-gantt-icon-size",`${r}px`);var s="gantt_link_arrow gantt_link_arrow_"+t.direction;return i.style.top=n+"px",i.style.left=a+"px",i.className=s,i},_get_line:function(t,e){var i=this.get_direction(t,e),n={x:t.x,y:t.y,direction:this.get_direction(t,e)};return i==this.dirs.left||i==this.dirs.right?n.size=Math.abs(t.x-e.x):n.size=Math.abs(t.y-e.y),n},get_direction:function(t,e){return e.x<t.x?this.dirs.left:e.x>t.x?this.dirs.right:e.y>t.y?this.dirs.down:this.dirs.up}},i={path:[],clear:function(){this.path=[]},current:function(){return this.path[this.path.length-1]},point:function(e){return e?(this.path.push(t.copy(e)),e):this.current()},point_to:function(i,n,a){a=a?{x:a.x,y:a.y}:t.copy(this.point());var r=e.dirs;switch(i){case r.left:a.x-=n;break;case r.right:a.x+=n;break;case r.up:a.y-=n;break;case r.down:a.y+=n}return this.point(a)},get_points:function(i,n,a,r){var s=this.get_endpoint(i,n,a,r),o=t.config,l=s.e_y-s.y,d=s.e_x-s.x,c=e.dirs,u=n.getItemHeight(i.source);this.clear(),this.point({x:s.x,y:s.y});var h=2*o.link_arrow_size,_=this.get_line_type(i,n.$getConfig()),g=s.e_x>s.x;if(_.from_start&&_.to_start)this.point_to(c.left,h),g?(this.point_to(c.down,l),this.point_to(c.right,d)):(this.point_to(c.right,d),this.point_to(c.down,l)),this.point_to(c.right,h);else if(!_.from_start&&_.to_start)if(0!==l&&(g=s.e_x>s.x+2*h),this.point_to(c.right,h),g)d-=h,this.point_to(c.down,l),this.point_to(c.right,d);else{d-=2*h;var f=l>0?1:-1;this.point_to(c.down,f*(u/2)),this.point_to(c.right,d),this.point_to(c.down,f*(Math.abs(l)-u/2)),this.point_to(c.right,h)}else _.from_start||_.to_start?_.from_start&&!_.to_start&&(0!==l&&(g=s.e_x>s.x-2*h),this.point_to(c.left,h),g?(d+=2*h,f=l>0?1:-1,this.point_to(c.down,f*(u/2)),this.point_to(c.right,d),this.point_to(c.down,f*(Math.abs(l)-u/2)),this.point_to(c.left,h)):(d+=h,this.point_to(c.down,l),this.point_to(c.right,d))):(this.point_to(c.right,h),g?(this.point_to(c.right,d),this.point_to(c.down,l)):(this.point_to(c.down,l),this.point_to(c.right,d)),this.point_to(c.left,h));return this.path},get_line_type:function(e,i){var n=i.links,a=!1,r=!1;return e.type==n.start_to_start?a=r=!0:e.type==n.finish_to_finish?a=r=!1:e.type==n.finish_to_start?(a=!1,r=!0):e.type==n.start_to_finish?(a=!0,r=!1):t.assert(!1,"Invalid link type"),i.rtl&&(a=!a,r=!r),{from_start:a,to_start:r}},get_endpoint:function(t,e,i,a){var r=e.$getConfig(),s=this.get_line_type(t,r),o=s.from_start,l=s.to_start,d=n(i,e,r),c=n(a,e,r);return{x:o?d.left:d.left+d.width,e_x:l?c.left:c.left+c.width,y:d.top+d.rowHeight/2-1,e_y:c.top+c.rowHeight/2-1}}};function n(e,i,n){var a=i.getItemPosition(e);let r=function(t,e,i){let n=e.$task_data.scrollHeight,a=!1,r=!1;return t.eachParent((function(t){if(le(t)){r=!0;const i=e.getItemPosition(t).rowHeight;i<n&&(n=i,a=!0)}}),i.id),{maxHeight:n,shrinkHeight:a,splitChild:r}}(t,i,e),s=r.maxHeight,o=r.splitChild;const l=t.config.baselines&&("separateRow"==t.config.baselines.render_mode||"individualRow"==t.config.baselines.render_mode)&&e.baselines&&e.baselines.length;let d;r.shrinkHeight&&(a.rowHeight=s);let c=t.getTaskType(e.type)==n.types.milestone;if(c){let t=i.getBarHeight(e.id,!0);d=Math.sqrt(2*t*t),r.shrinkHeight&&s<t&&(t=s,d=s),a.left-=d/2,a.width=d}if(o)if(s>=a.height){const i=function(t,e){let i=!1;return t.eachTask((function(e){i||(i=oe(t,e))}),e),i}(t,e.parent);l||i?c?(a.rowHeight=a.height+4,a.left+=(a.width-a.rowHeight+4)/2,a.width=a.rowHeight-3):a.rowHeight=a.height+6:c&&(a.left+=(d-a.height)/2)}else a.rowHeight=s+2,c&&(a.left+=(a.width-a.rowHeight+4)/2,a.width=a.rowHeight-3);else l&&(a.rowHeight=a.height+4);return a}return{render:function(n,a,r){var s=t.getTask(n.source);if(s.hide_bar)return;var o=t.getTask(n.target);if(o.hide_bar)return;var l=i.get_endpoint(n,a,s,o),d=l.e_y-l.y;if(!(l.e_x-l.x||d))return null;var c=i.get_points(n,a,s,o);const u=function(t,i,n,a){const r=document.createElement("div");return t.forEach((t=>{let s;"line"===t.type?s=e.render_line(t.data,null,i,n.source):"corner"===t.type?s=e.render_corner(t.data,i):"arrow"===t.type&&(s=e.render_arrow(t.data,a)),r.appendChild(s)})),r}(function(t,e){const i=e.link_radius||4,n=e.link_arrow_size||6,a=[];for(let n=0;n<t.length;n++){const r=t[n],s=t[n+1];if(!s||e.link_radius<=1)a.push({type:"line",data:r});else if(r.direction!==s.direction){if(r.size<i||s.size<i){a.push({type:"line",data:r});continue}r.size-=i,a.push({type:"line",data:r});let t=r.x,n=r.y-e.link_line_width/2;switch(r.direction){case"right":t+=r.size;break;case"left":t-=r.size;break;case"down":n+=r.size;break;case"up":n-=r.size}const o={x:t,y:n,direction:{from:r.direction,to:s.direction},radius:i};switch(a.push({type:"corner",data:o}),s.direction){case"right":s.x+=i,s.size-=i;break;case"left":s.x-=i,s.size-=i;break;case"down":s.y+=i,s.size-=i;break;case"up":s.y-=i,s.size-=i}}else a.push({type:"line",data:r})}const r=t[t.length-1];if("right"===r.direction||"left"===r.direction){r.size-=3*n/4;let t="right"===r.direction?r.x+r.size:r.x-r.size-n/2,i=r.y-e.link_line_width/2-n/2+1;"left"===r.direction?(i-=1,t-=2):t-=1;const s={x:t,y:i,size:n,direction:r.direction};a.push({type:"line",data:r}),a.push({type:"arrow",data:s})}else a.push({type:"line",data:r});return a}(e.get_lines(c,a).filter((t=>t.size>0)),r),a,n,r);var h="gantt_task_link";n.color&&(h+=" gantt_link_inline_color");var _=t.templates.link_class?t.templates.link_class(n):"";return _&&(h+=" "+_),r.highlight_critical_path&&t.isCriticalLink&&t.isCriticalLink(n)&&(h+=" gantt_critical_link"),u.className=h,a.$config.link_attribute&&(u.setAttribute(a.$config.link_attribute,n.id),u.setAttribute("link_id",n.id)),n.color&&u.style.setProperty("--dhx-gantt-link-background",n.color),t._waiAria.linkAttr(n,u),u},update:null,isInViewPort:$i,getVisibleRange:xi()}}(t)},resourceRow:function(){return function(t){var e=function(t){let e={};return t.$data.tasksStore.attachEvent("onStoreUpdated",(function(){e={}})),function(i,n,a,r){const s=i.id+"_"+n+"_"+a.unit+"_"+a.step;let o;return o=e[s]?e[s]:e[s]=function(e,i,n,a){let r,s=!1,o={};t.config.process_resource_assignments&&i===t.config.resource_property?(r="task"==e.$role?t.getResourceAssignments(e.$resource_id,e.$task_id):t.getResourceAssignments(e.id),s=!0):r="task"==e.$role?[]:t.getTaskBy(i,e.id),o=function(e,i,n){const a=i.unit,r=i.step,s={},o={};for(let l=0;l<e.length;l++){const d=e[l];let c=d;if(n&&(c=t.getTask(d.task_id)),c.unscheduled)continue;let u=d.start_date||c.start_date,h=d.end_date||c.end_date;n&&(d.start_date&&(u=new Date(Math.max(d.start_date.valueOf(),c.start_date.valueOf()))),d.end_date&&(h=new Date(Math.min(d.end_date.valueOf(),c.end_date.valueOf()))),d.mode&&"fixedDates"==d.mode&&(u=d.start_date,h=d.end_date));let _=V(i.trace_x,u.valueOf()),g=new Date(i.trace_x[_]||t.date[a+"_start"](new Date(u))),f=new Date(Math.min(u.valueOf(),g.valueOf())),p=t.config.work_time?t.getTaskCalendar(c):t;for(o[p.id]={};f<h;){const e=o[p.id],i=f.valueOf();f=t.date.add(f,r,a),!1!==e[i]&&(s[i]||(s[i]={tasks:[],assignments:[]}),s[i].tasks.push(c),n&&s[i].assignments.push(d))}}return s}(r,n,s);const l=n.unit,d=n.step,c=[];let u,h,_,g,f;const p=a.$getConfig();for(let e=0;e<n.trace_x.length;e++)u=new Date(n.trace_x[e]),h=t.date.add(u,d,l),f=o[u.valueOf()]||{},_=f.tasks||[],g=f.assignments||[],_.length||p.resource_render_empty_cells?c.push({start_date:u,end_date:h,tasks:_,assignments:g}):c.push(null);return c}(i,n,a,r),o}}(t),i={};function n(t,e,i,n,a){var r=i.resource_cell_class(e.start_date,e.end_date,t,e.tasks,e.assignments),s=i.resource_cell_value(e.start_date,e.end_date,t,e.tasks,e.assignments),o=a.getItemHeight(t.id)-1;if(r||s){var l=a.getItemPosition(t,e.start_date,e.end_date),d=document.createElement("div");return d.setAttribute(a.$config.item_attribute,t.id),d.className=["gantt_resource_marker",r].join(" "),d.style.cssText=["left:"+l.left+"px","width:"+l.width+"px","height:"+o+"px","line-height:"+o+"px","top:"+l.top+"px"].join(";"),s&&(d.innerHTML=s),d}return null}function a(t,e){i[t]&&i[t][e]&&i[t][e].parentNode&&i[t][e].parentNode.removeChild(i[t][e])}return{render:function(a,r,s,o){var l=r.$getTemplates(),d=r.getScale(),c=e(a,s.resource_property,r.getScale(),r),u=!!o,h=[];i[a.id]={};for(var _=tn(d,o),g=_.start;g<=_.end;g++){var f=c[g];if(f&&(!u||en(g,d,o,t))){var p=n(a,f,l,0,r);p&&(h.push(p),i[a.id][g]=p)}}var m=null;if(h.length){m=document.createElement("div");for(var v=0;v<h.length;v++)m.appendChild(h[v])}return m},update:function(r,s,o,l,d){var c=o.$getTemplates(),u=o.getScale(),h=e(r,l.resource_property,o.getScale(),o),_=tn(u,d),g={};if(i&&i[r.id])for(var f in i[r.id])g[f]=f;for(var p=_.start;p<=_.end;p++){var m=h[p];if(g[p]=!1,m)if(en(p,u,d,t))if(i[r.id]&&i[r.id][p])i[r.id]&&i[r.id][p]&&!i[r.id][p].parentNode&&s.appendChild(i[r.id][p]);else{var v=n(r,m,c,0,o);v&&(s.appendChild(v),i[r.id][p]=v)}else a(r.id,p)}for(var f in g)!1!==g[f]&&a(r.id,f)},getRectangle:Qi,getVisibleRange:ki}}(t)},resourceHistogram:function(){return Zi()},gridTaskRowResizer:function(){return function(t){return{render:function(e,i,n){var a=i.$getConfig(),r=document.createElement("div");return r.className="gantt_task_grid_row_resize_wrap",r.style.top=i.getItemTop(e.id)+i.getItemHeight(e.id)+"px",r.innerHTML="<div class='gantt_task_grid_row_resize' role='cell'></div>",r.setAttribute(a.task_grid_row_resizer_attribute,e.id),t._waiAria.rowResizerAttr(r),r},update:null,getRectangle:vi,getVisibleRange:ki}}(t)}},layersService:{getDataRender:function(e){return r.getDataRender(e,t)},createDataRender:function(e){return r.createDataRender(e,t)}}}};function xn(t,e){const i=getComputedStyle(e.$root).getPropertyValue("--dhx-gantt-theme");let n,a=!!i;if(a)n=i;else{var r=e.skin;if(n=r,!r||t)for(var s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var l=s[o].href.match("dhtmlxgantt_([a-z_]+).css");if(l&&(e.skins[l[1]]||!r)){n=l[1];break}}}e._theme_info={theme:n,cssVarTheme:a},e.skin=n||"terrace";var d=e.skins[e.skin]||e.skins.terrace;(function(t,e,i){for(var n in e)(void 0===t[n]||i)&&(t[n]=e[n])})(e.config,d.config,t),a||(e.config.link_radius=1);var c=e.getGridColumns();for(c[1]&&!e.defined(c[1].width)&&(c[1].width=d._second_column_width),c[2]&&!e.defined(c[2].width)&&(c[2].width=d._third_column_width),o=0;o<c.length;o++){var u=c[o];"add"==u.name&&(u.width||(u.width=44),e.defined(u.min_width)&&e.defined(u.max_width)||(u.min_width=u.min_width||u.width,u.max_width=u.max_width||u.width),u.min_width&&(u.min_width=+u.min_width),u.max_width&&(u.max_width=+u.max_width),u.width&&(u.width=+u.width,u.width=u.min_width&&u.min_width>u.width?u.min_width:u.width,u.width=u.max_width&&u.max_width<u.width?u.max_width:u.width))}d.config.task_height&&(e.config.task_height=d.config.task_height||"full"),d.config.bar_height&&(e.config.bar_height=d.config.bar_height||"full"),d._lightbox_template&&(e._lightbox_template=d._lightbox_template),d._redefine_lightbox_buttons&&(e.config.buttons_right=d._redefine_lightbox_buttons.buttons_right,e.config.buttons_left=d._redefine_lightbox_buttons.buttons_left),e.resetLightbox()}function $n(t){var i=null,n=!1,a=null,r={started:!1},s={};function o(e){return e&&x(e,t.$root)&&e.offsetHeight}function l(){var e=!!document.querySelector(".gantt_drag_marker"),i=!!document.querySelector(".gantt_drag_marker.gantt_grid_resize_area")||!!document.querySelector(".gantt_drag_marker.gantt_row_grid_resize_area"),a=!!document.querySelector(".gantt_link_direction"),r=t.getState(),s=r.autoscroll;return n=e&&!i&&!a,!(!r.drag_mode&&!e||i)||s}function d(e){if(a&&(clearTimeout(a),a=null),e){var n=t.config.autoscroll_speed;n&&n<10&&(n=10),a=setTimeout((function(){i=setInterval(h,n||50)}),t.config.autoscroll_delay||10)}}function c(t){t?(d(!0),r.started||(r.x=s.x,r.y=s.y,r.started=!0)):(i&&(clearInterval(i),i=null),d(!1),r.started=!1)}function u(e){var n=l();if(!i&&!a||n||c(!1),!t.config.autoscroll||!n)return!1;s={x:e.clientX,y:e.clientY},"touchmove"==e.type&&(s.x=e.targetTouches[0].clientX,s.y=e.targetTouches[0].clientY),!i&&n&&c(!0)}function h(){if(!l())return c(!1),!1;var i,a,d,u,h,g=o(t.$task)?t.$task:o(t.$grid)?t.$grid:t.$root;if(g){var f=!1;[".gantt_drag_marker.gantt_grid_resize_area",".gantt_drag_marker .gantt_row.gantt_row_task",".gantt_drag_marker.gantt_grid_dnd_marker"].forEach((function(t){f=f||!!document.querySelector(t)})),f&&(g=t.$grid);var p=e(g),m=s.x-p.x,v=s.y-p.y+window.scrollY,k=n?0:_(m,p.width,r.x-p.x),y=_(v,p.height,r.y-p.y+window.scrollY),b=t.getScrollState(),x=b.y,$=b.inner_height,w=b.height,S=b.x,T=b.inner_width,E=b.width;(y&&!$||y<0&&!x||y>0&&x+$>=w+2)&&(y=0),(k&&!T||k<0&&!S||k>0&&S+T>=E)&&(k=0);var C=t.config.autoscroll_step;C&&C<2&&(C=2),y*=C||30,((k*=C||30)||y)&&(i=k,a=y,d=t.getScrollState(),u=null,h=null,i&&(u=d.x+i,u=Math.min(d.width,u),u=Math.max(0,u)),a&&(h=d.y+a,h=Math.min(d.height,h),h=Math.max(0,h)),t.scrollTo(u,h))}}function _(t,e,i){return t-50<0&&t<i?-1:t>e-50&&t>i?1:0}t.attachEvent("onGanttReady",(function(){if(!It(t)){var e=E(t.$root)||document.body;t.eventRemove(e,"mousemove",u),t.event(e,"mousemove",u),t.eventRemove(e,"touchmove",u),t.event(e,"touchmove",u),t.eventRemove(e,"pointermove",u),t.event(e,"pointermove",u)}})),t.attachEvent("onDestroy",(function(){c(!1)}))}var wn,Sn;typeof window<"u"&&window.jQuery&&(wn=window.jQuery,Sn=[],wn.fn.dhx_gantt=function(t){if("string"!=typeof(t=t||{})){var e=[];return this.each((function(){if(this&&this.getAttribute)if(this.gantt||window.gantt.$root==this)e.push("object"==typeof this.gantt?this.gantt:window.gantt);else{var i=window.gantt.$container&&window.Gantt?window.Gantt.getGanttInstance():window.gantt;for(var n in t)"data"!=n&&(i.config[n]=t[n]);i.init(this),t.data&&i.parse(t.data),e.push(i)}})),1===e.length?e[0]:e}if(Sn[t])return Sn[t].apply(this,[]);wn.error("Method "+t+" does not exist on jQuery.dhx_gantt")}),typeof window<"u"&&window.dhtmlx&&(window.dhtmlx.attaches||(window.dhtmlx.attaches={}),window.dhtmlx.attaches.attachGantt=function(t,e,i){var n=document.createElement("DIV");i=i||window.gantt,n.id="gantt_"+i.uid(),n.style.width="100%",n.style.height="100%",n.cmp="grid",document.body.appendChild(n),this.attachObject(n.id),this.dataType="gantt",this.dataObj=i;var a=this.vs[this.av];return a.grid=i,i.init(n.id,t,e),n.firstChild.style.border="none",a.gridId=n.id,a.gridObj=n,this.vs[this._viewRestore()].grid}),typeof window<"u"&&void 0!==window.dhtmlXCellObject&&(window.dhtmlXCellObject.prototype.attachGantt=function(t,e,i){i=i||window.gantt;var n=document.createElement("DIV");return n.id="gantt_"+i.uid(),n.style.width="100%",n.style.height="100%",n.cmp="grid",document.body.appendChild(n),this.attachObject(n.id),this.dataType="gantt",this.dataObj=i,i.init(n.id,t,e),n.firstChild.style.border="none",n=null,this.callEvent("_onContentAttach",[]),this.dataObj});const Tn=["ctrlKey","altKey","shiftKey","metaKey"],En=[[{unit:"month",date:"%M",step:1},{unit:"day",date:"%d",step:1}],[{unit:"day",date:"%d %M",step:1}],[{unit:"day",date:"%d %M",step:1},{unit:"hour",date:"%H:00",step:8}],[{unit:"day",date:"%d %M",step:1},{unit:"hour",date:"%H:00",step:1}]];class Cn{constructor(t){this.zoomIn=()=>{const t=this.getCurrentLevel()-1;t<0||this.setLevel(t)},this.zoomOut=()=>{const t=this.getCurrentLevel()+1;t>this._levels.length-1||this.setLevel(t)},this.getCurrentLevel=()=>this._activeLevelIndex,this.getLevels=()=>this._levels,this.setLevel=t=>{const e=this._getZoomIndexByName(t);-1===e&&this.$gantt.assert(-1!==e,"Invalid zoom level for gantt.ext.zoom.setLevel. "+t+" is not an expected value."),this._setLevel(e,0)},this._getZoomIndexByName=t=>{let e=-1;if("string"==typeof t){if(!isNaN(Number(t))&&this._levels[Number(t)])e=Number(t);else for(let i=0;i<this._levels.length;i++)if(this._levels[i].name===t){e=i;break}}else e=t;return e},this._getVisibleDate=()=>{if(!this.$gantt.$task)return null;const t=this.$gantt.getScrollState().x,e=this.$gantt.$task.offsetWidth;this._visibleDate=this.$gantt.dateFromPos(t+e/2)},this._setLevel=(t,e)=>{this._activeLevelIndex=t;const i=this.$gantt,n=i.copy(this._levels[this._activeLevelIndex]),a=i.copy(n);if(delete a.name,i.mixin(i.config,a,!0),["resourceTimeline","resourceHistogram"].forEach((function(t){const e=i.$ui.getView(t);if(e){const t=e.$getConfig();t.fixed_scales||i.mixin(t,a,!0)}})),i.$root&&i.$task){if(e){const t=this.$gantt.dateFromPos(e+this.$gantt.getScrollState().x);this.$gantt.render();const i=this.$gantt.posFromDate(t);this.$gantt.scrollTo(i-e)}else{const t=this.$gantt.$task.offsetWidth;this._visibleDate||this._getVisibleDate();const e=this._visibleDate;this.$gantt.render();const i=this.$gantt.posFromDate(e);this.$gantt.scrollTo(i-t/2)}this.callEvent("onAfterZoom",[this._activeLevelIndex,n])}},this._attachWheelEvent=t=>{const e=pt.isFF?"wheel":"mousewheel";let i;i="function"==typeof t.element?t.element():t.element,i&&this._domEvents.attach(i,e,this.$gantt.bind((function(t){return!(this._useKey&&(Tn.indexOf(this._useKey)<0||!t[this._useKey]))&&("function"==typeof this._handler?(this._handler.apply(this,[t]),!0):void 0)}),this),{passive:!1})},this._defaultHandler=t=>{const e=this.$gantt.$task.getBoundingClientRect().x,i=t.clientX-e;let n=!1;(this.$gantt.env.isFF?-40*t.deltaY:t.wheelDelta)>0&&(n=!0),t.preventDefault(),t.stopPropagation(),this._setScaleSettings(n,i)},this._setScaleDates=()=>{this._initialStartDate&&this._initialEndDate&&(this.$gantt.config.start_date=this._initialStartDate,this.$gantt.config.end_date=this._initialEndDate)},this.$gantt=t,this._domEvents=this.$gantt._createDomEventScope()}init(t){this.$gantt.env.isNode||(this._initialStartDate=t.startDate,this._initialEndDate=t.endDate,this._activeLevelIndex=t.activeLevelIndex?t.activeLevelIndex:0,this._levels=this._mapScales(t.levels||En),this._handler=t.handler||this._defaultHandler,this._minColumnWidth=t.minColumnWidth||60,this._maxColumnWidth=t.maxColumnWidth||240,this._widthStep=t.widthStep||3/8*t.minColumnWidth,this._useKey=t.useKey,this._initialized||(M(this),this.$gantt.attachEvent("onGanttScroll",(()=>{this._getVisibleDate()}))),this._domEvents.detachAll(),"wheel"===t.trigger&&(this.$gantt.$root?this._attachWheelEvent(t):this.$gantt.attachEvent("onGanttLayoutReady",(()=>{this.$gantt.attachEvent("onGanttRender",(()=>{this._attachWheelEvent(t)}),{once:!0})}))),this._initialized=!0,this.setLevel(this._activeLevelIndex))}_mapScales(t){return t.map((t=>Array.isArray(t)?{scales:t}:t))}_setScaleSettings(t,e){t?this._stepUp(e):this._stepDown(e)}_stepUp(t){if(this._activeLevelIndex>=this._levels.length-1)return;let e=this._activeLevelIndex;if(this._setScaleDates(),this._widthStep){let t=this.$gantt.config.min_column_width+this._widthStep;t>this._maxColumnWidth&&(t=this._minColumnWidth,e++),this.$gantt.config.min_column_width=t}else e++;this._setLevel(e,t)}_stepDown(t){if(this._activeLevelIndex<1)return;let e=this._activeLevelIndex;if(this._setScaleDates(),this._widthStep){let t=this.$gantt.config.min_column_width-this._widthStep;t<this._minColumnWidth&&(t=this._maxColumnWidth,e--),this.$gantt.config.min_column_width=t}else e--;this._setLevel(e,t)}}function Dn(){console.log("Method is not implemented.")}function An(){}function In(t){return An}An.prototype.render=Dn,An.prototype.set_value=Dn,An.prototype.get_value=Dn,An.prototype.focus=Dn;var Mn={getHtmlSelect:function(t,e,i){var n="",a=this;return P(t=t||[],(function(t){var e=[{key:"value",value:t.key}];i==t.key&&(e[e.length]={key:"selected",value:"selected"}),t.attributes&&(e=e.concat(t.attributes)),n+=a.getHtmlOption({innerHTML:t.label},e)})),Nn("select",{innerHTML:n},e)},getHtmlOption:function(t,e){return Nn("option",t,e)},getHtmlButton:function(t,e){return Nn("button",t,e)},getHtmlDiv:function(t,e){return Nn("div",t,e)},getHtmlLabel:function(t,e){return Nn("label",t,e)},getHtmlInput:function(t){return"<input"+Ln(t||[])+">"}};function Nn(t,e,i){return e=e||[],"<"+t+Ln(i||[])+">"+(e.innerHTML||"")+"</"+t+">"}function Ln(t){var e="";return P(t,(function(t){e+=" "+t.key+"='"+t.value+"'"})),e}function Pn(t){const e=In();function i(){return e.apply(this,arguments)||this}return Ti(i,e),i.prototype.render=function(t){const e=t.height?`height:${t.height}px;`:"";let i=`<div class='gantt_cal_ltext gantt_section_${t.name}' ${e?`style='${e}'`:""}>`;return i+=Mn.getHtmlSelect(t.options,[{key:"style",value:"width:100%;"},{key:"title",value:t.name}]),i+="</div>",i},i.prototype.set_value=function(t,e,i,n){var a=t.firstChild;!a._dhx_onchange&&n.onchange&&(a.onchange=n.onchange,a._dhx_onchange=!0),void 0===e&&(e=(a.options[0]||{}).value),a.value=e||""},i.prototype.get_value=function(t){return t.firstChild.value},i.prototype.focus=function(e){var i=e.firstChild;t._focus(i,!0)},i}function Rn(t){var e=function(){const t=In();function e(){return t.apply(this,arguments)||this}return Ti(e,t),e.prototype.render=function(t){let e=t.height?`${t.height}px`:"";return`<div class='gantt_cal_ltext gantt_cal_template gantt_section_${t.name}' ${e?`style='height:${e};'`:""}></div>`},e.prototype.set_value=function(t,e){t.innerHTML=e||""},e.prototype.get_value=function(t){return t.innerHTML||""},e.prototype.focus=function(){},e}(),i=function(t){const e=In();function i(){return e.apply(this,arguments)||this}return Ti(i,e),i.prototype.render=function(t){const e=(t.height||"130")+"px",i=t.placeholder?`placeholder='${t.placeholder}'`:"";return`<div class='gantt_cal_ltext gantt_section_${t.name}' style='height:${e};' ${i}><textarea></textarea></div>`},i.prototype.set_value=function(e,i){t.form_blocks.textarea._get_input(e).value=i||""},i.prototype.get_value=function(e){return t.form_blocks.textarea._get_input(e).value},i.prototype.focus=function(e){var i=t.form_blocks.textarea._get_input(e);t._focus(i,!0)},i.prototype._get_input=function(t){return t.querySelector("textarea")},i}(t),n=function(t){const e=In();function i(){return e.apply(this,arguments)||this}return Ti(i,e),i.prototype.render=function(e){var i=t.form_blocks.getTimePicker.call(this,e);let n="gantt_section_time";"time"!==e.name&&(n+=" gantt_section_"+e.name);var a="<div style='padding-top:0px;font-size:inherit;text-align:center;' class='"+n+"'>";return a+=i,e.single_date?(i=t.form_blocks.getTimePicker.call(this,e,!0),a+="<span></span>"):a+="<span class='gantt_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>",(a+=i)+"</div>"},i.prototype.set_value=function(e,i,n,a){var r=a,s=e.getElementsByTagName("select"),o=a._time_format_order;if(r.auto_end_date)for(var l=function(){u=new Date(s[o[2]].value,s[o[1]].value,s[o[0]].value,0,0),h=t.calculateEndDate({start_date:u,duration:1,task:n}),t.form_blocks._fill_lightbox_select(s,o.size,h,o,r)},d=0;d<4;d++)s[d].onchange=l;var c=t._resolve_default_mapping(a);"string"==typeof c&&(c={start_date:c});var u=n[c.start_date]||new Date,h=n[c.end_date]||t.calculateEndDate({start_date:u,duration:1,task:n});t.form_blocks._fill_lightbox_select(s,0,u,o,r),t.form_blocks._fill_lightbox_select(s,o.size,h,o,r)},i.prototype.get_value=function(e,i,n){var a,r,s,o,l,d=e.getElementsByTagName("select"),c=n._time_format_order;return a=t.form_blocks.getTimePickerValue(d,n),"string"==typeof t._resolve_default_mapping(n)?a:{start_date:a,end_date:(r=d,s=c,o=a,l=t.form_blocks.getTimePickerValue(r,n,s.size),l<=o&&(!1!==n.autofix_end||n.single_date)?t.date.add(o,t._get_timepicker_step(),"minute"):l)}},i.prototype.focus=function(e){t._focus(e.getElementsByTagName("select")[0])},i}(t),a=Pn(t),r=function(t){var e=In();function i(){return e.apply(this,arguments)||this}return Ti(i,e),i.prototype.render=function(t){const e=t.height?`height:${t.height}px;`:"";let i=`<div class='gantt_cal_ltext gantt_cal_lcheckbox gantt_section_${t.name}' ${e?`style='${e}'`:""}>`;if(t.options&&t.options.length)for(var n=0;n<t.options.length;n++)i+="<label><input type='checkbox' value='"+t.options[n].key+"' name='"+t.name+"'>"+t.options[n].label+"</label>";else t.single_value=!0,i+="<label><input type='checkbox' name='"+t.name+"'></label>";return i+="</div>",i},i.prototype.set_value=function(t,e,i,n){var a=Array.prototype.slice.call(t.querySelectorAll("input[type=checkbox]"));!t._dhx_onchange&&n.onchange&&(t.onchange=n.onchange,t._dhx_onchange=!0),n.single_value?a[0].checked=!!e:P(a,(function(t){t.checked=!!e&&e.indexOf(t.value)>=0}))},i.prototype.get_value=function(t,e,i){return i.single_value?t.querySelector("input[type=checkbox]").checked:function(t,e){if(t.map)return t.map(e);for(var i=t.slice(),n=[],a=0;a<i.length;a++)n.push(e(i[a]));return n}(Array.prototype.slice.call(t.querySelectorAll("input[type=checkbox]:checked")),(function(t){return t.value}))},i.prototype.focus=function(e){t._focus(e.querySelector("input[type=checkbox]"))},i}(t),s=function(t){const e=In();function i(){return e.apply(this,arguments)||this}return Ti(i,e),i.prototype.render=function(t){const e=t.height?`${t.height}px`:"";let i=`<div class='gantt_cal_ltext gantt_cal_lradio gantt_section_${t.name}' ${e?`style='height:${e};'`:""}>`;if(t.options&&t.options.length)for(var n=0;n<t.options.length;n++)i+="<label><input type='radio' value='"+t.options[n].key+"' name='"+t.name+"'>"+t.options[n].label+"</label>";return i+="</div>",i},i.prototype.set_value=function(t,e,i,n){var a;n.options&&n.options.length&&(a=t.querySelector("input[type=radio][value='"+e+"']")||t.querySelector("input[type=radio][value='"+n.default_value+"']"))&&(!t._dhx_onchange&&n.onchange&&(t.onchange=n.onchange,t._dhx_onchange=!0),a.checked=!0)},i.prototype.get_value=function(t,e){var i=t.querySelector("input[type=radio]:checked");return i?i.value:""},i.prototype.focus=function(e){t._focus(e.querySelector("input[type=radio]"))},i}(t),o=function(t){var e=In();function i(){return e.apply(this,arguments)||this}function n(t){return t.formatter||new ie}function a(e,i){var n=e.getElementsByTagName("select"),a=i._time_format_order,r=0,s=0;if(t.defined(a[3])){var o=n[a[3]],l=parseInt(o.value,10);isNaN(l)&&o.hasAttribute("data-value")&&(l=parseInt(o.getAttribute("data-value"),10)),r=Math.floor(l/60),s=l%60}return new Date(n[a[2]].value,n[a[1]].value,n[a[0]].value,r,s)}function r(t,e){var i=t.getElementsByTagName("input")[1];return(i=n(e).parse(i.value))&&!window.isNaN(i)||(i=1),i<0&&(i*=-1),i}return Ti(i,e),i.prototype.render=function(e){var i="<div class='gantt_time_selects'>"+t.form_blocks.getTimePicker.call(this,e)+"</div>",n=" "+t.locale.labels[t.config.duration_unit+"s"]+" ",a=e.single_date?" style='display:none'":"",r=e.readonly?" disabled='disabled'":"",s=t._waiAria.lightboxDurationInputAttrString(e),o="gantt_duration_value";e.formatter&&(n="",o+=" gantt_duration_value_formatted");var l="<div class='gantt_duration' "+a+"><div class='gantt_duration_inputs'><input type='button' class='gantt_duration_dec' value='−'"+r+"><input type='text' value='5days' class='"+o+"'"+r+" "+s+"><input type='button' class='gantt_duration_inc' value='+'"+r+"></div><div class='gantt_duration_end_date'>"+n+"<span></span></div></div></div>";let d="gantt_section_time gantt_section_duration";return"time"!==e.name&&(d+=" gantt_section_"+e.name),"<div style='padding-top:0px;font-size:inherit;' class='"+d+"'>"+i+" "+l+"</div>"},i.prototype.set_value=function(e,i,s,o){var l,d,c,u,h=e.getElementsByTagName("select"),_=e.getElementsByTagName("input"),g=_[1],f=[_[0],_[2]],p=e.getElementsByTagName("span")[0],m=o._time_format_order;function v(){var i=a.call(t,e,o),n=r.call(t,e,o),l=t.calculateEndDate({start_date:i,duration:n,task:s}),d=t.templates.task_end_date||t.templates.task_date;p.innerHTML=d(l)}function k(t){var e=g.value;e=n(o).parse(e),window.isNaN(e)&&(e=0),(e+=t)<1&&(e=1),g.value=n(o).format(e),v()}f[0].onclick=t.bind((function(){k(-1*t.config.duration_step)}),this),f[1].onclick=t.bind((function(){k(1*t.config.duration_step)}),this),h[0].onchange=v,h[1].onchange=v,h[2].onchange=v,h[3]&&(h[3].onchange=v),g.onkeydown=t.bind((function(e){var i;return(i=(e=e||window.event).charCode||e.keyCode||e.which)==t.constants.KEY_CODES.DOWN?(k(-1*t.config.duration_step),!1):i==t.constants.KEY_CODES.UP?(k(1*t.config.duration_step),!1):void window.setTimeout(v,1)}),this),g.onchange=t.bind(v,this),"string"==typeof(l=t._resolve_default_mapping(o))&&(l={start_date:l}),d=s[l.start_date]||new Date,c=s[l.end_date]||t.calculateEndDate({start_date:d,duration:1,task:s}),u=Math.round(s[l.duration])||t.calculateDuration({start_date:d,end_date:c,task:s}),u=n(o).format(u),t.form_blocks._fill_lightbox_select(h,0,d,m,o),g.value=u,v()},i.prototype.get_value=function(e,i,n){var s=a(e,n),o=r(e,n),l=t.calculateEndDate({start_date:s,duration:o,task:i});return"string"==typeof t._resolve_default_mapping(n)?s:{start_date:s,end_date:l,duration:o}},i.prototype.focus=function(e){t._focus(e.getElementsByTagName("select")[0])},i}(t),d=function(t){var e=Pn(t);function i(){return e.apply(this,arguments)||this}function n(e,i){var n=[],a=[];i&&(n=t.getTaskByTime(),e.allow_root&&n.unshift({id:t.config.root_id,text:e.root_label||""}),n=function(e,i,n){var a=i.filter||function(){return!0};e=e.slice(0);for(var r=0;r<e.length;r++){var s=e[r];(s.id==n||t.isChildOf(s.id,n)||!1===a(s.id,s))&&(e.splice(r,1),r--)}return e}(n,e,i),e.sort&&n.sort(e.sort));for(var r=e.template||t.templates.task_text,s=0;s<n.length;s++){var o=r.apply(t,[n[s].start_date,n[s].end_date,n[s]]);void 0===o&&(o=""),a.push({key:n[s].id,label:o})}return e.options=a,e.map_to=e.map_to||"parent",t.form_blocks.select.render.apply(this,arguments)}return Ti(i,e),i.prototype.render=function(t){return n(t,!1)},i.prototype.set_value=function(e,i,a,r){0===i&&(i="0"),!a.id&&t.getState().lightbox&&(a.id=t.getLightboxValues().id);var s=document.createElement("div");s.innerHTML=n(r,a.id);var o=s.removeChild(s.firstChild);return e.onselect=null,e.parentNode.replaceChild(o,e),t.form_blocks.select.set_value.apply(t,[o,i,a,r])},i}(t),c=Pn(t),u=function(t){var e=In();function i(){return e.apply(this,arguments)||this}function n(e){return!e||e===t.config.constraint_types.ASAP||e===t.config.constraint_types.ALAP}function a(t,e){for(var i=n(e),a=0;a<t.length;a++)t[a].disabled=i}return Ti(i,e),i.prototype.render=function(e){const i=e.height?`height:${e.height}px;`:"";let n=`<div class='gantt_cal_ltext gantt_section_${e.name}' ${i?`style='${i}'`:""}>`;var a=[];for(var r in t.config.constraint_types)a.push({key:t.config.constraint_types[r],label:t.locale.labels[t.config.constraint_types[r]]});return e.options=e.options||a,n+="<span data-constraint-type-select>"+Mn.getHtmlSelect(e.options,[{key:"data-type",value:"constraint-type"}])+"</span>",n+="<label data-constraint-time-select>"+(t.locale.labels.constraint_date||"Constraint date")+": "+t.form_blocks.getTimePicker.call(this,e)+"</label>",n+="</div>",n},i.prototype.set_value=function(e,i,n,r){var s=e.querySelector("[data-constraint-type-select] select"),o=e.querySelectorAll("[data-constraint-time-select] select"),l=r._time_format_order,d=t._resolve_default_mapping(r);s._eventsInitialized||(s.addEventListener("change",(function(t){a(o,t.target.value)})),s._eventsInitialized=!0);var c=n[d.constraint_date]||new Date;t.form_blocks._fill_lightbox_select(o,0,c,l,r);var u=n[d.constraint_type]||t.getConstraintType(n);s.value=u,a(o,u)},i.prototype.get_value=function(e,i,a){var r=e.querySelector("[data-constraint-type-select] select"),s=e.querySelectorAll("[data-constraint-time-select] select"),o=r.value,l=null;return n(o)||(l=t.form_blocks.getTimePickerValue(s,a)),{constraint_type:o,constraint_date:l}},i.prototype.focus=function(e){t._focus(e.querySelector("select"))},i}(t),h=function(t){const e=Pn(t);function i(){return e.apply(this,arguments)||this}return Ti(i,e),i.prototype.render=function(i){var n=t.config.types,a=t.locale.labels,r=[],s=i.filter||function(t,e){return!n.placeholder||e!==n.placeholder};for(var o in n)0==!s(o,n[o])&&r.push({key:n[o],label:a["type_"+o]});i.options=r;var l=i.onchange;return i.onchange=function(){t._lightbox_current_type=this.value,t.changeLightboxType(this.value),"function"==typeof l&&l.apply(this,arguments)},e.prototype.render.apply(this,arguments)},i}(t),_=function(t){var e=In();function i(){return e.apply(this,arguments)||this}function n(t){return t.formatter||new ie}function a(e,i,a,o){const l="<div class='gantt_time_selects'>"+t.form_blocks.getTimePicker.call(t,o)+"</div>";let d=" "+t.locale.labels[t.config.duration_unit+"s"]+" ";const c=o.single_date?" style='display:none'":"",u=o.readonly?" disabled='disabled'":"",h=t._waiAria.lightboxDurationInputAttrString(o),_=t.locale.labels.baselines_remove_button;let g="gantt_duration_value";o.formatter&&(d="",g+=" gantt_duration_value_formatted");const f="<div class='gantt_duration' "+c+"><div class='gantt_duration_inputs'><input type='button' class='gantt_duration_dec' value='−'"+u+"><input type='text' value='5days' class='"+g+"'"+u+" "+h+"><input type='button' class='gantt_duration_inc' value='+'"+u+"></div><div class='gantt_duration_end_date'>"+d+"<span></span></div></div></div>",p=`<div><div class='baseline_delete_button gantt_custom_button'>${_}</div></div>`,m=document.createElement("div");m.className="gantt_section_time gantt_section_duration",m.setAttribute("data-baseline-id",i.id),m.innerHTML=l+f+p+"<br>",e.appendChild(m);var v,k,y,b=m.getElementsByTagName("select"),x=m.getElementsByTagName("input"),$=x[1],w=[x[0],x[2]],S=m.getElementsByTagName("span")[0],T=o._time_format_order;function E(){var e=r.call(t,m,o),i=s.call(t,m,o),n=t.calculateEndDate({start_date:e,duration:i,task:a}),l=t.templates.task_end_date||t.templates.task_date;S.innerHTML=l(n)}function C(t){var e=$.value;e=n(o).parse(e),window.isNaN(e)&&(e=0),(e+=t)<1&&(e=1),$.value=n(o).format(e),E()}m.querySelector(".baseline_delete_button").onclick=function(e){const i=m.parentNode;m.innerHTML="",m.remove(),""===i.innerHTML&&(i.innerHTML=t.locale.labels.baselines_section_placeholder)},w[0].onclick=t.bind((function(){C(-1*t.config.duration_step)}),t),w[1].onclick=t.bind((function(){C(1*t.config.duration_step)}),t),b[0].onchange=E,b[1].onchange=E,b[2].onchange=E,b[3]&&(b[3].onchange=E),$.onkeydown=t.bind((function(e){var i;return(i=(e=e||window.event).charCode||e.keyCode||e.which)==t.constants.KEY_CODES.DOWN?(C(-1*t.config.duration_step),!1):i==t.constants.KEY_CODES.UP?(C(1*t.config.duration_step),!1):void window.setTimeout(E,1)}),t),$.onchange=t.bind(E,t),t._resolve_default_mapping(o),v=i.start_date||new Date,k=i.end_date||t.calculateEndDate({start_date:v,duration:1,task:a}),y=t.calculateDuration({start_date:v,end_date:k,task:a}),y=n(o).format(y),t.form_blocks._fill_lightbox_select(b,0,v,T,o),$.value=y,E()}function r(e,i){var n=e.getElementsByTagName("select"),a=i._time_format_order,r=0,s=0;if(t.defined(a[3])){var o=n[a[3]],l=parseInt(o.value,10);isNaN(l)&&o.hasAttribute("data-value")&&(l=parseInt(o.getAttribute("data-value"),10)),r=Math.floor(l/60),s=l%60}return new Date(n[a[2]].value,n[a[1]].value,n[a[0]].value,r,s)}function s(t,e){var i=t.getElementsByTagName("input")[1];return(i=n(e).parse(i.value))&&!window.isNaN(i)||(i=1),i<0&&(i*=-1),i}return Ti(i,e),i.prototype.render=function(t){return`<div style='height: ${t.height||100}px; padding-top:0px; font-size:inherit;' class='gantt_section_baselines'></div>`},i.prototype.set_value=function(e,i,n,r){n.baselines?(e.innerHTML="",n.baselines.forEach((t=>{a(e,t,n,r)}))):e.innerHTML=t.locale.labels.baselines_section_placeholder},i.prototype.get_value=function(e,i,n){const a=[];return e.querySelectorAll("[data-baseline-id]").forEach((e=>{const o=e.dataset.baselineId;let l,d=t.getDatastore("baselines").getItem(o);l=d?t.copy(d):{id:t.uid(),task_id:i.id,text:"Baseline 1"},l.start_date=r(e,n),l.duration=s(e,n),l.end_date=t.calculateEndDate({start_date:l.start_date,duration:l.duration,task:i}),a.push(l)})),a},i.prototype.button_click=function(e,i,n,r){if(!1!==t.callEvent("onSectionButton",[t._lightbox_id,n])&&(i.closest(".gantt_custom_button.gantt_remove_baselines")&&(r.innerHTML=t.locale.labels.baselines_section_placeholder),i.closest(".gantt_custom_button.gantt_add_baselines"))){r.innerHTML==t.locale.labels.baselines_section_placeholder&&(r.innerHTML="");const i=t.getTask(t._lightbox_id);a(r,{id:t.uid(),task_id:i.id,start_date:i.start_date,end_date:i.end_date},i,t._get_typed_lightbox_config()[e])}},i.prototype.focus=function(e){t._focus(e.getElementsByTagName("select")[0])},i}(t);t._lightbox_methods={},t._lightbox_template="<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span></div><div class='gantt_cal_larea'></div>",t._lightbox_template="<div class='gantt_cal_ltitle'><div class=\"dhx_cal_ltitle_descr\"><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='dhx_title'></span>\n</div>\n<div class=\"gantt_cal_ltitle_controls\">\n\t<a class=\"gantt_cal_ltitle_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\n</div></div><div class='gantt_cal_larea'></div>",t._lightbox_root=t.$root,t.$services.getService("state").registerProvider("lightbox",(function(){return{lightbox:t._lightbox_id}})),t.showLightbox=function(e){var i=this.getTask(e);if(this.callEvent("onBeforeLightbox",[e])){var n=this.getLightbox(this.getTaskType(i.type));this.showCover(n),this._fill_lightbox(e,n),this._setLbPosition(n),this._waiAria.lightboxVisibleAttr(n),this.callEvent("onLightbox",[e])}else t.isTaskExists(e)&&t.getTask(e).$new&&this.$data.tasksStore._updateOrder()},t._get_timepicker_step=function(){if(this.config.round_dnd_dates){var e;if((n=this.$ui.getView("timeline"))&&n.isVisible()){var i=t.getScale();e=L(i.unit)*i.step/60}return(!e||e>=1440)&&(e=this.config.time_step),e}var n;return this.config.time_step},t.getLabel=function(t,e){for(var i=this._get_typed_lightbox_config(),n=0;n<i.length;n++)if(i[n].map_to==t)for(var a=i[n].options,r=0;r<a.length;r++)if(a[r].key==e)return a[r].label;return""},t.updateCollection=function(e,i){i=i.slice(0);var n=t.serverList(e);if(!n)return!1;n.splice(0,n.length),n.push.apply(n,i||[]),t.resetLightbox()},t.getLightboxType=function(){return this.getTaskType(this._lightbox_type)},t.getLightbox=function(e){var i,n,a,r,s,o="";if(!0===t.config.csp||t.env.isSalesforce?t._lightbox_root=t.$root:t._lightbox_root=document.body,void 0===e&&(e=this.getLightboxType()),!this._lightbox||this.getLightboxType()!=this.getTaskType(e)){this._lightbox_type=this.getTaskType(e),i=document.createElement("div"),o="gantt_cal_light",n=this._is_lightbox_timepicker(),t.config.wide_form&&(o+=" gantt_cal_light_wide"),n&&(o+=" gantt_cal_light_full"),i.className=o,i.style.visibility="hidden",a=this._lightbox_template,a+="<div class='gantt_cal_lcontrols'>",a+=m(this.config.buttons_left),a+="<div class='gantt_cal_lcontrols_push_right'></div>",a+=m(this.config.buttons_right),a+="</div>",i.innerHTML=a,t._waiAria.lightboxAttr(i),t.config.drag_lightbox&&(i.firstChild.onmousedown=t._ready_to_dnd,i.firstChild.ontouchstart=function(e){t._ready_to_dnd(e.touches[0])},i.firstChild.onselectstart=function(){return!1},i.firstChild.style.cursor="pointer",t._init_dnd_events()),this._lightbox&&this.resetLightbox(),g(),this._cover.insertBefore(i,this._cover.firstChild),this._lightbox=i,r=this._get_typed_lightbox_config(e),a=this._render_sections(r);var l=(s=i.querySelector("div.gantt_cal_larea")).style.overflow;s.style.overflow="hidden",s.innerHTML=a,function(e){var i,n,a,r,s,o;for(o=0;o<e.length;o++)i=e[o],a=t._lightbox_root.querySelector("#"+i.id),i.id&&a&&(n=a.querySelector("label"),(r=a.nextSibling)&&(s=r.querySelector("input, select, textarea"))&&(s.id=s.id||"input_"+t.uid(),i.inputId=s.id,n.setAttribute("for",i.inputId)))}(r),s.style.overflow=l,this._init_lightbox_events(this),i.style.display="none",i.style.visibility="visible"}return this._lightbox},t._render_sections=function(t){for(var e="",i=0;i<t.length;i++){var n=this.form_blocks[t[i].type];if(n){t[i].id="area_"+this.uid();var a=t[i].hidden?" style='display:none'":"",r="";t[i].button&&(r="<div class='gantt_custom_button' data-index='"+i+"'><div class='gantt_custom_button_"+t[i].button+"'></div><div class='gantt_custom_button_label'>"+this.locale.labels["button_"+t[i].button]+"</div></div>"),"baselines"==t[i].type&&(r="<div class='gantt_custom_button gantt_remove_baselines' data-index='"+i+"'><div class='gantt_custom_button_delete_baselines'></div><div class='gantt_custom_button_label'>"+this.locale.labels.baselines_remove_all_button+"</div></div><div class='gantt_custom_button gantt_add_baselines' data-index='"+i+"'><div class='gantt_custom_button_add_baseline'></div><div class='gantt_custom_button_label'>"+this.locale.labels.baselines_add_button+"</div></div>"),this.config.wide_form&&(e+="<div class='gantt_wrap_section' "+a+">"),e+="<div id='"+t[i].id+"' class='gantt_cal_lsection'><label>"+r+(t[i].label||this.locale.labels["section_"+t[i].name]||t[i].name)+"</label></div>"+n.render.call(this,t[i]),e+="</div>"}}return e},t._center_lightbox=function(e){t._setLbPosition(e)},t._setLbPosition=function(e){if(!e)return;const i=t._lightbox_root||t.$root;e.style.top=Math.max(i.offsetHeight/2-e.offsetHeight/2,0)+"px",e.style.left=Math.max(i.offsetWidth/2-e.offsetWidth/2,0)+"px"},t.showCover=function(t){t&&(t.style.display="block",this._setLbPosition(t)),g(),this._cover.style.display=""};const g=function(){t._cover||(t._cover=document.createElement("div"),t._cover.className="gantt_cal_cover",t._cover.style.display="none",t.event(t._cover,"mousemove",t._move_while_dnd),t.event(t._cover,"mouseup",t._finish_dnd),(t._lightbox_root||t.$root).appendChild(t._cover))};function f(t){for(var e in this.config.types)if(this.config.types[e]==t)return e;return"task"}function m(e,i){var n,a,r="";for(a=0;a<e.length;a++)n=t.config._migrate_buttons[e[a]]?t.config._migrate_buttons[e[a]]:e[a],r+="<div "+t._waiAria.lightboxButtonAttrString(n)+" class='gantt_btn_set gantt_left_btn_set "+n+"_set'><div dhx_button='1' data-dhx-button='1' class='"+n+"'></div><div>"+t.locale.labels[n]+"</div></div>";return r}function v(e){var i,n;return e.time_format?e.time_format:(n=["%d","%m","%Y"],L((i=t.getScale())?i.unit:t.config.duration_unit)<L("day")&&n.push("%H:%i"),n)}function k(e,i,n){var a,r,s,o,l,d,c="";switch(n.timeFormat[i]){case"%Y":for(e._time_format_order[2]=i,e._time_format_order.size++,e.year_range&&(isNaN(e.year_range)?e.year_range.push&&(s=e.year_range[0],o=e.year_range[1]):a=e.year_range),a=a||10,r=r||Math.floor(a/2),s=s||n.date.getFullYear()-r,o=o||t.getState().max_date.getFullYear()+r,l=s;l<=o;l++)c+="<option value='"+l+"'>"+l+"</option>";break;case"%m":for(e._time_format_order[1]=i,e._time_format_order.size++,l=0;l<12;l++)c+="<option value='"+l+"'>"+t.locale.date.month_full[l]+"</option>";break;case"%d":for(e._time_format_order[0]=i,e._time_format_order.size++,l=1;l<32;l++)c+="<option value='"+l+"'>"+l+"</option>";break;case"%H:%i":for(e._time_format_order[3]=i,e._time_format_order.size++,l=n.first,d=n.date.getDate(),e._time_values=[];l<n.last;)c+="<option value='"+l+"'>"+t.templates.time_picker(n.date)+"</option>",e._time_values.push(l),n.date.setTime(n.date.valueOf()+60*t._get_timepicker_step()*1e3),l=24*(n.date.getDate()!=d?1:0)*60+60*n.date.getHours()+n.date.getMinutes()}return c}t._init_lightbox_events=function(){t.lightbox_events={},t.lightbox_events.gantt_save_btn=function(){t._save_lightbox()},t.lightbox_events.gantt_delete_btn=function(){t._lightbox_current_type=null,t.callEvent("onLightboxDelete",[t._lightbox_id])&&(t.isTaskExists(t._lightbox_id)?t.$click.buttons.delete(t._lightbox_id):t.hideLightbox())},t.lightbox_events.gantt_cancel_btn=function(){t._cancel_lightbox()},t.lightbox_events.default=function(e,i){if(i.getAttribute("data-dhx-button"))t.callEvent("onLightboxButton",[i.className,i,e]);else{var n,a,r=l(i);if(-1!=r.indexOf("gantt_custom_button"))if(-1!=r.indexOf("gantt_custom_button_"))for(n=i.parentNode.getAttribute("data-index"),a=i;a&&-1==l(a).indexOf("gantt_cal_lsection");)a=a.parentNode;else n=i.getAttribute("data-index"),a=i.closest(".gantt_cal_lsection"),i=i.firstChild;var s=t._get_typed_lightbox_config();n&&(n*=1,t.form_blocks[s[1*n].type].button_click(n,i,a,a.nextSibling))}},this.event(t.getLightbox(),"click",(function(e){e.target.closest(".gantt_cal_ltitle_close_btn")&&t._cancel_lightbox();var i=p(e),n=l(i);return n||(n=l(i=i.previousSibling)),i&&n&&0===n.indexOf("gantt_btn_set")&&(n=l(i=i.firstChild)),!(!i||!n)&&(t.defined(t.lightbox_events[i.className])?t.lightbox_events[i.className]:t.lightbox_events.default)(e,i)})),t.getLightbox().onkeydown=function(e){var i=e||window.event,n=e.target||e.srcElement,a=l(n).indexOf("gantt_btn_set")>-1;switch((e||i).keyCode){case t.constants.KEY_CODES.SPACE:if((e||i).shiftKey)return;a&&n.click&&n.click();break;case t.keys.edit_save:if((e||i).shiftKey)return;a&&n.click?n.click():t._save_lightbox();break;case t.keys.edit_cancel:t._cancel_lightbox()}}},t._cancel_lightbox=function(){var e=this.getLightboxValues();t._lightbox_current_type=null,this.callEvent("onLightboxCancel",[this._lightbox_id,e.$new]),t.isTaskExists(e.id)&&e.$new&&(this.silent((function(){t.$data.tasksStore.removeItem(e.id),t._update_flags(e.id,null)})),this.refreshData()),this.hideLightbox()},t._save_lightbox=function(){var e=this.getLightboxValues();t._lightbox_current_type=null,this.callEvent("onLightboxSave",[this._lightbox_id,e,!!e.$new])&&(t.$data.tasksStore._skipTaskRecalculation="lightbox",e.$new?(delete e.$new,this.addTask(e,e.parent,this.getTaskIndex(e.id))):this.isTaskExists(e.id)&&(this.mixin(this.getTask(e.id),e,!0),this.refreshTask(e.id),this.updateTask(e.id)),t.$data.tasksStore._skipTaskRecalculation=!1,this.refreshData(),this.hideLightbox())},t._resolve_default_mapping=function(t){var e=t.map_to;return{time:!0,time_optional:!0,duration:!0,duration_optional:!0}[t.type]?"auto"==t.map_to?e={start_date:"start_date",end_date:"end_date",duration:"duration"}:"string"==typeof t.map_to&&(e={start_date:t.map_to}):"constraint"===t.type&&(t.map_to&&"string"!=typeof t.map_to||(e={constraint_type:"constraint_type",constraint_date:"constraint_date"})),e},t.getLightboxValues=function(){let e={};t.isTaskExists(this._lightbox_id)&&(e=this.mixin({},this.getTask(this._lightbox_id)));const i=[...this._get_typed_lightbox_config()].sort(((t,e)=>"time"===t.name?1:"time"===e.name?-1:0));for(let n=0;n<i.length;n++){let a=t._lightbox_root.querySelector("#"+i[n].id);a=a&&a.nextSibling;let r=this.form_blocks[i[n].type];if(!r)continue;let s=r.get_value.call(this,a,e,i[n]),o=t._resolve_default_mapping(i[n]);if("string"==typeof o&&"auto"!=o)e[o]=s;else if("object"==typeof o)for(let t in o)o[t]&&(e[o[t]]=s[t])}return t._lightbox_current_type&&(e.type=t._lightbox_current_type),e},t.hideLightbox=function(){var t=this.getLightbox();t&&(t.style.display="none"),this._waiAria.lightboxHiddenAttr(t),this._lightbox_id=null,this.hideCover(t),this.resetLightbox(),this.callEvent("onAfterLightbox",[])},t.hideCover=function(t){t&&(t.style.display="none"),this._cover&&this._cover.parentNode.removeChild(this._cover),this._cover=null},t.resetLightbox=function(){t._lightbox&&!t._custom_lightbox&&t._lightbox.remove(),t._lightbox=null},t._set_lightbox_values=function(e,i){var n=e,a=i.getElementsByTagName("span"),r=[];t.templates.lightbox_header?(r.push(""),r.push(t.templates.lightbox_header(n.start_date,n.end_date,n)),a[1].innerHTML="",a[2].innerHTML=t.templates.lightbox_header(n.start_date,n.end_date,n)):(r.push(this.templates.task_time(n.start_date,n.end_date,n)),r.push(String(this.templates.task_text(n.start_date,n.end_date,n)||"").substr(0,70)),a[1].innerHTML=this.templates.task_time(n.start_date,n.end_date,n),a[2].innerHTML=String(this.templates.task_text(n.start_date,n.end_date,n)||"").substr(0,70)),a[1].innerHTML=r[0],a[2].innerHTML=r[1],t._waiAria.lightboxHeader(i,r.join(" "));for(var s=this._get_typed_lightbox_config(this.getLightboxType()),o=0;o<s.length;o++){var l=s[o];if(this.form_blocks[l.type]){var d=t._lightbox_root.querySelector("#"+l.id).nextSibling,c=this.form_blocks[l.type],u=t._resolve_default_mapping(s[o]),h=this.defined(n[u])?n[u]:l.default_value;c.set_value.call(t,d,h,n,l),l.focus&&c.focus.call(t,d)}}t.isTaskExists(e.id)&&(t._lightbox_id=e.id)},t._fill_lightbox=function(t,e){var i=this.getTask(t);this._set_lightbox_values(i,e)},t.getLightboxSection=function(e){for(var i=this._get_typed_lightbox_config(),n=0;n<i.length&&i[n].name!=e;n++);var a=i[n];if(!a)return null;this._lightbox||this.getLightbox();var r=t._lightbox_root.querySelector("#"+a.id),s=r.nextSibling,o={section:a,header:r,node:s,getValue:function(e){return t.form_blocks[a.type].get_value.call(t,s,e||{},a)},setValue:function(e,i){return t.form_blocks[a.type].set_value.call(t,s,e,i||{},a)}},l=this._lightbox_methods["get_"+a.type+"_control"];return l?l(o):o},t._lightbox_methods.get_template_control=function(t){return t.control=t.node,t},t._lightbox_methods.get_select_control=function(t){return t.control=t.node.getElementsByTagName("select")[0],t},t._lightbox_methods.get_textarea_control=function(t){return t.control=t.node.getElementsByTagName("textarea")[0],t},t._lightbox_methods.get_time_control=function(t){return t.control=t.node.getElementsByTagName("select"),t},t._init_dnd_events=function(){var e=t._lightbox_root;this.event(e,"mousemove",t._move_while_dnd),this.event(e,"mouseup",t._finish_dnd),this.event(e,"touchmove",(function(e){t._move_while_dnd(e.touches[0])})),this.event(e,"touchend",(function(e){t._finish_dnd(e.touches[0])}))},t._move_while_dnd=function(e){if(t._dnd_start_lb){document.gantt_unselectable||(t._lightbox_root.className+=" gantt_unselectable",document.gantt_unselectable=!0);var i=t.getLightbox(),n=[e.pageX,e.pageY];i.style.top=t._lb_start[1]+n[1]-t._dnd_start_lb[1]+"px",i.style.left=t._lb_start[0]+n[0]-t._dnd_start_lb[0]+"px"}},t._ready_to_dnd=function(e){var i=t.getLightbox();t._lb_start=[i.offsetLeft,i.offsetTop],t._dnd_start_lb=[e.pageX,e.pageY]},t._finish_dnd=function(){t._lb_start&&(t._lb_start=t._dnd_start_lb=!1,t._lightbox_root.className=t._lightbox_root.className.replace(" gantt_unselectable",""),document.gantt_unselectable=!1)},t._focus=function(e,i){if(e&&e.focus&&!t.config.touch)try{i&&e.select&&e.select(),e.focus()}catch{}},t.form_blocks={getTimePicker:function(e,i){var n,a,r,s="",o=this.config,l={first:0,last:1440,date:this.date.date_part(new Date(t._min_date.valueOf())),timeFormat:v(e)};for(e._time_format_order={size:0},t.config.limit_time_select&&(l.first=60*o.first_hour,l.last=60*o.last_hour+1,l.date.setHours(o.first_hour)),n=0;n<l.timeFormat.length;n++)n>0&&(s+=" "),(a=k(e,n,l))&&(r=t._waiAria.lightboxSelectAttrString(l.timeFormat[n]),s+="<select "+(e.readonly?"disabled='disabled'":"")+(i?" style='display:none' ":"")+r+">"+a+"</select>");return s},getTimePickerValue:function(e,i,n){var a,r=i._time_format_order,s=0,o=0,l=n||0;return t.defined(r[3])&&(a=parseInt(e[r[3]+l].value,10),s=Math.floor(a/60),o=a%60),new Date(e[r[2]+l].value,e[r[1]+l].value,e[r[0]+l].value,s,o)},_fill_lightbox_select:function(e,i,n,a){if(e[i+a[0]].value=n.getDate(),e[i+a[1]].value=n.getMonth(),e[i+a[2]].value=n.getFullYear(),t.defined(a[3])){var r=60*n.getHours()+n.getMinutes();r=Math.round(r/t._get_timepicker_step())*t._get_timepicker_step();var s=e[i+a[3]];s.value=r,s.setAttribute("data-value",r)}},template:new e,textarea:new i,select:new a,time:new n,duration:new o,parent:new d,radio:new s,checkbox:new r,resources:new c,constraint:new u,baselines:new _,typeselect:new h},t._is_lightbox_timepicker=function(){for(var t=this._get_typed_lightbox_config(),e=0;e<t.length;e++)if("time"==t[e].name&&"time"==t[e].type)return!0;return!1},t._delete_task_confirm=function({task:e,message:i,title:n,callback:a,ok:r}){t._simple_confirm(i,n,a,r)},t._delete_link_confirm=function({link:e,message:i,title:n,callback:a,ok:r}){t._simple_confirm(i,n,a,r)},t._simple_confirm=function(e,i,n,a){if(!e)return n();var r={text:e};i&&(r.title=i),a&&(r.ok=a),n&&(r.callback=function(t){t&&n()}),t.confirm(r)},t._get_typed_lightbox_config=function(e){void 0===e&&(e=this.getLightboxType());var i=f.call(this,e);return t.config.lightbox[i+"_sections"]?t.config.lightbox[i+"_sections"]:t.config.lightbox.sections},t._silent_redraw_lightbox=function(t){var e=this.getLightboxType();if(this.getState().lightbox){var i=this.getState().lightbox,n=this.getLightboxValues(),a=this.copy(this.getTask(i));this.resetLightbox();var r=this.mixin(a,n,!0),s=this.getLightbox(t||void 0);this._set_lightbox_values(r,s),this.showCover(s)}else this.resetLightbox(),this.getLightbox(t||void 0);this.callEvent("onLightboxChange",[e,this.getLightboxType()])}}function Hn(t){if(!pt.isNode){t.utils={arrayFind:R,dom:C};var e=rt();t.event=e.attach,t.eventRemove=e.detach,t._eventRemoveAll=e.detachAll,t._createDomEventScope=e.extend,Z(t,ui(t));var i=bn(t);t.$ui=i.factory,t.$ui.layers=i.render,t.$mouseEvents=i.mouseEvents,t.$services.setService("mouseEvents",(function(){return t.$mouseEvents})),t.mixin(t,i.layersApi),delete(n=t).addTaskLayer,delete n.addLinkLayer,t.$services.setService("layers",(function(){return i.layersService})),t.mixin(t,function(){function t(t){return t.$ui.getView("timeline")}function e(t){return t.$ui.getView("grid")}function i(i){var n=t(i);if(n&&!n.$config.hidden)return n;var a=e(i);return a&&!a.$config.hidden?a:null}function n(t){var n,a=!1;return[".gantt_drag_marker.gantt_grid_resize_area",".gantt_drag_marker .gantt_row.gantt_row_task",".gantt_drag_marker.gantt_grid_dnd_marker"].forEach((function(t){a=a||!!document.querySelector(t)})),(n=a?e(t):i(t))?r(t,n,"scrollY"):null}function a(t){var e=i(t);return e&&"grid"!=e.id?r(t,e,"scrollX"):null}function r(t,e,i){var n=e.$config[i];return t.$ui.getView(n)}var s="DEFAULT_VALUE";function o(t,e,i,n){var a=t(this);return a&&a.isVisible()?a[e].apply(a,i):n?n():s}return{getColumnIndex:function(t){var i=o.call(this,e,"getColumnIndex",[t]);return i===s?0:i},dateFromPos:function(e){var i=o.call(this,t,"dateFromPos",Array.prototype.slice.call(arguments));return i===s?this.getState().min_date:i},posFromDate:function(e){var i=o.call(this,t,"posFromDate",[e]);return i===s?0:i},getRowTop:function(i){var n=this,a=o.call(n,t,"getRowTop",[i],(function(){return o.call(n,e,"getRowTop",[i])}));return a===s?0:a},getTaskTop:function(i){var n=this,a=o.call(n,t,"getItemTop",[i],(function(){return o.call(n,e,"getItemTop",[i])}));return a===s?0:a},getTaskPosition:function(e,i,n){var a=o.call(this,t,"getItemPosition",[e,i,n]);return a===s?{left:0,top:this.getTaskTop(e.id),height:this.getTaskBarHeight(e.id),width:0}:a},getTaskBarHeight:function(i,n){var a=this,r=o.call(a,t,"getBarHeight",[i,n],(function(){return o.call(a,e,"getItemHeight",[i])}));return r===s?0:r},getTaskHeight:function(i){var n=this,a=o.call(n,t,"getItemHeight",[i],(function(){return o.call(n,e,"getItemHeight",[i])}));return a===s?0:a},columnIndexByDate:function(e){var i=o.call(this,t,"columnIndexByDate",[e]);return i===s?0:i},roundTaskDates:function(){o.call(this,t,"roundTaskDates",[])},getScale:function(){var e=o.call(this,t,"getScale",[]);return e===s?null:e},getTaskNode:function(e){var i=t(this);if(i&&i.isVisible()){var n=i._taskRenderer.rendered[e];if(!n){var a=i.$config.item_attribute;n=i.$task_bars.querySelector("["+a+"='"+e+"']")}return n||null}return null},getLinkNode:function(e){var i=t(this);return i.isVisible()?i._linkRenderer.rendered[e]:null},scrollTo:function(t,e){var i=n(this),r=a(this),s={position:0},o={position:0};i&&(o=i.getScrollState()),r&&(s=r.getScrollState());var l=r&&1*t==t,d=i&&1*e==e;if(l&&d)for(var c=i._getLinkedViews(),u=r._getLinkedViews(),h=[],_=0;_<c.length;_++)for(var g=0;g<u.length;g++)c[_].$config.id&&u[g].$config.id&&c[_].$config.id===u[g].$config.id&&h.push(c[_].$config.id);l&&(h&&h.forEach(function(t){this.$ui.getView(t).$config.$skipSmartRenderOnScroll=!0}.bind(this)),r.scroll(t),h&&h.forEach(function(t){this.$ui.getView(t).$config.$skipSmartRenderOnScroll=!1}.bind(this))),d&&i.scroll(e);var f={position:0},p={position:0};i&&(f=i.getScrollState()),r&&(p=r.getScrollState()),this.callEvent("onGanttScroll",[s.position,o.position,p.position,f.position])},showDate:function(t){var e=this.posFromDate(t),i=Math.max(e-this.config.task_scroll_offset,0);this.scrollTo(i)},showTask:function(i){var n=this.getTaskPosition(this.getTask(i)),a=n.left;this.config.rtl&&(a=n.left+n.width);var s,o=Math.max(a-this.config.task_scroll_offset,0),l=this._scroll_state().y;s=l?n.top-(l-this.getTaskBarHeight(i))/2:n.top,this.scrollTo(o,s);var d=e(this),c=t(this);d&&c&&d.$config.scrollY!=c.$config.scrollY&&r(this,d,"scrollY").scrollTo(null,s)},_scroll_state:function(){var t={x:!1,y:!1,x_pos:0,y_pos:0,scroll_size:this.config.scroll_size+1,x_inner:0,y_inner:0},e=n(this),i=a(this);if(i){var r=i.getScrollState();r.visible&&(t.x=r.size,t.x_inner=r.scrollSize),t.x_pos=r.position||0}if(e){var s=e.getScrollState();s.visible&&(t.y=s.size,t.y_inner=s.scrollSize),t.y_pos=s.position||0}return t},getScrollState:function(){var t=this._scroll_state();return{x:t.x_pos,y:t.y_pos,inner_width:t.x,inner_height:t.y,width:t.x_inner,height:t.y_inner}},getLayoutView:function(t){return this.$ui.getView(t)},scrollLayoutCell:function(t,e,i){const n=this.$ui.getView(t);if(!n)return!1;if(null!==e){const t=this.$ui.getView(n.$config.scrollX);t&&t.scrollTo(e,null)}if(null!==i){const t=this.$ui.getView(n.$config.scrollY);t&&t.scrollTo(null,i)}}}}()),function(t){t.resetSkin||(t.resetSkin=function(){this.skin="",xn(!0,this)},t.skins={},t.attachEvent("onGanttLayoutReady",(function(){xn(!1,this),i()}))),t._addThemeClass=function(){document.documentElement.setAttribute("data-gantt-theme",t.skin)},t.setSkin=function(e){const n=this.skin!==e;this.skin=e,t._addThemeClass(),i(),t.$root&&(xn(!n,t),this.render())};let e=null;function i(){const i=t.$root;e&&clearInterval(e),i&&(e=setInterval((()=>{const e=getComputedStyle(i).getPropertyValue("--dhx-gantt-theme");e&&e!==t.skin&&t.setSkin(e)}),100))}t.attachEvent("onDestroy",(function(){clearInterval(e)}))}(t),function(t){t.skins.skyblue={config:{grid_width:370,row_height:27,bar_height_padding:4,scale_height:27,link_line_width:1,link_arrow_size:8,link_radius:2,lightbox_additional_height:75},_second_column_width:95,_third_column_width:80}}(t),function(t){t.skins.dark={config:{grid_width:390,row_height:36,scale_height:36,link_line_width:2,link_arrow_size:12,bar_height_padding:9,lightbox_additional_height:75},_second_column_width:100,_third_column_width:70}}(t),function(t){t.skins.meadow={config:{grid_width:380,row_height:27,scale_height:30,link_line_width:2,link_arrow_size:10,bar_height_padding:4,lightbox_additional_height:72},_second_column_width:95,_third_column_width:80}}(t),function(t){t.skins.terrace={config:{grid_width:390,row_height:36,scale_height:36,link_line_width:2,link_arrow_size:12,bar_height_padding:9,lightbox_additional_height:75},_second_column_width:100,_third_column_width:70}}(t),function(t){t.skins.broadway={config:{grid_width:390,row_height:35,scale_height:35,link_line_width:1,link_arrow_size:9,bar_height_padding:4,lightbox_additional_height:86},_second_column_width:100,_third_column_width:80,_lightbox_template:"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span><div class='gantt_cancel_btn'></div></div><div class='gantt_cal_larea'></div>",_config_buttons_left:{},_config_buttons_right:{gantt_delete_btn:"icon_delete",gantt_save_btn:"icon_save"}}}(t),function(t){t.skins.material={config:{grid_width:411,row_height:34,scale_height:36,link_line_width:2,link_arrow_size:12,bar_height_padding:9,lightbox_additional_height:80},_second_column_width:110,_third_column_width:75,_redefine_lightbox_buttons:{buttons_left:["dhx_delete_btn"],buttons_right:["dhx_cancel_btn","dhx_save_btn"]}},t.attachEvent("onAfterTaskDrag",(function(e){var i=t.getTaskNode(e);i&&(i.className+=" gantt_drag_animation",setTimeout((function(){var t=i.className.indexOf(" gantt_drag_animation");t>-1&&(i.className=i.className.slice(0,t))}),200))}))}(t),function(t){t.skins.contrast_black={config:{grid_width:390,row_height:35,scale_height:35,link_line_width:2,link_arrow_size:12,lightbox_additional_height:75},_second_column_width:100,_third_column_width:80}}(t),function(t){t.skins.contrast_white={config:{grid_width:390,row_height:35,scale_height:35,link_line_width:2,link_arrow_size:12,lightbox_additional_height:75},_second_column_width:100,_third_column_width:80}}(t),function(t){t.ext||(t.ext={});for(var e=[$n,null,null],i=0;i<e.length;i++)e[i]&&e[i](t);t.ext.zoom=new Cn(t)}(t),function(t){function e(){if("force"!=t.config.touch&&(t.config.touch=t.config.touch&&(-1!=navigator.userAgent.indexOf("Mobile")||-1!=navigator.userAgent.indexOf("iPad")||-1!=navigator.userAgent.indexOf("Android")||-1!=navigator.userAgent.indexOf("Touch"))||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),t.config.touch){var e=!0;try{document.createEvent("TouchEvent")}catch{e=!1}e?t._touch_events(["touchmove","touchstart","touchend"],(function(t){return t.touches&&t.touches.length>1?null:t.touches[0]?{target:t.target,pageX:t.touches[0].pageX,pageY:t.touches[0].pageY,clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}:t}),(function(t){return t.defaultPrevented})):window.navigator.pointerEnabled?t._touch_events(["pointermove","pointerdown","pointerup"],(function(t){return"mouse"==t.pointerType?null:t}),(function(t){return!t||"mouse"==t.pointerType})):window.navigator.msPointerEnabled&&t._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],(function(t){return t.pointerType==t.MSPOINTER_TYPE_MOUSE?null:t}),(function(t){return!t||t.pointerType==t.MSPOINTER_TYPE_MOUSE}))}}function i(e){var i=e.$config.scrollX?t.$ui.getView(e.$config.scrollX):null,n=e.$config.scrollY?t.$ui.getView(e.$config.scrollY):null,a={x:null,y:null};return i&&i.getScrollState().visible&&(a.x=i.$view.scrollLeft),n&&n.getScrollState().visible&&(a.y=n.$view.scrollTop),a}function n(){var e;return t.$ui.getView("timeline")&&(e=t.$ui.getView("timeline")._tasks_dnd),e}t.config.touch_drag=75,t.config.touch=!0,t.config.touch_feedback=!0,t.config.touch_feedback_duration=1,t._prevent_touch_scroll=!1,t._touch_feedback=function(){t.config.touch_feedback&&navigator.vibrate&&navigator.vibrate(t.config.touch_feedback_duration)},t.attachEvent("onGanttReady",(function(){t.$container&&e()})),t.attachEvent("onGanttLayoutReady",(function(){t.$container&&t.attachEvent("onGanttRender",e,{once:!0})}));var a=[];t._touch_events=function(e,r,s){var o,l=0,d=!1,c=!1,u=null,h=null,_=null,g=[],f=null;let p={};for(var m=0;m<a.length;m++)t.eventRemove(a[m][0],a[m][1],a[m][2]);(a=[]).push([t.$container,e[0],function(e){var a,_,g,p,m,k=n();if(!s(e)&&d){h&&clearTimeout(h);var y=r(e);if(k&&(k.drag.id||k.drag.start_drag))return k.on_mouse_move(y),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,!1;if(!t._prevent_touch_scroll){if(y&&u){var b=u.pageX-y.pageX,x=u.pageY-y.pageY;if(!c&&(Math.abs(b)>5||Math.abs(x)>5)&&(c=!0,l=0,o=f?i(f):t.getScrollState()),c){var $,w=o.x+b,S=o.y+x;if(f?(_=w,g=S,p=(a=f).$config.scrollX?t.$ui.getView(a.$config.scrollX):null,m=a.$config.scrollY?t.$ui.getView(a.$config.scrollY):null,p&&p.scrollTo(_,null),m&&m.scrollTo(null,g),$=i(f)):(t.scrollTo(w,S),$=t.getScrollState()),o.x!=$.x&&x>2*b||o.y!=$.y&&b>2*x)return v(e)}}return v(e)}return!0}}]);try{document.addEventListener("touchmove",(function(e){t._touch_drag&&v(e)}),{passive:!1})}catch{console.warn("Cannot prevent touch event for the page drag")}for(a.push([this.$container,"contextmenu",function(t){if(d)return v(t)}]),a.push([this.$container,e[1],function(e){if(p=e.touches.length,document&&document.body&&document.body.classList.add("gantt_touch_active"),!s(e))if(e.touches&&e.touches.length>1)d=!1;else{u=r(e),f=function(e){for(var i=t.$layout.getCellsByType("viewCell"),n=0;n<i.length;n++){var a=i[n].$view.getBoundingClientRect();if(e.clientX>=a.left&&e.clientX<=a.right&&e.clientY<=a.bottom&&e.clientY>=a.top)return i[n]}}(u),t._locate_css(u,"gantt_hor_scroll")||t._locate_css(u,"gantt_ver_scroll")||(d=!0);var i=n();h=setTimeout((function(){var e=t.locate(u);i&&e&&!t._locate_css(u,"gantt_link_control")&&!t._locate_css(u,"gantt_grid_data")&&(i.on_mouse_down(u),i.drag&&i.drag.start_drag&&(function(e){const i=t._getTaskLayers();let n=t.getTask(e);if(n){let a=t.isTaskVisible(e);if(a){_=e;for(let a=0;a<i.length;a++)if(n=i[a].rendered[e],n&&n.getAttribute(t.config.task_attribute)&&n.getAttribute(t.config.task_attribute)==e){const t=n.cloneNode(!0);g.push(n),i[a].rendered[e]=t,n.style.display="none",t.className+=" gantt_drag_move ",n.parentNode.appendChild(t)}}else if(n.$split_subtask){let r=n.$rendered_parent;if(a=t.isTaskVisible(r),!a)return;_=e;for(let e=0;e<i.length;e++){const a=i[e].rendered[r];let s;if(a&&a.childNodes&&(s=a.querySelector(`[${t.config.task_attribute}="${n.id}"]`)),s){const e=s.cloneNode(!0);s.parentNode.appendChild(e),t.$task_bars.appendChild(s),s.style.display="none",g.push(s),s=null}}}}}(e),i._start_dnd(u),t._touch_drag=!0,t.refreshTask(e),t._touch_feedback())),h=null}),t.config.touch_drag)}}]),a.push([this.$container,e[2],function(e){if(document&&document.body&&document.body.classList.remove("gantt_touch_active"),!s(e)){h&&clearTimeout(h),t._touch_drag=!1,d=!1;var i=r(e),a=n();if(a&&a.on_mouse_up(i),_&&t.isTaskExists(_)&&(t.refreshTask(_),g.length&&(g.forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)})),t._touch_feedback())),d=c=!1,g=[],_=null,u&&l){var o=new Date;o-l<500&&p<=1?(t.$services.getService("mouseEvents").onDoubleClick(u),v(e)):l=o}else l=new Date}}]),m=0;m<a.length;m++)t.event(a[m][0],a[m][1],a[m][2]);function v(t){return t&&t.preventDefault&&t.cancelable&&t.preventDefault(),t.cancelBubble=!0,!1}}}(t),Rn(t),function(t){t._extend_to_optional=function(e){var i=e,n={render:i.render,focus:i.focus,set_value:function(e,a,r,s){var o=t._resolve_default_mapping(s);if(!r[o.start_date]||"start_date"==o.start_date&&this._isAllowedUnscheduledTask(r)){n.disable(e,s);var l={};for(var d in o)l[o[d]]=r[d];return i.set_value.call(t,e,a,l,s)}return n.enable(e,s),i.set_value.call(t,e,a,r,s)},get_value:function(e,n,a){return a.disabled?{start_date:null}:i.get_value.call(t,e,n,a)},update_block:function(e,i){if(t.callEvent("onSectionToggle",[t._lightbox_id,i]),e.style.display=i.disabled?"none":"",i.button){var n=e.previousSibling.querySelector(".gantt_custom_button_label"),a=t.locale.labels,r=i.disabled?a[i.name+"_enable_button"]:a[i.name+"_disable_button"];n.innerHTML=r}},disable:function(t,e){e.disabled=!0,n.update_block(t,e)},enable:function(t,e){e.disabled=!1,n.update_block(t,e)},button_click:function(e,i,a,r){if(!1!==t.callEvent("onSectionButton",[t._lightbox_id,a])){var s=t._get_typed_lightbox_config()[e];s.disabled?n.enable(r,s):n.disable(r,s)}}};return n},t.form_blocks.duration_optional=t._extend_to_optional(t.form_blocks.duration),t.form_blocks.time_optional=t._extend_to_optional(t.form_blocks.time)}(t),function(t){var e=new RegExp("<(?:.|\n)*?>","gm"),i=new RegExp(" +","gm");function n(t){return(t+"").replace(e," ").replace(i," ")}var a=new RegExp("'","gm");function r(t){return(t+"").replace(a,"&#39;")}for(var s in t._waiAria={getAttributeString:function(t){var e=[" "];for(var i in t){var a=r(n(t[i]));e.push(i+"='"+a+"'")}return e.push(" "),e.join(" ")},getTimelineCellAttr:function(e){return t._waiAria.getAttributeString({"aria-label":e})},_taskCommonAttr:function(e,i){e.start_date&&e.end_date&&(i.setAttribute("aria-label",n(t.templates.tooltip_text(e.start_date,e.end_date,e))),e.$dataprocessor_class&&i.setAttribute("aria-busy",!0))},setTaskBarAttr:function(e,i){this._taskCommonAttr(e,i),i.setAttribute("role","img"),!t.isReadonly(e)&&t.config.drag_move&&(e.id!=t.getState("tasksDnd").drag_id?i.setAttribute("aria-grabbed",!1):i.setAttribute("aria-grabbed",!0))},taskRowAttr:function(e,i){this._taskCommonAttr(e,i),!t.isReadonly(e)&&t.config.order_branch&&i.setAttribute("aria-grabbed",!1),i.setAttribute("role","row"),i.setAttribute("aria-selected",t.isSelectedTask(e.id)?"true":"false"),i.setAttribute("aria-level",e.$level+1||1),t.hasChild(e.id)&&i.setAttribute("aria-expanded",e.$open?"true":"false")},linkAttr:function(e,i){var a=t.config.links,r=e.type==a.finish_to_start||e.type==a.start_to_start,s=e.type==a.start_to_start||e.type==a.start_to_finish,o=t.locale.labels.link+" "+t.templates.drag_link(e.source,s,e.target,r);i.setAttribute("role","img"),i.setAttribute("aria-label",n(o))},gridSeparatorAttr:function(t){t.setAttribute("role","columnheader")},rowResizerAttr:function(t){t.setAttribute("role","row")},lightboxHiddenAttr:function(t){t.setAttribute("aria-hidden","true")},lightboxVisibleAttr:function(t){t.setAttribute("aria-hidden","false")},lightboxAttr:function(t){t.setAttribute("role","dialog"),t.setAttribute("aria-hidden","true"),t.firstChild.setAttribute("role","heading"),t.firstChild.setAttribute("aria-level","1")},lightboxButtonAttrString:function(e){return this.getAttributeString({role:"button","aria-label":t.locale.labels[e],tabindex:"0"})},lightboxHeader:function(t,e){t.setAttribute("aria-label",e)},lightboxSelectAttrString:function(e){var i="";switch(e){case"%Y":i=t.locale.labels.years;break;case"%m":i=t.locale.labels.months;break;case"%d":i=t.locale.labels.days;break;case"%H:%i":i=t.locale.labels.hours+t.locale.labels.minutes}return t._waiAria.getAttributeString({"aria-label":i})},lightboxDurationInputAttrString:function(e){return this.getAttributeString({"aria-label":t.locale.labels.column_duration,"aria-valuemin":"0",role:"spinbutton"})},inlineEditorAttr:function(t){t.setAttribute("role","row")},gridAttrString:function(){return[" role='treegrid'",t.config.multiselect?"aria-multiselectable='true'":"aria-multiselectable='false'"," "].join(" ")},gridScaleRowAttrString:function(){return"role='row'"},gridScaleCellAttrString:function(e,i){var n="";if("add"==e.name)n=this.getAttributeString({role:"columnheader","aria-label":t.locale.labels.new_task});else{var a={role:"columnheader","aria-label":t.config.external_render&&t.config.external_render.isElement(i)?"":i};t._sort&&t._sort.name==e.name&&("asc"==t._sort.direction?a["aria-sort"]="ascending":a["aria-sort"]="descending"),n=this.getAttributeString(a)}return n},gridDataAttrString:function(){return"role='rowgroup'"},reorderMarkerAttr:function(t){t.setAttribute("role","grid"),t.firstChild.removeAttribute("aria-level"),t.firstChild.setAttribute("aria-grabbed","true")},gridCellAttrString:function(e,i,n){var a={role:"gridcell","aria-label":i};return e.editor&&!t.isReadonly(n)||(a["aria-readonly"]=!0),this.getAttributeString(a)},gridAddButtonAttrString:function(e){return this.getAttributeString({role:"button","aria-label":t.locale.labels.new_task})},messageButtonAttrString:function(t){return"tabindex='0' role='button' aria-label='"+t+"'"},messageInfoAttr:function(t){t.setAttribute("role","alert")},messageModalAttr:function(t,e){t.setAttribute("role","dialog"),e&&t.setAttribute("aria-labelledby",e)},quickInfoAttr:function(t){t.setAttribute("role","dialog")},quickInfoHeaderAttrString:function(){return" role='heading' aria-level='1' "},quickInfoHeader:function(t,e){t.setAttribute("aria-label",e)},quickInfoButtonAttrString:function(e){return t._waiAria.getAttributeString({role:"button","aria-label":e,tabindex:"0"})},tooltipAttr:function(t){t.setAttribute("role","tooltip")},tooltipVisibleAttr:function(t){t.setAttribute("aria-hidden","false")},tooltipHiddenAttr:function(t){t.setAttribute("aria-hidden","true")}},t._waiAria)t._waiAria[s]=function(e){return function(){return t.config.wai_aria_attributes?e.apply(this,arguments):""}}(t._waiAria[s])}(t),t.locate=function(t){var e=p(t);if($(e,".gantt_task_row"))return null;var i=arguments[1]||this.config.task_attribute,n=m(e,i);return n?n.getAttribute(i):null},t._locate_css=function(t,e,i){return k(t,e,i)},t._locateHTML=function(t,e){return m(t,e||this.config.task_attribute)}}var n;t.attachEvent("onParse",(function(){It(t)||t.attachEvent("onGanttRender",(function(){if(t.config.initial_scroll){var e=t.getTaskByIndex(0),i=e?e.id:t.config.root_id;t.isTaskExists(i)&&t.$task&&t.utils.dom.isChildOf(t.$task,t.$container)&&t.showTask(i)}}),{once:!0})})),t.attachEvent("onBeforeGanttReady",(function(){this.config.scroll_size||(this.config.scroll_size=o()||15),It(t)||(this._eventRemoveAll(),this.$mouseEvents.reset(),this.resetLightbox())})),t.attachEvent("onGanttReady",(function(){!It(t)&&t.config.rtl&&t.$layout.getCellsByType("viewCell").forEach((function(e){var i=e.$config.scrollX;if(i){var n=t.$ui.getView(i);n&&n.scrollTo(n.$config.scrollSize,0)}}))})),t.attachEvent("onGanttReady",(function(){if(!It(t)){var e=t.plugins(),i={auto_scheduling:t.autoSchedule,click_drag:t.ext.clickDrag,critical_path:t.isCriticalTask,drag_timeline:t.ext.dragTimeline,export_api:t.exportToPDF,fullscreen:t.ext.fullscreen,grouping:t.groupBy,keyboard_navigation:t.ext.keyboardNavigation,marker:t.addMarker,multiselect:t.eachSelectedTask,overlay:t.ext.overlay,quick_info:t.templates.quick_info_content,tooltip:t.ext.tooltips,undo:t.undo};for(let t in i)i[t]&&!e[t]&&console.warn(`You connected the '${t}' extension via an obsolete file. \nTo fix it, you need to remove the obsolete file and connect the extension via the plugins method: https://docs.dhtmlx.com/gantt/api__gantt_plugins.html`)}}))}const On=D.gantt=function(t){var e,i=ci(t);return i.env.isNode||(Hn(i),(e=i).load=function(t,i,n){this._load_url=t,this.assert(arguments.length,"Invalid load arguments");var a="json",r=null;return arguments.length>=3?(a=i,r=n):"string"==typeof arguments[1]?a=arguments[1]:"function"==typeof arguments[1]&&(r=arguments[1]),this._load_type=a,this.callEvent("onLoadStart",[t,a]),this.ajax.get(t,e.bind((function(e){this.on_load(e,a),this.callEvent("onLoadEnd",[t,a]),"function"==typeof r&&r.call(this)}),this))}),i}(ht);t.default=On,t.gantt=On,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
//# sourceMappingURL=/sm/ec4049208dca15b1d74334d9b37c8a7fb3d6ca320fe9cb775959bc3436592091.map